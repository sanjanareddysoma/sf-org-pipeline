[0m19:02:20.458671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A4F2DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A4BD1BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A4F2E840>]}


============================== 19:02:20.468607 | 296d83fe-d0ec-4bdf-bb41-ce943a699916 ==============================
[0m19:02:20.468607 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:02:20.470606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:02:20.907414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '296d83fe-d0ec-4bdf-bb41-ce943a699916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A57AFB60>]}
[0m19:02:20.972953 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:02:20.976262 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:02:20.980365 [debug] [MainThread]: Command `cli deps` succeeded at 19:02:20.979314 after 1.12 seconds
[0m19:02:20.981375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A2258140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A57894F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A5789310>]}
[0m19:02:20.982360 [debug] [MainThread]: Flushing usage events
[0m19:02:22.371776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:22.959704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B4829CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B7421A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B7421F70>]}


============================== 12:54:22.972782 | bac6ea96-0a7b-44e8-a5db-d704f8cd7bbe ==============================
[0m12:54:22.972782 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:54:22.977632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:25.941171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bac6ea96-0a7b-44e8-a5db-d704f8cd7bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B7A43230>]}
[0m12:54:26.137640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bac6ea96-0a7b-44e8-a5db-d704f8cd7bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B99F44D0>]}
[0m12:54:26.149355 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m12:54:27.837564 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:54:27.924145 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:54:27.927324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bac6ea96-0a7b-44e8-a5db-d704f8cd7bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B7420380>]}
[0m12:54:32.530858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.healthcare.example
[0m12:54:32.539431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bac6ea96-0a7b-44e8-a5db-d704f8cd7bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1BA0DA330>]}
[0m12:54:32.742430 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m12:54:32.807601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m12:54:32.997386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bac6ea96-0a7b-44e8-a5db-d704f8cd7bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1BA0606E0>]}
[0m12:54:33.002636 [info ] [MainThread]: Found 1 model, 472 macros
[0m12:54:33.007502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bac6ea96-0a7b-44e8-a5db-d704f8cd7bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1BA0295B0>]}
[0m12:54:33.012738 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:54:33.017529 [debug] [MainThread]: Command end result
[0m12:54:33.087320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m12:54:33.097492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m12:54:33.112311 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m12:54:33.117516 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:33.117516 after 10.47 seconds
[0m12:54:33.117516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B6DE1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B6DE1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B4DB14C0>]}
[0m12:54:33.120805 [debug] [MainThread]: Flushing usage events
[0m12:54:33.302359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:22.276689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AECFF7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AEC00CA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AECFF7650>]}


============================== 14:13:22.293317 | 013ecf77-0f3a-4b30-99a9-78384907855c ==============================
[0m14:13:22.293317 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:13:22.293317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:24.131350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '013ecf77-0f3a-4b30-99a9-78384907855c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AECFF48F0>]}
[0m14:13:24.324797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '013ecf77-0f3a-4b30-99a9-78384907855c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AEEEA3EF0>]}
[0m14:13:24.332355 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:13:25.550278 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:13:25.679922 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:13:25.679922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '013ecf77-0f3a-4b30-99a9-78384907855c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AECB942C0>]}
[0m14:13:27.596941 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.healthcare.base_healthcare_r_patients' (models\base_healthcare_r_patients.sql) depends on a source named 'healthcare.r_patients' which was not found
[0m14:13:27.597793 [debug] [MainThread]: Command `dbt run` failed at 14:13:27.597793 after 5.63 seconds
[0m14:13:27.597793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AED0960F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AEF730620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AEF2AD370>]}
[0m14:13:27.597793 [debug] [MainThread]: Flushing usage events
[0m14:13:27.774832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:13.958390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E3F99BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E65519D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E65516D0>]}


============================== 14:39:13.958390 | de3d1bd2-801d-4f3d-96c1-2392d671cf54 ==============================
[0m14:39:13.958390 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:39:13.958390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt init healthcare', 'send_anonymous_usage_stats': 'True'}
[0m14:39:14.041322 [info ] [MainThread]: Setting up your profile.
[0m14:45:58.723724 [debug] [MainThread]: Command `dbt init` succeeded at 14:45:58.723724 after 405.01 seconds
[0m14:45:58.730070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E6E9A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E68DCE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E36BE930>]}
[0m14:45:58.733899 [debug] [MainThread]: Flushing usage events
[0m14:45:58.949038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:26.350881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A65C8A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A7275AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A72766C0>]}


============================== 14:46:26.359056 | 89b0028d-3065-418e-abeb-93c28eab3b80 ==============================
[0m14:46:26.359056 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:46:26.367749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:46:27.682325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b0028d-3065-418e-abeb-93c28eab3b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A94648F0>]}
[0m14:46:27.787493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89b0028d-3065-418e-abeb-93c28eab3b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1AC241310>]}
[0m14:46:27.793507 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:46:28.854730 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:46:28.954640 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:46:28.954640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89b0028d-3065-418e-abeb-93c28eab3b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A9B642F0>]}
[0m14:46:30.554633 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.healthcare.base_healthcare_r_patients' (models\base_healthcare_r_patients.sql) depends on a source named 'healthcare.r_patients' which was not found
[0m14:46:30.566273 [debug] [MainThread]: Command `dbt run` failed at 14:46:30.566273 after 4.46 seconds
[0m14:46:30.566273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A65C8A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1A94C6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1AC3AFF80>]}
[0m14:46:30.566273 [debug] [MainThread]: Flushing usage events
[0m14:46:30.700495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:47:54.308360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC067F2DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC067F2D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC067F1B20>]}


============================== 14:47:54.311460 | cdfe3199-9ce2-4ca9-832e-b2e2c229bb30 ==============================
[0m14:47:54.311460 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:47:54.311460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:47:55.439690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdfe3199-9ce2-4ca9-832e-b2e2c229bb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC06053A70>]}
[0m14:47:55.576124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdfe3199-9ce2-4ca9-832e-b2e2c229bb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC0589A7E0>]}
[0m14:47:55.583309 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:47:56.461141 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:47:56.547320 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:47:56.549331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdfe3199-9ce2-4ca9-832e-b2e2c229bb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC067F0380>]}
[0m14:47:58.055276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdfe3199-9ce2-4ca9-832e-b2e2c229bb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC08F94230>]}
[0m14:47:58.129930 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m14:47:58.135786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m14:47:58.211388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdfe3199-9ce2-4ca9-832e-b2e2c229bb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC06DDC1A0>]}
[0m14:47:58.212244 [info ] [MainThread]: Found 5 models, 472 macros
[0m14:47:58.214904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdfe3199-9ce2-4ca9-832e-b2e2c229bb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC09561460>]}
[0m14:47:58.218996 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:47:58.219588 [debug] [MainThread]: Command end result
[0m14:47:58.256030 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m14:47:58.261304 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m14:47:58.269509 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m14:47:58.273536 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:58.273536 after 4.20 seconds
[0m14:47:58.276179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC067F13D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC09347D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC09026000>]}
[0m14:47:58.278004 [debug] [MainThread]: Flushing usage events
[0m14:47:58.417919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:50.182188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A2211100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A2A736E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A2213BC0>]}


============================== 14:58:50.182188 | 031c66ce-43b7-4552-8e5b-61836ef35335 ==============================
[0m14:58:50.182188 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:58:50.182188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:58:50.515541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '031c66ce-43b7-4552-8e5b-61836ef35335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A1FBFE90>]}
[0m14:58:50.549115 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:58:50.549115 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:58:50.549115 [debug] [MainThread]: Command `cli deps` succeeded at 14:58:50.549115 after 0.67 seconds
[0m14:58:50.549115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A2ECBD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A1A6E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A1FBFE90>]}
[0m14:58:50.549115 [debug] [MainThread]: Flushing usage events
[0m14:58:51.280149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:05.654071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FF646900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FF647980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FCB5E9C0>]}


============================== 15:01:05.660842 | c001ae28-a4e6-47cb-9785-1f04f8eec8e9 ==============================
[0m15:01:05.660842 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:01:05.660842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:01:05.735966 [info ] [MainThread]: dbt version: 1.10.4
[0m15:01:05.737978 [info ] [MainThread]: python version: 3.12.3
[0m15:01:05.737978 [info ] [MainThread]: python path: C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\venv\Scripts\python.exe
[0m15:01:05.737978 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m15:01:06.953041 [info ] [MainThread]: Using profiles dir at C:\Users\sanja\.dbt
[0m15:01:06.953041 [info ] [MainThread]: Using profiles.yml file at C:\Users\sanja\.dbt\profiles.yml
[0m15:01:06.953041 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\dbt_project.yml
[0m15:01:06.958420 [info ] [MainThread]: adapter type: snowflake
[0m15:01:06.960433 [info ] [MainThread]: adapter version: 1.9.0
[0m15:01:07.111419 [info ] [MainThread]: Configuration:
[0m15:01:07.114022 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:01:07.114022 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:01:07.116035 [info ] [MainThread]: Required dependencies:
[0m15:01:07.118043 [debug] [MainThread]: Executing "git --help"
[0m15:01:07.186108 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:01:07.195558 [debug] [MainThread]: STDERR: "b''"
[0m15:01:07.197682 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:01:07.199692 [info ] [MainThread]: Connection:
[0m15:01:07.202216 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m15:01:07.203978 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m15:01:07.204561 [info ] [MainThread]:   database: DBT_DB
[0m15:01:07.206411 [info ] [MainThread]:   warehouse: DBT_WH
[0m15:01:07.207592 [info ] [MainThread]:   role: DBT_ROLE
[0m15:01:07.208141 [info ] [MainThread]:   schema: RAW
[0m15:01:07.210423 [info ] [MainThread]:   authenticator: None
[0m15:01:07.212199 [info ] [MainThread]:   oauth_client_id: None
[0m15:01:07.213613 [info ] [MainThread]:   query_tag: None
[0m15:01:07.217218 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:01:07.217218 [info ] [MainThread]:   host: None
[0m15:01:07.219993 [info ] [MainThread]:   port: None
[0m15:01:07.219993 [info ] [MainThread]:   proxy_host: None
[0m15:01:07.219993 [info ] [MainThread]:   proxy_port: None
[0m15:01:07.219993 [info ] [MainThread]:   protocol: None
[0m15:01:07.219993 [info ] [MainThread]:   connect_retries: 1
[0m15:01:07.225523 [info ] [MainThread]:   connect_timeout: None
[0m15:01:07.227597 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:01:07.228570 [info ] [MainThread]:   retry_all: False
[0m15:01:07.268297 [info ] [MainThread]:   insecure_mode: False
[0m15:01:07.281134 [info ] [MainThread]:   reuse_connections: True
[0m15:01:07.283104 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:01:07.947813 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:01:14.503103 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:01:14.503103 [debug] [MainThread]: On debug: select 1 as id
[0m15:01:14.503103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:17.307285 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.798 seconds
[0m15:01:17.311327 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:01:17.314306 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:01:17.322380 [debug] [MainThread]: Command `dbt debug` succeeded at 15:01:17.320367 after 11.91 seconds
[0m15:01:17.326940 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:01:17.330990 [debug] [MainThread]: On debug: Close
[0m15:01:17.448278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029781D7A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FF7727E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FF647980>]}
[0m15:01:17.452317 [debug] [MainThread]: Flushing usage events
[0m15:01:17.557214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:53.852077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B11338E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B138EDC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B11891250>]}


============================== 15:01:53.852077 | fa216900-af45-4ebc-b2a9-b74b54fb6438 ==============================
[0m15:01:53.852077 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:01:53.867967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:01:54.789736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa216900-af45-4ebc-b2a9-b74b54fb6438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B16176360>]}
[0m15:01:54.872762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa216900-af45-4ebc-b2a9-b74b54fb6438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B161B3FB0>]}
[0m15:01:54.872762 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:01:55.409977 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:01:55.505323 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:01:55.505323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa216900-af45-4ebc-b2a9-b74b54fb6438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1673B380>]}
[0m15:01:56.975944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa216900-af45-4ebc-b2a9-b74b54fb6438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B16A91FD0>]}
[0m15:01:57.039418 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m15:01:57.055293 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m15:01:57.118697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa216900-af45-4ebc-b2a9-b74b54fb6438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B16B35E20>]}
[0m15:01:57.118697 [info ] [MainThread]: Found 5 models, 472 macros
[0m15:01:57.118697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa216900-af45-4ebc-b2a9-b74b54fb6438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1124EFC0>]}
[0m15:01:57.118697 [info ] [MainThread]: 
[0m15:01:57.118697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:57.129087 [info ] [MainThread]: 
[0m15:01:57.130583 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:57.133863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m15:01:57.267915 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m15:01:57.267915 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m15:01:57.267915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:59.057785 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.787 seconds
[0m15:01:59.057785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_RAW)
[0m15:01:59.057785 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "RAW"
"
[0m15:01:59.057785 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_RAW"
[0m15:01:59.057785 [debug] [ThreadPool]: On create_DBT_DB_RAW: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "create_DBT_DB_RAW"} */
create schema if not exists DBT_DB.RAW
[0m15:01:59.573185 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdaab5-0000-2541-0027-cf8b0002d246
[0m15:01:59.573185 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'RAW' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m15:01:59.573185 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m15:01:59.573185 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:01:59.573185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:59.573185 [debug] [MainThread]: Connection 'create_DBT_DB_RAW' was left open.
[0m15:01:59.573185 [debug] [MainThread]: On create_DBT_DB_RAW: Close
[0m15:01:59.652548 [info ] [MainThread]: 
[0m15:01:59.652548 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m15:01:59.652548 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'RAW' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m15:01:59.652548 [debug] [MainThread]: Command `dbt run` failed at 15:01:59.652548 after 6.04 seconds
[0m15:01:59.652548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B13DF2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B16BA8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1717B5F0>]}
[0m15:01:59.652548 [debug] [MainThread]: Flushing usage events
[0m15:01:59.778849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:33.036586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023117561130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023114985CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023116F55DC0>]}


============================== 16:07:33.047724 | 5deec472-9747-4a13-974a-985cf7b09347 ==============================
[0m16:07:33.047724 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:07:33.049000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:33.603471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5deec472-9747-4a13-974a-985cf7b09347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023117A12990>]}
[0m16:07:33.647660 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:07:33.665568 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:07:33.669602 [debug] [MainThread]: Command `cli deps` succeeded at 16:07:33.667585 after 0.97 seconds
[0m16:07:33.669602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023117956F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023117957350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023117A12990>]}
[0m16:07:33.671717 [debug] [MainThread]: Flushing usage events
[0m16:07:34.712624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:46.674547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C63BCBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C3C5B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C5DF1820>]}


============================== 16:08:46.683406 | 90afb01f-c3fc-48f5-89cd-6f53d6a91d61 ==============================
[0m16:08:46.683406 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:08:46.683406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:49.107358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90afb01f-c3fc-48f5-89cd-6f53d6a91d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C84E6F00>]}
[0m16:08:49.234744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90afb01f-c3fc-48f5-89cd-6f53d6a91d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C88565D0>]}
[0m16:08:49.238774 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:08:50.091248 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:08:50.239761 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:08:50.241766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90afb01f-c3fc-48f5-89cd-6f53d6a91d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C8EE2180>]}
[0m16:08:52.778418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90afb01f-c3fc-48f5-89cd-6f53d6a91d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C8F50890>]}
[0m16:08:52.868602 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m16:08:52.947389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m16:08:53.026236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90afb01f-c3fc-48f5-89cd-6f53d6a91d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C8FC3650>]}
[0m16:08:53.027730 [info ] [MainThread]: Found 5 models, 472 macros
[0m16:08:53.031193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90afb01f-c3fc-48f5-89cd-6f53d6a91d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C8EE18B0>]}
[0m16:08:53.035722 [info ] [MainThread]: 
[0m16:08:53.037736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:53.039686 [info ] [MainThread]: 
[0m16:08:53.042116 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:08:53.046833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m16:08:59.985319 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m16:08:59.985319 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m16:08:59.990704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:00.751212 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.762 seconds
[0m16:09:00.756570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_RAW)
[0m16:09:00.758580 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "RAW"
"
[0m16:09:00.770402 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_RAW"
[0m16:09:00.770402 [debug] [ThreadPool]: On create_DBT_DB_RAW: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "create_DBT_DB_RAW"} */
create schema if not exists DBT_DB.RAW
[0m16:09:01.321236 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdaaf9-0000-2540-0027-cf8b0003029a
[0m16:09:01.323248 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'RAW' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m16:09:01.323248 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m16:09:01.325260 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:09:01.325260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:01.325260 [debug] [MainThread]: Connection 'create_DBT_DB_RAW' was left open.
[0m16:09:01.325260 [debug] [MainThread]: On create_DBT_DB_RAW: Close
[0m16:09:01.395170 [info ] [MainThread]: 
[0m16:09:01.395170 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 8.35 seconds (8.35s).
[0m16:09:01.410970 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'RAW' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m16:09:01.412063 [debug] [MainThread]: Command `dbt run` failed at 16:09:01.412063 after 15.07 seconds
[0m16:09:01.412063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C68C2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C8BDE0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C939A8D0>]}
[0m16:09:01.412063 [debug] [MainThread]: Flushing usage events
[0m16:09:01.557707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:48.524796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C397B6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C37C6B380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C397B4290>]}


============================== 16:14:48.533419 | fa95911c-e9dc-47c1-b50b-4196f16ec443 ==============================
[0m16:14:48.533419 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:14:48.535425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:14:49.499545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa95911c-e9dc-47c1-b50b-4196f16ec443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3C653A70>]}
[0m16:14:49.614368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa95911c-e9dc-47c1-b50b-4196f16ec443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3C2C7FE0>]}
[0m16:14:49.616374 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:14:50.153568 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:14:50.258621 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:14:50.258621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa95911c-e9dc-47c1-b50b-4196f16ec443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3C9E1F40>]}
[0m16:14:51.996110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa95911c-e9dc-47c1-b50b-4196f16ec443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3CB3DD30>]}
[0m16:14:52.098501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m16:14:52.104258 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m16:14:52.156090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa95911c-e9dc-47c1-b50b-4196f16ec443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3CAD7E90>]}
[0m16:14:52.158104 [info ] [MainThread]: Found 5 models, 472 macros
[0m16:14:52.161503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa95911c-e9dc-47c1-b50b-4196f16ec443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3CAF22D0>]}
[0m16:14:52.161503 [info ] [MainThread]: 
[0m16:14:52.165306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:52.170371 [info ] [MainThread]: 
[0m16:14:52.170371 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:14:52.174427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m16:14:52.310883 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m16:14:52.310883 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m16:14:52.312894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:53.093247 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.780 seconds
[0m16:14:53.108874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_RAW'
[0m16:14:53.128697 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_RAW"
[0m16:14:53.130708 [debug] [ThreadPool]: On list_DBT_DB_RAW: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_RAW"} */
show objects in DBT_DB.RAW limit 10000;
[0m16:14:53.130708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:53.657431 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.529 seconds
[0m16:14:53.666352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa95911c-e9dc-47c1-b50b-4196f16ec443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3CAF0860>]}
[0m16:14:53.674072 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m16:14:53.674072 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.src_patients ................................... [RUN]
[0m16:14:53.682579 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_patients'
[0m16:14:53.683230 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m16:14:53.685242 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m16:14:53.706371 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m16:14:53.756566 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m16:14:53.767817 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m16:14:53.767817 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.RAW.src_patients
  
   as (
    with RAW_PATIENTS as (

    select * from DBT_DB.RAW.RAW_PATIENTS

)
    select
        "PatientID" as patient_id,
        "FirstName" as first_name,
        "LastName" as last_name,
        "MiddleName" as middle_name,
        "SSN" as ssn,
        "PhoneNumber" as phone_number,
        "Gender" as gender,
        "DOB" as date_of_birth,
        "Address" as address,
        "ModifiedDate" as modified_date

    from RAW_PATIENTS
  );
[0m16:14:53.767817 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:54.279607 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdaafe-0000-2540-0027-cf8b000302b2
[0m16:14:54.279607 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'RAW'
[0m16:14:54.317694 [debug] [Thread-1 (]: Database Error in model src_patients (models\staging\src_patients.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'
  compiled code at target\run\healthcare\models\staging\src_patients.sql
[0m16:14:54.324608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa95911c-e9dc-47c1-b50b-4196f16ec443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3CAE2660>]}
[0m16:14:54.326622 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.src_patients .......................... [[31mERROR[0m in 0.64s]
[0m16:14:54.326622 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m16:14:54.329882 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_patients' to be skipped because of status 'error'.  Reason: Database Error in model src_patients (models\staging\src_patients.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'
  compiled code at target\run\healthcare\models\staging\src_patients.sql.
[0m16:14:54.332882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:54.332882 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m16:14:54.335087 [debug] [MainThread]: On list_DBT_DB: Close
[0m16:14:54.415167 [debug] [MainThread]: Connection 'list_DBT_DB_RAW' was left open.
[0m16:14:54.417180 [debug] [MainThread]: On list_DBT_DB_RAW: Close
[0m16:14:54.514442 [debug] [MainThread]: Connection 'model.healthcare.src_patients' was left open.
[0m16:14:54.519073 [debug] [MainThread]: On model.healthcare.src_patients: Close
[0m16:14:54.600507 [info ] [MainThread]: 
[0m16:14:54.601713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m16:14:54.603590 [debug] [MainThread]: Command end result
[0m16:14:54.647444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m16:14:54.658537 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m16:14:54.708361 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m16:14:54.709376 [info ] [MainThread]: 
[0m16:14:54.731604 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:14:54.736134 [info ] [MainThread]: 
[0m16:14:54.743191 [error] [MainThread]: [31mFailure in model src_patients (models\staging\src_patients.sql)[0m
[0m16:14:54.767018 [error] [MainThread]:   Database Error in model src_patients (models\staging\src_patients.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'
  compiled code at target\run\healthcare\models\staging\src_patients.sql
[0m16:14:54.773517 [info ] [MainThread]: 
[0m16:14:54.776270 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\staging\src_patients.sql
[0m16:14:54.778285 [info ] [MainThread]: 
[0m16:14:54.779854 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:14:54.779854 [debug] [MainThread]: Command `dbt run` failed at 16:14:54.779854 after 6.52 seconds
[0m16:14:54.779854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3A4BDD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3CA08CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3C8BC890>]}
[0m16:14:54.779854 [debug] [MainThread]: Flushing usage events
[0m16:14:54.924532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:51.917671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BE21F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BE30F8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BE30CA10>]}


============================== 19:04:51.920981 | 08c9abe6-f3c9-4afd-a8ef-d8c75828f8ee ==============================
[0m19:04:51.920981 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:04:51.920981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:04:52.834856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08c9abe6-f3c9-4afd-a8ef-d8c75828f8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C0A72C00>]}
[0m19:04:52.901222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08c9abe6-f3c9-4afd-a8ef-d8c75828f8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C09086E0>]}
[0m19:04:52.901222 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:04:53.479176 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:04:53.515659 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:04:53.515659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08c9abe6-f3c9-4afd-a8ef-d8c75828f8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C0F222D0>]}
[0m19:04:55.122200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08c9abe6-f3c9-4afd-a8ef-d8c75828f8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1028080>]}
[0m19:04:55.169340 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:04:55.210918 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:04:55.261173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08c9abe6-f3c9-4afd-a8ef-d8c75828f8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1028B90>]}
[0m19:04:55.261173 [info ] [MainThread]: Found 5 models, 472 macros
[0m19:04:55.262176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08c9abe6-f3c9-4afd-a8ef-d8c75828f8ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1009D60>]}
[0m19:04:55.263176 [info ] [MainThread]: 
[0m19:04:55.264175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:55.265175 [info ] [MainThread]: 
[0m19:04:55.266174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:55.267528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:05:02.955427 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:05:02.956042 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:05:02.956787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:03.710960 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.754 seconds
[0m19:05:03.713571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_SILVER)
[0m19:05:03.714633 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "SILVER"
"
[0m19:05:03.726558 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_SILVER"
[0m19:05:03.727558 [debug] [ThreadPool]: On create_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "create_DBT_DB_SILVER"} */
create schema if not exists DBT_DB.SILVER
[0m19:05:04.295673 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdaba9-0000-2540-0027-cf8b0003034e
[0m19:05:04.297686 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'SILVER' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m19:05:04.297686 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m19:05:04.299696 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:05:04.301449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:04.301449 [debug] [MainThread]: Connection 'create_DBT_DB_SILVER' was left open.
[0m19:05:04.301449 [debug] [MainThread]: On create_DBT_DB_SILVER: Close
[0m19:05:04.387845 [info ] [MainThread]: 
[0m19:05:04.389877 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 9.12 seconds (9.12s).
[0m19:05:04.391870 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'SILVER' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m19:05:04.393254 [debug] [MainThread]: Command `dbt run` failed at 19:05:04.392192 after 12.68 seconds
[0m19:05:04.393254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BE99DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1107CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C0F96CC0>]}
[0m19:05:04.394257 [debug] [MainThread]: Flushing usage events
[0m19:05:04.545813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:37.107064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AB2D57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AB191FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AAED6C30>]}


============================== 19:05:37.107064 | b51aab3a-dcdb-4c49-9715-97083f041fef ==============================
[0m19:05:37.107064 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:05:37.107064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:37.534364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b51aab3a-dcdb-4c49-9715-97083f041fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AD81AC00>]}
[0m19:05:37.587838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b51aab3a-dcdb-4c49-9715-97083f041fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AAC0B500>]}
[0m19:05:37.588343 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:05:37.774317 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:05:37.883109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:37.883109 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:37.946295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b51aab3a-dcdb-4c49-9715-97083f041fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191ADB81640>]}
[0m19:05:37.978177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:05:37.978177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:05:38.009921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b51aab3a-dcdb-4c49-9715-97083f041fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AB8BEE40>]}
[0m19:05:38.009921 [info ] [MainThread]: Found 5 models, 472 macros
[0m19:05:38.009921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b51aab3a-dcdb-4c49-9715-97083f041fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191ADA7A180>]}
[0m19:05:38.009921 [info ] [MainThread]: 
[0m19:05:38.009921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:38.009921 [info ] [MainThread]: 
[0m19:05:38.009921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:38.009921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:05:38.083695 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:05:38.083695 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:05:38.083695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:39.617912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.533 seconds
[0m19:05:39.619919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:05:39.632053 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:05:39.632053 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m19:05:39.632053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:40.062148 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.427 seconds
[0m19:05:40.062148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b51aab3a-dcdb-4c49-9715-97083f041fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AB90AC00>]}
[0m19:05:40.078048 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m19:05:40.078048 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_patients ................................ [RUN]
[0m19:05:40.078048 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_patients'
[0m19:05:40.078048 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m19:05:40.078048 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m19:05:40.078048 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m19:05:40.105718 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m19:05:40.105718 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m19:05:40.105718 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with RAW_PATIENTS as (

    select * from DBT_DB.RAW.RAW_PATIENTS

)
    select
        "PatientID" as patient_id,
        "FirstName" as first_name,
        "LastName" as last_name,
        "MiddleName" as middle_name,
        "SSN" as ssn,
        "PhoneNumber" as phone_number,
        "Gender" as gender,
        "DOB" as date_of_birth,
        "Address" as address,
        "ModifiedDate" as modified_date

    from RAW_PATIENTS
  );
[0m19:05:40.105718 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:40.641620 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdaba9-0000-253e-0027-cf8b0002f532
[0m19:05:40.641620 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 8
invalid identifier '"PatientID"'
[0m19:05:40.657368 [debug] [Thread-1 (]: Database Error in model src_patients (models\staging\src_patients.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier '"PatientID"'
  compiled code at target\run\healthcare\models\staging\src_patients.sql
[0m19:05:40.657368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b51aab3a-dcdb-4c49-9715-97083f041fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AABDAF90>]}
[0m19:05:40.657368 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_patients ....................... [[31mERROR[0m in 0.58s]
[0m19:05:40.657368 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m19:05:40.657368 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_patients' to be skipped because of status 'error'.  Reason: Database Error in model src_patients (models\staging\src_patients.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier '"PatientID"'
  compiled code at target\run\healthcare\models\staging\src_patients.sql.
[0m19:05:40.657368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:40.657368 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:05:40.657368 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:05:40.735592 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:05:40.736569 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:05:40.801262 [debug] [MainThread]: Connection 'model.healthcare.src_patients' was left open.
[0m19:05:40.801262 [debug] [MainThread]: On model.healthcare.src_patients: Close
[0m19:05:40.880722 [info ] [MainThread]: 
[0m19:05:40.880722 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m19:05:40.896740 [debug] [MainThread]: Command end result
[0m19:05:40.930765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:05:40.930765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:05:40.944452 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:05:40.944452 [info ] [MainThread]: 
[0m19:05:40.946898 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:05:40.946898 [info ] [MainThread]: 
[0m19:05:40.946898 [error] [MainThread]: [31mFailure in model src_patients (models\staging\src_patients.sql)[0m
[0m19:05:40.948920 [error] [MainThread]:   Database Error in model src_patients (models\staging\src_patients.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier '"PatientID"'
  compiled code at target\run\healthcare\models\staging\src_patients.sql
[0m19:05:40.948920 [info ] [MainThread]: 
[0m19:05:40.948920 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\staging\src_patients.sql
[0m19:05:40.948920 [info ] [MainThread]: 
[0m19:05:40.948920 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:05:40.953377 [debug] [MainThread]: Command `dbt run` failed at 19:05:40.953377 after 3.99 seconds
[0m19:05:40.954394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AB3007A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AB8BDF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AB8BC7D0>]}
[0m19:05:40.955395 [debug] [MainThread]: Flushing usage events
[0m19:05:41.086305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:08:28.190018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F481B6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F481B4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F481B6DB0>]}


============================== 19:08:28.199864 | 06f1bf6b-4b93-4791-a965-65bba0918fe0 ==============================
[0m19:08:28.199864 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:08:28.199864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:08:28.612696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f1bf6b-4b93-4791-a965-65bba0918fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4A8F9C40>]}
[0m19:08:28.662619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06f1bf6b-4b93-4791-a965-65bba0918fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F45F7B050>]}
[0m19:08:28.663619 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:08:28.855126 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:08:28.908537 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:08:28.908537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06f1bf6b-4b93-4791-a965-65bba0918fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4AD520F0>]}
[0m19:08:29.648891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f1bf6b-4b93-4791-a965-65bba0918fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4ADC0CE0>]}
[0m19:08:29.700978 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:08:29.703978 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:08:29.727931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f1bf6b-4b93-4791-a965-65bba0918fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4AE3ABA0>]}
[0m19:08:29.727931 [info ] [MainThread]: Found 5 models, 472 macros
[0m19:08:29.727931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f1bf6b-4b93-4791-a965-65bba0918fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4AED4500>]}
[0m19:08:29.727931 [info ] [MainThread]: 
[0m19:08:29.727931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:08:29.727931 [info ] [MainThread]: 
[0m19:08:29.727931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:08:29.727931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:08:29.805768 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:08:29.806788 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:08:29.806788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:30.357879 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.551 seconds
[0m19:08:30.369106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:08:30.383198 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:08:30.384198 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m19:08:30.385203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:31.042586 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.671 seconds
[0m19:08:31.058372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f1bf6b-4b93-4791-a965-65bba0918fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4AE46300>]}
[0m19:08:31.058372 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m19:08:31.058372 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_patients ................................ [RUN]
[0m19:08:31.058372 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_patients'
[0m19:08:31.058372 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m19:08:31.074247 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m19:08:31.074247 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m19:08:31.112158 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m19:08:31.114323 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m19:08:31.114323 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with RAW_PATIENTS as (

    select * from DBT_DB.RAW.RAW_PATIENTS

)
    select
        PatientID as patient_id,
        FirstName as first_name,
        LastName as last_name,
        MiddleName as middle_name,
        SSN as ssn,
        PhoneNumber as phone_number,
        Gender as gender,
        DOB as date_of_birth,
        Address as address,
        ModifiedDate as modified_date

    from RAW_PATIENTS
  );
[0m19:08:31.115248 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:08:31.614766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m19:08:31.630583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f1bf6b-4b93-4791-a965-65bba0918fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F456CA150>]}
[0m19:08:31.630583 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.57s]
[0m19:08:31.630583 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m19:08:31.630583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:31.630583 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:08:31.630583 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:08:31.711990 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:08:31.711990 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:08:31.775331 [debug] [MainThread]: Connection 'model.healthcare.src_patients' was left open.
[0m19:08:31.775331 [debug] [MainThread]: On model.healthcare.src_patients: Close
[0m19:08:31.862075 [info ] [MainThread]: 
[0m19:08:31.862075 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m19:08:31.862075 [debug] [MainThread]: Command end result
[0m19:08:31.884560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:08:31.887798 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:08:31.895480 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:08:31.896741 [info ] [MainThread]: 
[0m19:08:31.897218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:08:31.897218 [info ] [MainThread]: 
[0m19:08:31.897218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:08:31.897218 [debug] [MainThread]: Command `dbt run` succeeded at 19:08:31.897218 after 3.88 seconds
[0m19:08:31.897218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4879C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4879DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4879CCE0>]}
[0m19:08:31.897218 [debug] [MainThread]: Flushing usage events
[0m19:08:32.044561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:05.936354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3D7D1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3E152EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE40E3F2F0>]}


============================== 19:51:05.953015 | f24c2c63-48ef-49b4-b61f-14960886b86e ==============================
[0m19:51:05.953015 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:51:05.953015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:51:06.425293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE43532C00>]}
[0m19:51:06.476537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE40EBB560>]}
[0m19:51:06.476537 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:51:06.750508 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:51:06.799066 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:51:06.799066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE439E2420>]}
[0m19:51:07.512630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE43B73CE0>]}
[0m19:51:07.554696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:51:07.556557 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:51:07.580807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE43AE26F0>]}
[0m19:51:07.582960 [info ] [MainThread]: Found 5 models, 472 macros
[0m19:51:07.582960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE43B7BCE0>]}
[0m19:51:07.582960 [info ] [MainThread]: 
[0m19:51:07.585744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:07.585744 [info ] [MainThread]: 
[0m19:51:07.586551 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:51:07.588463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:51:07.668830 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:51:07.669844 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:51:07.669844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:08.209723 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.550 seconds
[0m19:51:08.225048 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:51:08.225048 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:51:08.225048 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m19:51:08.225048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:08.615705 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.378 seconds
[0m19:51:08.619741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE43B87F80>]}
[0m19:51:08.623520 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m19:51:08.623520 [info ] [Thread-1 (]: 1 of 5 START sql view model SILVER.src_departments ............................. [RUN]
[0m19:51:08.623520 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_departments'
[0m19:51:08.623520 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m19:51:08.623520 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m19:51:08.640713 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m19:51:08.666345 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m19:51:08.668357 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m19:51:08.668357 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m19:51:08.668357 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:51:09.027525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m19:51:09.044862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3E35A1E0>]}
[0m19:51:09.044862 [info ] [Thread-1 (]: 1 of 5 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.42s]
[0m19:51:09.044862 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m19:51:09.044862 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m19:51:09.044862 [info ] [Thread-1 (]: 2 of 5 START sql view model SILVER.src_encounters .............................. [RUN]
[0m19:51:09.044862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m19:51:09.054255 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m19:51:09.054255 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m19:51:09.054255 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m19:51:09.059874 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m19:51:09.061885 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m19:51:09.063209 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m19:51:09.320561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m19:51:09.323562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4411B320>]}
[0m19:51:09.325561 [info ] [Thread-1 (]: 2 of 5 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.28s]
[0m19:51:09.327036 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m19:51:09.327743 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m19:51:09.327743 [info ] [Thread-1 (]: 3 of 5 START sql view model SILVER.src_patients ................................ [RUN]
[0m19:51:09.328787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m19:51:09.329968 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m19:51:09.331323 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m19:51:09.332553 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m19:51:09.339045 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m19:51:09.341043 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m19:51:09.342042 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with RAW_PATIENTS as (

    select * from DBT_DB.RAW.RAW_PATIENTS

)
    select
        PatientID as patient_id,
        FirstName as first_name,
        LastName as last_name,
        MiddleName as middle_name,
        SSN as ssn,
        PhoneNumber as phone_number,
        Gender as gender,
        DOB as date_of_birth,
        Address as address,
        ModifiedDate as modified_date

    from RAW_PATIENTS
  );
[0m19:51:09.590067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.248 seconds
[0m19:51:09.594325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE44133350>]}
[0m19:51:09.594325 [info ] [Thread-1 (]: 3 of 5 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.27s]
[0m19:51:09.595506 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m19:51:09.596503 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m19:51:09.597499 [info ] [Thread-1 (]: 4 of 5 START sql view model SILVER.src_providers ............................... [RUN]
[0m19:51:09.598527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m19:51:09.598527 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m19:51:09.599508 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m19:51:09.600504 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m19:51:09.603457 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m19:51:09.605443 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m19:51:09.605443 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m19:51:09.778015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m19:51:09.778431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4415B7A0>]}
[0m19:51:09.778431 [info ] [Thread-1 (]: 4 of 5 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.18s]
[0m19:51:09.778431 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m19:51:09.778431 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m19:51:09.778431 [info ] [Thread-1 (]: 5 of 5 START sql view model SILVER.src_transactions ............................ [RUN]
[0m19:51:09.778431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m19:51:09.778431 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m19:51:09.778431 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m19:51:09.778431 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m19:51:09.796369 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m19:51:09.799861 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m19:51:09.799861 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m19:51:10.087961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m19:51:10.089972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f24c2c63-48ef-49b4-b61f-14960886b86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4415AED0>]}
[0m19:51:10.091990 [info ] [Thread-1 (]: 5 of 5 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.31s]
[0m19:51:10.091990 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m19:51:10.091990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:10.091990 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:51:10.091990 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:51:10.161472 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:51:10.161472 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:51:10.241128 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m19:51:10.241128 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m19:51:10.311322 [info ] [MainThread]: 
[0m19:51:10.312333 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m19:51:10.314438 [debug] [MainThread]: Command end result
[0m19:51:10.332394 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:51:10.339249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:51:10.352112 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:51:10.352112 [info ] [MainThread]: 
[0m19:51:10.355522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:10.355522 [info ] [MainThread]: 
[0m19:51:10.355522 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:51:10.355522 [debug] [MainThread]: Command `dbt run` succeeded at 19:51:10.355522 after 4.59 seconds
[0m19:51:10.355522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41203EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41460B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE414615B0>]}
[0m19:51:10.355522 [debug] [MainThread]: Flushing usage events
[0m19:51:10.513206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:14.679896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD059A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD2B21AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD2F40FB0>]}


============================== 19:21:14.679896 | b4f9d64b-2671-4503-8ec1-2d459bb7f6cb ==============================
[0m19:21:14.679896 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:21:14.679896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:21:16.015783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD58A05F0>]}
[0m19:21:16.066505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5255370>]}
[0m19:21:16.070622 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:21:16.579957 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:21:16.627389 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:21:16.627389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5D062A0>]}
[0m19:21:17.990480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5E332F0>]}
[0m19:21:18.022195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:21:18.038249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:21:18.085686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5E11220>]}
[0m19:21:18.085686 [info ] [MainThread]: Found 8 models, 472 macros
[0m19:21:18.085686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5D56E10>]}
[0m19:21:18.101627 [info ] [MainThread]: 
[0m19:21:18.106072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:21:18.107155 [info ] [MainThread]: 
[0m19:21:18.110156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:21:18.112850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:21:25.365843 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:21:25.365843 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:21:25.365843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:27.690281 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.326 seconds
[0m19:21:27.690281 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:21:27.706129 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:21:27.706129 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m19:21:27.706129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:28.145269 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.441 seconds
[0m19:21:28.145269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5E33320>]}
[0m19:21:28.161167 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m19:21:28.161167 [info ] [Thread-1 (]: 1 of 8 START sql view model SILVER.src_claims .................................. [RUN]
[0m19:21:28.161167 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m19:21:28.161167 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m19:21:28.176926 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m19:21:28.176926 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m19:21:28.200210 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m19:21:28.202166 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m19:21:28.203186 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m19:21:28.203186 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:21:28.725413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdb159-0000-2543-0027-cf8b0002e57a
[0m19:21:28.725413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_DB.RAW.RAW_CLAIMS' does not exist or not authorized.
[0m19:21:28.741256 [debug] [Thread-1 (]: Database Error in model src_claims (models\staging\src_claims.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CLAIMS' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_claims.sql
[0m19:21:28.741256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5E102C0>]}
[0m19:21:28.741256 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model SILVER.src_claims ......................... [[31mERROR[0m in 0.58s]
[0m19:21:28.741256 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m19:21:28.741256 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m19:21:28.741256 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_claims' to be skipped because of status 'error'.  Reason: Database Error in model src_claims (models\staging\src_claims.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CLAIMS' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_claims.sql.
[0m19:21:28.741256 [info ] [Thread-1 (]: 2 of 8 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m19:21:28.741256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m19:21:28.741256 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m19:21:28.741256 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m19:21:28.757168 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m19:21:28.759810 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m19:21:28.762694 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m19:21:28.763544 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m19:21:28.874815 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdb159-0000-2542-0027-cf8b0002c5b2
[0m19:21:28.875816 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_DB.RAW.RAW_CPTCODES' does not exist or not authorized.
[0m19:21:28.879223 [debug] [Thread-1 (]: Database Error in model src_cptcodes (models\staging\src_cptcodes.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CPTCODES' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_cptcodes.sql
[0m19:21:28.879223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD7517DA0>]}
[0m19:21:28.879223 [error] [Thread-1 (]: 2 of 8 ERROR creating sql view model SILVER.src_cptcodes ....................... [[31mERROR[0m in 0.14s]
[0m19:21:28.879223 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m19:21:28.879223 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m19:21:28.879223 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_cptcodes' to be skipped because of status 'error'.  Reason: Database Error in model src_cptcodes (models\staging\src_cptcodes.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CPTCODES' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_cptcodes.sql.
[0m19:21:28.879223 [info ] [Thread-1 (]: 3 of 8 START sql view model SILVER.src_departments ............................. [RUN]
[0m19:21:28.879223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m19:21:28.879223 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m19:21:28.879223 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m19:21:28.879223 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m19:21:28.894513 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m19:21:28.896783 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m19:21:28.898239 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m19:21:29.139004 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m19:21:29.170567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD750B7A0>]}
[0m19:21:29.170567 [info ] [Thread-1 (]: 3 of 8 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.28s]
[0m19:21:29.170567 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m19:21:29.170567 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m19:21:29.170567 [info ] [Thread-1 (]: 4 of 8 START sql view model SILVER.src_encounters .............................. [RUN]
[0m19:21:29.170567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m19:21:29.170567 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m19:21:29.170567 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m19:21:29.170567 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m19:21:29.170567 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m19:21:29.170567 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m19:21:29.170567 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m19:21:29.357210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m19:21:29.357210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD750B8F0>]}
[0m19:21:29.357210 [info ] [Thread-1 (]: 4 of 8 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.19s]
[0m19:21:29.374586 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m19:21:29.374586 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m19:21:29.374586 [info ] [Thread-1 (]: 5 of 8 START sql view model SILVER.src_patients ................................ [RUN]
[0m19:21:29.374586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m19:21:29.381599 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m19:21:29.385363 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m19:21:29.386359 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m19:21:29.386359 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m19:21:29.386359 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m19:21:29.386359 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with RAW_PATIENTS as (

    select * from DBT_DB.RAW.RAW_PATIENTS

)
    select
        PatientID as patient_id,
        FirstName as first_name,
        LastName as last_name,
        MiddleName as middle_name,
        SSN as ssn,
        PhoneNumber as phone_number,
        Gender as gender,
        DOB as date_of_birth,
        Address as address,
        ModifiedDate as modified_date

    from RAW_PATIENTS
  );
[0m19:21:29.638998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m19:21:29.638998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5CA66F0>]}
[0m19:21:29.638998 [info ] [Thread-1 (]: 5 of 8 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.26s]
[0m19:21:29.638998 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m19:21:29.638998 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m19:21:29.638998 [info ] [Thread-1 (]: 6 of 8 START sql view model SILVER.src_providers ............................... [RUN]
[0m19:21:29.638998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m19:21:29.638998 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m19:21:29.638998 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m19:21:29.638998 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m19:21:29.638998 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m19:21:29.654777 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m19:21:29.654777 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m19:21:29.842486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m19:21:29.842486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD756FEC0>]}
[0m19:21:29.842486 [info ] [Thread-1 (]: 6 of 8 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.20s]
[0m19:21:29.858527 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m19:21:29.858527 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m19:21:29.858527 [info ] [Thread-1 (]: 7 of 8 START sql view model SILVER.src_transactions ............................ [RUN]
[0m19:21:29.858527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m19:21:29.864508 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m19:21:29.868423 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m19:21:29.868423 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m19:21:29.868423 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m19:21:29.881054 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m19:21:29.882900 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m19:21:30.216817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.339 seconds
[0m19:21:30.216817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD6415790>]}
[0m19:21:30.216817 [info ] [Thread-1 (]: 7 of 8 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.36s]
[0m19:21:30.216817 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m19:21:30.216817 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m19:21:30.216817 [info ] [Thread-1 (]: 8 of 8 START sql table model SILVER.dim_patients ............................... [RUN]
[0m19:21:30.216817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.dim_patients)
[0m19:21:30.216817 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m19:21:30.232695 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m19:21:30.232695 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m19:21:30.255661 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m19:21:30.255661 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m19:21:30.255661 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER.dim_patients
         as
        (with RAW_PATIENTS as (
    select * from DBT_DB.SILVER.src_patients
)
select
    PatientID as patient_id,
    FirstName as first_name,
    LastName as last_name,
    coalesce(MiddleName, 'N/A') as middle_name,
    SSN as ssn,
    PhoneNumber as phone_number,
    UPPER(Gender) as gender,
    cast(DOB as DATE) as date_of_birth,
    -- Calculate age
    date_diff('year', cast(DOB as DATE), current_date) as age,
    Address as address,
    ModifiedDate as modified_date
from RAW_PATIENTS
        );
[0m19:21:30.363872 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdb159-0000-253e-0027-cf8b0002f6fe
[0m19:21:30.363872 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'PATIENTID'
[0m19:21:30.365897 [debug] [Thread-1 (]: Database Error in model dim_patients (models\dim\dim_patients.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'PATIENTID'
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m19:21:30.365897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f9d64b-2671-4503-8ec1-2d459bb7f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD7576270>]}
[0m19:21:30.365897 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model SILVER.dim_patients ...................... [[31mERROR[0m in 0.15s]
[0m19:21:30.365897 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m19:21:30.365897 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.dim_patients' to be skipped because of status 'error'.  Reason: Database Error in model dim_patients (models\dim\dim_patients.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'PATIENTID'
  compiled code at target\run\healthcare\models\dim\dim_patients.sql.
[0m19:21:30.379955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:30.379955 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:21:30.379955 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:21:30.469591 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:21:30.472609 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:21:30.555344 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m19:21:30.556341 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m19:21:30.640931 [info ] [MainThread]: 
[0m19:21:30.643917 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 12.53 seconds (12.53s).
[0m19:21:30.648315 [debug] [MainThread]: Command end result
[0m19:21:30.691094 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:21:30.693109 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:21:30.700797 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:21:30.709896 [info ] [MainThread]: 
[0m19:21:30.713098 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:21:30.714868 [info ] [MainThread]: 
[0m19:21:30.717900 [error] [MainThread]: [31mFailure in model src_claims (models\staging\src_claims.sql)[0m
[0m19:21:30.719965 [error] [MainThread]:   Database Error in model src_claims (models\staging\src_claims.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CLAIMS' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_claims.sql
[0m19:21:30.720904 [info ] [MainThread]: 
[0m19:21:30.722883 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\staging\src_claims.sql
[0m19:21:30.723884 [info ] [MainThread]: 
[0m19:21:30.726370 [error] [MainThread]: [31mFailure in model src_cptcodes (models\staging\src_cptcodes.sql)[0m
[0m19:21:30.728306 [error] [MainThread]:   Database Error in model src_cptcodes (models\staging\src_cptcodes.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CPTCODES' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_cptcodes.sql
[0m19:21:30.730294 [info ] [MainThread]: 
[0m19:21:30.731296 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\staging\src_cptcodes.sql
[0m19:21:30.733382 [info ] [MainThread]: 
[0m19:21:30.734392 [error] [MainThread]: [31mFailure in model dim_patients (models\dim\dim_patients.sql)[0m
[0m19:21:30.735437 [error] [MainThread]:   Database Error in model dim_patients (models\dim\dim_patients.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'PATIENTID'
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m19:21:30.737415 [info ] [MainThread]: 
[0m19:21:30.738397 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\dim\dim_patients.sql
[0m19:21:30.740393 [info ] [MainThread]: 
[0m19:21:30.741427 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=8
[0m19:21:30.745440 [debug] [MainThread]: Command `dbt run` failed at 19:21:30.745440 after 16.32 seconds
[0m19:21:30.746044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD0FEECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD0768650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5E04110>]}
[0m19:21:30.747476 [debug] [MainThread]: Flushing usage events
[0m19:21:30.919658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:05.501776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255316A77A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255316A7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025531243BF0>]}


============================== 19:22:05.509463 | c784da0d-8d60-422a-ba3f-f7205e70d4b7 ==============================
[0m19:22:05.509463 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:22:05.510971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:22:06.153583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255338CE8A0>]}
[0m19:22:06.201153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025531271FD0>]}
[0m19:22:06.201153 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:22:06.545440 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:22:06.687961 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:22:06.689963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255312403E0>]}
[0m19:22:07.818583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255333355B0>]}
[0m19:22:07.865862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:22:07.881497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:22:07.933909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025533F005F0>]}
[0m19:22:07.935986 [info ] [MainThread]: Found 8 models, 472 macros
[0m19:22:07.935986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025533ADDCD0>]}
[0m19:22:07.939504 [info ] [MainThread]: 
[0m19:22:07.939504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:22:07.939504 [info ] [MainThread]: 
[0m19:22:07.943324 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:07.950286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:22:08.061407 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:22:08.077525 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:22:08.077525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:09.705541 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.634 seconds
[0m19:22:09.705541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:22:09.739819 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:22:09.739819 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m19:22:09.739819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:10.143890 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.414 seconds
[0m19:22:10.159728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025533B0F3B0>]}
[0m19:22:10.159728 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m19:22:10.159728 [info ] [Thread-1 (]: 1 of 7 START sql view model SILVER.src_claims .................................. [RUN]
[0m19:22:10.159728 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m19:22:10.159728 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m19:22:10.175505 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m19:22:10.175505 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m19:22:10.199114 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m19:22:10.199114 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m19:22:10.199114 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m19:22:10.199114 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:22:10.581636 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdb15a-0000-253f-0027-cf8b0002b58e
[0m19:22:10.581636 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_DB.RAW.RAW_CLAIMS' does not exist or not authorized.
[0m19:22:10.597741 [debug] [Thread-1 (]: Database Error in model src_claims (models\staging\src_claims.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CLAIMS' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_claims.sql
[0m19:22:10.597741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025530B46870>]}
[0m19:22:10.597741 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model SILVER.src_claims ......................... [[31mERROR[0m in 0.44s]
[0m19:22:10.597741 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m19:22:10.597741 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m19:22:10.597741 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_claims' to be skipped because of status 'error'.  Reason: Database Error in model src_claims (models\staging\src_claims.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CLAIMS' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_claims.sql.
[0m19:22:10.597741 [info ] [Thread-1 (]: 2 of 7 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m19:22:10.612882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m19:22:10.613424 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m19:22:10.617951 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m19:22:10.619964 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m19:22:10.621977 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m19:22:10.623988 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m19:22:10.623988 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m19:22:10.698694 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdb15a-0000-2541-0027-cf8b0002d52a
[0m19:22:10.699702 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_DB.RAW.RAW_CPTCODES' does not exist or not authorized.
[0m19:22:10.708213 [debug] [Thread-1 (]: Database Error in model src_cptcodes (models\staging\src_cptcodes.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CPTCODES' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_cptcodes.sql
[0m19:22:10.709224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255345CCB60>]}
[0m19:22:10.710172 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model SILVER.src_cptcodes ....................... [[31mERROR[0m in 0.10s]
[0m19:22:10.713273 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m19:22:10.714230 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m19:22:10.714230 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_cptcodes' to be skipped because of status 'error'.  Reason: Database Error in model src_cptcodes (models\staging\src_cptcodes.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CPTCODES' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_cptcodes.sql.
[0m19:22:10.714230 [info ] [Thread-1 (]: 3 of 7 START sql view model SILVER.src_departments ............................. [RUN]
[0m19:22:10.718633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m19:22:10.719707 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m19:22:10.722597 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m19:22:10.724924 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m19:22:10.732631 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m19:22:10.735624 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m19:22:10.737627 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m19:22:10.894039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m19:22:10.909833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552E759E80>]}
[0m19:22:10.909833 [info ] [Thread-1 (]: 3 of 7 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.19s]
[0m19:22:10.925537 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m19:22:10.925537 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m19:22:10.925537 [info ] [Thread-1 (]: 4 of 7 START sql view model SILVER.src_encounters .............................. [RUN]
[0m19:22:10.925537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m19:22:10.925537 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m19:22:10.925537 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m19:22:10.925537 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m19:22:10.925537 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m19:22:10.925537 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m19:22:10.925537 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m19:22:11.111151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m19:22:11.127052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002553442BB90>]}
[0m19:22:11.127052 [info ] [Thread-1 (]: 4 of 7 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.20s]
[0m19:22:11.127052 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m19:22:11.127052 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m19:22:11.127052 [info ] [Thread-1 (]: 5 of 7 START sql view model SILVER.src_patients ................................ [RUN]
[0m19:22:11.127052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m19:22:11.137302 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m19:22:11.140231 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m19:22:11.141363 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m19:22:11.145109 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m19:22:11.145109 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m19:22:11.147119 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with RAW_PATIENTS as (

    select * from DBT_DB.RAW.RAW_PATIENTS

)
    select
        PatientID as patient_id,
        FirstName as first_name,
        LastName as last_name,
        MiddleName as middle_name,
        SSN as ssn,
        PhoneNumber as phone_number,
        Gender as gender,
        DOB as date_of_birth,
        Address as address,
        ModifiedDate as modified_date

    from RAW_PATIENTS
  );
[0m19:22:11.340358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m19:22:11.342358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002553463AE70>]}
[0m19:22:11.347309 [info ] [Thread-1 (]: 5 of 7 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.22s]
[0m19:22:11.350457 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m19:22:11.350965 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m19:22:11.352975 [info ] [Thread-1 (]: 6 of 7 START sql view model SILVER.src_providers ............................... [RUN]
[0m19:22:11.352975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m19:22:11.355646 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m19:22:11.357544 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m19:22:11.359486 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m19:22:11.366071 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m19:22:11.369283 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m19:22:11.369283 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m19:22:11.594357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m19:22:11.607588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255345E8FE0>]}
[0m19:22:11.607588 [info ] [Thread-1 (]: 6 of 7 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.25s]
[0m19:22:11.612390 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m19:22:11.612390 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m19:22:11.614401 [info ] [Thread-1 (]: 7 of 7 START sql view model SILVER.src_transactions ............................ [RUN]
[0m19:22:11.614401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m19:22:11.614401 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m19:22:11.623246 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m19:22:11.624308 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m19:22:11.630814 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m19:22:11.633876 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m19:22:11.633876 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m19:22:11.962433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m19:22:11.968038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c784da0d-8d60-422a-ba3f-f7205e70d4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255345E9F10>]}
[0m19:22:11.970049 [info ] [Thread-1 (]: 7 of 7 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.35s]
[0m19:22:11.972073 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m19:22:11.972073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:11.974095 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:22:11.974095 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:22:12.049004 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:22:12.065136 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:22:12.152673 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m19:22:12.152673 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m19:22:12.221850 [info ] [MainThread]: 
[0m19:22:12.223880 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m19:22:12.225908 [debug] [MainThread]: Command end result
[0m19:22:12.253157 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:22:12.256151 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:22:12.267763 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:22:12.267763 [info ] [MainThread]: 
[0m19:22:12.267763 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:22:12.267763 [info ] [MainThread]: 
[0m19:22:12.267763 [error] [MainThread]: [31mFailure in model src_claims (models\staging\src_claims.sql)[0m
[0m19:22:12.267763 [error] [MainThread]:   Database Error in model src_claims (models\staging\src_claims.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CLAIMS' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_claims.sql
[0m19:22:12.267763 [info ] [MainThread]: 
[0m19:22:12.267763 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\staging\src_claims.sql
[0m19:22:12.277321 [info ] [MainThread]: 
[0m19:22:12.278400 [error] [MainThread]: [31mFailure in model src_cptcodes (models\staging\src_cptcodes.sql)[0m
[0m19:22:12.279334 [error] [MainThread]:   Database Error in model src_cptcodes (models\staging\src_cptcodes.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.RAW.RAW_CPTCODES' does not exist or not authorized.
  compiled code at target\run\healthcare\models\staging\src_cptcodes.sql
[0m19:22:12.280344 [info ] [MainThread]: 
[0m19:22:12.281335 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\staging\src_cptcodes.sql
[0m19:22:12.283337 [info ] [MainThread]: 
[0m19:22:12.285344 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=7
[0m19:22:12.287356 [debug] [MainThread]: Command `dbt run` failed at 19:22:12.287356 after 6.97 seconds
[0m19:22:12.288422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025530444DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025530DB4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025530B23F50>]}
[0m19:22:12.288422 [debug] [MainThread]: Flushing usage events
[0m19:22:12.431645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:27.448049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74E7C1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D752034920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D752034FB0>]}


============================== 19:25:27.468441 | 0a876feb-9f4d-47bc-b5bb-08979a1c1713 ==============================
[0m19:25:27.468441 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:25:27.468441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:25:28.139087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D752A1C8F0>]}
[0m19:25:28.186020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D753A64590>]}
[0m19:25:28.186020 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:25:28.485543 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:25:28.743456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:28.743456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:28.864447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7526B3200>]}
[0m19:25:28.895575 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:25:28.905002 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:25:28.926908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D754E20260>]}
[0m19:25:28.926908 [info ] [MainThread]: Found 8 models, 472 macros
[0m19:25:28.937589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D754C8F8C0>]}
[0m19:25:28.937589 [info ] [MainThread]: 
[0m19:25:28.937589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:25:28.937589 [info ] [MainThread]: 
[0m19:25:28.943392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:25:28.947446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:25:29.012238 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:25:29.012238 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:25:29.012238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:29.493390 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.467 seconds
[0m19:25:29.498667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:25:29.509321 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:25:29.510165 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m19:25:29.510165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:29.929373 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.420 seconds
[0m19:25:29.929373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D754AC4BC0>]}
[0m19:25:29.940180 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m19:25:29.942191 [info ] [Thread-1 (]: 1 of 7 START sql view model SILVER.src_claims .................................. [RUN]
[0m19:25:29.944202 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m19:25:29.945310 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m19:25:29.945310 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m19:25:29.945310 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m19:25:29.972553 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m19:25:29.974560 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m19:25:29.974560 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m19:25:29.976570 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:25:30.576089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m19:25:30.597082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D751D3B2F0>]}
[0m19:25:30.599093 [info ] [Thread-1 (]: 1 of 7 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.65s]
[0m19:25:30.599093 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m19:25:30.601110 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m19:25:30.601110 [info ] [Thread-1 (]: 2 of 7 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m19:25:30.601110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m19:25:30.601110 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m19:25:30.601110 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m19:25:30.601110 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m19:25:30.608744 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m19:25:30.612111 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m19:25:30.613190 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m19:25:30.744180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m19:25:30.744180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D755542FC0>]}
[0m19:25:30.744180 [info ] [Thread-1 (]: 2 of 7 OK created sql view model SILVER.src_cptcodes ........................... [[32mSUCCESS 1[0m in 0.14s]
[0m19:25:30.760146 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m19:25:30.760146 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m19:25:30.762862 [info ] [Thread-1 (]: 3 of 7 START sql view model SILVER.src_departments ............................. [RUN]
[0m19:25:30.762862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m19:25:30.762862 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m19:25:30.767159 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m19:25:30.769178 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m19:25:30.772633 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m19:25:30.778051 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m19:25:30.779362 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m19:25:30.894985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m19:25:30.911060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D75555A870>]}
[0m19:25:30.915739 [info ] [Thread-1 (]: 3 of 7 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.15s]
[0m19:25:30.916859 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m19:25:30.916859 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m19:25:30.919669 [info ] [Thread-1 (]: 4 of 7 START sql view model SILVER.src_encounters .............................. [RUN]
[0m19:25:30.919669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m19:25:30.919669 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m19:25:30.925350 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m19:25:30.927352 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m19:25:30.932733 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m19:25:30.937984 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m19:25:30.940124 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m19:25:31.113226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m19:25:31.113226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D755582F00>]}
[0m19:25:31.113226 [info ] [Thread-1 (]: 4 of 7 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.19s]
[0m19:25:31.124831 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m19:25:31.124831 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m19:25:31.124831 [info ] [Thread-1 (]: 5 of 7 START sql view model SILVER.src_patients ................................ [RUN]
[0m19:25:31.130887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m19:25:31.132450 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m19:25:31.134998 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m19:25:31.135870 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m19:25:31.140953 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m19:25:31.140953 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m19:25:31.142971 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with RAW_PATIENTS as (

    select * from DBT_DB.RAW.RAW_PATIENTS

)
    select
        PatientID as patient_id,
        FirstName as first_name,
        LastName as last_name,
        MiddleName as middle_name,
        SSN as ssn,
        PhoneNumber as phone_number,
        Gender as gender,
        DOB as date_of_birth,
        Address as address,
        ModifiedDate as modified_date

    from RAW_PATIENTS
  );
[0m19:25:31.314639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m19:25:31.316656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D755592330>]}
[0m19:25:31.316656 [info ] [Thread-1 (]: 5 of 7 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.19s]
[0m19:25:31.319587 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m19:25:31.319587 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m19:25:31.319587 [info ] [Thread-1 (]: 6 of 7 START sql view model SILVER.src_providers ............................... [RUN]
[0m19:25:31.319587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m19:25:31.319587 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m19:25:31.326502 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m19:25:31.327487 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m19:25:31.333161 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m19:25:31.334849 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m19:25:31.334849 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m19:25:31.485489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m19:25:31.486004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7555A7A40>]}
[0m19:25:31.488018 [info ] [Thread-1 (]: 6 of 7 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.17s]
[0m19:25:31.488018 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m19:25:31.488018 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m19:25:31.488018 [info ] [Thread-1 (]: 7 of 7 START sql view model SILVER.src_transactions ............................ [RUN]
[0m19:25:31.494621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m19:25:31.494621 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m19:25:31.494621 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m19:25:31.494621 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m19:25:31.503797 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m19:25:31.505821 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m19:25:31.505821 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m19:25:31.742474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m19:25:31.745515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a876feb-9f4d-47bc-b5bb-08979a1c1713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D755566B10>]}
[0m19:25:31.745515 [info ] [Thread-1 (]: 7 of 7 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.25s]
[0m19:25:31.745515 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m19:25:31.745515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:31.745515 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:25:31.745515 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:25:31.842880 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:25:31.843877 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:25:31.927577 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m19:25:31.927577 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m19:25:32.022517 [info ] [MainThread]: 
[0m19:25:32.022517 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m19:25:32.022517 [debug] [MainThread]: Command end result
[0m19:25:32.054684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:25:32.054684 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:25:32.065693 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:25:32.065693 [info ] [MainThread]: 
[0m19:25:32.065693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:25:32.065693 [info ] [MainThread]: 
[0m19:25:32.065693 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m19:25:32.065693 [debug] [MainThread]: Command `dbt run` succeeded at 19:25:32.065693 after 4.79 seconds
[0m19:25:32.065693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D752895640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D752895970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D752897C80>]}
[0m19:25:32.065693 [debug] [MainThread]: Flushing usage events
[0m19:25:32.255203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:17.325996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD56CBFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD56CBD7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD56CBD820>]}


============================== 17:05:17.331997 | e43d544f-9125-47ca-a86b-b1da74d855f7 ==============================
[0m17:05:17.331997 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:05:17.333995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:05:18.556930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD592DAC00>]}
[0m17:05:18.603663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD58FB89B0>]}
[0m17:05:18.603663 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:05:19.297259 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:05:19.337675 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:05:19.337675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD56D341A0>]}
[0m17:05:20.455327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5983B3B0>]}
[0m17:05:20.498712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:05:20.523590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:05:20.570555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD59A09220>]}
[0m17:05:20.570555 [info ] [MainThread]: Found 16 models, 472 macros
[0m17:05:20.570555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD568D4230>]}
[0m17:05:20.575112 [info ] [MainThread]: 
[0m17:05:20.575112 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:20.575112 [info ] [MainThread]: 
[0m17:05:20.575112 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:05:20.575112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:05:24.234188 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:05:24.234188 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:05:24.235188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:25.777418 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.546 seconds
[0m17:05:25.777418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:05:25.795280 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:05:25.796279 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:05:25.796279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:26.241885 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.446 seconds
[0m17:05:26.241885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD595AA6F0>]}
[0m17:05:26.251816 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m17:05:26.251816 [info ] [Thread-1 (]: 1 of 7 START sql view model SILVER.src_claims .................................. [RUN]
[0m17:05:26.256881 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m17:05:26.258134 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m17:05:26.262774 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m17:05:26.263763 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m17:05:26.290458 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m17:05:26.294804 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m17:05:26.294804 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m17:05:26.295813 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:05:26.876127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m17:05:26.908939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD54245E50>]}
[0m17:05:26.908939 [info ] [Thread-1 (]: 1 of 7 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.65s]
[0m17:05:26.908939 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m17:05:26.908939 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m17:05:26.908939 [info ] [Thread-1 (]: 2 of 7 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m17:05:26.915745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m17:05:26.915745 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m17:05:26.915745 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m17:05:26.919919 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m17:05:26.919919 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m17:05:26.926367 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m17:05:26.927434 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m17:05:27.136697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m17:05:27.139760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD59FD1C10>]}
[0m17:05:27.142300 [info ] [Thread-1 (]: 2 of 7 OK created sql view model SILVER.src_cptcodes ........................... [[32mSUCCESS 1[0m in 0.22s]
[0m17:05:27.144245 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m17:05:27.144245 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m17:05:27.144245 [info ] [Thread-1 (]: 3 of 7 START sql view model SILVER.src_departments ............................. [RUN]
[0m17:05:27.146856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m17:05:27.146856 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m17:05:27.146856 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m17:05:27.146856 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m17:05:27.152000 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m17:05:27.152000 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m17:05:27.152000 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m17:05:27.409715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m17:05:27.409715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5A008F50>]}
[0m17:05:27.409715 [info ] [Thread-1 (]: 3 of 7 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.26s]
[0m17:05:27.409715 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m17:05:27.409715 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m17:05:27.409715 [info ] [Thread-1 (]: 4 of 7 START sql view model SILVER.src_encounters .............................. [RUN]
[0m17:05:27.419339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m17:05:27.419339 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m17:05:27.419339 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m17:05:27.425112 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m17:05:27.428351 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m17:05:27.429806 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m17:05:27.429806 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m17:05:27.707155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m17:05:27.709575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5A053140>]}
[0m17:05:27.709575 [info ] [Thread-1 (]: 4 of 7 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.29s]
[0m17:05:27.709575 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m17:05:27.709575 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m17:05:27.709575 [info ] [Thread-1 (]: 5 of 7 START sql view model SILVER.src_patients ................................ [RUN]
[0m17:05:27.717775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m17:05:27.717775 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m17:05:27.717775 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m17:05:27.717775 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m17:05:27.724190 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m17:05:27.728743 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m17:05:27.729836 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with RAW_PATIENTS as (

    select * from DBT_DB.RAW.RAW_PATIENTS

)
    select
        PatientID as patient_id,
        FirstName as first_name,
        LastName as last_name,
        MiddleName as middle_name,
        SSN as ssn,
        PhoneNumber as phone_number,
        Gender as gender,
        DOB as date_of_birth,
        Address as address,
        ModifiedDate as modified_date

    from RAW_PATIENTS
  );
[0m17:05:28.043850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m17:05:28.043850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5A08CD70>]}
[0m17:05:28.043850 [info ] [Thread-1 (]: 5 of 7 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.33s]
[0m17:05:28.043850 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m17:05:28.043850 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m17:05:28.059627 [info ] [Thread-1 (]: 6 of 7 START sql view model SILVER.src_providers ............................... [RUN]
[0m17:05:28.061878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m17:05:28.062917 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m17:05:28.065872 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m17:05:28.067868 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m17:05:28.069937 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m17:05:28.071957 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m17:05:28.072959 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m17:05:28.343720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m17:05:28.343720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5B06AA20>]}
[0m17:05:28.343720 [info ] [Thread-1 (]: 6 of 7 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.28s]
[0m17:05:28.343720 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m17:05:28.343720 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m17:05:28.343720 [info ] [Thread-1 (]: 7 of 7 START sql view model SILVER.src_transactions ............................ [RUN]
[0m17:05:28.343720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m17:05:28.343720 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m17:05:28.343720 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m17:05:28.359219 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m17:05:28.364055 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m17:05:28.366429 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m17:05:28.367707 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m17:05:28.610692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.248 seconds
[0m17:05:28.619160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43d544f-9125-47ca-a86b-b1da74d855f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5A0084A0>]}
[0m17:05:28.621173 [info ] [Thread-1 (]: 7 of 7 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.28s]
[0m17:05:28.621173 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m17:05:28.621173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:28.626274 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m17:05:28.626889 [debug] [MainThread]: On list_DBT_DB: Close
[0m17:05:28.716258 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m17:05:28.716258 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m17:05:28.834701 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m17:05:28.835706 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m17:05:28.910751 [info ] [MainThread]: 
[0m17:05:28.910751 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m17:05:28.910751 [debug] [MainThread]: Command end result
[0m17:05:28.935561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:05:28.937561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:05:28.945930 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:05:28.946637 [info ] [MainThread]: 
[0m17:05:28.947721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:28.947721 [info ] [MainThread]: 
[0m17:05:28.947721 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m17:05:28.947721 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:28.947721 after 11.81 seconds
[0m17:05:28.947721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD56D37950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD56D34590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD56D34650>]}
[0m17:05:28.947721 [debug] [MainThread]: Flushing usage events
[0m17:05:29.563165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:06.375678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B882A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B66AA000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B6C03EC0>]}


============================== 17:28:06.381681 | 8161d428-9854-44a7-8102-392d63c555a3 ==============================
[0m17:28:06.381681 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:28:06.383183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:28:06.917010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B988CA40>]}
[0m17:28:06.965461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BB533FB0>]}
[0m17:28:06.967682 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:28:07.269108 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:28:07.317251 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:28:07.317251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B92A04A0>]}
[0m17:28:08.275895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BBEE3380>]}
[0m17:28:08.321490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:28:08.333050 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:28:08.367561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BC0FE960>]}
[0m17:28:08.368801 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m17:28:08.369800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BC115DC0>]}
[0m17:28:08.370800 [info ] [MainThread]: 
[0m17:28:08.371798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:08.372801 [info ] [MainThread]: 
[0m17:28:08.373799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:28:08.377816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:28:08.469968 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:28:08.470968 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:28:08.470968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:09.517647 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.046 seconds
[0m17:28:09.523383 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:28:09.527297 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:28:09.534653 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:28:09.536513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:10.160070 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.624 seconds
[0m17:28:10.161935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BBFF7D40>]}
[0m17:28:10.175448 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m17:28:10.177462 [info ] [Thread-1 (]: 1 of 7 START sql view model SILVER.src_claims .................................. [RUN]
[0m17:28:10.181452 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m17:28:10.183460 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m17:28:10.199225 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m17:28:10.202892 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m17:28:10.227316 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m17:28:10.229214 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m17:28:10.230215 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m17:28:10.231213 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:28:10.987136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m17:28:11.020350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B67BA2D0>]}
[0m17:28:11.020350 [info ] [Thread-1 (]: 1 of 7 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.84s]
[0m17:28:11.020350 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m17:28:11.030217 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m17:28:11.030217 [info ] [Thread-1 (]: 2 of 7 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m17:28:11.034476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m17:28:11.035883 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m17:28:11.040912 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m17:28:11.042912 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m17:28:11.122336 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m17:28:11.124336 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m17:28:11.126340 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m17:28:11.475283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m17:28:11.478282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BC630AD0>]}
[0m17:28:11.479284 [info ] [Thread-1 (]: 2 of 7 OK created sql view model SILVER.src_cptcodes ........................... [[32mSUCCESS 1[0m in 0.44s]
[0m17:28:11.480289 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m17:28:11.481285 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m17:28:11.481285 [info ] [Thread-1 (]: 3 of 7 START sql view model SILVER.src_departments ............................. [RUN]
[0m17:28:11.482285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m17:28:11.483308 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m17:28:11.485302 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m17:28:11.486283 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m17:28:11.490161 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m17:28:11.491163 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m17:28:11.492161 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m17:28:11.709038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m17:28:11.713041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BBE6F9B0>]}
[0m17:28:11.714039 [info ] [Thread-1 (]: 3 of 7 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.23s]
[0m17:28:11.716050 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m17:28:11.716050 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m17:28:11.718146 [info ] [Thread-1 (]: 4 of 7 START sql view model SILVER.src_encounters .............................. [RUN]
[0m17:28:11.719087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m17:28:11.719087 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m17:28:11.720798 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m17:28:11.720798 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m17:28:11.726353 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m17:28:11.726353 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m17:28:11.726353 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m17:28:11.942707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m17:28:11.947706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BBF54050>]}
[0m17:28:11.949721 [info ] [Thread-1 (]: 4 of 7 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.23s]
[0m17:28:11.952719 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m17:28:11.953718 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m17:28:11.954530 [info ] [Thread-1 (]: 5 of 7 START sql view model SILVER.src_patients ................................ [RUN]
[0m17:28:11.954530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m17:28:11.954530 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m17:28:11.960950 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m17:28:11.960950 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m17:28:11.964512 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m17:28:11.964512 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m17:28:11.969597 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospital_id, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m17:28:12.273055 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdcd08-0000-26ab-0027-cf8b0004f36e
[0m17:28:12.273055 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'HOSPITAL_ID'
[0m17:28:12.288533 [debug] [Thread-1 (]: Database Error in model src_patients (models\staging\src_patients.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'HOSPITAL_ID'
  compiled code at target\run\healthcare\models\staging\src_patients.sql
[0m17:28:12.289502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BBEB8560>]}
[0m17:28:12.290503 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model SILVER.src_patients ....................... [[31mERROR[0m in 0.33s]
[0m17:28:12.291504 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m17:28:12.292503 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m17:28:12.292503 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_patients' to be skipped because of status 'error'.  Reason: Database Error in model src_patients (models\staging\src_patients.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'HOSPITAL_ID'
  compiled code at target\run\healthcare\models\staging\src_patients.sql.
[0m17:28:12.293502 [info ] [Thread-1 (]: 6 of 7 START sql view model SILVER.src_providers ............................... [RUN]
[0m17:28:12.294507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m17:28:12.295533 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m17:28:12.297518 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m17:28:12.298502 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m17:28:12.303617 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m17:28:12.306739 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m17:28:12.307743 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m17:28:12.537864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m17:28:12.540254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BBEB89E0>]}
[0m17:28:12.541251 [info ] [Thread-1 (]: 6 of 7 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.25s]
[0m17:28:12.543155 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m17:28:12.543155 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m17:28:12.546149 [info ] [Thread-1 (]: 7 of 7 START sql view model SILVER.src_transactions ............................ [RUN]
[0m17:28:12.547157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m17:28:12.548150 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m17:28:12.553169 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m17:28:12.555478 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m17:28:12.557104 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m17:28:12.557104 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m17:28:12.557104 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m17:28:12.928769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m17:28:12.941033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8161d428-9854-44a7-8102-392d63c555a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287BBD5A240>]}
[0m17:28:12.942932 [info ] [Thread-1 (]: 7 of 7 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.39s]
[0m17:28:12.945939 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m17:28:12.948970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:12.948970 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m17:28:12.950033 [debug] [MainThread]: On list_DBT_DB: Close
[0m17:28:13.047762 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m17:28:13.048766 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m17:28:13.142029 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m17:28:13.143029 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m17:28:13.227984 [info ] [MainThread]: 
[0m17:28:13.227984 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m17:28:13.233796 [debug] [MainThread]: Command end result
[0m17:28:13.261765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:28:13.261765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:28:13.266926 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:28:13.271588 [info ] [MainThread]: 
[0m17:28:13.273598 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:28:13.274596 [info ] [MainThread]: 
[0m17:28:13.275596 [error] [MainThread]: [31mFailure in model src_patients (models\staging\src_patients.sql)[0m
[0m17:28:13.276596 [error] [MainThread]:   Database Error in model src_patients (models\staging\src_patients.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'HOSPITAL_ID'
  compiled code at target\run\healthcare\models\staging\src_patients.sql
[0m17:28:13.277594 [info ] [MainThread]: 
[0m17:28:13.278593 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\staging\src_patients.sql
[0m17:28:13.279596 [info ] [MainThread]: 
[0m17:28:13.280597 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m17:28:13.281596 [debug] [MainThread]: Command `dbt run` failed at 17:28:13.281596 after 7.12 seconds
[0m17:28:13.282596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B8C5DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B92A0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287B92A2F00>]}
[0m17:28:13.282596 [debug] [MainThread]: Flushing usage events
[0m17:28:13.547351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:35.205697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9977F60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D994A9C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D994C816D0>]}


============================== 17:31:35.205697 | 775ef369-b2e1-4897-bd98-96f6f2d3965d ==============================
[0m17:31:35.205697 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:31:35.220630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:31:35.735508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9977344A0>]}
[0m17:31:35.772815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D994D11670>]}
[0m17:31:35.772815 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:31:36.072664 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:31:36.139734 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:31:36.139734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D999E17D70>]}
[0m17:31:37.055936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D999F09FD0>]}
[0m17:31:37.107045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:31:37.107045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:31:37.140485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D999F879E0>]}
[0m17:31:37.140485 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m17:31:37.140485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A078BF0>]}
[0m17:31:37.140485 [info ] [MainThread]: 
[0m17:31:37.140485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:37.140485 [info ] [MainThread]: 
[0m17:31:37.140485 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:31:37.156655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:31:37.239150 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:31:37.240697 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:31:37.240697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:37.861095 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.620 seconds
[0m17:31:37.865188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:31:37.873085 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:31:37.874086 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:31:37.874571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:38.174984 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.306 seconds
[0m17:31:38.174984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A15DA90>]}
[0m17:31:38.195653 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m17:31:38.195653 [info ] [Thread-1 (]: 1 of 7 START sql view model SILVER.src_claims .................................. [RUN]
[0m17:31:38.196666 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m17:31:38.197655 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m17:31:38.203653 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m17:31:38.204758 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m17:31:38.236196 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m17:31:38.238132 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m17:31:38.238132 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m17:31:38.239138 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:38.875695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m17:31:38.904888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99480A120>]}
[0m17:31:38.905889 [info ] [Thread-1 (]: 1 of 7 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.71s]
[0m17:31:38.906890 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m17:31:38.907940 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m17:31:38.908259 [info ] [Thread-1 (]: 2 of 7 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m17:31:38.908259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m17:31:38.908259 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m17:31:38.908259 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m17:31:38.908259 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m17:31:38.976873 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m17:31:38.991914 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m17:31:38.993925 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m17:31:39.162184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m17:31:39.165281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A67D250>]}
[0m17:31:39.167205 [info ] [Thread-1 (]: 2 of 7 OK created sql view model SILVER.src_cptcodes ........................... [[32mSUCCESS 1[0m in 0.26s]
[0m17:31:39.168192 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m17:31:39.169186 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m17:31:39.170188 [info ] [Thread-1 (]: 3 of 7 START sql view model SILVER.src_departments ............................. [RUN]
[0m17:31:39.171195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m17:31:39.172183 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m17:31:39.174284 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m17:31:39.178200 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m17:31:39.185039 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m17:31:39.185039 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m17:31:39.185039 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m17:31:39.336994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m17:31:39.342632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A67E6F0>]}
[0m17:31:39.342632 [info ] [Thread-1 (]: 3 of 7 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.17s]
[0m17:31:39.342632 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m17:31:39.342632 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m17:31:39.342632 [info ] [Thread-1 (]: 4 of 7 START sql view model SILVER.src_encounters .............................. [RUN]
[0m17:31:39.342632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m17:31:39.353106 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m17:31:39.360002 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m17:31:39.365087 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m17:31:39.372991 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m17:31:39.379433 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m17:31:39.381411 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m17:31:39.559466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m17:31:39.562469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D999FC66F0>]}
[0m17:31:39.564472 [info ] [Thread-1 (]: 4 of 7 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.22s]
[0m17:31:39.567483 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m17:31:39.570465 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m17:31:39.570465 [info ] [Thread-1 (]: 5 of 7 START sql view model SILVER.src_patients ................................ [RUN]
[0m17:31:39.571465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m17:31:39.572465 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m17:31:39.574463 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m17:31:39.576475 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m17:31:39.577921 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m17:31:39.577921 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m17:31:39.577921 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m17:31:39.802278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m17:31:39.807328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D999EDCD70>]}
[0m17:31:39.810239 [info ] [Thread-1 (]: 5 of 7 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.24s]
[0m17:31:39.813233 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m17:31:39.814232 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m17:31:39.815236 [info ] [Thread-1 (]: 6 of 7 START sql view model SILVER.src_providers ............................... [RUN]
[0m17:31:39.817254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m17:31:39.819239 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m17:31:39.821240 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m17:31:39.822243 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m17:31:39.828582 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m17:31:39.831107 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m17:31:39.832214 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m17:31:40.109856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m17:31:40.109856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9999B3770>]}
[0m17:31:40.109856 [info ] [Thread-1 (]: 6 of 7 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.29s]
[0m17:31:40.109856 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m17:31:40.109856 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m17:31:40.109856 [info ] [Thread-1 (]: 7 of 7 START sql view model SILVER.src_transactions ............................ [RUN]
[0m17:31:40.109856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m17:31:40.109856 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m17:31:40.129525 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m17:31:40.134075 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m17:31:40.138215 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m17:31:40.140065 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m17:31:40.141177 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m17:31:40.443540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m17:31:40.443540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775ef369-b2e1-4897-bd98-96f6f2d3965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D999D729C0>]}
[0m17:31:40.443540 [info ] [Thread-1 (]: 7 of 7 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.33s]
[0m17:31:40.443540 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m17:31:40.443540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:40.443540 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m17:31:40.443540 [debug] [MainThread]: On list_DBT_DB: Close
[0m17:31:40.537743 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m17:31:40.538747 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m17:31:40.610703 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m17:31:40.610703 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m17:31:40.677416 [info ] [MainThread]: 
[0m17:31:40.677416 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m17:31:40.677416 [debug] [MainThread]: Command end result
[0m17:31:40.715291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:31:40.715291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:31:40.732055 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:31:40.733072 [info ] [MainThread]: 
[0m17:31:40.734067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:40.735065 [info ] [MainThread]: 
[0m17:31:40.736065 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m17:31:40.737069 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:40.737069 after 5.73 seconds
[0m17:31:40.737069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9950335F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D996CFFA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D996C28530>]}
[0m17:31:40.738066 [debug] [MainThread]: Flushing usage events
[0m17:31:40.885787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:57.909764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C62319C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C6223E930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C647B9310>]}


============================== 17:31:57.913878 | 3f8848b2-137c-4f88-8ede-7993a2963ff9 ==============================
[0m17:31:57.913878 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:31:57.915769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select src_patients', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:31:58.456432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f8848b2-137c-4f88-8ede-7993a2963ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C672E5760>]}
[0m17:31:58.491712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f8848b2-137c-4f88-8ede-7993a2963ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C6739FD70>]}
[0m17:31:58.491712 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:31:58.792066 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:31:59.017495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:59.017495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:59.044244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f8848b2-137c-4f88-8ede-7993a2963ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C67940860>]}
[0m17:31:59.091971 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:31:59.096818 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:31:59.129599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f8848b2-137c-4f88-8ede-7993a2963ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C67BD62D0>]}
[0m17:31:59.129599 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m17:31:59.140610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f8848b2-137c-4f88-8ede-7993a2963ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C67B9B770>]}
[0m17:31:59.142039 [info ] [MainThread]: 
[0m17:31:59.143095 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:59.144105 [info ] [MainThread]: 
[0m17:31:59.144105 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:31:59.149104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:31:59.242372 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:31:59.243380 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:31:59.244378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:59.974736 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.731 seconds
[0m17:31:59.979368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f8848b2-137c-4f88-8ede-7993a2963ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C6778CAD0>]}
[0m17:31:59.984350 [debug] [Thread-1 (]: Began running node test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca
[0m17:31:59.984350 [info ] [Thread-1 (]: 1 of 2 START test not_null_src_patients_unique_patient_id ...................... [RUN]
[0m17:31:59.985349 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca'
[0m17:31:59.986359 [debug] [Thread-1 (]: Began compiling node test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca
[0m17:32:00.017174 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca"
[0m17:32:00.021163 [debug] [Thread-1 (]: Began executing node test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca
[0m17:32:00.057794 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca"
[0m17:32:00.059302 [debug] [Thread-1 (]: Using snowflake connection "test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca"
[0m17:32:00.059302 [debug] [Thread-1 (]: On test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_patient_id
from DBT_DB.SILVER.src_patients
where unique_patient_id is null



  
  
      
    ) dbt_internal_test
[0m17:32:00.059302 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:01.107788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.044 seconds
[0m17:32:01.120619 [info ] [Thread-1 (]: 1 of 2 PASS not_null_src_patients_unique_patient_id ............................ [[32mPASS[0m in 1.14s]
[0m17:32:01.123525 [debug] [Thread-1 (]: Finished running node test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca
[0m17:32:01.124520 [debug] [Thread-1 (]: Began running node test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd
[0m17:32:01.125521 [info ] [Thread-1 (]: 2 of 2 START test unique_src_patients_unique_patient_id ........................ [RUN]
[0m17:32:01.126994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare.not_null_src_patients_unique_patient_id.3e92befaca, now test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd)
[0m17:32:01.126994 [debug] [Thread-1 (]: Began compiling node test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd
[0m17:32:01.133568 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd"
[0m17:32:01.133568 [debug] [Thread-1 (]: Began executing node test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd
[0m17:32:01.139186 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd"
[0m17:32:01.141198 [debug] [Thread-1 (]: Using snowflake connection "test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd"
[0m17:32:01.141198 [debug] [Thread-1 (]: On test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    unique_patient_id as unique_field,
    count(*) as n_records

from DBT_DB.SILVER.src_patients
where unique_patient_id is not null
group by unique_patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:32:01.615279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m17:32:01.617281 [info ] [Thread-1 (]: 2 of 2 PASS unique_src_patients_unique_patient_id .............................. [[32mPASS[0m in 0.49s]
[0m17:32:01.619285 [debug] [Thread-1 (]: Finished running node test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd
[0m17:32:01.621280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:01.622379 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m17:32:01.623284 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m17:32:01.700602 [debug] [MainThread]: Connection 'test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd' was left open.
[0m17:32:01.701602 [debug] [MainThread]: On test.healthcare.unique_src_patients_unique_patient_id.8459eeb2dd: Close
[0m17:32:01.771269 [info ] [MainThread]: 
[0m17:32:01.773304 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m17:32:01.777781 [debug] [MainThread]: Command end result
[0m17:32:01.820464 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:32:01.823464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:32:01.828807 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:32:01.828807 [info ] [MainThread]: 
[0m17:32:01.828807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:01.828807 [info ] [MainThread]: 
[0m17:32:01.828807 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:32:01.828807 [debug] [MainThread]: Command `dbt test` succeeded at 17:32:01.828807 after 4.12 seconds
[0m17:32:01.828807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C654CC1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C67299EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C647E6DE0>]}
[0m17:32:01.828807 [debug] [MainThread]: Flushing usage events
[0m17:32:01.963119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:48.727842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D411B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D0D02720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D3E19820>]}


============================== 17:42:48.735303 | 8fbc8769-9cff-457f-8634-98a1f0fa767b ==============================
[0m17:42:48.735303 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:42:48.737296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:49.304299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D5F92630>]}
[0m17:42:49.346192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D66E1C70>]}
[0m17:42:49.346192 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:42:49.815919 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:42:49.880038 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:42:49.880038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D67F2FC0>]}
[0m17:42:50.829470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6E3DA30>]}
[0m17:42:50.879115 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:42:50.880463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:42:50.918343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6E3D340>]}
[0m17:42:50.918343 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m17:42:50.918343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6E09A90>]}
[0m17:42:50.918343 [info ] [MainThread]: 
[0m17:42:50.918343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:50.918343 [info ] [MainThread]: 
[0m17:42:50.918343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:50.932471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:42:51.024146 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:42:51.025147 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:42:51.025147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:52.833580 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.808 seconds
[0m17:42:52.836537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:42:52.845537 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:42:52.846538 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:42:52.847538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:53.315776 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.468 seconds
[0m17:42:53.320758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6D350A0>]}
[0m17:42:53.322907 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m17:42:53.322907 [info ] [Thread-1 (]: 1 of 8 START sql view model SILVER.src_claims .................................. [RUN]
[0m17:42:53.322907 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m17:42:53.331213 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m17:42:53.336859 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m17:42:53.339758 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m17:42:53.366815 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m17:42:53.370750 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m17:42:53.371750 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m17:42:53.372752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:53.818478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m17:42:53.844340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D16AA240>]}
[0m17:42:53.845340 [info ] [Thread-1 (]: 1 of 8 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.52s]
[0m17:42:53.846342 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m17:42:53.847341 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m17:42:53.848341 [info ] [Thread-1 (]: 2 of 8 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m17:42:53.850037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m17:42:53.850037 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m17:42:53.852933 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m17:42:53.854941 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m17:42:53.934063 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m17:42:53.936060 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m17:42:53.937081 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m17:42:54.168131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m17:42:54.171132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6D02180>]}
[0m17:42:54.173142 [info ] [Thread-1 (]: 2 of 8 OK created sql view model SILVER.src_cptcodes ........................... [[32mSUCCESS 1[0m in 0.32s]
[0m17:42:54.175233 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m17:42:54.175233 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m17:42:54.177140 [info ] [Thread-1 (]: 3 of 8 START sql view model SILVER.src_departments ............................. [RUN]
[0m17:42:54.180132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m17:42:54.181134 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m17:42:54.183515 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m17:42:54.185022 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m17:42:54.190572 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m17:42:54.190572 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m17:42:54.190572 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m17:42:54.540772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m17:42:54.548771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6825310>]}
[0m17:42:54.551753 [info ] [Thread-1 (]: 3 of 8 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.37s]
[0m17:42:54.553759 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m17:42:54.555770 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m17:42:54.555770 [info ] [Thread-1 (]: 4 of 8 START sql view model SILVER.src_encounters .............................. [RUN]
[0m17:42:54.555770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m17:42:54.559365 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m17:42:54.562847 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m17:42:54.562847 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m17:42:54.565014 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m17:42:54.567856 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m17:42:54.568960 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m17:42:54.791520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m17:42:54.796126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6E01970>]}
[0m17:42:54.798131 [info ] [Thread-1 (]: 4 of 8 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.24s]
[0m17:42:54.799893 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m17:42:54.800412 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m17:42:54.802589 [info ] [Thread-1 (]: 5 of 8 START sql view model SILVER.src_patients ................................ [RUN]
[0m17:42:54.804583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m17:42:54.805584 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m17:42:54.809584 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m17:42:54.812583 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m17:42:54.818583 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m17:42:54.822757 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m17:42:54.824567 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m17:42:55.044714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m17:42:55.047707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6C9D910>]}
[0m17:42:55.048605 [info ] [Thread-1 (]: 5 of 8 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.24s]
[0m17:42:55.050587 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m17:42:55.050973 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m17:42:55.050973 [info ] [Thread-1 (]: 6 of 8 START sql view model SILVER.src_providers ............................... [RUN]
[0m17:42:55.050973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m17:42:55.050973 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m17:42:55.050973 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m17:42:55.057343 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m17:42:55.059351 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m17:42:55.059351 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m17:42:55.059351 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m17:42:55.259031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m17:42:55.265033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6BC3CE0>]}
[0m17:42:55.267917 [info ] [Thread-1 (]: 6 of 8 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.21s]
[0m17:42:55.269965 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m17:42:55.269965 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m17:42:55.270964 [info ] [Thread-1 (]: 7 of 8 START sql view model SILVER.src_transactions ............................ [RUN]
[0m17:42:55.271963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m17:42:55.271963 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m17:42:55.277078 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m17:42:55.279973 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m17:42:55.284293 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m17:42:55.287641 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m17:42:55.288692 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m17:42:55.670490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.381 seconds
[0m17:42:55.675491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6D6D8E0>]}
[0m17:42:55.678551 [info ] [Thread-1 (]: 7 of 8 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.40s]
[0m17:42:55.681510 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m17:42:55.683495 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m17:42:55.685139 [info ] [Thread-1 (]: 8 of 8 START sql table model SILVER.dim_patients ............................... [RUN]
[0m17:42:55.685139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.dim_patients)
[0m17:42:55.688111 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m17:42:55.692201 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m17:42:55.692201 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m17:42:55.719816 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m17:42:55.721426 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m17:42:55.721426 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER.dim_patients
         as
        (with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m17:42:56.897449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.173 seconds
[0m17:42:56.902702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbc8769-9cff-457f-8634-98a1f0fa767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D6B806E0>]}
[0m17:42:56.905738 [info ] [Thread-1 (]: 8 of 8 OK created sql table model SILVER.dim_patients .......................... [[32mSUCCESS 1[0m in 1.22s]
[0m17:42:56.906744 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m17:42:56.908737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:56.909759 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m17:42:56.912760 [debug] [MainThread]: On list_DBT_DB: Close
[0m17:42:57.009311 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m17:42:57.011311 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m17:42:57.102589 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m17:42:57.102589 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m17:42:57.186130 [info ] [MainThread]: 
[0m17:42:57.186130 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 6.27 seconds (6.27s).
[0m17:42:57.189646 [debug] [MainThread]: Command end result
[0m17:42:57.223515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:42:57.224604 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:42:57.224604 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:42:57.224604 [info ] [MainThread]: 
[0m17:42:57.236901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:57.237898 [info ] [MainThread]: 
[0m17:42:57.239901 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m17:42:57.241930 [debug] [MainThread]: Command `dbt run` succeeded at 17:42:57.240898 after 8.73 seconds
[0m17:42:57.241930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D3B22AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D63060F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264D3AC8E90>]}
[0m17:42:57.242930 [debug] [MainThread]: Flushing usage events
[0m17:42:57.392338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:52.547754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019159779D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915A0B3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915C305670>]}


============================== 17:45:52.567504 | eafaa189-72ae-480a-8e49-f9915d73ff73 ==============================
[0m17:45:52.567504 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:45:52.569411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients', 'send_anonymous_usage_stats': 'True'}
[0m17:45:53.080984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eafaa189-72ae-480a-8e49-f9915d73ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915E8891F0>]}
[0m17:45:53.130233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eafaa189-72ae-480a-8e49-f9915d73ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915C87E000>]}
[0m17:45:53.133394 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:45:53.541170 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:45:53.600930 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:45:53.601837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eafaa189-72ae-480a-8e49-f9915d73ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915EEC09E0>]}
[0m17:45:54.506524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eafaa189-72ae-480a-8e49-f9915d73ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915F009580>]}
[0m17:45:54.554940 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:45:54.560233 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:45:54.587072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eafaa189-72ae-480a-8e49-f9915d73ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915F1EBC50>]}
[0m17:45:54.587072 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m17:45:54.587072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eafaa189-72ae-480a-8e49-f9915d73ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915B293A10>]}
[0m17:45:54.598084 [info ] [MainThread]: 
[0m17:45:54.599271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:54.600270 [info ] [MainThread]: 
[0m17:45:54.600270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:54.601287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:45:54.690868 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:45:54.691869 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:45:54.691869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:55.346656 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.654 seconds
[0m17:45:55.350156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_SILVER_GOLD)
[0m17:45:55.350156 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "SILVER_GOLD"
"
[0m17:45:55.350156 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_SILVER_GOLD"
[0m17:45:55.350156 [debug] [ThreadPool]: On create_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "create_DBT_DB_SILVER_GOLD"} */
create schema if not exists DBT_DB.SILVER_GOLD
[0m17:45:55.450360 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m17:45:55.459275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:45:55.468076 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:45:55.468076 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:45:55.468971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:55.870033 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.401 seconds
[0m17:45:55.872033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_SILVER_GOLD)
[0m17:45:55.875033 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_GOLD"
[0m17:45:55.876039 [debug] [ThreadPool]: On list_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_GOLD"} */
show objects in DBT_DB.SILVER_GOLD limit 10000;
[0m17:45:55.956359 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.084 seconds
[0m17:45:55.956359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eafaa189-72ae-480a-8e49-f9915d73ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019159958800>]}
[0m17:45:55.971354 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m17:45:55.972371 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_GOLD.dim_patients .......................... [RUN]
[0m17:45:55.973352 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m17:45:55.974356 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m17:45:55.980358 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m17:45:55.981360 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m17:45:56.008473 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m17:45:56.010366 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m17:45:56.011362 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER_GOLD.dim_patients
         as
        (

with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m17:45:56.012364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:56.978766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.967 seconds
[0m17:45:57.002584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eafaa189-72ae-480a-8e49-f9915d73ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915BC866F0>]}
[0m17:45:57.003672 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_GOLD.dim_patients ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m17:45:57.004555 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m17:45:57.006554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:57.007577 [debug] [MainThread]: Connection 'create_DBT_DB_SILVER_GOLD' was left open.
[0m17:45:57.008551 [debug] [MainThread]: On create_DBT_DB_SILVER_GOLD: Close
[0m17:45:57.080115 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER_GOLD' was left open.
[0m17:45:57.081116 [debug] [MainThread]: On list_DBT_DB_SILVER_GOLD: Close
[0m17:45:57.161578 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m17:45:57.163596 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m17:45:57.245296 [info ] [MainThread]: 
[0m17:45:57.247296 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m17:45:57.249286 [debug] [MainThread]: Command end result
[0m17:45:57.353024 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:45:57.353024 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:45:57.369835 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:45:57.370865 [info ] [MainThread]: 
[0m17:45:57.371837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:57.371837 [info ] [MainThread]: 
[0m17:45:57.372836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:45:57.374842 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:57.374842 after 5.03 seconds
[0m17:45:57.374842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915C2A3F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915C7B55B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915C7B5970>]}
[0m17:45:57.375834 [debug] [MainThread]: Flushing usage events
[0m17:45:57.505129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:48.040923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24D55DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24E042900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24E0436B0>]}


============================== 18:06:48.053536 | 1a817e02-622e-426c-aac4-5d7d9f32337f ==============================
[0m18:06:48.053536 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:06:48.055537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:48.636101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a817e02-622e-426c-aac4-5d7d9f32337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24E18C590>]}
[0m18:06:48.692257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a817e02-622e-426c-aac4-5d7d9f32337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D250285A30>]}
[0m18:06:48.695850 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:06:49.124889 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:06:49.191073 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:06:49.192070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a817e02-622e-426c-aac4-5d7d9f32337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D250707F50>]}
[0m18:06:50.263224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a817e02-622e-426c-aac4-5d7d9f32337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2506C58B0>]}
[0m18:06:50.316529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:06:50.318714 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:06:50.370314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a817e02-622e-426c-aac4-5d7d9f32337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D250869F70>]}
[0m18:06:50.370832 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m18:06:50.370832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a817e02-622e-426c-aac4-5d7d9f32337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D250881700>]}
[0m18:06:50.375516 [info ] [MainThread]: 
[0m18:06:50.375516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:50.375516 [info ] [MainThread]: 
[0m18:06:50.377534 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:50.381083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m18:06:50.489157 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:06:50.490167 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:06:50.490167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:52.198444 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.708 seconds
[0m18:06:52.206017 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER_GOLD'
[0m18:06:52.206017 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_GOLD"
[0m18:06:52.206017 [debug] [ThreadPool]: On list_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_GOLD"} */
show objects in DBT_DB.SILVER_GOLD limit 10000;
[0m18:06:52.206017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:52.706472 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.491 seconds
[0m18:06:52.706472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER_GOLD, now list_DBT_DB_SILVER)
[0m18:06:52.706472 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m18:06:52.706472 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m18:06:52.806477 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.087 seconds
[0m18:06:52.809542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a817e02-622e-426c-aac4-5d7d9f32337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2502A07A0>]}
[0m18:06:52.815580 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m18:06:52.817592 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_GOLD.dim_patients .......................... [RUN]
[0m18:06:52.819605 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m18:06:52.821358 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m18:06:52.830703 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m18:06:52.832704 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m18:06:52.860985 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m18:06:52.864986 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m18:06:52.865986 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER_GOLD.dim_patients
         as
        (

with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m18:06:52.865986 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:54.640937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.783 seconds
[0m18:06:54.674840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a817e02-622e-426c-aac4-5d7d9f32337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24B0B9FA0>]}
[0m18:06:54.674840 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_GOLD.dim_patients ..................... [[32mSUCCESS 1[0m in 1.85s]
[0m18:06:54.674840 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m18:06:54.674840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:54.674840 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m18:06:54.674840 [debug] [MainThread]: On list_DBT_DB: Close
[0m18:06:54.771766 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m18:06:54.772767 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m18:06:54.875121 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m18:06:54.875121 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m18:06:54.967319 [info ] [MainThread]: 
[0m18:06:54.968260 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m18:06:54.971328 [debug] [MainThread]: Command end result
[0m18:06:55.072925 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:06:55.074976 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:06:55.074976 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m18:06:55.074976 [info ] [MainThread]: 
[0m18:06:55.074976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:55.074976 [info ] [MainThread]: 
[0m18:06:55.074976 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:06:55.085510 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:55.085510 after 7.26 seconds
[0m18:06:55.085510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24DF943B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24D55D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24DE8BEC0>]}
[0m18:06:55.085510 [debug] [MainThread]: Flushing usage events
[0m18:06:55.237009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:00.794552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A1881400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A11D42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A11D4F20>]}


============================== 18:17:00.794552 | e549176e-a7d5-4348-a126-86fb1f6403de ==============================
[0m18:17:00.794552 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:17:00.794552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:01.355674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e549176e-a7d5-4348-a126-86fb1f6403de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A3E61BB0>]}
[0m18:17:01.405387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e549176e-a7d5-4348-a126-86fb1f6403de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A18BEAB0>]}
[0m18:17:01.408947 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:17:01.893134 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:17:01.960164 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:17:01.960164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e549176e-a7d5-4348-a126-86fb1f6403de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A44440B0>]}
[0m18:17:02.947063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e549176e-a7d5-4348-a126-86fb1f6403de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A40B46B0>]}
[0m18:17:02.997474 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:17:02.997474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:17:03.027397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e549176e-a7d5-4348-a126-86fb1f6403de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A4589070>]}
[0m18:17:03.027397 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m18:17:03.027397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e549176e-a7d5-4348-a126-86fb1f6403de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A45836E0>]}
[0m18:17:03.043371 [info ] [MainThread]: 
[0m18:17:03.043707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:03.045091 [info ] [MainThread]: 
[0m18:17:03.046116 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:03.047117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m18:17:03.128775 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:17:03.129765 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:17:03.129765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:03.774372 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.644 seconds
[0m18:17:03.786123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m18:17:03.795314 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m18:17:03.795314 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m18:17:03.795314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:04.274869 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.474 seconds
[0m18:17:04.278675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_SILVER_GOLD)
[0m18:17:04.282728 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_GOLD"
[0m18:17:04.283732 [debug] [ThreadPool]: On list_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_GOLD"} */
show objects in DBT_DB.SILVER_GOLD limit 10000;
[0m18:17:04.395639 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m18:17:04.395639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e549176e-a7d5-4348-a126-86fb1f6403de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A44FEFC0>]}
[0m18:17:04.416878 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m18:17:04.417878 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_GOLD.dim_patients .......................... [RUN]
[0m18:17:04.419820 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m18:17:04.420865 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m18:17:04.430687 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m18:17:04.434770 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m18:17:04.459213 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m18:17:04.462797 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m18:17:04.463855 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER_GOLD.dim_patients
         as
        (with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m18:17:04.464838 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:06.030288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.574 seconds
[0m18:17:06.063278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e549176e-a7d5-4348-a126-86fb1f6403de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A4C62180>]}
[0m18:17:06.063278 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_GOLD.dim_patients ..................... [[32mSUCCESS 1[0m in 1.64s]
[0m18:17:06.063278 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m18:17:06.069301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:06.069301 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m18:17:06.069301 [debug] [MainThread]: On list_DBT_DB: Close
[0m18:17:06.133029 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER_GOLD' was left open.
[0m18:17:06.134029 [debug] [MainThread]: On list_DBT_DB_SILVER_GOLD: Close
[0m18:17:06.197189 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m18:17:06.197189 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m18:17:06.281122 [info ] [MainThread]: 
[0m18:17:06.283060 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m18:17:06.284062 [debug] [MainThread]: Command end result
[0m18:17:06.388881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:17:06.391889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:17:06.396881 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m18:17:06.396881 [info ] [MainThread]: 
[0m18:17:06.396881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:06.396881 [info ] [MainThread]: 
[0m18:17:06.396881 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:17:06.402727 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:06.402727 after 5.81 seconds
[0m18:17:06.402727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0AC5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A1228C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A1228560>]}
[0m18:17:06.402727 [debug] [MainThread]: Flushing usage events
[0m18:17:06.552498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:20.318607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B5790890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B4C61220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B2F3C980>]}


============================== 18:30:20.328295 | c8151209-3eed-46b8-a7ff-494e43c83cd9 ==============================
[0m18:30:20.328295 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:30:20.329295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:30:21.037284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8151209-3eed-46b8-a7ff-494e43c83cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B7F4AA80>]}
[0m18:30:21.091899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8151209-3eed-46b8-a7ff-494e43c83cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B7A04B00>]}
[0m18:30:21.093898 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:30:21.537577 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:30:21.823387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:21.824411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:21.853440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8151209-3eed-46b8-a7ff-494e43c83cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B7DCAB70>]}
[0m18:30:21.911839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:30:21.915597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:30:21.964694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8151209-3eed-46b8-a7ff-494e43c83cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B8320A70>]}
[0m18:30:21.965696 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m18:30:21.966692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8151209-3eed-46b8-a7ff-494e43c83cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B83D3E90>]}
[0m18:30:21.969123 [info ] [MainThread]: 
[0m18:30:21.969123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:21.970099 [info ] [MainThread]: 
[0m18:30:21.971201 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:30:21.971201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m18:30:22.070304 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:30:22.070304 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:30:22.071968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:23.785939 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.716 seconds
[0m18:30:23.790178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_SILVER_GOLD)
[0m18:30:23.791582 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "SILVER_GOLD"
"
[0m18:30:23.795773 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_SILVER_GOLD"
[0m18:30:23.796773 [debug] [ThreadPool]: On create_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "create_DBT_DB_SILVER_GOLD"} */
create schema if not exists DBT_DB.SILVER_GOLD
[0m18:30:23.870792 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.073 seconds
[0m18:30:23.877349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m18:30:23.897848 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m18:30:23.899846 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m18:30:23.900845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:24.242285 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.346 seconds
[0m18:30:24.242285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_SILVER_GOLD)
[0m18:30:24.242285 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_GOLD"
[0m18:30:24.242285 [debug] [ThreadPool]: On list_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_GOLD"} */
show objects in DBT_DB.SILVER_GOLD limit 10000;
[0m18:30:24.327711 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.073 seconds
[0m18:30:24.329747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8151209-3eed-46b8-a7ff-494e43c83cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B7EABFB0>]}
[0m18:30:24.336645 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m18:30:24.337698 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_GOLD.dim_patients .......................... [RUN]
[0m18:30:24.339802 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m18:30:24.339802 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m18:30:24.346745 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m18:30:24.346745 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m18:30:24.375841 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m18:30:24.375841 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m18:30:24.375841 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER_GOLD.dim_patients
         as
        (with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m18:30:24.375841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:30:26.283960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.896 seconds
[0m18:30:26.304348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8151209-3eed-46b8-a7ff-494e43c83cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B2CA9F70>]}
[0m18:30:26.305356 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_GOLD.dim_patients ..................... [[32mSUCCESS 1[0m in 1.96s]
[0m18:30:26.306346 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m18:30:26.307941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:26.307941 [debug] [MainThread]: Connection 'create_DBT_DB_SILVER_GOLD' was left open.
[0m18:30:26.309746 [debug] [MainThread]: On create_DBT_DB_SILVER_GOLD: Close
[0m18:30:26.389519 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER_GOLD' was left open.
[0m18:30:26.390536 [debug] [MainThread]: On list_DBT_DB_SILVER_GOLD: Close
[0m18:30:26.460476 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m18:30:26.460476 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m18:30:26.541714 [info ] [MainThread]: 
[0m18:30:26.541714 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m18:30:26.541714 [debug] [MainThread]: Command end result
[0m18:30:26.575657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:30:26.578917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:30:26.582610 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m18:30:26.582610 [info ] [MainThread]: 
[0m18:30:26.582610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:26.590776 [info ] [MainThread]: 
[0m18:30:26.591776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:30:26.595771 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:26.594776 after 6.50 seconds
[0m18:30:26.596775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B554D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B5939CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2B5A12FF0>]}
[0m18:30:26.597775 [debug] [MainThread]: Flushing usage events
[0m18:30:26.763129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:20:56.719545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205CC889D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205CF921100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205CD21B800>]}


============================== 19:20:56.727541 | f129d88f-a5c8-4891-9eb1-f2b9b60112dd ==============================
[0m19:20:56.727541 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:20:56.728681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:20:57.603209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f129d88f-a5c8-4891-9eb1-f2b9b60112dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D1A8E240>]}
[0m19:20:57.669162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f129d88f-a5c8-4891-9eb1-f2b9b60112dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205CEA7F860>]}
[0m19:20:57.673611 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:20:58.086444 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:20:58.161883 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:20:58.162918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f129d88f-a5c8-4891-9eb1-f2b9b60112dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D1F941D0>]}
[0m19:20:59.190468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f129d88f-a5c8-4891-9eb1-f2b9b60112dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D1BDA180>]}
[0m19:20:59.232126 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:20:59.248880 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:20:59.297145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f129d88f-a5c8-4891-9eb1-f2b9b60112dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D20D3F20>]}
[0m19:20:59.298544 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m19:20:59.299009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f129d88f-a5c8-4891-9eb1-f2b9b60112dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D1E53D70>]}
[0m19:20:59.299009 [info ] [MainThread]: 
[0m19:20:59.299009 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:20:59.299009 [info ] [MainThread]: 
[0m19:20:59.299009 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:20:59.306544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:20:59.399389 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:20:59.399389 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:20:59.399389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:00.296272 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.887 seconds
[0m19:21:00.302852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER_SILVER'
[0m19:21:00.311831 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_SILVER"
[0m19:21:00.311831 [debug] [ThreadPool]: On list_DBT_DB_SILVER_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_SILVER"} */
show objects in DBT_DB.SILVER_SILVER limit 10000;
[0m19:21:00.313838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:01.128773 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdcd78-0000-26a9-0027-cf8b00052536
[0m19:21:01.128773 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:21:01.129774 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:21:01.129774 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:21:01.131780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER_SILVER, now list_DBT_DB_SILVER_GOLD)
[0m19:21:01.133319 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_GOLD"
[0m19:21:01.134435 [debug] [ThreadPool]: On list_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_GOLD"} */
show objects in DBT_DB.SILVER_GOLD limit 10000;
[0m19:21:01.454193 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.319 seconds
[0m19:21:01.457192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f129d88f-a5c8-4891-9eb1-f2b9b60112dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D2748380>]}
[0m19:21:01.469296 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m19:21:01.469296 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_GOLD.dim_patients .......................... [RUN]
[0m19:21:01.471629 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m19:21:01.471629 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m19:21:01.471629 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m19:21:01.471629 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m19:21:01.508858 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m19:21:01.513858 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m19:21:01.513858 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER_GOLD.dim_patients
         as
        (with base as (

    select * 
    from DBT_DB.SILVER_SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m19:21:01.514859 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:21:02.152314 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdcd79-0000-26ab-0027-cf8b0004f55e
[0m19:21:02.152314 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
[0m19:21:02.159433 [debug] [Thread-1 (]: Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m19:21:02.163323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f129d88f-a5c8-4891-9eb1-f2b9b60112dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D2933EF0>]}
[0m19:21:02.164418 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_GOLD.dim_patients ................. [[31mERROR[0m in 0.69s]
[0m19:21:02.166321 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m19:21:02.168839 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.dim_patients' to be skipped because of status 'error'.  Reason: Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql.
[0m19:21:02.172724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:02.174083 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:21:02.175139 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:21:02.337782 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER_GOLD' was left open.
[0m19:21:02.337782 [debug] [MainThread]: On list_DBT_DB_SILVER_GOLD: Close
[0m19:21:02.522761 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m19:21:02.523759 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m19:21:02.682040 [info ] [MainThread]: 
[0m19:21:02.683551 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m19:21:02.685878 [debug] [MainThread]: Command end result
[0m19:21:02.793885 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:21:02.796890 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:21:02.805360 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:21:02.805360 [info ] [MainThread]: 
[0m19:21:02.806401 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:21:02.807676 [info ] [MainThread]: 
[0m19:21:02.808965 [error] [MainThread]: [31mFailure in model dim_patients (models\dim\dim_patients.sql)[0m
[0m19:21:02.809984 [error] [MainThread]:   Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m19:21:02.811320 [info ] [MainThread]: 
[0m19:21:02.812517 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\dim\dim_patients.sql
[0m19:21:02.813508 [info ] [MainThread]: 
[0m19:21:02.814549 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:21:02.815564 [debug] [MainThread]: Command `dbt run` failed at 19:21:02.815564 after 6.30 seconds
[0m19:21:02.815564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205CF335730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D22ACAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D2307740>]}
[0m19:21:02.816567 [debug] [MainThread]: Flushing usage events
[0m19:21:03.152799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:52.954593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C632A3BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C62763D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C62760680>]}


============================== 19:38:52.969651 | 1d138459-fd47-4470-92d7-f88da9219053 ==============================
[0m19:38:52.969651 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:38:52.971721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:38:53.087060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d138459-fd47-4470-92d7-f88da9219053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C649A8530>]}
[0m19:38:53.154506 [debug] [MainThread]: Command `dbt clean` succeeded at 19:38:53.154506 after 0.50 seconds
[0m19:38:53.154506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C630F0EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C639489B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C637B0EC0>]}
[0m19:38:53.154506 [debug] [MainThread]: Flushing usage events
[0m19:38:53.316204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:29.450288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB6139CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB5717F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB89371A0>]}


============================== 19:39:29.469818 | cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6 ==============================
[0m19:39:29.469818 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:39:29.471375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_patients', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:39:31.780575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FBB4DAA20>]}
[0m19:39:31.869649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB8C15DF0>]}
[0m19:39:31.873639 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:39:33.012570 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:39:33.014556 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:39:33.016565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FBB2A5D00>]}
[0m19:39:38.106824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FBB9ECF20>]}
[0m19:39:38.192779 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:39:38.278046 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:39:38.344843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FBBA95460>]}
[0m19:39:38.345846 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m19:39:38.346845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FBBA22EA0>]}
[0m19:39:38.349847 [info ] [MainThread]: 
[0m19:39:38.351846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:38.352855 [info ] [MainThread]: 
[0m19:39:38.355850 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:39:38.358965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:39:45.029828 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:39:45.029828 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:39:45.029828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:47.965336 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.932 seconds
[0m19:39:47.965336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER_SILVER'
[0m19:39:47.988471 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_SILVER"
[0m19:39:47.989470 [debug] [ThreadPool]: On list_DBT_DB_SILVER_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_SILVER"} */
show objects in DBT_DB.SILVER_SILVER limit 10000;
[0m19:39:47.990470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:48.592606 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdcd8b-0000-26a6-0027-cf8b0004e53e
[0m19:39:48.593593 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:39:48.593593 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:39:48.594605 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:39:48.595601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER_SILVER, now list_DBT_DB_SILVER_GOLD)
[0m19:39:48.598758 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_GOLD"
[0m19:39:48.599209 [debug] [ThreadPool]: On list_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_GOLD"} */
show objects in DBT_DB.SILVER_GOLD limit 10000;
[0m19:39:48.665924 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.077 seconds
[0m19:39:48.682287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FBB8719D0>]}
[0m19:39:48.692702 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m19:39:48.693676 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_GOLD.dim_patients .......................... [RUN]
[0m19:39:48.695711 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m19:39:48.695711 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m19:39:48.699346 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m19:39:48.699346 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m19:39:48.754159 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m19:39:48.759160 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m19:39:48.760204 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER_GOLD.dim_patients
         as
        (with base as (

    select * 
    from DBT_DB.SILVER_SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m19:39:48.761181 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:49.276314 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdcd8b-0000-26a9-0027-cf8b00052552
[0m19:39:49.277312 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
[0m19:39:49.299566 [debug] [Thread-1 (]: Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m19:39:49.303609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd55c3b4-6e4e-46cc-b7ae-1d959d9ed5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FBBA00860>]}
[0m19:39:49.304609 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_GOLD.dim_patients ................. [[31mERROR[0m in 0.61s]
[0m19:39:49.306596 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m19:39:49.307578 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.dim_patients' to be skipped because of status 'error'.  Reason: Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql.
[0m19:39:49.310580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:49.312579 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:39:49.313585 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:39:49.383258 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER_GOLD' was left open.
[0m19:39:49.383258 [debug] [MainThread]: On list_DBT_DB_SILVER_GOLD: Close
[0m19:39:49.449773 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m19:39:49.449773 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m19:39:49.545530 [info ] [MainThread]: 
[0m19:39:49.547484 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.19 seconds (11.19s).
[0m19:39:49.549484 [debug] [MainThread]: Command end result
[0m19:39:49.576638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:39:49.579646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:39:49.589547 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:39:49.589547 [info ] [MainThread]: 
[0m19:39:49.589547 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:39:49.589547 [info ] [MainThread]: 
[0m19:39:49.589547 [error] [MainThread]: [31mFailure in model dim_patients (models\dim\dim_patients.sql)[0m
[0m19:39:49.589547 [error] [MainThread]:   Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m19:39:49.589547 [info ] [MainThread]: 
[0m19:39:49.599084 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\dim\dim_patients.sql
[0m19:39:49.601182 [info ] [MainThread]: 
[0m19:39:49.603181 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:39:49.606182 [debug] [MainThread]: Command `dbt run` failed at 19:39:49.605181 after 20.37 seconds
[0m19:39:49.607182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB8614320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB87E8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB89371A0>]}
[0m19:39:49.608178 [debug] [MainThread]: Flushing usage events
[0m19:39:49.738542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:02.940145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194916D5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001948F14E0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019490C110A0>]}


============================== 11:22:02.944467 | 1a3cea48-242e-4c4e-a2b5-1466afd4055b ==============================
[0m11:22:02.944467 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:22:02.954226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:22:03.427751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a3cea48-242e-4c4e-a2b5-1466afd4055b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019492908590>]}
[0m11:22:03.585776 [debug] [MainThread]: Command `dbt clean` succeeded at 11:22:03.583099 after 0.87 seconds
[0m11:22:03.587787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194916B6E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019491710EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194929763F0>]}
[0m11:22:03.589801 [debug] [MainThread]: Flushing usage events
[0m11:22:03.869447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:30.377571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280A101FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022809E1C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022809E1FF80>]}


============================== 11:22:30.385194 | cd5a6d64-0647-4d07-b669-a2eff2f413d0 ==============================
[0m11:22:30.385194 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:22:30.387209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients', 'send_anonymous_usage_stats': 'True'}
[0m11:22:32.886679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd5a6d64-0647-4d07-b669-a2eff2f413d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280C839280>]}
[0m11:22:32.995726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd5a6d64-0647-4d07-b669-a2eff2f413d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280A5DA060>]}
[0m11:22:33.007671 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m11:22:34.056558 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m11:22:34.060155 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:22:34.062705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd5a6d64-0647-4d07-b669-a2eff2f413d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280BFB5D00>]}
[0m11:22:38.994638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd5a6d64-0647-4d07-b669-a2eff2f413d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280CD4D430>]}
[0m11:22:39.105062 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m11:22:39.160234 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m11:22:39.239900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd5a6d64-0647-4d07-b669-a2eff2f413d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280CF3CBF0>]}
[0m11:22:39.239900 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m11:22:39.243488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd5a6d64-0647-4d07-b669-a2eff2f413d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280CC25970>]}
[0m11:22:39.248360 [info ] [MainThread]: 
[0m11:22:39.250539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:39.251928 [info ] [MainThread]: 
[0m11:22:39.253941 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:39.262728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m11:22:44.927877 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m11:22:44.929890 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m11:22:44.929890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:47.099689 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.169 seconds
[0m11:22:47.104285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_dbt_GOLD)
[0m11:22:47.107465 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "dbt_GOLD"
"
[0m11:22:47.117521 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_dbt_GOLD"
[0m11:22:47.117521 [debug] [ThreadPool]: On create_DBT_DB_dbt_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "create_DBT_DB_dbt_GOLD"} */
create schema if not exists DBT_DB.dbt_GOLD
[0m11:22:47.281418 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.162 seconds
[0m11:22:47.299614 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_GOLD'
[0m11:22:47.325469 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_GOLD"
[0m11:22:47.327802 [debug] [ThreadPool]: On list_DBT_DB_dbt_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_GOLD"} */
show objects in DBT_DB.dbt_GOLD limit 10000;
[0m11:22:47.329538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:48.010950 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.683 seconds
[0m11:22:48.016874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_dbt_GOLD, now list_DBT_DB_dbt_SILVER)
[0m11:22:48.022593 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_SILVER"
[0m11:22:48.024673 [debug] [ThreadPool]: On list_DBT_DB_dbt_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_SILVER"} */
show objects in DBT_DB.dbt_SILVER limit 10000;
[0m11:22:48.508670 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bde21a-0000-26a9-0027-cf8b000526ae
[0m11:22:48.510687 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:22:48.514718 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:22:48.514718 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:22:48.517232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd5a6d64-0647-4d07-b669-a2eff2f413d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280CFC4BF0>]}
[0m11:22:48.531375 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m11:22:48.533037 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_GOLD.dim_patients ............................. [RUN]
[0m11:22:48.540452 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m11:22:48.542507 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m11:22:48.564241 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m11:22:48.568263 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m11:22:48.627609 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m11:22:48.635653 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m11:22:48.638372 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.dbt_GOLD.dim_patients
         as
        (with base as (

    select * 
    from DBT_DB.dbt_SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m11:22:48.640385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:22:49.306348 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bde21a-0000-26ab-0027-cf8b0004f6c6
[0m11:22:49.306348 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'DBT_DB.DBT_SILVER' does not exist or not authorized.
[0m11:22:49.349892 [debug] [Thread-1 (]: Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.DBT_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m11:22:49.357327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd5a6d64-0647-4d07-b669-a2eff2f413d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280E596060>]}
[0m11:22:49.361914 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_GOLD.dim_patients .................... [[31mERROR[0m in 0.81s]
[0m11:22:49.365941 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m11:22:49.367954 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.dim_patients' to be skipped because of status 'error'.  Reason: Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.DBT_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql.
[0m11:22:49.372660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:49.372660 [debug] [MainThread]: Connection 'create_DBT_DB_dbt_GOLD' was left open.
[0m11:22:49.374673 [debug] [MainThread]: On create_DBT_DB_dbt_GOLD: Close
[0m11:22:49.518655 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_SILVER' was left open.
[0m11:22:49.520667 [debug] [MainThread]: On list_DBT_DB_dbt_SILVER: Close
[0m11:22:49.662391 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m11:22:49.663401 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m11:22:49.813455 [info ] [MainThread]: 
[0m11:22:49.818987 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.56 seconds (10.56s).
[0m11:22:49.821585 [debug] [MainThread]: Command end result
[0m11:22:49.982979 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m11:22:49.987005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m11:22:50.000094 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m11:22:50.002111 [info ] [MainThread]: 
[0m11:22:50.002111 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:22:50.004612 [info ] [MainThread]: 
[0m11:22:50.007851 [error] [MainThread]: [31mFailure in model dim_patients (models\dim\dim_patients.sql)[0m
[0m11:22:50.010071 [error] [MainThread]:   Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.DBT_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m11:22:50.015960 [info ] [MainThread]: 
[0m11:22:50.018994 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\dim\dim_patients.sql
[0m11:22:50.021463 [info ] [MainThread]: 
[0m11:22:50.021463 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:22:50.030171 [debug] [MainThread]: Command `dbt run` failed at 11:22:50.029216 after 19.90 seconds
[0m11:22:50.030171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280740E930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280A0D2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002280A0D0980>]}
[0m11:22:50.032184 [debug] [MainThread]: Flushing usage events
[0m11:22:50.287074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:14.381345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6B6EB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6AEAE4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6AE47260>]}


============================== 12:51:14.387554 | e0c95376-68ef-426b-9a0a-7c49236018e5 ==============================
[0m12:51:14.387554 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:51:14.387554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients', 'send_anonymous_usage_stats': 'True'}
[0m12:51:15.409159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0c95376-68ef-426b-9a0a-7c49236018e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6D85B290>]}
[0m12:51:15.456702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0c95376-68ef-426b-9a0a-7c49236018e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6D1FB170>]}
[0m12:51:15.456702 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m12:51:16.082682 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:51:16.155247 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:51:16.156152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0c95376-68ef-426b-9a0a-7c49236018e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6AB45730>]}
[0m12:51:19.517210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0c95376-68ef-426b-9a0a-7c49236018e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6DE0E3F0>]}
[0m12:51:19.580696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m12:51:19.624075 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m12:51:19.702547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0c95376-68ef-426b-9a0a-7c49236018e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6E054B00>]}
[0m12:51:19.702547 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m12:51:19.702547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c95376-68ef-426b-9a0a-7c49236018e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6DF0B1D0>]}
[0m12:51:19.708664 [info ] [MainThread]: 
[0m12:51:19.708664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:19.711589 [info ] [MainThread]: 
[0m12:51:19.715411 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:51:19.717966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m12:51:26.392012 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m12:51:26.392012 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m12:51:26.392012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:27.192680 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.786 seconds
[0m12:51:27.199349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER_GOLD'
[0m12:51:27.200992 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_GOLD"
[0m12:51:27.200992 [debug] [ThreadPool]: On list_DBT_DB_SILVER_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_GOLD"} */
show objects in DBT_DB.SILVER_GOLD limit 10000;
[0m12:51:27.200992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:27.620895 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.413 seconds
[0m12:51:27.622911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER_GOLD, now list_DBT_DB_SILVER_SILVER)
[0m12:51:27.624918 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER_SILVER"
[0m12:51:27.624918 [debug] [ThreadPool]: On list_DBT_DB_SILVER_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER_SILVER"} */
show objects in DBT_DB.SILVER_SILVER limit 10000;
[0m12:51:28.146820 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bde273-0000-26aa-0027-cf8b000563ca
[0m12:51:28.147820 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:51:28.149820 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:51:28.150567 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:51:28.152108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c95376-68ef-426b-9a0a-7c49236018e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6E0654C0>]}
[0m12:51:28.160114 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m12:51:28.161213 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_GOLD.dim_patients .......................... [RUN]
[0m12:51:28.163136 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m12:51:28.163136 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m12:51:28.170054 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m12:51:28.172115 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m12:51:28.197666 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m12:51:28.199623 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m12:51:28.200561 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.SILVER_GOLD.dim_patients
         as
        (with base as (

    select * 
    from DBT_DB.SILVER_SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m12:51:28.201563 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:28.916869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bde273-0000-26a6-0027-cf8b0004e692
[0m12:51:28.916869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
[0m12:51:28.946820 [debug] [Thread-1 (]: Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m12:51:28.948830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c95376-68ef-426b-9a0a-7c49236018e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6DF7E960>]}
[0m12:51:28.948830 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_GOLD.dim_patients ................. [[31mERROR[0m in 0.78s]
[0m12:51:28.951437 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m12:51:28.951437 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.dim_patients' to be skipped because of status 'error'.  Reason: Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql.
[0m12:51:28.954143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:28.954775 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m12:51:28.954775 [debug] [MainThread]: On list_DBT_DB: Close
[0m12:51:29.091499 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER_SILVER' was left open.
[0m12:51:29.091499 [debug] [MainThread]: On list_DBT_DB_SILVER_SILVER: Close
[0m12:51:29.602090 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m12:51:29.602090 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m12:51:29.761865 [info ] [MainThread]: 
[0m12:51:29.761865 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m12:51:29.763869 [debug] [MainThread]: Command end result
[0m12:51:29.849093 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m12:51:29.851951 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m12:51:29.856995 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m12:51:29.857997 [info ] [MainThread]: 
[0m12:51:29.858994 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:51:29.858994 [info ] [MainThread]: 
[0m12:51:29.860036 [error] [MainThread]: [31mFailure in model dim_patients (models\dim\dim_patients.sql)[0m
[0m12:51:29.860996 [error] [MainThread]:   Database Error in model dim_patients (models\dim\dim_patients.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_DB.SILVER_SILVER' does not exist or not authorized.
  compiled code at target\run\healthcare\models\dim\dim_patients.sql
[0m12:51:29.860996 [info ] [MainThread]: 
[0m12:51:29.862014 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\dim\dim_patients.sql
[0m12:51:29.862996 [info ] [MainThread]: 
[0m12:51:29.862996 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:51:29.864997 [debug] [MainThread]: Command `dbt run` failed at 12:51:29.863996 after 15.72 seconds
[0m12:51:29.865657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6B02D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6A1C9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6A1C93D0>]}
[0m12:51:29.865657 [debug] [MainThread]: Flushing usage events
[0m12:51:30.177530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:03.904112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02BC52630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02B7E7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02BCE14F0>]}


============================== 13:00:03.904112 | 4b395489-f103-4559-9a8f-a4e29aab7912 ==============================
[0m13:00:03.904112 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:00:03.904112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:00:03.964380 [info ] [MainThread]: dbt version: 1.10.4
[0m13:00:03.966326 [info ] [MainThread]: python version: 3.12.3
[0m13:00:03.967385 [info ] [MainThread]: python path: C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\venv\Scripts\python.exe
[0m13:00:03.969321 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m13:00:04.356269 [info ] [MainThread]: Using profiles dir at C:\Users\sanja\.dbt
[0m13:00:04.356269 [info ] [MainThread]: Using profiles.yml file at C:\Users\sanja\.dbt\profiles.yml
[0m13:00:04.356269 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\dbt_project.yml
[0m13:00:04.356269 [info ] [MainThread]: adapter type: snowflake
[0m13:00:04.356269 [info ] [MainThread]: adapter version: 1.9.0
[0m13:00:04.448117 [info ] [MainThread]: Configuration:
[0m13:00:04.449116 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:00:04.450162 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:00:04.450162 [info ] [MainThread]: Required dependencies:
[0m13:00:04.451130 [debug] [MainThread]: Executing "git --help"
[0m13:00:04.511536 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:00:04.511536 [debug] [MainThread]: STDERR: "b''"
[0m13:00:04.512772 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:00:04.513797 [info ] [MainThread]: Connection:
[0m13:00:04.514788 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m13:00:04.515811 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m13:00:04.515811 [info ] [MainThread]:   database: DBT_DB
[0m13:00:04.516806 [info ] [MainThread]:   warehouse: DBT_WH
[0m13:00:04.517808 [info ] [MainThread]:   role: DBT_ROLE
[0m13:00:04.517808 [info ] [MainThread]:   schema: SILVER
[0m13:00:04.518801 [info ] [MainThread]:   authenticator: None
[0m13:00:04.518801 [info ] [MainThread]:   oauth_client_id: None
[0m13:00:04.519804 [info ] [MainThread]:   query_tag: None
[0m13:00:04.521841 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:00:04.522847 [info ] [MainThread]:   host: None
[0m13:00:04.524840 [info ] [MainThread]:   port: None
[0m13:00:04.526839 [info ] [MainThread]:   proxy_host: None
[0m13:00:04.529206 [info ] [MainThread]:   proxy_port: None
[0m13:00:04.529206 [info ] [MainThread]:   protocol: None
[0m13:00:04.529206 [info ] [MainThread]:   connect_retries: 1
[0m13:00:04.529206 [info ] [MainThread]:   connect_timeout: None
[0m13:00:04.529206 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:00:04.529206 [info ] [MainThread]:   retry_all: False
[0m13:00:04.536010 [info ] [MainThread]:   insecure_mode: False
[0m13:00:04.536010 [info ] [MainThread]:   reuse_connections: True
[0m13:00:04.538028 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:00:04.866703 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:00:04.930299 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:00:04.930299 [debug] [MainThread]: On debug: select 1 as id
[0m13:00:04.930299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:05.689582 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.767 seconds
[0m13:00:05.705364 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:00:05.705364 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:00:05.705364 [debug] [MainThread]: Command `dbt debug` succeeded at 13:00:05.705364 after 2.06 seconds
[0m13:00:05.705364 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:00:05.705364 [debug] [MainThread]: On debug: Close
[0m13:00:05.861137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02BD28EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02EA8EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02EAB0BC0>]}
[0m13:00:05.861137 [debug] [MainThread]: Flushing usage events
[0m13:00:06.199520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:33.918380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A090FAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229E652720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A0C9DC10>]}


============================== 13:00:33.934111 | 245b4052-f782-4970-a17a-f766cb241a74 ==============================
[0m13:00:33.934111 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:00:33.934111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients --debug', 'send_anonymous_usage_stats': 'True'}
[0m13:00:34.425241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '245b4052-f782-4970-a17a-f766cb241a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A39903B0>]}
[0m13:00:34.483804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '245b4052-f782-4970-a17a-f766cb241a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A0C19730>]}
[0m13:00:34.487750 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:00:34.761924 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:00:34.868218 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:00:34.868218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '245b4052-f782-4970-a17a-f766cb241a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A12E03E0>]}
[0m13:00:35.923324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.fact
- models.staging
- models.dim
[0m13:00:35.939245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '245b4052-f782-4970-a17a-f766cb241a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A3DB50A0>]}
[0m13:00:35.988067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:00:35.988067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:00:36.027851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '245b4052-f782-4970-a17a-f766cb241a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A41832C0>]}
[0m13:00:36.027851 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m13:00:36.027851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '245b4052-f782-4970-a17a-f766cb241a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A3F67920>]}
[0m13:00:36.036555 [info ] [MainThread]: 
[0m13:00:36.037573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:36.038950 [info ] [MainThread]: 
[0m13:00:36.038950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:36.041756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m13:00:36.121037 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m13:00:36.122064 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m13:00:36.123037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:37.106145 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.994 seconds
[0m13:00:37.118191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m13:00:37.141918 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m13:00:37.142812 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m13:00:37.143811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:37.607248 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.464 seconds
[0m13:00:37.607248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '245b4052-f782-4970-a17a-f766cb241a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A3A518E0>]}
[0m13:00:37.621219 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m13:00:37.622217 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.dim_patients ................................ [RUN]
[0m13:00:37.622217 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m13:00:37.622217 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m13:00:37.635559 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m13:00:37.638100 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m13:00:37.662794 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m13:00:37.662794 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m13:00:37.662794 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.SILVER.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m13:00:37.662794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:38.908883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.241 seconds
[0m13:00:38.955763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '245b4052-f782-4970-a17a-f766cb241a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229E7FA210>]}
[0m13:00:38.958148 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.dim_patients ........................... [[32mSUCCESS 1[0m in 1.32s]
[0m13:00:38.959156 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m13:00:38.963162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:38.965184 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m13:00:38.967224 [debug] [MainThread]: On list_DBT_DB: Close
[0m13:00:39.200506 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m13:00:39.200506 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m13:00:39.370214 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m13:00:39.370214 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m13:00:39.538726 [info ] [MainThread]: 
[0m13:00:39.538726 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m13:00:39.554455 [debug] [MainThread]: Command end result
[0m13:00:39.689637 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:00:39.689637 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:00:39.713248 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m13:00:39.713248 [info ] [MainThread]: 
[0m13:00:39.723104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:39.724137 [info ] [MainThread]: 
[0m13:00:39.725200 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:00:39.728142 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:39.728142 after 6.07 seconds
[0m13:00:39.729134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A1311AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A44CFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A3338CB0>]}
[0m13:00:39.731174 [debug] [MainThread]: Flushing usage events
[0m13:00:40.035369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:43.254111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001708381DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170868B37A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170868B0F80>]}


============================== 13:08:43.259299 | e3cb86b5-f769-49f9-a961-64e4f6315167 ==============================
[0m13:08:43.259299 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:08:43.259299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:08:44.351961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3cb86b5-f769-49f9-a961-64e4f6315167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017088976F60>]}
[0m13:08:44.383455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3cb86b5-f769-49f9-a961-64e4f6315167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017088BA9C10>]}
[0m13:08:44.399211 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:08:45.015702 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:08:45.685721 [debug] [MainThread]: Partial parsing enabled: 16 files deleted, 16 files added, 0 files changed.
[0m13:08:45.685721 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\dim\dim_provider.sql
[0m13:08:45.685721 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\staging\src_departments.sql
[0m13:08:45.685721 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\staging\src_patients.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\dim\dim_patients.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\fact\provider_performance_summary.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\staging\src_providers.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\dim\dim_department.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\dim\dim_cptcodes.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\fact\procedure_statistics.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\staging\src_transactions.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\staging\src_encounters.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\staging\src_claims.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\fact\claims_status_metrics.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\fact\patient_utilization_summary.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\staging\src_cptcodes.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\fact\department_revenue_summary.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\staging\src_claims.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\dim\dim_cptcodes.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\staging\src_cptcodes.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\staging\src_patients.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\staging\src_departments.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\staging\src_providers.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\fact\patient_utilization_summary.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\fact\provider_performance_summary.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\fact\claims_status_metrics.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\dim\dim_department.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\dim\dim_patients.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\dim\dim_provider.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\fact\department_revenue_summary.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\fact\procedure_statistics.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\staging\src_encounters.sql
[0m13:08:45.701579 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\staging\src_transactions.sql
[0m13:08:46.002684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dim
- models.staging
- models.fact
[0m13:08:46.002684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3cb86b5-f769-49f9-a961-64e4f6315167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017089089640>]}
[0m13:08:46.065293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:08:46.069376 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:08:46.093542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3cb86b5-f769-49f9-a961-64e4f6315167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170891039B0>]}
[0m13:08:46.093542 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m13:08:46.093542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3cb86b5-f769-49f9-a961-64e4f6315167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170891B1AC0>]}
[0m13:08:46.093542 [info ] [MainThread]: 
[0m13:08:46.093542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:46.093542 [info ] [MainThread]: 
[0m13:08:46.093542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:08:46.093542 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m13:08:48.210248 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m13:08:48.210248 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m13:08:48.211569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:48.950333 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.752 seconds
[0m13:08:48.966084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m13:08:48.970685 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m13:08:48.970685 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m13:08:48.970685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:49.421272 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.457 seconds
[0m13:08:49.437018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3cb86b5-f769-49f9-a961-64e4f6315167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017089263170>]}
[0m13:08:49.437018 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m13:08:49.437018 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.dim_patients ................................ [RUN]
[0m13:08:49.437018 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m13:08:49.437018 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m13:08:49.452836 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m13:08:49.452836 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m13:08:49.479629 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m13:08:49.479629 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m13:08:49.479629 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.SILVER.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m13:08:49.479629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:08:50.278805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m13:08:50.294536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3cb86b5-f769-49f9-a961-64e4f6315167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017083929F40>]}
[0m13:08:50.294536 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.dim_patients ........................... [[32mSUCCESS 1[0m in 0.86s]
[0m13:08:50.310298 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m13:08:50.310298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:50.310298 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m13:08:50.310298 [debug] [MainThread]: On list_DBT_DB: Close
[0m13:08:50.443996 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m13:08:50.443996 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m13:08:50.601920 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m13:08:50.601920 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m13:08:50.775220 [info ] [MainThread]: 
[0m13:08:50.775220 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m13:08:50.775220 [debug] [MainThread]: Command end result
[0m13:08:50.796672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:08:50.799803 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:08:50.803026 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m13:08:50.803026 [info ] [MainThread]: 
[0m13:08:50.803026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:08:50.803026 [info ] [MainThread]: 
[0m13:08:50.803026 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:08:50.803026 [debug] [MainThread]: Command `dbt run` succeeded at 13:08:50.803026 after 7.79 seconds
[0m13:08:50.803026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001708381DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170841DB380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170841E5010>]}
[0m13:08:50.803026 [debug] [MainThread]: Flushing usage events
[0m13:08:51.135053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:06.432159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDDE5B53D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDDDA896D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDDB4F2720>]}


============================== 13:11:06.448000 | e110ca75-09cf-4a98-8392-f1374acd1b57 ==============================
[0m13:11:06.448000 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:11:06.448000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:06.557929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e110ca75-09cf-4a98-8392-f1374acd1b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDDF7EB890>]}
[0m13:11:06.640697 [debug] [MainThread]: Command `dbt clean` succeeded at 13:11:06.640697 after 0.41 seconds
[0m13:11:06.642675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDDDEE1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDDDA32570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDDF94C4D0>]}
[0m13:11:06.644744 [debug] [MainThread]: Flushing usage events
[0m13:11:06.949933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:49.181801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353719A7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023536B04530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353629BFB0>]}


============================== 13:11:49.186794 | 187d03d4-6a93-4a3d-8875-353a30ba3e8d ==============================
[0m13:11:49.186794 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:11:49.187803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:11:49.724434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '187d03d4-6a93-4a3d-8875-353a30ba3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353770FE90>]}
[0m13:11:49.780423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '187d03d4-6a93-4a3d-8875-353a30ba3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235375C0D70>]}
[0m13:11:49.782482 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:11:50.090585 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:11:50.091581 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:11:50.092591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '187d03d4-6a93-4a3d-8875-353a30ba3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023536ADE180>]}
[0m13:11:51.350091 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.healthcare.dim
- models.healthcare.staging
- models.healthcare.fact
[0m13:11:51.355073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '187d03d4-6a93-4a3d-8875-353a30ba3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353995A900>]}
[0m13:11:51.418470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:11:51.424467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:11:51.464992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '187d03d4-6a93-4a3d-8875-353a30ba3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023539DBD2B0>]}
[0m13:11:51.465991 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m13:11:51.466992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '187d03d4-6a93-4a3d-8875-353a30ba3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023539D5D9D0>]}
[0m13:11:51.467991 [info ] [MainThread]: 
[0m13:11:51.468991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:51.469991 [info ] [MainThread]: 
[0m13:11:51.470990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:11:51.471992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m13:11:51.565831 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m13:11:51.566833 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m13:11:51.566833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:52.360297 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.793 seconds
[0m13:11:52.373710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m13:11:52.382473 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m13:11:52.383478 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m13:11:52.384477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:52.958542 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.574 seconds
[0m13:11:52.961537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '187d03d4-6a93-4a3d-8875-353a30ba3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235397E5730>]}
[0m13:11:52.968183 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m13:11:52.968183 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.dim_patients ................................ [RUN]
[0m13:11:52.970221 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m13:11:52.970221 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m13:11:52.977169 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m13:11:52.980156 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m13:11:53.005154 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m13:11:53.008259 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m13:11:53.009155 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.SILVER.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m13:11:53.010154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:53.774194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m13:11:53.800293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '187d03d4-6a93-4a3d-8875-353a30ba3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235398F6300>]}
[0m13:11:53.801254 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.dim_patients ........................... [[32mSUCCESS 1[0m in 0.83s]
[0m13:11:53.803274 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m13:11:53.805222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:53.806253 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m13:11:53.806253 [debug] [MainThread]: On list_DBT_DB: Close
[0m13:11:53.967169 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m13:11:53.968172 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m13:11:54.114069 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m13:11:54.115125 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m13:11:54.253694 [info ] [MainThread]: 
[0m13:11:54.254633 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m13:11:54.256680 [debug] [MainThread]: Command end result
[0m13:11:54.275566 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:11:54.278599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:11:54.284988 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m13:11:54.285984 [info ] [MainThread]: 
[0m13:11:54.287038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:54.287955 [info ] [MainThread]: 
[0m13:11:54.288957 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:11:54.289954 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:54.289954 after 5.30 seconds
[0m13:11:54.289954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353443E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235375ED1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023537565730>]}
[0m13:11:54.290959 [debug] [MainThread]: Flushing usage events
[0m13:11:54.708102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:56.937292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224258625D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022425862870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224258627B0>]}


============================== 13:14:56.950349 | 01617cce-d138-4e87-8104-0fb16fb65cbc ==============================
[0m13:14:56.950349 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:14:56.950349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m13:14:57.439433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01617cce-d138-4e87-8104-0fb16fb65cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224281F6420>]}
[0m13:14:57.483673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01617cce-d138-4e87-8104-0fb16fb65cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022428503170>]}
[0m13:14:57.485678 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:14:57.972381 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:14:58.195854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:58.195854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:58.201472 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.healthcare.staging
- models.healthcare.fact
- models.healthcare.dim
[0m13:14:58.222852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01617cce-d138-4e87-8104-0fb16fb65cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224280D52E0>]}
[0m13:14:58.275997 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:14:58.278111 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:14:58.310505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01617cce-d138-4e87-8104-0fb16fb65cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022428AE49E0>]}
[0m13:14:58.310505 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m13:14:58.310505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01617cce-d138-4e87-8104-0fb16fb65cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022428A44710>]}
[0m13:14:58.314459 [info ] [MainThread]: 
[0m13:14:58.314459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:58.314459 [info ] [MainThread]: 
[0m13:14:58.314459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:14:58.320006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m13:14:58.397068 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m13:14:58.398069 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m13:14:58.398069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:59.219066 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.821 seconds
[0m13:14:59.223604 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m13:14:59.231882 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m13:14:59.232889 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m13:14:59.232889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:00.566396 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.333 seconds
[0m13:15:00.570421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01617cce-d138-4e87-8104-0fb16fb65cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022428B44E30>]}
[0m13:15:00.578515 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m13:15:00.578515 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.dim_patients ................................ [RUN]
[0m13:15:00.582567 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m13:15:00.582567 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m13:15:00.598526 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m13:15:00.601353 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m13:15:00.658451 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m13:15:00.663673 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m13:15:00.665678 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.SILVER.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m13:15:00.665678 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:01.533973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m13:15:01.565713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01617cce-d138-4e87-8104-0fb16fb65cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022423499EE0>]}
[0m13:15:01.565713 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.dim_patients ........................... [[32mSUCCESS 1[0m in 0.98s]
[0m13:15:01.565713 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m13:15:01.565713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:01.565713 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m13:15:01.565713 [debug] [MainThread]: On list_DBT_DB: Close
[0m13:15:01.730211 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m13:15:01.731955 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m13:15:01.896162 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m13:15:01.896162 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m13:15:02.052667 [info ] [MainThread]: 
[0m13:15:02.052667 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m13:15:02.052667 [debug] [MainThread]: Command end result
[0m13:15:02.088765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:15:02.091744 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:15:02.098170 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m13:15:02.098170 [info ] [MainThread]: 
[0m13:15:02.098170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:02.098170 [info ] [MainThread]: 
[0m13:15:02.102431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:15:02.104442 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:02.104442 after 5.35 seconds
[0m13:15:02.107918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022428690830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022423568530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224276723C0>]}
[0m13:15:02.109025 [debug] [MainThread]: Flushing usage events
[0m13:15:02.413852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:38.033054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B8C99EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BB6F8F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B962B5C0>]}


============================== 13:17:38.039094 | 2351088b-7876-4532-b70b-bcf299c5bf2c ==============================
[0m13:17:38.039094 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:17:38.039094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --select dim_patients --output json', 'send_anonymous_usage_stats': 'True'}
[0m13:17:38.534011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2351088b-7876-4532-b70b-bcf299c5bf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BDF411C0>]}
[0m13:17:38.579627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2351088b-7876-4532-b70b-bcf299c5bf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BB7E8590>]}
[0m13:17:38.579627 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:17:39.065634 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:17:39.253971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:39.253971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:39.255717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.healthcare.dim
- models.healthcare.staging
- models.healthcare.fact
[0m13:17:39.283375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2351088b-7876-4532-b70b-bcf299c5bf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BB1FA960>]}
[0m13:17:39.333090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:17:39.333090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:17:39.366996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2351088b-7876-4532-b70b-bcf299c5bf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BE37CC80>]}
[0m13:17:39.366996 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m13:17:39.366996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2351088b-7876-4532-b70b-bcf299c5bf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BE46E060>]}
[0m13:17:39.366996 [info ] [MainThread]: {"name": "dim_patients", "resource_type": "model", "package_name": "healthcare", "original_file_path": "models\\healthcare\\dim\\dim_patients.sql", "unique_id": "model.healthcare.dim_patients", "alias": "dim_patients", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": [], "depends_on": {"macros": [], "nodes": ["model.healthcare.src_patients"]}}
[0m13:17:39.371616 [debug] [MainThread]: Command `dbt ls` succeeded at 13:17:39.371616 after 1.58 seconds
[0m13:17:39.371616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BB4F7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BB2C0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BB24EB10>]}
[0m13:17:39.371616 [debug] [MainThread]: Flushing usage events
[0m13:17:39.646981 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:08.682860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EDCBC530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EDCBC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EC5B31A0>]}


============================== 13:21:08.688031 | 15ac8fc6-07fa-4ac7-97ad-91faa7d05c04 ==============================
[0m13:21:08.688031 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:21:08.690051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:09.295920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15ac8fc6-07fa-4ac7-97ad-91faa7d05c04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F0FD6BD0>]}
[0m13:21:09.343288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15ac8fc6-07fa-4ac7-97ad-91faa7d05c04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EE1ABAD0>]}
[0m13:21:09.343288 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:21:09.617699 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:21:09.670130 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:21:09.670130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15ac8fc6-07fa-4ac7-97ad-91faa7d05c04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F1420350>]}
[0m13:21:10.756716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
- models.healthcare.staging
[0m13:21:10.763529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15ac8fc6-07fa-4ac7-97ad-91faa7d05c04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F1586B10>]}
[0m13:21:10.840922 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:21:10.845271 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:21:10.890933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15ac8fc6-07fa-4ac7-97ad-91faa7d05c04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F174A750>]}
[0m13:21:10.890933 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m13:21:10.890933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ac8fc6-07fa-4ac7-97ad-91faa7d05c04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F166D1F0>]}
[0m13:21:10.897265 [info ] [MainThread]: 
[0m13:21:10.897265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:10.897265 [info ] [MainThread]: 
[0m13:21:10.901405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:21:10.904027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m13:21:11.024235 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m13:21:11.024235 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m13:21:11.024235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:11.794510 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.767 seconds
[0m13:21:11.806495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m13:21:11.827012 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m13:21:11.827012 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m13:21:11.828011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:12.824931 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.001 seconds
[0m13:21:12.824931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ac8fc6-07fa-4ac7-97ad-91faa7d05c04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F166DB20>]}
[0m13:21:12.840772 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m13:21:12.840772 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.dim_patients ................................ [RUN]
[0m13:21:12.840772 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m13:21:12.840772 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m13:21:12.851364 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m13:21:12.853373 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m13:21:12.877899 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m13:21:12.877899 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m13:21:12.877899 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.SILVER.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m13:21:12.877899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:13.615656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m13:21:13.627501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ac8fc6-07fa-4ac7-97ad-91faa7d05c04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EBD89E20>]}
[0m13:21:13.627501 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.dim_patients ........................... [[32mSUCCESS 1[0m in 0.79s]
[0m13:21:13.627501 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m13:21:13.638761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:13.638761 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m13:21:13.638761 [debug] [MainThread]: On list_DBT_DB: Close
[0m13:21:13.790059 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m13:21:13.790059 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m13:21:13.942192 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m13:21:13.942192 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m13:21:14.098627 [info ] [MainThread]: 
[0m13:21:14.098627 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m13:21:14.098627 [debug] [MainThread]: Command end result
[0m13:21:14.188281 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:21:14.190277 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:21:14.195380 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m13:21:14.196562 [info ] [MainThread]: 
[0m13:21:14.197560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:14.197560 [info ] [MainThread]: 
[0m13:21:14.198552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:21:14.199559 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:14.199559 after 5.75 seconds
[0m13:21:14.200558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EE609AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EE1A85F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EE1A8D10>]}
[0m13:21:14.200558 [debug] [MainThread]: Flushing usage events
[0m13:21:14.605571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:12.638999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0CD49C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0F544740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0F545430>]}


============================== 13:22:12.638999 | fbfbe424-b555-4b16-ae45-0280865dd8f8 ==============================
[0m13:22:12.638999 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:22:12.638999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_patients', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:22:13.136714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbfbe424-b555-4b16-ae45-0280865dd8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0CE5AD20>]}
[0m13:22:13.183575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbfbe424-b555-4b16-ae45-0280865dd8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F11B83B30>]}
[0m13:22:13.183575 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:22:13.450232 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:22:13.545390 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:22:13.545390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbfbe424-b555-4b16-ae45-0280865dd8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F124A0650>]}
[0m13:22:14.405932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.healthcare.staging
- models.healthcare.fact
- models.healthcare.dim
[0m13:22:14.405932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbfbe424-b555-4b16-ae45-0280865dd8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F12361250>]}
[0m13:22:14.465896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:22:14.467896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:22:14.494062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbfbe424-b555-4b16-ae45-0280865dd8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F125ED550>]}
[0m13:22:14.501395 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m13:22:14.501395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbfbe424-b555-4b16-ae45-0280865dd8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F12112E70>]}
[0m13:22:14.501395 [info ] [MainThread]: 
[0m13:22:14.501395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:22:14.501395 [info ] [MainThread]: 
[0m13:22:14.501395 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:22:14.507333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m13:22:14.583770 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m13:22:14.583770 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m13:22:14.584729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:15.281364 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.698 seconds
[0m13:22:15.290265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m13:22:15.298836 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m13:22:15.300743 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m13:22:15.300743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:15.943184 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.644 seconds
[0m13:22:15.945193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbfbe424-b555-4b16-ae45-0280865dd8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F125ED550>]}
[0m13:22:15.959698 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m13:22:15.959698 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.dim_patients ................................ [RUN]
[0m13:22:15.959698 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m13:22:15.959698 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m13:22:15.959698 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m13:22:15.959698 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m13:22:15.995068 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m13:22:16.008248 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m13:22:16.011375 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.SILVER.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m13:22:16.013276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:16.641651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m13:22:16.662573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbfbe424-b555-4b16-ae45-0280865dd8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0CE59DF0>]}
[0m13:22:16.662573 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.dim_patients ........................... [[32mSUCCESS 1[0m in 0.69s]
[0m13:22:16.662573 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m13:22:16.665867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:16.665867 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m13:22:16.665867 [debug] [MainThread]: On list_DBT_DB: Close
[0m13:22:16.808565 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m13:22:16.808565 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m13:22:16.964852 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m13:22:16.966865 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m13:22:17.103512 [info ] [MainThread]: 
[0m13:22:17.103512 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m13:22:17.103512 [debug] [MainThread]: Command end result
[0m13:22:17.191990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m13:22:17.193906 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m13:22:17.199306 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m13:22:17.200202 [info ] [MainThread]: 
[0m13:22:17.201201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:17.202201 [info ] [MainThread]: 
[0m13:22:17.202201 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:22:17.204202 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:17.204202 after 4.76 seconds
[0m13:22:17.204202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0F449DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0F278D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0F278530>]}
[0m13:22:17.205214 [debug] [MainThread]: Flushing usage events
[0m13:22:17.494842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:53.480170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A538A000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A5EDEBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A7D02270>]}


============================== 16:59:53.494019 | 38edc259-7846-4618-859f-8cbc4952b21b ==============================
[0m16:59:53.494019 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:59:53.494019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:53.920829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38edc259-7846-4618-859f-8cbc4952b21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A9603740>]}
[0m16:59:54.025703 [debug] [MainThread]: Command `dbt clean` succeeded at 16:59:54.025703 after 0.84 seconds
[0m16:59:54.027774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A852CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A83351F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A5D2CAA0>]}
[0m16:59:54.030724 [debug] [MainThread]: Flushing usage events
[0m16:59:55.381672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:30.953686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F7519D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F7A91340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FA1C8D40>]}


============================== 17:00:30.963508 | fac939f0-6dbd-46f1-8446-091ef7c1af79 ==============================
[0m17:00:30.963508 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:00:30.967531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:33.433168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FC6F2C00>]}
[0m17:00:33.556179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FA00B110>]}
[0m17:00:33.558191 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:00:34.635980 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:00:34.640524 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:00:34.644556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FC742300>]}
[0m17:00:38.129684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.healthcare.example
[0m17:00:38.148004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FCD005C0>]}
[0m17:00:38.269896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:00:38.294915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:00:38.372382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FCC98B90>]}
[0m17:00:38.374395 [info ] [MainThread]: Found 16 models, 2 data tests, 472 macros
[0m17:00:38.376410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FCD9F2C0>]}
[0m17:00:38.380820 [info ] [MainThread]: 
[0m17:00:38.382836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:38.386111 [info ] [MainThread]: 
[0m17:00:38.390867 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:00:38.406418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:00:41.155806 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:00:41.157818 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:00:41.157818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:42.301348 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.143 seconds
[0m17:00:42.304873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_GOLD)
[0m17:00:42.308128 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "GOLD"
"
[0m17:00:42.318195 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_GOLD"
[0m17:00:42.320209 [debug] [ThreadPool]: On create_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "create_DBT_DB_GOLD"} */
create schema if not exists DBT_DB.GOLD
[0m17:00:42.445850 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m17:00:42.451881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m17:00:42.477934 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m17:00:42.479696 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000;
[0m17:00:42.481709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:43.546494 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.065 seconds
[0m17:00:43.550511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FC889E50>]}
[0m17:00:43.563504 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m17:00:43.563504 [info ] [Thread-1 (]: 1 of 8 START sql view model GOLD.src_claims .................................... [RUN]
[0m17:00:43.567526 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m17:00:43.569541 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m17:00:43.584313 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m17:00:43.593431 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m17:00:43.652168 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m17:00:43.663905 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m17:00:43.663905 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.GOLD.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m17:00:43.663905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:44.562065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.896 seconds
[0m17:00:44.608884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F998A930>]}
[0m17:00:44.611346 [info ] [Thread-1 (]: 1 of 8 OK created sql view model GOLD.src_claims ............................... [[32mSUCCESS 1[0m in 1.03s]
[0m17:00:44.613374 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m17:00:44.613374 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m17:00:44.613374 [info ] [Thread-1 (]: 2 of 8 START sql view model GOLD.src_cptcodes .................................. [RUN]
[0m17:00:44.622326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m17:00:44.623282 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m17:00:44.629465 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m17:00:44.635963 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m17:00:44.643740 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m17:00:44.648317 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m17:00:44.652086 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.GOLD.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m17:00:44.962252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m17:00:44.966270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FD40D490>]}
[0m17:00:44.966270 [info ] [Thread-1 (]: 2 of 8 OK created sql view model GOLD.src_cptcodes ............................. [[32mSUCCESS 1[0m in 0.34s]
[0m17:00:44.969295 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m17:00:44.971306 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m17:00:44.973316 [info ] [Thread-1 (]: 3 of 8 START sql view model GOLD.src_departments ............................... [RUN]
[0m17:00:44.975326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m17:00:44.978497 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m17:00:44.982148 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m17:00:44.986640 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m17:00:44.995043 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m17:00:44.999084 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m17:00:45.001100 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.GOLD.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m17:00:45.272025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m17:00:45.276045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FE4D6990>]}
[0m17:00:45.278054 [info ] [Thread-1 (]: 3 of 8 OK created sql view model GOLD.src_departments .......................... [[32mSUCCESS 1[0m in 0.30s]
[0m17:00:45.280072 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m17:00:45.280072 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m17:00:45.282085 [info ] [Thread-1 (]: 4 of 8 START sql view model GOLD.src_encounters ................................ [RUN]
[0m17:00:45.284810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m17:00:45.284810 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m17:00:45.288837 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m17:00:45.292862 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m17:00:45.296885 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m17:00:45.299922 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m17:00:45.301784 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.GOLD.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m17:00:46.294795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m17:00:46.298820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FE4BD310>]}
[0m17:00:46.300834 [info ] [Thread-1 (]: 4 of 8 OK created sql view model GOLD.src_encounters ........................... [[32mSUCCESS 1[0m in 1.01s]
[0m17:00:46.304269 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m17:00:46.304868 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m17:00:46.306878 [info ] [Thread-1 (]: 5 of 8 START sql view model GOLD.src_patients .................................. [RUN]
[0m17:00:46.309903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m17:00:46.311423 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m17:00:46.316173 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m17:00:46.317714 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m17:00:46.326023 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m17:00:46.332058 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m17:00:46.334071 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.GOLD.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m17:00:46.660744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m17:00:46.666776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FE50F4D0>]}
[0m17:00:46.668785 [info ] [Thread-1 (]: 5 of 8 OK created sql view model GOLD.src_patients ............................. [[32mSUCCESS 1[0m in 0.36s]
[0m17:00:46.670548 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m17:00:46.672562 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m17:00:46.674643 [info ] [Thread-1 (]: 6 of 8 START sql view model GOLD.src_providers ................................. [RUN]
[0m17:00:46.676663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m17:00:46.677574 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m17:00:46.681928 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m17:00:46.683837 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m17:00:46.691575 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m17:00:46.696682 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m17:00:46.698208 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.GOLD.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m17:00:47.110889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m17:00:47.114409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FE50F0B0>]}
[0m17:00:47.116423 [info ] [Thread-1 (]: 6 of 8 OK created sql view model GOLD.src_providers ............................ [[32mSUCCESS 1[0m in 0.44s]
[0m17:00:47.120879 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m17:00:47.122892 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m17:00:47.124346 [info ] [Thread-1 (]: 7 of 8 START sql view model GOLD.src_transactions .............................. [RUN]
[0m17:00:47.128070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m17:00:47.130087 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m17:00:47.134689 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m17:00:47.138680 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m17:00:47.146440 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m17:00:47.152489 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m17:00:47.152489 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.GOLD.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m17:00:47.526715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.371 seconds
[0m17:00:47.529737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FD386C30>]}
[0m17:00:47.531748 [info ] [Thread-1 (]: 7 of 8 OK created sql view model GOLD.src_transactions ......................... [[32mSUCCESS 1[0m in 0.40s]
[0m17:00:47.534324 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m17:00:47.534324 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m17:00:47.536337 [info ] [Thread-1 (]: 8 of 8 START sql view model GOLD.dim_patients .................................. [RUN]
[0m17:00:47.538349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.dim_patients)
[0m17:00:47.540366 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m17:00:47.545853 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m17:00:47.550668 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m17:00:47.557238 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m17:00:47.564074 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m17:00:47.566086 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.GOLD.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.GOLD.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m17:00:47.936446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m17:00:47.943502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac939f0-6dbd-46f1-8446-091ef7c1af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FCDE0FE0>]}
[0m17:00:47.945515 [info ] [Thread-1 (]: 8 of 8 OK created sql view model GOLD.dim_patients ............................. [[32mSUCCESS 1[0m in 0.40s]
[0m17:00:47.947528 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m17:00:47.952274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:47.952274 [debug] [MainThread]: Connection 'create_DBT_DB_GOLD' was left open.
[0m17:00:47.953704 [debug] [MainThread]: On create_DBT_DB_GOLD: Close
[0m17:00:48.147030 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m17:00:48.147030 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m17:00:48.334236 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m17:00:48.336248 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m17:00:48.524626 [info ] [MainThread]: 
[0m17:00:48.526642 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 10.14 seconds (10.14s).
[0m17:00:48.529770 [debug] [MainThread]: Command end result
[0m17:00:48.688742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:00:48.696541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:00:48.710393 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:00:48.712405 [info ] [MainThread]: 
[0m17:00:48.714418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:48.718443 [info ] [MainThread]: 
[0m17:00:48.720452 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m17:00:48.728128 [debug] [MainThread]: Command `dbt run` succeeded at 17:00:48.727514 after 18.05 seconds
[0m17:00:48.728128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F7519D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FC6BDBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FA11B5F0>]}
[0m17:00:48.730147 [debug] [MainThread]: Flushing usage events
[0m17:00:49.152486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:47.736119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D29DA9EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2C193500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D29CCE930>]}


============================== 17:20:47.744793 | 0daaf646-7178-4fbd-9dde-507f4b5bb0a1 ==============================
[0m17:20:47.744793 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:20:47.753357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m17:20:48.020504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0daaf646-7178-4fbd-9dde-507f4b5bb0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2CDD36E0>]}
[0m17:20:48.157304 [debug] [MainThread]: Command `dbt clean` succeeded at 17:20:48.157304 after 0.69 seconds
[0m17:20:48.157304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2B8EB260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2CE3A930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2E48BDA0>]}
[0m17:20:48.157304 [debug] [MainThread]: Flushing usage events
[0m17:20:48.457124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:00.706783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CA2B0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CA715190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114C9B70830>]}


============================== 17:21:00.717112 | 48cd5ad7-b3f5-4d08-9a3a-f31c1413d616 ==============================
[0m17:21:00.717112 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:21:00.718867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:02.123170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114C9BEB3B0>]}
[0m17:21:02.248683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114C9BEB3E0>]}
[0m17:21:02.254722 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:21:03.468333 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:21:03.468333 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:21:03.478618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CCAF8FB0>]}
[0m17:21:05.939652 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.healthcare.example
[0m17:21:05.958322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CCF44050>]}
[0m17:21:06.101950 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:21:06.114031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:21:06.197753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CCFD7D70>]}
[0m17:21:06.201435 [info ] [MainThread]: Found 16 models, 2 data tests, 473 macros
[0m17:21:06.201435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CD1C2180>]}
[0m17:21:06.207812 [info ] [MainThread]: 
[0m17:21:06.209825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:06.212906 [info ] [MainThread]: 
[0m17:21:06.213918 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:21:06.226913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:21:06.567404 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:21:06.567404 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:21:06.567404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:07.457521 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.888 seconds
[0m17:21:07.465632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:21:07.490338 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:21:07.498385 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:21:07.498385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:08.065056 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.571 seconds
[0m17:21:08.079806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114C818C560>]}
[0m17:21:08.081556 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m17:21:08.089106 [info ] [Thread-1 (]: 1 of 8 START sql view model SILVER.src_claims .................................. [RUN]
[0m17:21:08.089106 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m17:21:08.089106 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m17:21:08.110850 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m17:21:08.122649 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m17:21:08.177686 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m17:21:08.186243 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m17:21:08.189014 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m17:21:08.189014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:21:08.778099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m17:21:08.827338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114C77CA150>]}
[0m17:21:08.831622 [info ] [Thread-1 (]: 1 of 8 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.73s]
[0m17:21:08.834344 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m17:21:08.835358 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m17:21:08.837372 [info ] [Thread-1 (]: 2 of 8 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m17:21:08.839384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m17:21:08.841096 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m17:21:08.845131 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m17:21:08.849163 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m17:21:08.859099 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m17:21:08.863127 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m17:21:08.865143 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m17:21:09.136937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m17:21:09.141331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CD78A2A0>]}
[0m17:21:09.144146 [info ] [Thread-1 (]: 2 of 8 OK created sql view model SILVER.src_cptcodes ........................... [[32mSUCCESS 1[0m in 0.30s]
[0m17:21:09.148383 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m17:21:09.151406 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m17:21:09.151725 [info ] [Thread-1 (]: 3 of 8 START sql view model SILVER.src_departments ............................. [RUN]
[0m17:21:09.157770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m17:21:09.161541 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m17:21:09.171486 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m17:21:09.175307 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m17:21:09.181358 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m17:21:09.185911 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m17:21:09.189944 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m17:21:09.529731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m17:21:09.535763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CD789BE0>]}
[0m17:21:09.535763 [info ] [Thread-1 (]: 3 of 8 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.38s]
[0m17:21:09.539996 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m17:21:09.539996 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m17:21:09.542003 [info ] [Thread-1 (]: 4 of 8 START sql view model SILVER.src_encounters .............................. [RUN]
[0m17:21:09.544192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m17:21:09.546206 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m17:21:09.551516 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m17:21:09.553570 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m17:21:09.560625 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m17:21:09.564649 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m17:21:09.564649 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m17:21:09.930366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m17:21:09.936397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CD7EF470>]}
[0m17:21:09.938411 [info ] [Thread-1 (]: 4 of 8 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.39s]
[0m17:21:09.940924 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m17:21:09.942930 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m17:21:09.942930 [info ] [Thread-1 (]: 5 of 8 START sql view model SILVER.src_patients ................................ [RUN]
[0m17:21:09.946865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m17:21:09.946865 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m17:21:09.950890 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m17:21:09.954917 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m17:21:09.958944 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m17:21:09.960957 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m17:21:09.962971 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m17:21:10.479048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m17:21:10.485074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CD7F1BB0>]}
[0m17:21:10.487086 [info ] [Thread-1 (]: 5 of 8 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.54s]
[0m17:21:10.491106 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m17:21:10.492798 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m17:21:10.494804 [info ] [Thread-1 (]: 6 of 8 START sql view model SILVER.src_providers ............................... [RUN]
[0m17:21:10.498386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m17:21:10.500397 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m17:21:10.505434 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m17:21:10.507450 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m17:21:10.515496 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m17:21:10.519517 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m17:21:10.521953 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m17:21:10.852200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m17:21:10.856227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CD7F9B20>]}
[0m17:21:10.856227 [info ] [Thread-1 (]: 6 of 8 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.36s]
[0m17:21:10.860554 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m17:21:10.862568 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m17:21:10.864582 [info ] [Thread-1 (]: 7 of 8 START sql view model SILVER.src_transactions ............................ [RUN]
[0m17:21:10.864582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m17:21:10.866597 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m17:21:10.973378 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m17:21:10.973378 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m17:21:10.983933 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m17:21:10.989639 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m17:21:10.991662 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m17:21:11.527313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m17:21:11.531456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CD061880>]}
[0m17:21:11.535474 [info ] [Thread-1 (]: 7 of 8 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m17:21:11.538100 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m17:21:11.538100 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m17:21:11.539851 [info ] [Thread-1 (]: 8 of 8 START sql view model SILVER.dim_patients ................................ [RUN]
[0m17:21:11.541866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.dim_patients)
[0m17:21:11.544131 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m17:21:11.552551 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m17:21:11.556569 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m17:21:11.562611 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m17:21:11.571438 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m17:21:11.573241 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.SILVER.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m17:21:11.961226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m17:21:11.965238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cd5ad7-b3f5-4d08-9a3a-f31c1413d616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CD077D70>]}
[0m17:21:11.967244 [info ] [Thread-1 (]: 8 of 8 OK created sql view model SILVER.dim_patients ........................... [[32mSUCCESS 1[0m in 0.42s]
[0m17:21:11.969378 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m17:21:11.973400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:11.975115 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m17:21:11.975115 [debug] [MainThread]: On list_DBT_DB: Close
[0m17:21:12.147299 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m17:21:12.147299 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m17:21:12.386282 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m17:21:12.388290 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m17:21:12.536471 [info ] [MainThread]: 
[0m17:21:12.538478 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m17:21:12.542228 [debug] [MainThread]: Command end result
[0m17:21:12.589569 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:21:12.596126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:21:12.612355 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:21:12.612355 [info ] [MainThread]: 
[0m17:21:12.616113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:12.619389 [info ] [MainThread]: 
[0m17:21:12.619389 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m17:21:12.623327 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:12.623327 after 12.17 seconds
[0m17:21:12.625340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114C75C6C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114C5FEF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114C9B70830>]}
[0m17:21:12.628230 [debug] [MainThread]: Flushing usage events
[0m17:21:12.989155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:33.520318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023632730E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023631D5B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023631D5BC80>]}


============================== 17:22:33.528499 | 47c31c75-04c0-4939-a8a2-06686a1d0712 ==============================
[0m17:22:33.528499 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:22:33.536665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:22:34.860615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363454E360>]}
[0m17:22:34.983020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363299DA30>]}
[0m17:22:34.988519 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:22:36.078468 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:22:36.261409 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:22:36.261409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023632B23680>]}
[0m17:22:38.547057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m17:22:38.557318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236351A9580>]}
[0m17:22:38.684664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:22:38.693769 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:22:38.767635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363537FD10>]}
[0m17:22:38.767635 [info ] [MainThread]: Found 16 models, 2 data tests, 473 macros
[0m17:22:38.775831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236351E5970>]}
[0m17:22:38.775831 [info ] [MainThread]: 
[0m17:22:38.784024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:38.790224 [info ] [MainThread]: 
[0m17:22:38.792375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:38.809977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:22:39.105839 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:22:39.105839 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:22:39.114006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:40.051466 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.939 seconds
[0m17:22:40.059992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:22:40.079584 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:22:40.081598 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:22:40.081598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:40.848618 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.766 seconds
[0m17:22:40.848618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236351E5970>]}
[0m17:22:40.864524 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m17:22:40.864524 [info ] [Thread-1 (]: 1 of 8 START sql view model SILVER.src_claims .................................. [RUN]
[0m17:22:40.864524 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m17:22:40.864524 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m17:22:40.881308 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m17:22:40.881308 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m17:22:40.947365 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m17:22:40.947365 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m17:22:40.947365 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m17:22:40.947365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:22:41.620211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m17:22:41.669603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002362FA1A210>]}
[0m17:22:41.678104 [info ] [Thread-1 (]: 1 of 8 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.81s]
[0m17:22:41.690542 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m17:22:41.692561 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m17:22:41.696732 [info ] [Thread-1 (]: 2 of 8 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m17:22:41.699124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m17:22:41.701140 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m17:22:41.705473 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m17:22:41.712665 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m17:22:41.720283 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m17:22:41.724327 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m17:22:41.724327 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m17:22:41.986095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.261 seconds
[0m17:22:41.986095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023635246B40>]}
[0m17:22:41.986095 [info ] [Thread-1 (]: 2 of 8 OK created sql view model SILVER.src_cptcodes ........................... [[32mSUCCESS 1[0m in 0.29s]
[0m17:22:41.994877 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m17:22:41.994877 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m17:22:41.999060 [info ] [Thread-1 (]: 3 of 8 START sql view model SILVER.src_departments ............................. [RUN]
[0m17:22:41.999060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m17:22:42.003236 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m17:22:42.118873 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m17:22:42.121184 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m17:22:42.127108 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m17:22:42.129266 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m17:22:42.131290 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m17:22:42.376738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m17:22:42.384912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236352748F0>]}
[0m17:22:42.384912 [info ] [Thread-1 (]: 3 of 8 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.39s]
[0m17:22:42.393558 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m17:22:42.393558 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m17:22:42.393558 [info ] [Thread-1 (]: 4 of 8 START sql view model SILVER.src_encounters .............................. [RUN]
[0m17:22:42.393558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m17:22:42.399799 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m17:22:42.401685 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m17:22:42.401685 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m17:22:42.409911 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m17:22:42.418591 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m17:22:42.418591 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m17:22:42.896018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m17:22:42.896018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236351D29F0>]}
[0m17:22:42.900689 [info ] [Thread-1 (]: 4 of 8 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.50s]
[0m17:22:42.903867 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m17:22:42.903867 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m17:22:42.903867 [info ] [Thread-1 (]: 5 of 8 START sql view model SILVER.src_patients ................................ [RUN]
[0m17:22:42.903867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m17:22:42.912103 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m17:22:42.912103 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m17:22:42.920329 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m17:22:42.928519 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m17:22:42.928519 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m17:22:42.936820 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m17:22:43.410979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m17:22:43.419514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634FFA150>]}
[0m17:22:43.419514 [info ] [Thread-1 (]: 5 of 8 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.52s]
[0m17:22:43.419514 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m17:22:43.427700 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m17:22:43.428118 [info ] [Thread-1 (]: 6 of 8 START sql view model SILVER.src_providers ............................... [RUN]
[0m17:22:43.428118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m17:22:43.428118 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m17:22:43.436308 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m17:22:43.436308 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m17:22:43.446178 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m17:22:43.446178 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m17:22:43.446178 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m17:22:43.718607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m17:22:43.718607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634D3F5F0>]}
[0m17:22:43.727038 [info ] [Thread-1 (]: 6 of 8 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.29s]
[0m17:22:43.727038 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m17:22:43.727038 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m17:22:43.727038 [info ] [Thread-1 (]: 7 of 8 START sql view model SILVER.src_transactions ............................ [RUN]
[0m17:22:43.735229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m17:22:43.735229 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m17:22:43.735229 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m17:22:43.743403 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m17:22:43.748415 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m17:22:43.759617 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m17:22:43.759617 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m17:22:44.121015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m17:22:44.128687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023635883D70>]}
[0m17:22:44.128687 [info ] [Thread-1 (]: 7 of 8 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.39s]
[0m17:22:44.136881 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m17:22:44.136881 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m17:22:44.136881 [info ] [Thread-1 (]: 8 of 8 START sql view model SILVER.dim_patients ................................ [RUN]
[0m17:22:44.136881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.dim_patients)
[0m17:22:44.136881 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m17:22:44.149943 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m17:22:44.149943 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m17:22:44.161653 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m17:22:44.161653 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m17:22:44.169347 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace   view DBT_DB.SILVER.dim_patients
  
   as (
    with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
  );
[0m17:22:44.635027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m17:22:44.635027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c31c75-04c0-4939-a8a2-06686a1d0712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023635162F90>]}
[0m17:22:44.635027 [info ] [Thread-1 (]: 8 of 8 OK created sql view model SILVER.dim_patients ........................... [[32mSUCCESS 1[0m in 0.50s]
[0m17:22:44.643649 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m17:22:44.643649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:44.643649 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m17:22:44.643649 [debug] [MainThread]: On list_DBT_DB: Close
[0m17:22:44.805569 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m17:22:44.805569 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m17:22:44.968255 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m17:22:44.968255 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m17:22:45.352409 [info ] [MainThread]: 
[0m17:22:45.352409 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m17:22:45.360591 [debug] [MainThread]: Command end result
[0m17:22:45.419077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:22:45.426036 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:22:45.441699 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:22:45.441699 [info ] [MainThread]: 
[0m17:22:45.443719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:45.447753 [info ] [MainThread]: 
[0m17:22:45.449143 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m17:22:45.453038 [debug] [MainThread]: Command `dbt run` succeeded at 17:22:45.453038 after 12.21 seconds
[0m17:22:45.455061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023631914410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236328095B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023631EA3F80>]}
[0m17:22:45.457078 [debug] [MainThread]: Flushing usage events
[0m17:22:45.819518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:40.517182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0C58E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0D79B770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0D9B94F0>]}


============================== 17:29:40.525258 | 6d37cb03-28c7-4518-90f1-699e3b000b21 ==============================
[0m17:29:40.525258 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:29:40.530456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:29:40.795364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d37cb03-28c7-4518-90f1-699e3b000b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0D4D0C20>]}
[0m17:29:40.933319 [debug] [MainThread]: Command `dbt clean` succeeded at 17:29:40.933319 after 0.74 seconds
[0m17:29:40.935338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0C58E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0CFD7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0CFD6C60>]}
[0m17:29:40.937352 [debug] [MainThread]: Flushing usage events
[0m17:29:41.387959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:54.297274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDEEF1A270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF1615430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF0C8A720>]}


============================== 17:29:54.305419 | e5c67b79-ca84-415f-a8bd-d734dfb23683 ==============================
[0m17:29:54.305419 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:29:54.310087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:29:55.665244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF41EE360>]}
[0m17:29:55.781951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF1449700>]}
[0m17:29:55.785970 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:29:56.912308 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:29:56.916336 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:29:56.916336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF43FA300>]}
[0m17:29:59.404590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m17:29:59.416413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF38DE0C0>]}
[0m17:29:59.564999 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:29:59.577018 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:29:59.659076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF487AC00>]}
[0m17:29:59.661093 [info ] [MainThread]: Found 16 models, 2 data tests, 473 macros
[0m17:29:59.664689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF4A55B80>]}
[0m17:29:59.668713 [info ] [MainThread]: 
[0m17:29:59.672991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:59.676322 [info ] [MainThread]: 
[0m17:29:59.681780 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:29:59.694927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m17:30:00.033527 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:30:00.036337 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:30:00.038352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:01.002862 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.972 seconds
[0m17:30:01.011176 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m17:30:01.019273 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m17:30:01.143234 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.125 seconds
[0m17:30:01.151296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m17:30:01.167478 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m17:30:01.167478 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m17:30:01.167478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:01.953021 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.785 seconds
[0m17:30:01.961368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m17:30:01.969878 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m17:30:01.969878 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000;
[0m17:30:02.115814 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.142 seconds
[0m17:30:02.123107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF48729C0>]}
[0m17:30:02.130699 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m17:30:02.133741 [info ] [Thread-1 (]: 1 of 8 START sql view model SILVER.src_claims .................................. [RUN]
[0m17:30:02.136181 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m17:30:02.138198 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m17:30:02.153169 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m17:30:02.159214 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m17:30:02.225230 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m17:30:02.234896 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m17:30:02.236912 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m17:30:02.236912 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:30:03.132302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.894 seconds
[0m17:30:03.184153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF141B290>]}
[0m17:30:03.186166 [info ] [Thread-1 (]: 1 of 8 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 1.04s]
[0m17:30:03.188186 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m17:30:03.191240 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m17:30:03.193255 [info ] [Thread-1 (]: 2 of 8 START sql view model SILVER.src_cptcodes ................................ [RUN]
[0m17:30:03.198442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m17:30:03.200580 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m17:30:03.204404 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m17:30:03.207657 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m17:30:03.215970 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m17:30:03.220007 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m17:30:03.220007 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m17:30:03.436088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m17:30:03.442120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF4F43440>]}
[0m17:30:03.444134 [info ] [Thread-1 (]: 2 of 8 OK created sql view model SILVER.src_cptcodes ........................... [[32mSUCCESS 1[0m in 0.25s]
[0m17:30:03.447438 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m17:30:03.449452 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m17:30:03.451543 [info ] [Thread-1 (]: 3 of 8 START sql view model SILVER.src_departments ............................. [RUN]
[0m17:30:03.453566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m17:30:03.456227 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m17:30:03.460919 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m17:30:03.464819 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m17:30:03.470019 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m17:30:03.477268 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m17:30:03.480297 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m17:30:03.659996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m17:30:03.668137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF5030CE0>]}
[0m17:30:03.671782 [info ] [Thread-1 (]: 3 of 8 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.21s]
[0m17:30:03.677551 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m17:30:03.681584 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m17:30:03.683598 [info ] [Thread-1 (]: 4 of 8 START sql view model SILVER.src_encounters .............................. [RUN]
[0m17:30:03.689128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m17:30:03.691140 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m17:30:03.696407 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m17:30:03.700940 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m17:30:03.706990 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m17:30:03.710682 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m17:30:03.712695 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m17:30:04.051362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m17:30:04.056297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF503EB40>]}
[0m17:30:04.059335 [info ] [Thread-1 (]: 4 of 8 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.37s]
[0m17:30:04.062366 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m17:30:04.062366 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m17:30:04.065041 [info ] [Thread-1 (]: 5 of 8 START sql view model SILVER.src_patients ................................ [RUN]
[0m17:30:04.069068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m17:30:04.070848 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m17:30:04.075079 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m17:30:04.079106 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m17:30:04.086263 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m17:30:04.091305 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m17:30:04.095336 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m17:30:04.460842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m17:30:04.464865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF5065C70>]}
[0m17:30:04.467206 [info ] [Thread-1 (]: 5 of 8 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.40s]
[0m17:30:04.471382 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m17:30:04.471382 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m17:30:04.475161 [info ] [Thread-1 (]: 6 of 8 START sql view model SILVER.src_providers ............................... [RUN]
[0m17:30:04.477404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m17:30:04.479416 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m17:30:04.594542 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m17:30:04.598301 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m17:30:04.604589 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m17:30:04.608362 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m17:30:04.610375 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m17:30:04.832891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m17:30:04.838180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF5067DA0>]}
[0m17:30:04.840196 [info ] [Thread-1 (]: 6 of 8 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.36s]
[0m17:30:04.844355 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m17:30:04.844355 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m17:30:04.846626 [info ] [Thread-1 (]: 7 of 8 START sql view model SILVER.src_transactions ............................ [RUN]
[0m17:30:04.849464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m17:30:04.851475 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m17:30:04.855189 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m17:30:04.859328 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m17:30:04.866884 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m17:30:04.871739 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m17:30:04.873754 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m17:30:05.197102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m17:30:05.200131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF48A2B70>]}
[0m17:30:05.204162 [info ] [Thread-1 (]: 7 of 8 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.35s]
[0m17:30:05.208201 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m17:30:05.210216 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m17:30:05.212228 [info ] [Thread-1 (]: 8 of 8 START sql table model GOLD.dim_patients ................................. [RUN]
[0m17:30:05.215252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.dim_patients)
[0m17:30:05.217266 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m17:30:05.225070 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m17:30:05.227931 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m17:30:05.249669 [debug] [Thread-1 (]:  adapter: Dropping relation "DBT_DB"."GOLD"."DIM_PATIENTS" because it is a view and target relation DBT_DB.GOLD.dim_patients is of type table.
[0m17:30:05.260892 [debug] [Thread-1 (]: Applying DROP to: "DBT_DB"."GOLD"."DIM_PATIENTS"
[0m17:30:05.283259 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m17:30:05.285268 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
drop view if exists "DBT_DB"."GOLD"."DIM_PATIENTS" cascade
[0m17:30:05.444819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m17:30:05.482209 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m17:30:05.490258 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m17:30:05.492276 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (
with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m17:30:06.988752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.494 seconds
[0m17:30:06.993789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c67b79-ca84-415f-a8bd-d734dfb23683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF42853D0>]}
[0m17:30:06.995800 [info ] [Thread-1 (]: 8 of 8 OK created sql table model GOLD.dim_patients ............................ [[32mSUCCESS 1[0m in 1.78s]
[0m17:30:07.002168 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m17:30:07.005941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:07.005941 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m17:30:07.009198 [debug] [MainThread]: On list_DBT_DB: Close
[0m17:30:07.145031 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m17:30:07.161028 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m17:30:07.309364 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m17:30:07.309364 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m17:30:07.457524 [info ] [MainThread]: 
[0m17:30:07.457524 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 7.78 seconds (7.78s).
[0m17:30:07.465638 [debug] [MainThread]: Command end result
[0m17:30:07.515699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m17:30:07.523047 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m17:30:07.539153 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m17:30:07.539153 [info ] [MainThread]: 
[0m17:30:07.542511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:07.542511 [info ] [MainThread]: 
[0m17:30:07.545791 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m17:30:07.548124 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:07.548124 after 13.52 seconds
[0m17:30:07.550138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF1AA1A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF1FE1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF18D3B60>]}
[0m17:30:07.550686 [debug] [MainThread]: Flushing usage events
[0m17:30:07.891265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:40.619360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0927A53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E091F91B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09218C530>]}


============================== 17:35:40.626297 | 9859c2aa-b02f-42ec-bb83-2020ce01d033 ==============================
[0m17:35:40.626297 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:35:40.634549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:35:40.912854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9859c2aa-b02f-42ec-bb83-2020ce01d033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09250CC80>]}
[0m17:35:41.001060 [debug] [MainThread]: Command `dbt clean` succeeded at 17:35:41.001060 after 0.70 seconds
[0m17:35:41.003400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09292D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E091862720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E091862DB0>]}
[0m17:35:41.005414 [debug] [MainThread]: Flushing usage events
[0m17:35:41.341480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:03.524972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC02E0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC0DF13A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDD12F30>]}


============================== 18:35:03.540851 | 8946f51d-3993-490f-a84a-1e0edc6c60e1 ==============================
[0m18:35:03.540851 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:35:03.540851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:35:05.124738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC20F0470>]}
[0m18:35:05.235694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC21FE9C0>]}
[0m18:35:05.235694 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:35:06.049029 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:35:06.049029 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:35:06.049029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC03BE180>]}
[0m18:35:08.151401 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_departments' in the 'models' section of file 'models\schema.yml'
[0m18:35:08.344201 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.healthcare.unique_dim_departments_department_key.9178691b54' (models\schema.yml) depends on a node named 'dim_departments' in package '' which was not found
[0m18:35:08.344201 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.healthcare.not_null_dim_departments_department_key.7edf97b422' (models\schema.yml) depends on a node named 'dim_departments' in package '' which was not found
[0m18:35:08.510866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m18:35:08.510866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC36779E0>]}
[0m18:35:08.648276 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:35:08.664169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:35:08.743605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC37AB9B0>]}
[0m18:35:08.759437 [info ] [MainThread]: Found 16 models, 4 data tests, 473 macros
[0m18:35:08.759437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC32BF2C0>]}
[0m18:35:08.759437 [info ] [MainThread]: 
[0m18:35:08.759437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:08.769137 [info ] [MainThread]: 
[0m18:35:08.772689 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:35:08.781591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m18:35:08.963594 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:35:08.963594 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:35:08.963594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:09.879099 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.900 seconds
[0m18:35:09.879099 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:35:09.879099 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:35:09.990044 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.110 seconds
[0m18:35:09.990044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_GOLD)
[0m18:35:09.990044 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "GOLD"
"
[0m18:35:10.005300 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_GOLD"
[0m18:35:10.005300 [debug] [ThreadPool]: On create_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "create_DBT_DB_GOLD"} */
create schema if not exists DBT_DB.GOLD
[0m18:35:10.128093 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m18:35:10.128093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m18:35:10.143901 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m18:35:10.143901 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000;
[0m18:35:10.143901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:10.803550 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.648 seconds
[0m18:35:10.806779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m18:35:10.806779 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m18:35:10.806779 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m18:35:10.930412 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.119 seconds
[0m18:35:10.946300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDFE89E0>]}
[0m18:35:10.946300 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m18:35:10.946300 [info ] [Thread-1 (]: 1 of 11 START sql view model SILVER.src_claims ................................. [RUN]
[0m18:35:10.962117 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m18:35:10.962117 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m18:35:11.085617 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m18:35:11.085617 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m18:35:11.154676 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m18:35:11.162843 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m18:35:11.162843 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m18:35:11.162843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:11.863805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m18:35:11.911297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC0306810>]}
[0m18:35:11.911297 [info ] [Thread-1 (]: 1 of 11 OK created sql view model SILVER.src_claims ............................ [[32mSUCCESS 1[0m in 0.93s]
[0m18:35:11.911297 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m18:35:11.911297 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m18:35:11.911297 [info ] [Thread-1 (]: 2 of 11 START sql view model SILVER.src_cptcodes ............................... [RUN]
[0m18:35:11.911297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m18:35:11.924527 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m18:35:11.929649 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m18:35:11.933406 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m18:35:11.940500 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m18:35:11.947563 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m18:35:11.949016 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m18:35:12.181234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m18:35:12.181234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3692120>]}
[0m18:35:12.197825 [info ] [Thread-1 (]: 2 of 11 OK created sql view model SILVER.src_cptcodes .......................... [[32mSUCCESS 1[0m in 0.27s]
[0m18:35:12.198550 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m18:35:12.198550 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m18:35:12.198550 [info ] [Thread-1 (]: 3 of 11 START sql view model SILVER.src_departments ............................ [RUN]
[0m18:35:12.198550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m18:35:12.198550 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m18:35:12.209638 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m18:35:12.214012 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m18:35:12.221422 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m18:35:12.225607 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m18:35:12.225607 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m18:35:12.416182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m18:35:12.432026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3747BC0>]}
[0m18:35:12.432026 [info ] [Thread-1 (]: 3 of 11 OK created sql view model SILVER.src_departments ....................... [[32mSUCCESS 1[0m in 0.23s]
[0m18:35:12.432026 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m18:35:12.432026 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m18:35:12.432026 [info ] [Thread-1 (]: 4 of 11 START sql view model SILVER.src_encounters ............................. [RUN]
[0m18:35:12.432026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m18:35:12.432026 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m18:35:12.448740 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m18:35:12.451184 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m18:35:12.454023 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m18:35:12.465480 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m18:35:12.465480 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m18:35:12.731377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m18:35:12.731377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC35C6930>]}
[0m18:35:12.731377 [info ] [Thread-1 (]: 4 of 11 OK created sql view model SILVER.src_encounters ........................ [[32mSUCCESS 1[0m in 0.30s]
[0m18:35:12.731377 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m18:35:12.731377 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m18:35:12.745407 [info ] [Thread-1 (]: 5 of 11 START sql view model SILVER.src_patients ............................... [RUN]
[0m18:35:12.748636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m18:35:12.750858 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m18:35:12.755146 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m18:35:12.757012 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m18:35:12.761795 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m18:35:12.761795 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m18:35:12.766109 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m18:35:13.141001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.381 seconds
[0m18:35:13.141001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC357DD00>]}
[0m18:35:13.141001 [info ] [Thread-1 (]: 5 of 11 OK created sql view model SILVER.src_patients .......................... [[32mSUCCESS 1[0m in 0.39s]
[0m18:35:13.156870 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m18:35:13.156870 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m18:35:13.156870 [info ] [Thread-1 (]: 6 of 11 START sql view model SILVER.src_providers .............................. [RUN]
[0m18:35:13.156870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m18:35:13.156870 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m18:35:13.167273 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m18:35:13.170653 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m18:35:13.173873 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m18:35:13.186882 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m18:35:13.189963 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m18:35:13.455099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m18:35:13.455099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC35AC290>]}
[0m18:35:13.455099 [info ] [Thread-1 (]: 6 of 11 OK created sql view model SILVER.src_providers ......................... [[32mSUCCESS 1[0m in 0.30s]
[0m18:35:13.455099 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m18:35:13.470920 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m18:35:13.470920 [info ] [Thread-1 (]: 7 of 11 START sql view model SILVER.src_transactions ........................... [RUN]
[0m18:35:13.470920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m18:35:13.470920 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m18:35:13.479240 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m18:35:13.483491 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m18:35:13.485088 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m18:35:13.485088 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m18:35:13.485088 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m18:35:13.859206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m18:35:13.859206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3742240>]}
[0m18:35:13.859206 [info ] [Thread-1 (]: 7 of 11 OK created sql view model SILVER.src_transactions ...................... [[32mSUCCESS 1[0m in 0.39s]
[0m18:35:13.875065 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m18:35:13.875065 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m18:35:13.875065 [info ] [Thread-1 (]: 8 of 11 START sql table model GOLD.dim_cptcodes ................................ [RUN]
[0m18:35:13.875065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.dim_cptcodes)
[0m18:35:13.875065 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m18:35:13.889260 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m18:35:13.891898 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m18:35:13.933993 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m18:35:13.948587 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m18:35:13.948587 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
         as
        (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        cpt_codes AS cpt_code,
        procedure_code_category AS category,
        procedure_code_descriptions AS description
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE cpt_codes IS NOT NULL
)

SELECT * FROM cleaned_cpt
        );
[0m18:35:15.216594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m18:35:15.216594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC35AA8D0>]}
[0m18:35:15.216594 [info ] [Thread-1 (]: 8 of 11 OK created sql table model GOLD.dim_cptcodes ........................... [[32mSUCCESS 1[0m in 1.34s]
[0m18:35:15.216594 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m18:35:15.216594 [debug] [Thread-1 (]: Began running node model.healthcare.dim_department
[0m18:35:15.216594 [info ] [Thread-1 (]: 9 of 11 START sql table model GOLD.dim_department .............................. [RUN]
[0m18:35:15.230259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_cptcodes, now model.healthcare.dim_department)
[0m18:35:15.230259 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_department
[0m18:35:15.230259 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_department"
[0m18:35:15.230259 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_department
[0m18:35:15.246122 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_department"
[0m18:35:15.249313 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_department"
[0m18:35:15.251069 [debug] [Thread-1 (]: On model.healthcare.dim_department: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_department"} */
create or replace transient table DBT_DB.GOLD.dim_department
         as
        (

WITH deduplicated_departments AS (
    SELECT DISTINCT dept_id, name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    dept_id AS department_key,
    name AS department_name
FROM deduplicated_departments
        );
[0m18:35:16.211873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.962 seconds
[0m18:35:16.218551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC329F830>]}
[0m18:35:16.218551 [info ] [Thread-1 (]: 9 of 11 OK created sql table model GOLD.dim_department ......................... [[32mSUCCESS 1[0m in 0.99s]
[0m18:35:16.218551 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_department
[0m18:35:16.227760 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m18:35:16.227760 [info ] [Thread-1 (]: 10 of 11 START sql table model GOLD.dim_patients ............................... [RUN]
[0m18:35:16.227760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_department, now model.healthcare.dim_patients)
[0m18:35:16.227760 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m18:35:16.242306 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m18:35:16.244587 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m18:35:16.253218 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m18:35:16.260890 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m18:35:16.260890 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (
with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m18:35:17.644948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.384 seconds
[0m18:35:17.644948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3750A40>]}
[0m18:35:17.644948 [info ] [Thread-1 (]: 10 of 11 OK created sql table model GOLD.dim_patients .......................... [[32mSUCCESS 1[0m in 1.42s]
[0m18:35:17.644948 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m18:35:17.660830 [debug] [Thread-1 (]: Began running node model.healthcare.dim_provider
[0m18:35:17.660830 [info ] [Thread-1 (]: 11 of 11 START sql table model GOLD.dim_provider ............................... [RUN]
[0m18:35:17.660830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_patients, now model.healthcare.dim_provider)
[0m18:35:17.666856 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_provider
[0m18:35:17.673177 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_provider"
[0m18:35:17.677414 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_provider
[0m18:35:17.677414 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_provider"
[0m18:35:17.688672 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_provider"
[0m18:35:17.688672 [debug] [Thread-1 (]: On model.healthcare.dim_provider: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_provider"} */
create or replace transient table DBT_DB.GOLD.dim_provider
         as
        (
WITH base AS (
    SELECT * 
    FROM DBT_DB.SILVER.src_providers
),

deduplicated AS (
    SELECT *
    FROM base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY provider_id ORDER BY npi DESC) = 1
),

final AS (
    SELECT
        provider_id,
        INITCAP(first_name) AS first_name,
        INITCAP(last_name) AS last_name,
        INITCAP(specialization) AS specialization,
        dept_id,
        npi,
        
        -- Optional derived field
        CONCAT(INITCAP(first_name), ' ', INITCAP(last_name)) AS full_name

    FROM deduplicated
)

SELECT * FROM final;
[0m18:35:18.267883 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bde3cb-0000-26a8-0027-cf8b00051a7e
[0m18:35:18.267883 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 19 unexpected ';'.
[0m18:35:18.299570 [debug] [Thread-1 (]: Database Error in model dim_provider (models\healthcare\dim\dim_provider.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\dim\dim_provider.sql
[0m18:35:18.299570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8946f51d-3993-490f-a84a-1e0edc6c60e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3740320>]}
[0m18:35:18.299570 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model GOLD.dim_provider ...................... [[31mERROR[0m in 0.64s]
[0m18:35:18.315399 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_provider
[0m18:35:18.315399 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.dim_provider' to be skipped because of status 'error'.  Reason: Database Error in model dim_provider (models\healthcare\dim\dim_provider.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\dim\dim_provider.sql.
[0m18:35:18.323162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:18.323162 [debug] [MainThread]: Connection 'create_DBT_DB_GOLD' was left open.
[0m18:35:18.323162 [debug] [MainThread]: On create_DBT_DB_GOLD: Close
[0m18:35:18.468494 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m18:35:18.468494 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m18:35:18.628048 [debug] [MainThread]: Connection 'model.healthcare.dim_provider' was left open.
[0m18:35:18.628048 [debug] [MainThread]: On model.healthcare.dim_provider: Close
[0m18:35:18.786549 [info ] [MainThread]: 
[0m18:35:18.786549 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m18:35:18.786549 [debug] [MainThread]: Command end result
[0m18:35:18.839150 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:35:18.840978 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:35:18.859170 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m18:35:18.859170 [info ] [MainThread]: 
[0m18:35:18.859170 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:35:18.859170 [info ] [MainThread]: 
[0m18:35:18.859170 [error] [MainThread]: [31mFailure in model dim_provider (models\healthcare\dim\dim_provider.sql)[0m
[0m18:35:18.867381 [error] [MainThread]:   Database Error in model dim_provider (models\healthcare\dim\dim_provider.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\dim\dim_provider.sql
[0m18:35:18.867381 [info ] [MainThread]: 
[0m18:35:18.870865 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\dim\dim_provider.sql
[0m18:35:18.870865 [info ] [MainThread]: 
[0m18:35:18.870865 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=11
[0m18:35:18.875721 [debug] [MainThread]: Command `dbt run` failed at 18:35:18.875721 after 15.61 seconds
[0m18:35:18.875721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC0CA9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC0E67980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC0E67E30>]}
[0m18:35:18.875721 [debug] [MainThread]: Flushing usage events
[0m18:35:19.247058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:42:07.460828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C3A71970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C3A71C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C3A71CA0>]}


============================== 18:42:07.468609 | 69a5fb7d-eca0-47d9-812a-5ce82f3861ae ==============================
[0m18:42:07.468609 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:42:07.470619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:42:08.745417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C60B2AB0>]}
[0m18:42:08.881599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C4197DD0>]}
[0m18:42:08.886674 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:42:09.772723 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:42:10.243981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:42:10.243981 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\dim\dim_provider.sql
[0m18:42:10.691838 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m18:42:10.705991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C6DBFE30>]}
[0m18:42:10.836545 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:42:10.840560 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:42:10.908197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C6BE9D90>]}
[0m18:42:10.911315 [info ] [MainThread]: Found 16 models, 4 data tests, 473 macros
[0m18:42:10.913328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C6B5B050>]}
[0m18:42:10.917594 [info ] [MainThread]: 
[0m18:42:10.919611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:42:10.922115 [info ] [MainThread]: 
[0m18:42:10.931117 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:42:10.939463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m18:42:11.130763 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:42:11.132777 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:42:11.134792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:12.006139 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.872 seconds
[0m18:42:12.006139 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:42:12.015592 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:42:12.129583 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.114 seconds
[0m18:42:12.135619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m18:42:12.160356 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m18:42:12.162367 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000;
[0m18:42:12.162367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:12.590931 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.428 seconds
[0m18:42:12.595394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m18:42:12.603333 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m18:42:12.605345 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m18:42:12.754656 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.148 seconds
[0m18:42:12.756663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C6D88DD0>]}
[0m18:42:12.768594 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m18:42:12.768594 [info ] [Thread-1 (]: 1 of 11 START sql view model SILVER.src_claims ................................. [RUN]
[0m18:42:12.773228 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m18:42:12.773228 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m18:42:12.799847 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m18:42:12.802559 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m18:42:12.863767 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m18:42:12.865781 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m18:42:12.865781 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
    CLAIM_ID               AS claim_id,
    TRANSACTION_ID         AS transaction_id,
    PATIENT_ID             AS patient_id,
    ENCOUNTER_ID           AS encounter_id,
    PROVIDER_ID            AS provider_id,
    DEPT_ID                AS dept_id,
    TRY_CAST(SERVICE_DATE AS DATE) AS service_date,
    TRY_CAST(CLAIM_DATE AS DATE) AS claim_date,
    PAYOR_ID               AS payor_id,
    TRY_CAST(CLAIM_AMOUNT AS NUMBER(38,2)) AS claim_amount,
    TRY_CAST(PAID_AMOUNT AS NUMBER(38,2)) AS paid_amount,
    UPPER(TRIM(CLAIM_STATUS)) AS claim_status,
    PAYOR_TYPE             AS payor_type,
    TRY_CAST(DEDUCTIBLE AS NUMBER(38,2)) AS deductible,
    TRY_CAST(COINSURANCE AS NUMBER(38,2)) AS coinsurance,
    TRY_CAST(COPAY AS NUMBER(38,2)) AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m18:42:12.865781 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:42:13.703342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m18:42:13.755924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C15C60C0>]}
[0m18:42:13.758383 [info ] [Thread-1 (]: 1 of 11 OK created sql view model SILVER.src_claims ............................ [[32mSUCCESS 1[0m in 0.98s]
[0m18:42:13.760936 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m18:42:13.762948 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m18:42:13.764961 [info ] [Thread-1 (]: 2 of 11 START sql view model SILVER.src_cptcodes ............................... [RUN]
[0m18:42:13.766975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m18:42:13.769390 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m18:42:13.776137 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m18:42:13.783946 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m18:42:13.790402 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m18:42:13.795349 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m18:42:13.797363 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m18:42:14.005169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m18:42:14.008194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C72EC500>]}
[0m18:42:14.008194 [info ] [Thread-1 (]: 2 of 11 OK created sql view model SILVER.src_cptcodes .......................... [[32mSUCCESS 1[0m in 0.24s]
[0m18:42:14.010208 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m18:42:14.014229 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m18:42:14.015466 [info ] [Thread-1 (]: 3 of 11 START sql view model SILVER.src_departments ............................ [RUN]
[0m18:42:14.017485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m18:42:14.020271 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m18:42:14.025050 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m18:42:14.026783 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m18:42:14.034224 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m18:42:14.036775 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m18:42:14.038789 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    DeptID as dept_id,
    Name as name
from RAW_DEPARTMENTS
  );
[0m18:42:14.331616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m18:42:14.335636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C73C7DD0>]}
[0m18:42:14.339706 [info ] [Thread-1 (]: 3 of 11 OK created sql view model SILVER.src_departments ....................... [[32mSUCCESS 1[0m in 0.32s]
[0m18:42:14.341720 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m18:42:14.341720 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m18:42:14.345645 [info ] [Thread-1 (]: 4 of 11 START sql view model SILVER.src_encounters ............................. [RUN]
[0m18:42:14.348156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m18:42:14.349994 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m18:42:14.354543 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m18:42:14.358160 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m18:42:14.366729 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m18:42:14.371449 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m18:42:14.373292 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m18:42:14.739388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m18:42:14.741402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C73D8DD0>]}
[0m18:42:14.743417 [info ] [Thread-1 (]: 4 of 11 OK created sql view model SILVER.src_encounters ........................ [[32mSUCCESS 1[0m in 0.39s]
[0m18:42:14.747568 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m18:42:14.749582 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m18:42:14.749582 [info ] [Thread-1 (]: 5 of 11 START sql view model SILVER.src_patients ............................... [RUN]
[0m18:42:14.753610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m18:42:14.755043 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m18:42:14.758800 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m18:42:14.761194 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m18:42:14.768636 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m18:42:14.772667 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m18:42:14.774680 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m18:42:15.151640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m18:42:15.155396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C73C7E00>]}
[0m18:42:15.157403 [info ] [Thread-1 (]: 5 of 11 OK created sql view model SILVER.src_patients .......................... [[32mSUCCESS 1[0m in 0.40s]
[0m18:42:15.161431 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m18:42:15.163441 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m18:42:15.163441 [info ] [Thread-1 (]: 6 of 11 START sql view model SILVER.src_providers .............................. [RUN]
[0m18:42:15.167463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m18:42:15.170081 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m18:42:15.172096 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m18:42:15.177276 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m18:42:15.183296 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m18:42:15.221323 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m18:42:15.224347 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m18:42:15.561358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m18:42:15.568400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C7385CA0>]}
[0m18:42:15.570412 [info ] [Thread-1 (]: 6 of 11 OK created sql view model SILVER.src_providers ......................... [[32mSUCCESS 1[0m in 0.40s]
[0m18:42:15.572423 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m18:42:15.572423 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m18:42:15.574436 [info ] [Thread-1 (]: 7 of 11 START sql view model SILVER.src_transactions ........................... [RUN]
[0m18:42:15.577750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m18:42:15.579736 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m18:42:15.584094 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m18:42:15.586959 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m18:42:15.592227 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m18:42:15.598440 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m18:42:15.599993 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.RAW.RAW_TRANSACTIONS
)
select
    TransactionID as transaction_id,
    EncounterID as encounter_id,
    PatientID as patient_id,
    ProviderID as provider_id,
    DeptID as dept_id,
    VisitDate as visit_date,
    ServiceDate as service_date,
    PaidDate as paid_date,
    VisitType as visit_type,
    Amount as amount,
    AmountType as amount_type,
    PaidAmount as paid_amount,
    ClaimID as claim_id,
    PayorID as payor_id,
    ProcedureCode as procedure_code,
    ICDCode as icd_code,
    LineOfBusiness as line_of_business,
    MedicaidID as medicaid_id,
    MedicareID as medicare_id,
    InsertDate as insert_date,
    ModifiedDate as modified_date
from RAW_TRANSACTIONS
  );
[0m18:42:15.970903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m18:42:15.972917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C7390FB0>]}
[0m18:42:15.974930 [info ] [Thread-1 (]: 7 of 11 OK created sql view model SILVER.src_transactions ...................... [[32mSUCCESS 1[0m in 0.40s]
[0m18:42:15.976941 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m18:42:15.976941 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m18:42:15.978953 [info ] [Thread-1 (]: 8 of 11 START sql table model GOLD.dim_cptcodes ................................ [RUN]
[0m18:42:15.982980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.dim_cptcodes)
[0m18:42:15.984410 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m18:42:15.992751 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m18:42:15.994847 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m18:42:16.043589 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m18:42:16.047610 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m18:42:16.050279 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
         as
        (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        cpt_codes AS cpt_code,
        procedure_code_category AS category,
        procedure_code_descriptions AS description
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE cpt_codes IS NOT NULL
)

SELECT * FROM cleaned_cpt
        );
[0m18:42:17.202833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.150 seconds
[0m18:42:17.206862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C73F7FE0>]}
[0m18:42:17.207432 [info ] [Thread-1 (]: 8 of 11 OK created sql table model GOLD.dim_cptcodes ........................... [[32mSUCCESS 1[0m in 1.22s]
[0m18:42:17.209449 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m18:42:17.211466 [debug] [Thread-1 (]: Began running node model.healthcare.dim_department
[0m18:42:17.211466 [info ] [Thread-1 (]: 9 of 11 START sql table model GOLD.dim_department .............................. [RUN]
[0m18:42:17.214485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_cptcodes, now model.healthcare.dim_department)
[0m18:42:17.214485 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_department
[0m18:42:17.223262 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_department"
[0m18:42:17.225314 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_department
[0m18:42:17.231447 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_department"
[0m18:42:17.236450 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_department"
[0m18:42:17.238516 [debug] [Thread-1 (]: On model.healthcare.dim_department: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_department"} */
create or replace transient table DBT_DB.GOLD.dim_department
         as
        (

WITH deduplicated_departments AS (
    SELECT DISTINCT dept_id, name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    dept_id AS department_key,
    name AS department_name
FROM deduplicated_departments
        );
[0m18:42:18.534929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.295 seconds
[0m18:42:18.536943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C73BBD70>]}
[0m18:42:18.538957 [info ] [Thread-1 (]: 9 of 11 OK created sql table model GOLD.dim_department ......................... [[32mSUCCESS 1[0m in 1.32s]
[0m18:42:18.543611 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_department
[0m18:42:18.545511 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m18:42:18.545511 [info ] [Thread-1 (]: 10 of 11 START sql table model GOLD.dim_patients ............................... [RUN]
[0m18:42:18.548636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_department, now model.healthcare.dim_patients)
[0m18:42:18.550650 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m18:42:18.558315 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m18:42:18.561236 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m18:42:18.566031 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m18:42:18.571987 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m18:42:18.574000 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (
with base as (

    select * 
    from DBT_DB.SILVER.src_patients

),

deduplicated as (

    select * 
    from base
    qualify row_number() over (partition by unique_patient_id order by modified_date desc) = 1

),

final as (

    select
        unique_patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated

)

select * from final
        );
[0m18:42:19.560108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.984 seconds
[0m18:42:19.564800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C723D010>]}
[0m18:42:19.567324 [info ] [Thread-1 (]: 10 of 11 OK created sql table model GOLD.dim_patients .......................... [[32mSUCCESS 1[0m in 1.02s]
[0m18:42:19.569337 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m18:42:19.571350 [debug] [Thread-1 (]: Began running node model.healthcare.dim_provider
[0m18:42:19.571350 [info ] [Thread-1 (]: 11 of 11 START sql table model GOLD.dim_provider ............................... [RUN]
[0m18:42:19.574786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_patients, now model.healthcare.dim_provider)
[0m18:42:19.574786 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_provider
[0m18:42:19.582904 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_provider"
[0m18:42:19.586124 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_provider
[0m18:42:19.592662 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_provider"
[0m18:42:19.597547 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_provider"
[0m18:42:19.599563 [debug] [Thread-1 (]: On model.healthcare.dim_provider: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_provider"} */
create or replace transient table DBT_DB.GOLD.dim_provider
         as
        (

WITH base AS (
    SELECT * 
    FROM DBT_DB.SILVER.src_providers
),

deduplicated AS (
    SELECT *
    FROM base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY provider_id ORDER BY npi DESC) = 1
),

final AS (
    SELECT
        provider_id,
        INITCAP(first_name) AS first_name,
        INITCAP(last_name) AS last_name,
        INITCAP(specialization) AS specialization,
        dept_id,
        npi,
        
        -- Optional derived field
        CONCAT(INITCAP(first_name), ' ', INITCAP(last_name)) AS full_name

    FROM deduplicated
)

SELECT * FROM final
        );
[0m18:42:20.334502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m18:42:20.338521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5fb7d-eca0-47d9-812a-5ce82f3861ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C73C03B0>]}
[0m18:42:20.340527 [info ] [Thread-1 (]: 11 of 11 OK created sql table model GOLD.dim_provider .......................... [[32mSUCCESS 1[0m in 0.76s]
[0m18:42:20.342538 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_provider
[0m18:42:20.345651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:20.345651 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m18:42:20.347666 [debug] [MainThread]: On list_DBT_DB: Close
[0m18:42:20.500680 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m18:42:20.502692 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m18:42:20.655663 [debug] [MainThread]: Connection 'model.healthcare.dim_provider' was left open.
[0m18:42:20.655663 [debug] [MainThread]: On model.healthcare.dim_provider: Close
[0m18:42:20.815362 [info ] [MainThread]: 
[0m18:42:20.817368 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 9.88 seconds (9.88s).
[0m18:42:20.820391 [debug] [MainThread]: Command end result
[0m18:42:20.876510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:42:20.882558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:42:20.897521 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m18:42:20.899530 [info ] [MainThread]: 
[0m18:42:20.901275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:42:20.903338 [info ] [MainThread]: 
[0m18:42:20.905770 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m18:42:20.908568 [debug] [MainThread]: Command `dbt run` succeeded at 18:42:20.908568 after 13.72 seconds
[0m18:42:20.910565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C4517980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C0BC42C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202C0BC6B40>]}
[0m18:42:20.912584 [debug] [MainThread]: Flushing usage events
[0m18:42:21.294173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:33.390694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A650A150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A60BC530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A6410F80>]}


============================== 18:51:33.400740 | d52894df-2123-4c8e-a829-1c19b65a7209 ==============================
[0m18:51:33.400740 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:51:33.403448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select department_revenue_summary', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:34.725808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd52894df-2123-4c8e-a829-1c19b65a7209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A8B92A20>]}
[0m18:51:34.835060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd52894df-2123-4c8e-a829-1c19b65a7209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A8633DA0>]}
[0m18:51:34.839085 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:51:35.596082 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:51:36.083961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:36.083961 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\fact\department_revenue_summary.sql
[0m18:51:36.469860 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.healthcare.department_revenue_summary' (models\healthcare\fact\department_revenue_summary.sql) depends on a node named 'dim_departments' which was not found
[0m18:51:36.471874 [debug] [MainThread]: Command `dbt run` failed at 18:51:36.471874 after 3.37 seconds
[0m18:51:36.471874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A67F9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A5DBAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A90AE570>]}
[0m18:51:36.476129 [debug] [MainThread]: Flushing usage events
[0m18:51:36.812261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:24.811701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000110FF8508F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000110844E7A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000110844E59A0>]}


============================== 18:52:24.821330 | 4f323bc3-d625-4161-a1a8-82c128aeda72 ==============================
[0m18:52:24.821330 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:52:24.824301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select department_revenue_summary', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:26.007832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f323bc3-d625-4161-a1a8-82c128aeda72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011087059370>]}
[0m18:52:26.134075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f323bc3-d625-4161-a1a8-82c128aeda72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011086DB3170>]}
[0m18:52:26.144959 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:52:26.988300 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:52:27.449675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:27.451684 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\fact\department_revenue_summary.sql
[0m18:52:27.919600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m18:52:27.933697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f323bc3-d625-4161-a1a8-82c128aeda72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000110875AFDD0>]}
[0m18:52:28.065001 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:52:28.072098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:52:28.143786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f323bc3-d625-4161-a1a8-82c128aeda72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000110875DEBA0>]}
[0m18:52:28.144829 [info ] [MainThread]: Found 16 models, 4 data tests, 473 macros
[0m18:52:28.148375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f323bc3-d625-4161-a1a8-82c128aeda72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000110875A1940>]}
[0m18:52:28.152396 [info ] [MainThread]: 
[0m18:52:28.155364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:28.158419 [info ] [MainThread]: 
[0m18:52:28.160438 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:52:28.162622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m18:52:28.348601 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:52:28.350613 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:52:28.350613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:29.189103 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.837 seconds
[0m18:52:29.200352 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m18:52:29.222656 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m18:52:29.224664 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000;
[0m18:52:29.226677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:29.829867 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.602 seconds
[0m18:52:29.831881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m18:52:29.837921 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m18:52:29.839936 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m18:52:29.980406 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.140 seconds
[0m18:52:29.986908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f323bc3-d625-4161-a1a8-82c128aeda72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001108797A990>]}
[0m18:52:29.996594 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m18:52:29.997225 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.department_revenue_summary ................... [RUN]
[0m18:52:30.000751 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.department_revenue_summary'
[0m18:52:30.002767 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m18:52:30.023541 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m18:52:30.029829 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m18:52:30.085580 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m18:52:30.090863 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m18:52:30.094026 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

with txn as (

    select
        t.dept_id,
        coalesce(t.amount, 0) as charge_amount,
        t.transaction_id
    from DBT_DB.SILVER.src_transactions t

),

claims as (

    select
        c.transaction_id,
        coalesce(c.paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims c

),

joined as (

    select
        txn.dept_id,
        txn.charge_amount,
        claims.paid_amount
    from txn
    left join claims
    on txn.transaction_id = claims.transaction_id

),

aggregated as (

    select
        d.dept_id,
        d.name as department_name,
        count(*) as total_encounters,
        sum(j.charge_amount) as total_charges,
        sum(j.paid_amount) as total_payments,
        rank() over (order by sum(j.charge_amount) desc) as revenue_rank
    from joined j
    join DBT_DB.GOLD.dim_department d
      on j.dept_id = d.dept_id
    group by d.dept_id, d.name

)

select * from aggregated
        );
[0m18:52:30.095759 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:30.645920 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bde3dc-0000-26aa-0027-cf8b0005678e
[0m18:52:30.648358 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 39 at position 8
invalid identifier 'D.DEPT_ID'
[0m18:52:30.657611 [debug] [Thread-1 (]: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 39 at position 8
  invalid identifier 'D.DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:52:30.665651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f323bc3-d625-4161-a1a8-82c128aeda72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011087ABA480>]}
[0m18:52:30.668668 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.department_revenue_summary .......... [[31mERROR[0m in 0.66s]
[0m18:52:30.671495 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m18:52:30.674443 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.department_revenue_summary' to be skipped because of status 'error'.  Reason: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 39 at position 8
  invalid identifier 'D.DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql.
[0m18:52:30.679233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:30.679233 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m18:52:30.681250 [debug] [MainThread]: On list_DBT_DB: Close
[0m18:52:30.837908 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m18:52:30.837908 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m18:52:30.994046 [debug] [MainThread]: Connection 'model.healthcare.department_revenue_summary' was left open.
[0m18:52:30.996859 [debug] [MainThread]: On model.healthcare.department_revenue_summary: Close
[0m18:52:31.153511 [info ] [MainThread]: 
[0m18:52:31.155029 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m18:52:31.157697 [debug] [MainThread]: Command end result
[0m18:52:31.213874 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:52:31.220924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:52:31.235196 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m18:52:31.237210 [info ] [MainThread]: 
[0m18:52:31.239222 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:52:31.243387 [info ] [MainThread]: 
[0m18:52:31.245044 [error] [MainThread]: [31mFailure in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)[0m
[0m18:52:31.246866 [error] [MainThread]:   Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 39 at position 8
  invalid identifier 'D.DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:52:31.248977 [info ] [MainThread]: 
[0m18:52:31.251418 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:52:31.252995 [info ] [MainThread]: 
[0m18:52:31.252995 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:52:31.257515 [debug] [MainThread]: Command `dbt run` failed at 18:52:31.257515 after 6.69 seconds
[0m18:52:31.259814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011083D0D670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001108467C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001108465BA70>]}
[0m18:52:31.261869 [debug] [MainThread]: Flushing usage events
[0m18:52:31.570710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:36.926472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A321944230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A321944EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A321946900>]}


============================== 18:55:36.940135 | 6207aca0-a84d-4a06-94eb-bd8628e663f9 ==============================
[0m18:55:36.940135 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:55:36.940135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select department_revenue_summary', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:55:38.190900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6207aca0-a84d-4a06-94eb-bd8628e663f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A323E736B0>]}
[0m18:55:38.317840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6207aca0-a84d-4a06-94eb-bd8628e663f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A324725880>]}
[0m18:55:38.317840 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:55:39.106128 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:55:39.561287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:55:39.561287 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\fact\department_revenue_summary.sql
[0m18:55:40.033896 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m18:55:40.047067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6207aca0-a84d-4a06-94eb-bd8628e663f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A324D34500>]}
[0m18:55:40.184487 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:55:40.184487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:55:40.249323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6207aca0-a84d-4a06-94eb-bd8628e663f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A324D740E0>]}
[0m18:55:40.249323 [info ] [MainThread]: Found 16 models, 4 data tests, 473 macros
[0m18:55:40.249323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6207aca0-a84d-4a06-94eb-bd8628e663f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A324D62930>]}
[0m18:55:40.262657 [info ] [MainThread]: 
[0m18:55:40.262657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:40.262657 [info ] [MainThread]: 
[0m18:55:40.262657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:55:40.271159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m18:55:40.448877 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:55:40.448877 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:55:40.448877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:41.289003 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.842 seconds
[0m18:55:41.313810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m18:55:41.336426 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m18:55:41.336426 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m18:55:41.336426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:41.943466 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.617 seconds
[0m18:55:41.959276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m18:55:41.959276 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m18:55:41.959276 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000;
[0m18:55:42.085817 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.121 seconds
[0m18:55:42.101701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6207aca0-a84d-4a06-94eb-bd8628e663f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A324D63D70>]}
[0m18:55:42.117591 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m18:55:42.117591 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.department_revenue_summary ................... [RUN]
[0m18:55:42.117591 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.department_revenue_summary'
[0m18:55:42.117591 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m18:55:42.148070 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m18:55:42.149629 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m18:55:42.197997 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m18:55:42.197997 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m18:55:42.206283 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

with txn as (

    select
        t.department_key as dept_id,
        coalesce(t.amount, 0) as charge_amount,
        t.transaction_id
    from DBT_DB.SILVER.src_transactions t

),

claims as (

    select
        c.transaction_id,
        coalesce(c.paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims c

),

joined as (

    select
        txn.dept_id,
        txn.charge_amount,
        claims.paid_amount
    from txn
    left join claims
    on txn.transaction_id = claims.transaction_id

),

aggregated as (

    select
        d.dept_id,
        d.name as department_name,
        count(*) as total_encounters,
        sum(j.charge_amount) as total_charges,
        sum(j.paid_amount) as total_payments,
        rank() over (order by sum(j.charge_amount) desc) as revenue_rank
    from joined j
    join DBT_DB.GOLD.dim_department d
      on j.dept_id = d.dept_id
    group by d.dept_id, d.name

)

select * from aggregated
        );
[0m18:55:42.206283 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:55:42.945905 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bde3df-0000-26a6-0027-cf8b0004eace
[0m18:55:42.945905 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'T.DEPARTMENT_KEY'
[0m18:55:42.945905 [debug] [Thread-1 (]: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'T.DEPARTMENT_KEY'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:55:42.961766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6207aca0-a84d-4a06-94eb-bd8628e663f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A321976B70>]}
[0m18:55:42.961766 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.department_revenue_summary .......... [[31mERROR[0m in 0.83s]
[0m18:55:42.961766 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m18:55:42.961766 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.department_revenue_summary' to be skipped because of status 'error'.  Reason: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'T.DEPARTMENT_KEY'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql.
[0m18:55:42.961766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:42.961766 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m18:55:42.977581 [debug] [MainThread]: On list_DBT_DB: Close
[0m18:55:43.118942 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m18:55:43.118942 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m18:55:43.261635 [debug] [MainThread]: Connection 'model.healthcare.department_revenue_summary' was left open.
[0m18:55:43.261635 [debug] [MainThread]: On model.healthcare.department_revenue_summary: Close
[0m18:55:43.420150 [info ] [MainThread]: 
[0m18:55:43.421817 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m18:55:43.421817 [debug] [MainThread]: Command end result
[0m18:55:43.468067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:55:43.514508 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:55:43.522688 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m18:55:43.522688 [info ] [MainThread]: 
[0m18:55:43.542470 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:55:43.554658 [info ] [MainThread]: 
[0m18:55:43.554658 [error] [MainThread]: [31mFailure in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)[0m
[0m18:55:43.554658 [error] [MainThread]:   Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'T.DEPARTMENT_KEY'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:55:43.554658 [info ] [MainThread]: 
[0m18:55:43.571908 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:55:43.587697 [info ] [MainThread]: 
[0m18:55:43.587697 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:55:43.587697 [debug] [MainThread]: Command `dbt run` failed at 18:55:43.587697 after 6.93 seconds
[0m18:55:43.598640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3220F9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A32256DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A32256FEC0>]}
[0m18:55:43.600659 [debug] [MainThread]: Flushing usage events
[0m18:55:43.965606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:27.419971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DACECB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DACEE030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DACEF980>]}


============================== 18:58:27.428067 | 71e422ce-a4fc-48e2-bef2-e6ea0fe8f2dd ==============================
[0m18:58:27.428067 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:58:27.431499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select department_revenue_summary', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:58:28.357354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e422ce-a4fc-48e2-bef2-e6ea0fe8f2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DD2CBB60>]}
[0m18:58:28.442947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71e422ce-a4fc-48e2-bef2-e6ea0fe8f2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DB32B110>]}
[0m18:58:28.448531 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:58:29.043248 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:58:29.491685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:58:29.495711 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\fact\department_revenue_summary.sql
[0m18:58:29.887473 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.healthcare.department_revenue_summary' (models\healthcare\fact\department_revenue_summary.sql) depends on a node named 'dim_departments' which was not found
[0m18:58:29.887473 [debug] [MainThread]: Command `dbt run` failed at 18:58:29.887473 after 2.69 seconds
[0m18:58:29.887473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D800E6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D8BCC740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DD9BE7E0>]}
[0m18:58:29.887473 [debug] [MainThread]: Flushing usage events
[0m18:58:30.220375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:15.994859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AA3E9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ACCB6D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ACD0C3B0>]}


============================== 18:59:16.001135 | 9981ed2a-d408-423d-92f6-59991fc39381 ==============================
[0m18:59:16.001135 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:59:16.008934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select department_revenue_summary', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:59:17.236744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9981ed2a-d408-423d-92f6-59991fc39381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AF78A390>]}
[0m18:59:17.354724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9981ed2a-d408-423d-92f6-59991fc39381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AF451D00>]}
[0m18:59:17.360354 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:59:18.183139 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:59:18.619010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:59:18.619010 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\fact\department_revenue_summary.sql
[0m18:59:19.071822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m18:59:19.084172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9981ed2a-d408-423d-92f6-59991fc39381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AFC3C320>]}
[0m18:59:19.232648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:59:19.235893 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:59:19.320296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9981ed2a-d408-423d-92f6-59991fc39381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AFB09670>]}
[0m18:59:19.320296 [info ] [MainThread]: Found 16 models, 4 data tests, 473 macros
[0m18:59:19.323791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9981ed2a-d408-423d-92f6-59991fc39381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AFA82960>]}
[0m18:59:19.328581 [info ] [MainThread]: 
[0m18:59:19.333525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:59:19.337008 [info ] [MainThread]: 
[0m18:59:19.343609 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:59:19.354478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m18:59:19.536407 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m18:59:19.538418 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m18:59:19.538418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:20.469804 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.931 seconds
[0m18:59:20.485746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m18:59:20.511263 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m18:59:20.511263 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000;
[0m18:59:20.515677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:20.956963 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.441 seconds
[0m18:59:20.960993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m18:59:20.967047 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m18:59:20.969062 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m18:59:21.107550 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.137 seconds
[0m18:59:21.115382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9981ed2a-d408-423d-92f6-59991fc39381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AFD68830>]}
[0m18:59:21.125622 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m18:59:21.125622 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.department_revenue_summary ................... [RUN]
[0m18:59:21.130055 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.department_revenue_summary'
[0m18:59:21.132068 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m18:59:21.149848 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m18:59:21.154073 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m18:59:21.214814 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m18:59:21.220857 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m18:59:21.222871 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

with txn as (

    select
        dept_id,
        coalesce(amount, 0) as charge_amount,
        transaction_id
    from DBT_DB.SILVER.src_transactions

),

claims as (

    select
        transaction_id,
        coalesce(paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims

),

joined as (

    select
        t.dept_id,
        d.name as department_name,
        t.charge_amount,
        c.paid_amount
    from txn t
    left join claims c
        on t.transaction_id = c.transaction_id
    left join DBT_DB.GOLD.dim_department d
        on t.dept_id = d.dept_id

),

aggregated as (

    select
        dept_id,
        department_name,
        count(*) as total_encounters,
        sum(charge_amount) as total_charges,
        sum(paid_amount) as total_payments,
        rank() over (order by sum(charge_amount) desc) as revenue_rank
    from joined
    group by dept_id, department_name

)

select * from aggregated
        );
[0m18:59:21.224884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:59:21.995359 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bde3e3-0000-26aa-0027-cf8b000567b6
[0m18:59:21.995359 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 28 at position 8
invalid identifier 'D.NAME'
[0m18:59:22.006965 [debug] [Thread-1 (]: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'D.NAME'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:59:22.013012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9981ed2a-d408-423d-92f6-59991fc39381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B01E94C0>]}
[0m18:59:22.018054 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.department_revenue_summary .......... [[31mERROR[0m in 0.88s]
[0m18:59:22.020067 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m18:59:22.020067 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.department_revenue_summary' to be skipped because of status 'error'.  Reason: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'D.NAME'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql.
[0m18:59:22.028557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:22.030568 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m18:59:22.031420 [debug] [MainThread]: On list_DBT_DB: Close
[0m18:59:22.183716 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m18:59:22.185726 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m18:59:22.333401 [debug] [MainThread]: Connection 'model.healthcare.department_revenue_summary' was left open.
[0m18:59:22.335412 [debug] [MainThread]: On model.healthcare.department_revenue_summary: Close
[0m18:59:22.481822 [info ] [MainThread]: 
[0m18:59:22.484776 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m18:59:22.485282 [debug] [MainThread]: Command end result
[0m18:59:22.537220 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m18:59:22.545270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m18:59:22.560301 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m18:59:22.562310 [info ] [MainThread]: 
[0m18:59:22.566809 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:59:22.566809 [info ] [MainThread]: 
[0m18:59:22.570123 [error] [MainThread]: [31mFailure in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)[0m
[0m18:59:22.572134 [error] [MainThread]:   Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'D.NAME'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:59:22.575321 [info ] [MainThread]: 
[0m18:59:22.577934 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m18:59:22.585436 [info ] [MainThread]: 
[0m18:59:22.592153 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:59:22.600016 [debug] [MainThread]: Command `dbt run` failed at 18:59:22.600016 after 6.86 seconds
[0m18:59:22.601537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A9AFE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AC0DC5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AFA93EC0>]}
[0m18:59:22.601537 [debug] [MainThread]: Flushing usage events
[0m18:59:22.902102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:50.972153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E6A108F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E9ACC500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E9ACD460>]}


============================== 19:04:50.987996 | ef762eef-f714-4319-9481-6a7f416b1de7 ==============================
[0m19:04:50.987996 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:04:50.987996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select department_revenue_summary', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:04:52.277001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef762eef-f714-4319-9481-6a7f416b1de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECE03590>]}
[0m19:04:52.414862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef762eef-f714-4319-9481-6a7f416b1de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EC8859A0>]}
[0m19:04:52.420223 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:04:53.443603 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:04:53.920113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:04:53.920113 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\fact\department_revenue_summary.sql
[0m19:04:54.289282 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.healthcare.department_revenue_summary' (models\healthcare\fact\department_revenue_summary.sql) depends on a node named 'dim_departments' which was not found
[0m19:04:54.289282 [debug] [MainThread]: Command `dbt run` failed at 19:04:54.289282 after 3.59 seconds
[0m19:04:54.296068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E719E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EC8F0CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECA3D6A0>]}
[0m19:04:54.296068 [debug] [MainThread]: Flushing usage events
[0m19:04:54.630842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:19.442276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ADA508F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B1BDF8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B10FDAC0>]}


============================== 19:05:19.458230 | 77437bc0-4897-43af-97d7-b06c305e5d3d ==============================
[0m19:05:19.458230 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:05:19.458230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select department_revenue_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:20.767101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77437bc0-4897-43af-97d7-b06c305e5d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AEC5AE70>]}
[0m19:05:20.878164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77437bc0-4897-43af-97d7-b06c305e5d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B12D5070>]}
[0m19:05:20.888899 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:05:21.919322 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:05:22.378165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:05:22.382010 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\fact\department_revenue_summary.sql
[0m19:05:22.827525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m19:05:22.837856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77437bc0-4897-43af-97d7-b06c305e5d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B43D0710>]}
[0m19:05:22.966641 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:05:22.982540 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:05:23.061859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77437bc0-4897-43af-97d7-b06c305e5d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B4422930>]}
[0m19:05:23.061859 [info ] [MainThread]: Found 16 models, 4 data tests, 473 macros
[0m19:05:23.061859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77437bc0-4897-43af-97d7-b06c305e5d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B3EC64E0>]}
[0m19:05:23.077731 [info ] [MainThread]: 
[0m19:05:23.080789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:23.083598 [info ] [MainThread]: 
[0m19:05:23.086318 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:23.088598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:05:23.280463 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:05:23.280463 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:05:23.295637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:24.228338 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.938 seconds
[0m19:05:24.244208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:05:24.260031 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:05:24.260031 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000;
[0m19:05:24.260031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:24.859266 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.590 seconds
[0m19:05:24.859266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m19:05:24.859266 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:05:24.875144 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000;
[0m19:05:25.003157 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.129 seconds
[0m19:05:25.003157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77437bc0-4897-43af-97d7-b06c305e5d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B448FDA0>]}
[0m19:05:25.018993 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m19:05:25.018993 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.department_revenue_summary ................... [RUN]
[0m19:05:25.018993 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.department_revenue_summary'
[0m19:05:25.018993 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m19:05:25.047048 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m19:05:25.047048 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m19:05:25.108480 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m19:05:25.116680 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m19:05:25.116680 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

with txn as (

    select
        dept_id,
        coalesce(amount, 0) as charge_amount,
        transaction_id
    from DBT_DB.SILVER.src_transactions

),

claims as (

    select
        transaction_id,
        coalesce(paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims

),

joined as (

    select
        t.dept_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    from txn t
    left join claims c
        on t.transaction_id = c.transaction_id
    left join DBT_DB.GOLD.dim_department d
        on t.dept_id = d.department_key

),

aggregated as (

    select
        dept_id,
        department_name,
        count(*) as total_encounters,
        sum(charge_amount) as total_charges,
        sum(paid_amount) as total_payments,
        rank() over (order by sum(charge_amount) desc) as revenue_rank
    from joined
    group by dept_id, department_name

)

select * from aggregated
        );
[0m19:05:25.116680 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:27.247993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.138 seconds
[0m19:05:27.295493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77437bc0-4897-43af-97d7-b06c305e5d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AEC5A030>]}
[0m19:05:27.295493 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.department_revenue_summary .............. [[32mSUCCESS 1[0m in 2.28s]
[0m19:05:27.307251 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m19:05:27.307251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:27.311423 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:05:27.311423 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:05:27.468153 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m19:05:27.468153 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m19:05:27.615644 [debug] [MainThread]: Connection 'model.healthcare.department_revenue_summary' was left open.
[0m19:05:27.615644 [debug] [MainThread]: On model.healthcare.department_revenue_summary: Close
[0m19:05:27.771164 [info ] [MainThread]: 
[0m19:05:27.771164 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m19:05:27.786986 [debug] [MainThread]: Command end result
[0m19:05:27.834995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:05:27.834995 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:05:27.856573 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:05:27.856573 [info ] [MainThread]: 
[0m19:05:27.856573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:27.856573 [info ] [MainThread]: 
[0m19:05:27.865271 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:05:27.869074 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:27.865271 after 8.68 seconds
[0m19:05:27.869074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B170EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AE25E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B1D2E2D0>]}
[0m19:05:27.873417 [debug] [MainThread]: Flushing usage events
[0m19:05:28.211416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:49.695139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B559E4E000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B559E4EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B559E4E0C0>]}


============================== 19:14:49.701827 | 86208eb9-dbb3-4ffc-97b4-c608a8f5c1ff ==============================
[0m19:14:49.701827 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:14:49.707921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:14:50.247620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86208eb9-dbb3-4ffc-97b4-c608a8f5c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55A75E990>]}
[0m19:14:50.308524 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:14:50.308524 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:14:50.312302 [debug] [MainThread]: Command `cli deps` succeeded at 19:14:50.312302 after 1.10 seconds
[0m19:14:50.312302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55A05ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55A737D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55A5CEDE0>]}
[0m19:14:50.312302 [debug] [MainThread]: Flushing usage events
[0m19:14:51.325571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:29.653993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACA81185F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACA7D2B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACA81187D0>]}


============================== 19:14:29.677506 | 42692662-43b6-4616-89f1-f3df479f02dd ==============================
[0m19:14:29.677506 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:14:29.677506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select src_encounters', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:42.056032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42692662-43b6-4616-89f1-f3df479f02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACA78FF110>]}
[0m19:14:42.212882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42692662-43b6-4616-89f1-f3df479f02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACA55F5220>]}
[0m19:14:42.216460 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:14:43.299166 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:14:43.541473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:43.541473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:43.551273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m19:14:43.608035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42692662-43b6-4616-89f1-f3df479f02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC254C170>]}
[0m19:14:43.719378 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:14:43.769981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:14:43.925993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42692662-43b6-4616-89f1-f3df479f02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC2756D20>]}
[0m19:14:43.925993 [info ] [MainThread]: Found 16 models, 4 data tests, 477 macros
[0m19:14:43.928003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42692662-43b6-4616-89f1-f3df479f02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC272D8E0>]}
[0m19:14:43.933779 [info ] [MainThread]: 
[0m19:14:43.935924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:43.938015 [info ] [MainThread]: 
[0m19:14:43.942166 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:43.942166 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:14:50.744462 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:14:50.744462 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:14:50.760303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:53.036871 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.282 seconds
[0m19:14:53.052668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:14:53.068422 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:14:53.068422 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:14:53.068422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:53.729940 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.663 seconds
[0m19:14:53.744540 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:14:53.744540 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:14:53.872681 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.129 seconds
[0m19:14:53.872681 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:14:53.872681 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:14:53.974150 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m19:14:53.989930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m19:14:53.989930 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:14:53.989930 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:14:54.100453 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m19:14:54.100453 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:14:54.100453 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:14:54.242383 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.142 seconds
[0m19:14:54.242383 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:14:54.242383 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:14:54.352755 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m19:14:54.352755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42692662-43b6-4616-89f1-f3df479f02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC21E89E0>]}
[0m19:14:54.368787 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m19:14:54.368787 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_encounters .............................. [RUN]
[0m19:14:54.384756 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_encounters'
[0m19:14:54.384756 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m19:14:54.384756 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m19:14:54.400523 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m19:14:54.456709 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m19:14:54.456709 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m19:14:54.464848 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.RAW.RAW_ENCOUNTERS
)
select
    EncounterID as encounter_id,
    PatientID as patient_id,
    EncounterDate as encounter_date,
    EncounterType as encounter_type,
    ProviderID as provider_id,
    DepartmentID as department_id,
    ProcedureCode as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m19:14:54.466012 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:55.530533 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdef32-0000-2795-0027-cf8b00065cd6
[0m19:14:55.530533 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'ENCOUNTERID'
[0m19:14:55.577796 [debug] [Thread-1 (]: Database Error in model src_encounters (models\healthcare\staging\src_encounters.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ENCOUNTERID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_encounters.sql
[0m19:14:55.577796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42692662-43b6-4616-89f1-f3df479f02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACA7219160>]}
[0m19:14:55.577796 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_encounters ..................... [[31mERROR[0m in 1.19s]
[0m19:14:55.577796 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m19:14:55.577796 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_encounters' to be skipped because of status 'error'.  Reason: Database Error in model src_encounters (models\healthcare\staging\src_encounters.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ENCOUNTERID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_encounters.sql.
[0m19:14:55.604490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:55.604490 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:14:55.604490 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:14:55.752987 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m19:14:55.768843 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m19:14:55.895489 [debug] [MainThread]: Connection 'model.healthcare.src_encounters' was left open.
[0m19:14:55.895489 [debug] [MainThread]: On model.healthcare.src_encounters: Close
[0m19:14:56.034705 [info ] [MainThread]: 
[0m19:14:56.034705 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 12.09 seconds (12.09s).
[0m19:14:56.048316 [debug] [MainThread]: Command end result
[0m19:14:56.117053 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:14:56.122194 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:14:56.146725 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:14:56.146725 [info ] [MainThread]: 
[0m19:14:56.146725 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:14:56.154944 [info ] [MainThread]: 
[0m19:14:56.170450 [error] [MainThread]: [31mFailure in model src_encounters (models\healthcare\staging\src_encounters.sql)[0m
[0m19:14:56.170450 [error] [MainThread]:   Database Error in model src_encounters (models\healthcare\staging\src_encounters.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ENCOUNTERID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_encounters.sql
[0m19:14:56.179030 [info ] [MainThread]: 
[0m19:14:56.179030 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_encounters.sql
[0m19:14:56.187110 [info ] [MainThread]: 
[0m19:14:56.189126 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:14:56.191145 [debug] [MainThread]: Command `dbt run` failed at 19:14:56.191145 after 26.97 seconds
[0m19:14:56.191145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC054E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC22C9EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC2787E60>]}
[0m19:14:56.191145 [debug] [MainThread]: Flushing usage events
[0m19:14:57.166552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:39.720788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001513EC511C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001514204FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001514204FE00>]}


============================== 19:16:39.743854 | b65cc75f-8bb3-4b49-90dc-34ef4fdf9050 ==============================
[0m19:16:39.743854 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:16:39.743854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_encounters', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:16:42.453966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b65cc75f-8bb3-4b49-90dc-34ef4fdf9050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515C04F860>]}
[0m19:16:42.603287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b65cc75f-8bb3-4b49-90dc-34ef4fdf9050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515C273140>]}
[0m19:16:42.603287 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:16:43.175210 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:16:43.415503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:16:43.415503 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\staging\src_encounters.sql
[0m19:16:43.993177 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.healthcare.src_encounters' (models\healthcare\staging\src_encounters.sql) depends on a source named 'raw.raw_encounters' which was not found
[0m19:16:43.997011 [debug] [MainThread]: Command `dbt run` failed at 19:16:43.997011 after 4.62 seconds
[0m19:16:43.997011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515AA64740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515C70AB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515C609FA0>]}
[0m19:16:43.997011 [debug] [MainThread]: Flushing usage events
[0m19:16:44.881411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:08.571266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013564801340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013567751DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013567C11400>]}


============================== 19:22:08.578856 | 89f52d5d-8b27-4543-a26e-da99e01421a1 ==============================
[0m19:22:08.578856 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:22:08.584640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select src_encounters', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:22:11.188047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89f52d5d-8b27-4543-a26e-da99e01421a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013501C5F710>]}
[0m19:22:11.336556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89f52d5d-8b27-4543-a26e-da99e01421a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001357FB91F70>]}
[0m19:22:11.336556 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:22:11.935600 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:22:12.218569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:22:12.218569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:22:12.235438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m19:22:12.313126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89f52d5d-8b27-4543-a26e-da99e01421a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013501DD5D90>]}
[0m19:22:12.465488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:22:12.473922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:22:12.664043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89f52d5d-8b27-4543-a26e-da99e01421a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135001B14C0>]}
[0m19:22:12.664043 [info ] [MainThread]: Found 16 models, 4 data tests, 1 source, 477 macros
[0m19:22:12.668708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89f52d5d-8b27-4543-a26e-da99e01421a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001356527BC20>]}
[0m19:22:12.670229 [info ] [MainThread]: 
[0m19:22:12.672261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:22:12.672261 [info ] [MainThread]: 
[0m19:22:12.672261 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:12.672261 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:22:12.801503 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:22:12.801503 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:22:12.801503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:13.761361 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.956 seconds
[0m19:22:13.775876 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:22:13.800255 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:22:13.800255 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:22:13.800255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:14.381398 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.579 seconds
[0m19:22:14.386529 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:22:14.388537 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:22:14.511365 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.123 seconds
[0m19:22:14.514746 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:22:14.516766 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:22:14.628758 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m19:22:14.631470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m19:22:14.641202 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:22:14.641202 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:22:14.758149 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m19:22:14.763666 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:22:14.763666 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:22:14.879644 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.115 seconds
[0m19:22:14.881820 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:22:14.883998 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:22:14.974230 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m19:22:14.978270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89f52d5d-8b27-4543-a26e-da99e01421a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013501DACB00>]}
[0m19:22:14.986793 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m19:22:14.986793 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_encounters .............................. [RUN]
[0m19:22:14.986793 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_encounters'
[0m19:22:14.986793 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m19:22:15.011304 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m19:22:15.017220 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m19:22:15.082182 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m19:22:15.088751 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m19:22:15.090777 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.raw.raw_encounters
)

select
    -- Add encounter prefix based on patient_id
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Encounter_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Encounter_ID
        else Encounter_ID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Provider_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || dept_id
        when Provider_key like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    Procedure_Code as procedure_code,
    InsertedDate as inserted_date,
    ModifiedDate as modified_date
from RAW_ENCOUNTERS
  );
[0m19:22:15.090777 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:22:15.648976 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdef3a-0000-27c1-0027-cf8b0006c4c2
[0m19:22:15.648976 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 38 at position 4
invalid identifier 'INSERTEDDATE'
[0m19:22:15.657606 [debug] [Thread-1 (]: Database Error in model src_encounters (models\healthcare\staging\src_encounters.sql)
  000904 (42000): SQL compilation error: error line 38 at position 4
  invalid identifier 'INSERTEDDATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_encounters.sql
[0m19:22:15.664147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f52d5d-8b27-4543-a26e-da99e01421a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013566D09340>]}
[0m19:22:15.666067 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_encounters ..................... [[31mERROR[0m in 0.67s]
[0m19:22:15.666377 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m19:22:15.666377 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_encounters' to be skipped because of status 'error'.  Reason: Database Error in model src_encounters (models\healthcare\staging\src_encounters.sql)
  000904 (42000): SQL compilation error: error line 38 at position 4
  invalid identifier 'INSERTEDDATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_encounters.sql.
[0m19:22:15.673476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:15.673988 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:22:15.673988 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:22:15.829518 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m19:22:15.829518 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m19:22:15.981250 [debug] [MainThread]: Connection 'model.healthcare.src_encounters' was left open.
[0m19:22:15.981250 [debug] [MainThread]: On model.healthcare.src_encounters: Close
[0m19:22:16.122203 [info ] [MainThread]: 
[0m19:22:16.123964 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m19:22:16.126732 [debug] [MainThread]: Command end result
[0m19:22:16.196488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:22:16.199527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:22:16.210004 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:22:16.212023 [info ] [MainThread]: 
[0m19:22:16.212023 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:22:16.214556 [info ] [MainThread]: 
[0m19:22:16.216572 [error] [MainThread]: [31mFailure in model src_encounters (models\healthcare\staging\src_encounters.sql)[0m
[0m19:22:16.219908 [error] [MainThread]:   Database Error in model src_encounters (models\healthcare\staging\src_encounters.sql)
  000904 (42000): SQL compilation error: error line 38 at position 4
  invalid identifier 'INSERTEDDATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_encounters.sql
[0m19:22:16.223433 [info ] [MainThread]: 
[0m19:22:16.224565 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_encounters.sql
[0m19:22:16.224565 [info ] [MainThread]: 
[0m19:22:16.226582 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:22:16.232049 [debug] [MainThread]: Command `dbt run` failed at 19:22:16.230031 after 8.01 seconds
[0m19:22:16.234093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013567BEFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013501C18290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013501DD65A0>]}
[0m19:22:16.234093 [debug] [MainThread]: Flushing usage events
[0m19:22:17.167630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:02.563561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797DCBFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797CDCA6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797DCBFB00>]}


============================== 19:23:02.577449 | 411145b0-70b9-49b5-ac71-17e6ba949ded ==============================
[0m19:23:02.577449 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:23:02.577449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select src_encounters', 'send_anonymous_usage_stats': 'True'}
[0m19:23:04.886760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411145b0-70b9-49b5-ac71-17e6ba949ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027917E86F00>]}
[0m19:23:05.024467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411145b0-70b9-49b5-ac71-17e6ba949ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027916B47260>]}
[0m19:23:05.024467 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:23:05.564840 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:23:05.808621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:05.808621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:05.811872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m19:23:05.885658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411145b0-70b9-49b5-ac71-17e6ba949ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279181287D0>]}
[0m19:23:06.057672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:23:06.066239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:23:06.253688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411145b0-70b9-49b5-ac71-17e6ba949ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027917BDE840>]}
[0m19:23:06.253688 [info ] [MainThread]: Found 16 models, 4 data tests, 1 source, 477 macros
[0m19:23:06.257389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411145b0-70b9-49b5-ac71-17e6ba949ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797B3397C0>]}
[0m19:23:06.258069 [info ] [MainThread]: 
[0m19:23:06.261776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:06.261776 [info ] [MainThread]: 
[0m19:23:06.261776 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:06.265962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:23:06.377540 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:23:06.377540 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:23:06.377540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:07.273829 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.894 seconds
[0m19:23:07.291127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:23:07.314589 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:23:07.314589 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:23:07.314589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:07.745420 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.426 seconds
[0m19:23:07.753487 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:23:07.753487 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:23:07.877572 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.124 seconds
[0m19:23:07.877572 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:23:07.877572 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:23:07.983641 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m19:23:07.989710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m19:23:07.996278 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:23:08.000147 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:23:08.086513 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.084 seconds
[0m19:23:08.088533 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:23:08.091139 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:23:08.192805 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.104 seconds
[0m19:23:08.198749 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:23:08.200769 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:23:08.315374 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m19:23:08.326014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411145b0-70b9-49b5-ac71-17e6ba949ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279186BA300>]}
[0m19:23:08.343651 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m19:23:08.347870 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_encounters .............................. [RUN]
[0m19:23:08.349884 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_encounters'
[0m19:23:08.351898 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m19:23:08.383444 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m19:23:08.387682 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m19:23:08.445675 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m19:23:08.453939 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m19:23:08.460735 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.raw.raw_encounters
)

select
    -- Add encounter prefix based on patient_id
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Encounter_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Encounter_ID
        else Encounter_ID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Provider_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || dept_id
        when Provider_key like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    Procedure_Code as procedure_code,
    Inserted_Date as inserted_date,
    Modified_Date as modified_date
from RAW_ENCOUNTERS
  );
[0m19:23:08.460735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:09.264673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m19:23:09.314364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411145b0-70b9-49b5-ac71-17e6ba949ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797A9AD220>]}
[0m19:23:09.314364 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_encounters ......................... [[32mSUCCESS 1[0m in 0.96s]
[0m19:23:09.322869 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m19:23:09.326250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:09.327074 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:23:09.327074 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:23:09.465176 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m19:23:09.473305 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m19:23:09.616504 [debug] [MainThread]: Connection 'model.healthcare.src_encounters' was left open.
[0m19:23:09.616504 [debug] [MainThread]: On model.healthcare.src_encounters: Close
[0m19:23:09.771957 [info ] [MainThread]: 
[0m19:23:09.771957 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m19:23:09.776000 [debug] [MainThread]: Command end result
[0m19:23:09.859996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:23:09.866069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:23:09.878121 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:23:09.878121 [info ] [MainThread]: 
[0m19:23:09.880132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:09.882144 [info ] [MainThread]: 
[0m19:23:09.884157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:23:09.886028 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:09.886028 after 7.69 seconds
[0m19:23:09.886028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797DD01B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797B33B920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797FBA27E0>]}
[0m19:23:09.886028 [debug] [MainThread]: Flushing usage events
[0m19:23:10.785934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:04.114773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57291FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57291FD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D57291FE00>]}


============================== 19:34:04.128186 | 01f00faa-53bf-413a-b5f0-a356dd08af5c ==============================
[0m19:34:04.128186 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:34:04.130205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select src_patients', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:34:06.460203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01f00faa-53bf-413a-b5f0-a356dd08af5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5723B3680>]}
[0m19:34:06.599266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01f00faa-53bf-413a-b5f0-a356dd08af5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D50CB4E210>]}
[0m19:34:06.599266 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:34:07.144652 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:34:07.373250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:07.373250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:07.389257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m19:34:07.461612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01f00faa-53bf-413a-b5f0-a356dd08af5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D50CB803E0>]}
[0m19:34:07.588953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:34:07.604637 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:34:07.779010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01f00faa-53bf-413a-b5f0-a356dd08af5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56F90B2C0>]}
[0m19:34:07.779010 [info ] [MainThread]: Found 16 models, 4 data tests, 1 source, 477 macros
[0m19:34:07.783309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01f00faa-53bf-413a-b5f0-a356dd08af5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D50ACB7500>]}
[0m19:34:07.783309 [info ] [MainThread]: 
[0m19:34:07.783309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:07.790722 [info ] [MainThread]: 
[0m19:34:07.791930 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:34:07.793760 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:34:07.909134 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:34:07.909134 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:34:07.909134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:08.852754 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.948 seconds
[0m19:34:08.874687 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m19:34:08.900113 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:34:08.900113 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:34:08.900113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:09.557379 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.653 seconds
[0m19:34:09.561292 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:34:09.561292 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:34:09.692084 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.131 seconds
[0m19:34:09.692084 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:34:09.692084 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:34:09.818689 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m19:34:09.818689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m19:34:09.818689 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:34:09.818689 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:34:09.929718 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m19:34:09.929718 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:34:09.929718 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:34:10.040406 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.111 seconds
[0m19:34:10.040406 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:34:10.040406 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:34:10.152171 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m19:34:10.152171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01f00faa-53bf-413a-b5f0-a356dd08af5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5720B7860>]}
[0m19:34:10.167944 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m19:34:10.167944 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_patients ................................ [RUN]
[0m19:34:10.177092 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_patients'
[0m19:34:10.177092 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m19:34:10.191841 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m19:34:10.191841 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m19:34:10.263236 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m19:34:10.263236 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m19:34:10.263236 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    hospitalid as hospital_id,
    regexp_replace(patientid, '^HOSP1-', '') as local_patient_id,
    concat(hospitalid, '-', regexp_replace(patientid, '^HOSP1-', '')) as unique_patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m19:34:10.263236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:34:10.860908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m19:34:10.908351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01f00faa-53bf-413a-b5f0-a356dd08af5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56F61D460>]}
[0m19:34:10.908351 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.73s]
[0m19:34:10.908351 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m19:34:10.908351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:10.908351 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:34:10.908351 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:34:11.079234 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:34:11.079234 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:34:11.220801 [debug] [MainThread]: Connection 'model.healthcare.src_patients' was left open.
[0m19:34:11.220801 [debug] [MainThread]: On model.healthcare.src_patients: Close
[0m19:34:11.388108 [info ] [MainThread]: 
[0m19:34:11.388108 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m19:34:11.388108 [debug] [MainThread]: Command end result
[0m19:34:11.448198 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:34:11.458232 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:34:11.473005 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:34:11.473005 [info ] [MainThread]: 
[0m19:34:11.473005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:34:11.473005 [info ] [MainThread]: 
[0m19:34:11.473005 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:34:11.481064 [debug] [MainThread]: Command `dbt run` succeeded at 19:34:11.480044 after 7.70 seconds
[0m19:34:11.481064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D572827E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56FFAA120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D50CED7E30>]}
[0m19:34:11.481064 [debug] [MainThread]: Flushing usage events
[0m19:34:12.350260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:44.828578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E372638350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E372638140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E372639820>]}


============================== 19:34:44.840224 | 8f6b7cdf-d641-44c9-bbd1-b7d839bd3cad ==============================
[0m19:34:44.840224 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:34:44.840224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select src_providers', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:34:47.363654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f6b7cdf-d641-44c9-bbd1-b7d839bd3cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E30A9B6BA0>]}
[0m19:34:47.507620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f6b7cdf-d641-44c9-bbd1-b7d839bd3cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E30C880470>]}
[0m19:34:47.511643 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:34:48.032103 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:34:48.281992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:48.281992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:48.291794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m19:34:48.357759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f6b7cdf-d641-44c9-bbd1-b7d839bd3cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E30CA24530>]}
[0m19:34:48.493246 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:34:48.493246 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:34:48.683263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f6b7cdf-d641-44c9-bbd1-b7d839bd3cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E36FC9BAA0>]}
[0m19:34:48.685682 [info ] [MainThread]: Found 16 models, 4 data tests, 1 source, 477 macros
[0m19:34:48.685682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f6b7cdf-d641-44c9-bbd1-b7d839bd3cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E30CC251F0>]}
[0m19:34:48.685682 [info ] [MainThread]: 
[0m19:34:48.685682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:48.685682 [info ] [MainThread]: 
[0m19:34:48.694677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:34:48.694677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:34:48.802199 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:34:48.802199 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:34:48.802199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:49.745507 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.939 seconds
[0m19:34:49.761628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m19:34:49.777454 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:34:49.777454 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:34:49.777454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:50.415672 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.643 seconds
[0m19:34:50.431418 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:34:50.431418 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:34:50.559820 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.129 seconds
[0m19:34:50.559820 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:34:50.569006 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:34:50.700857 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.133 seconds
[0m19:34:50.700857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m19:34:50.712230 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:34:50.714246 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:34:50.808005 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m19:34:50.808005 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:34:50.808005 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:34:50.920040 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.110 seconds
[0m19:34:50.920040 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:34:50.920040 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:34:51.015882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m19:34:51.031725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f6b7cdf-d641-44c9-bbd1-b7d839bd3cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E372134050>]}
[0m19:34:51.033143 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m19:34:51.033143 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_providers ............................... [RUN]
[0m19:34:51.033143 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_providers'
[0m19:34:51.033143 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m19:34:51.057612 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m19:34:51.060645 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m19:34:51.126446 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m19:34:51.128207 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m19:34:51.128207 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    ProviderID as provider_id,
    FirstName as first_name,
    LastName as last_name,
    Specialization as specialization,
    DeptID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m19:34:51.128207 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:34:51.592143 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdef46-0000-2795-0027-cf8b00065d5e
[0m19:34:51.592143 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'PROVIDERID'
[0m19:34:51.592143 [debug] [Thread-1 (]: Database Error in model src_providers (models\healthcare\staging\src_providers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PROVIDERID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_providers.sql
[0m19:34:51.592143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6b7cdf-d641-44c9-bbd1-b7d839bd3cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3717292E0>]}
[0m19:34:51.592143 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_providers ...................... [[31mERROR[0m in 0.56s]
[0m19:34:51.592143 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m19:34:51.607917 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_providers' to be skipped because of status 'error'.  Reason: Database Error in model src_providers (models\healthcare\staging\src_providers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PROVIDERID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_providers.sql.
[0m19:34:51.609936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:51.612764 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:34:51.612764 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:34:51.761907 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:34:51.761907 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:34:51.945654 [debug] [MainThread]: Connection 'model.healthcare.src_providers' was left open.
[0m19:34:51.945654 [debug] [MainThread]: On model.healthcare.src_providers: Close
[0m19:34:52.089054 [info ] [MainThread]: 
[0m19:34:52.089054 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m19:34:52.092285 [debug] [MainThread]: Command end result
[0m19:34:52.151366 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:34:52.157546 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:34:52.169755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:34:52.171772 [info ] [MainThread]: 
[0m19:34:52.174508 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:34:52.174508 [info ] [MainThread]: 
[0m19:34:52.176586 [error] [MainThread]: [31mFailure in model src_providers (models\healthcare\staging\src_providers.sql)[0m
[0m19:34:52.179306 [error] [MainThread]:   Database Error in model src_providers (models\healthcare\staging\src_providers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PROVIDERID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_providers.sql
[0m19:34:52.181401 [info ] [MainThread]: 
[0m19:34:52.181401 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_providers.sql
[0m19:34:52.183415 [info ] [MainThread]: 
[0m19:34:52.183415 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:34:52.195238 [debug] [MainThread]: Command `dbt run` failed at 19:34:52.189619 after 7.69 seconds
[0m19:34:52.195238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E30A9B7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E372265A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E371B36B40>]}
[0m19:34:52.197666 [debug] [MainThread]: Flushing usage events
[0m19:34:53.080165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:38.789962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C20EDFF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C211AA480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C20CB2CC0>]}


============================== 19:35:38.798404 | dc168e67-5a08-44a3-ad00-8d53a07797db ==============================
[0m19:35:38.798404 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:35:38.798404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select src_providers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:41.387509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc168e67-5a08-44a3-ad00-8d53a07797db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C390CFE00>]}
[0m19:35:41.524499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc168e67-5a08-44a3-ad00-8d53a07797db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3B940620>]}
[0m19:35:41.528542 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:35:42.120308 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:35:42.374479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:42.374479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:42.390130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m19:35:42.449448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc168e67-5a08-44a3-ad00-8d53a07797db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3B5A3EF0>]}
[0m19:35:42.585221 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:35:42.597452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:35:42.783489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc168e67-5a08-44a3-ad00-8d53a07797db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3BC24FE0>]}
[0m19:35:42.786252 [info ] [MainThread]: Found 16 models, 4 data tests, 1 source, 477 macros
[0m19:35:42.786252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc168e67-5a08-44a3-ad00-8d53a07797db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3BC250A0>]}
[0m19:35:42.790288 [info ] [MainThread]: 
[0m19:35:42.791402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:42.791402 [info ] [MainThread]: 
[0m19:35:42.793972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:35:42.795870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:35:42.905019 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:35:42.905019 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:35:42.905019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:43.891805 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.987 seconds
[0m19:35:43.905639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m19:35:43.925507 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:35:43.925507 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:35:43.927518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:44.303204 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.380 seconds
[0m19:35:44.311325 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:35:44.311325 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:35:44.423850 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.119 seconds
[0m19:35:44.439639 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:35:44.439639 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:35:44.519638 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m19:35:44.535586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m19:35:44.543947 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:35:44.543947 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:35:44.642641 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m19:35:44.646670 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:35:44.646670 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:35:44.783301 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.144 seconds
[0m19:35:44.783301 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:35:44.783301 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:35:44.918430 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m19:35:44.922458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc168e67-5a08-44a3-ad00-8d53a07797db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3C10F410>]}
[0m19:35:44.932272 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m19:35:44.932272 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_providers ............................... [RUN]
[0m19:35:44.936296 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_providers'
[0m19:35:44.936296 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m19:35:44.955093 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m19:35:44.957956 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m19:35:45.016534 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m19:35:45.020985 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m19:35:45.022001 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    replace(replace(Department_key, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m19:35:45.022001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:35:45.515019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m19:35:45.572201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc168e67-5a08-44a3-ad00-8d53a07797db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C1E3DD520>]}
[0m19:35:45.574218 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m19:35:45.576649 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m19:35:45.579283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:45.579283 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:35:45.579283 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:35:45.725791 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:35:45.725791 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:35:45.873985 [debug] [MainThread]: Connection 'model.healthcare.src_providers' was left open.
[0m19:35:45.877626 [debug] [MainThread]: On model.healthcare.src_providers: Close
[0m19:35:46.246747 [info ] [MainThread]: 
[0m19:35:46.248757 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m19:35:46.250540 [debug] [MainThread]: Command end result
[0m19:35:46.308535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:35:46.313358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:35:46.322998 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:35:46.325953 [info ] [MainThread]: 
[0m19:35:46.327973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:35:46.327973 [info ] [MainThread]: 
[0m19:35:46.330725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:35:46.332813 [debug] [MainThread]: Command `dbt run` succeeded at 19:35:46.332813 after 7.89 seconds
[0m19:35:46.334961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C2138DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3A32C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3B897260>]}
[0m19:35:46.334961 [debug] [MainThread]: Flushing usage events
[0m19:35:47.412815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:44.965967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D25EFEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D2244DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D25EFE00>]}


============================== 19:53:44.981958 | b7510769-ce00-4721-947c-23f1848e5899 ==============================
[0m19:53:44.981958 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:53:44.981958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_transactions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:53:47.422967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7510769-ce00-4721-947c-23f1848e5899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2EC5EF470>]}
[0m19:53:47.583775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7510769-ce00-4721-947c-23f1848e5899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2EC811E20>]}
[0m19:53:47.583775 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:53:48.143963 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:53:48.411402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:48.411402 [debug] [MainThread]: Partial parsing: updated file: healthcare://models\healthcare\staging\src_transactions.sql
[0m19:53:48.959892 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.healthcare.src_transactions' (models\healthcare\staging\src_transactions.sql) depends on a source named 'raw.raw_transactions' which was not found
[0m19:53:48.959892 [debug] [MainThread]: Command `dbt run` failed at 19:53:48.959892 after 4.36 seconds
[0m19:53:48.959892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D20836B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2ECAF71D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2ECB9F710>]}
[0m19:53:48.959892 [debug] [MainThread]: Flushing usage events
[0m19:53:49.888922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:50.098248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC134B0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC131410D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC134B0410>]}


============================== 19:54:50.114190 | b78665a7-f4f9-49f0-bd7c-53a91f6b6ed6 ==============================
[0m19:54:50.114190 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:54:50.114190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_transactions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:54:52.484117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b78665a7-f4f9-49f0-bd7c-53a91f6b6ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1255BB30>]}
[0m19:54:52.641504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b78665a7-f4f9-49f0-bd7c-53a91f6b6ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2D700470>]}
[0m19:54:52.641504 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:54:53.158560 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:54:53.410353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:53.410353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:53.426090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m19:54:53.538845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b78665a7-f4f9-49f0-bd7c-53a91f6b6ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2D7016A0>]}
[0m19:54:53.680839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:54:53.696566 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:54:53.864153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b78665a7-f4f9-49f0-bd7c-53a91f6b6ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2D9E52E0>]}
[0m19:54:53.864153 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m19:54:53.864153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b78665a7-f4f9-49f0-bd7c-53a91f6b6ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC129E1400>]}
[0m19:54:53.864153 [info ] [MainThread]: 
[0m19:54:53.879856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:54:53.879856 [info ] [MainThread]: 
[0m19:54:53.882765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:54:53.882765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:54:53.990758 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:54:53.990758 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:54:53.990758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:54.841863 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.848 seconds
[0m19:54:54.850502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m19:54:54.866263 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:54:54.866263 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:54:54.866263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:55.428933 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.552 seconds
[0m19:54:55.437727 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:54:55.437727 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:54:55.548173 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.121 seconds
[0m19:54:55.563982 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:54:55.563982 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:54:55.695546 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m19:54:55.695546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m19:54:55.695546 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:54:55.695546 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:54:55.806426 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m19:54:55.806426 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:54:55.822182 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:54:55.937389 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.120 seconds
[0m19:54:55.944533 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:54:55.944533 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:54:56.048136 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m19:54:56.048136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b78665a7-f4f9-49f0-bd7c-53a91f6b6ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC12C2A4B0>]}
[0m19:54:56.048136 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m19:54:56.063933 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m19:54:56.063933 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m19:54:56.063933 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m19:54:56.082715 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m19:54:56.087900 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m19:54:56.145239 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m19:54:56.145239 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m19:54:56.145239 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || TransactionID
        when Patientid like 'HOSP2-%' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || EncounterID
        when Patientid like 'HOSP2-%' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(PatientID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add provider_id prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || ProviderID
        when Patientid like 'HOSP2-%' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || DeptID
        when Patientid like 'HOSP2-%' then 'H2-' || DeptID
        else DeptID
    end as Dept_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || Provider_ID
        when Patientid like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || dept_id
        when Patientid like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paid_amount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || claimid
        when Patientid like 'HOSP2-%' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m19:54:56.145239 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:54:56.558495 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdef5a-0000-2803-0027-cf8b0006f55e
[0m19:54:56.558495 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 4
invalid identifier 'ENCOUNTER_DATE'
[0m19:54:56.574294 [debug] [Thread-1 (]: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'ENCOUNTER_DATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m19:54:56.574294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78665a7-f4f9-49f0-bd7c-53a91f6b6ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC125A9190>]}
[0m19:54:56.574294 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_transactions ................... [[31mERROR[0m in 0.51s]
[0m19:54:56.574294 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m19:54:56.574294 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_transactions' to be skipped because of status 'error'.  Reason: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'ENCOUNTER_DATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql.
[0m19:54:56.590091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:56.590091 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:54:56.590091 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:54:56.743315 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:54:56.746938 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:54:56.885834 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m19:54:56.885834 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m19:54:57.044871 [info ] [MainThread]: 
[0m19:54:57.048013 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m19:54:57.048013 [debug] [MainThread]: Command end result
[0m19:54:57.104628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:54:57.105985 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:54:57.120754 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:54:57.120754 [info ] [MainThread]: 
[0m19:54:57.120754 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:54:57.120754 [info ] [MainThread]: 
[0m19:54:57.120754 [error] [MainThread]: [31mFailure in model src_transactions (models\healthcare\staging\src_transactions.sql)[0m
[0m19:54:57.120754 [error] [MainThread]:   Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'ENCOUNTER_DATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m19:54:57.132792 [info ] [MainThread]: 
[0m19:54:57.132792 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_transactions.sql
[0m19:54:57.222207 [info ] [MainThread]: 
[0m19:54:57.222207 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:54:57.255968 [debug] [MainThread]: Command `dbt run` failed at 19:54:57.255968 after 7.52 seconds
[0m19:54:57.255968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC11C99EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC131410D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2D655BB0>]}
[0m19:54:57.262109 [debug] [MainThread]: Flushing usage events
[0m19:54:58.181157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:17.606822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8E6CFE150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8E6CFC080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8E6CFC0B0>]}


============================== 19:57:17.612787 | 3db092ff-5a22-44b7-9c6f-f9dbf9b491f0 ==============================
[0m19:57:17.612787 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:57:17.612787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select src_transactions', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:20.120348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3db092ff-5a22-44b7-9c6f-f9dbf9b491f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8E61B3B60>]}
[0m19:57:20.275275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3db092ff-5a22-44b7-9c6f-f9dbf9b491f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8817829F0>]}
[0m19:57:20.277294 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:57:20.784734 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:57:21.055362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:57:21.071180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:57:21.074062 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m19:57:21.153420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3db092ff-5a22-44b7-9c6f-f9dbf9b491f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88192C0B0>]}
[0m19:57:21.288956 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:57:21.293688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:57:21.452337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3db092ff-5a22-44b7-9c6f-f9dbf9b491f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8E6FCBD40>]}
[0m19:57:21.452337 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m19:57:21.452337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3db092ff-5a22-44b7-9c6f-f9dbf9b491f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8FFCF4560>]}
[0m19:57:21.464781 [info ] [MainThread]: 
[0m19:57:21.464781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:21.466791 [info ] [MainThread]: 
[0m19:57:21.469630 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:57:21.471102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:57:21.597587 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:57:21.597587 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:57:21.597587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:22.600909 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.998 seconds
[0m19:57:22.615373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m19:57:22.646216 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:57:22.646216 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:57:22.648240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:23.218293 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.585 seconds
[0m19:57:23.242023 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:57:23.242868 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:57:23.364268 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.127 seconds
[0m19:57:23.364268 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:57:23.364268 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:57:23.475462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m19:57:23.478908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m19:57:23.489012 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:57:23.489012 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:57:23.594768 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m19:57:23.598235 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:57:23.598235 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:57:23.710116 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.109 seconds
[0m19:57:23.712130 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:57:23.714139 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:57:23.805096 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m19:57:23.810406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3db092ff-5a22-44b7-9c6f-f9dbf9b491f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A881AE7FB0>]}
[0m19:57:23.820480 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m19:57:23.822491 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m19:57:23.824500 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m19:57:23.826520 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m19:57:23.840415 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m19:57:23.846150 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m19:57:23.910207 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m19:57:23.918649 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m19:57:23.918649 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || TransactionID
        when Patientid like 'HOSP2-%' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || EncounterID
        when Patientid like 'HOSP2-%' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(PatientID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add provider_id prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || ProviderID
        when Patientid like 'HOSP2-%' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || DeptID
        when Patientid like 'HOSP2-%' then 'H2-' || DeptID
        else DeptID
    end as Dept_id,

    EncounterDate as encounter_date,
    EncounterType as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || ProviderID
        when Patientid like 'HOSP2-%' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || deptid
        when Patientid like 'HOSP2-%' then 'H2-' || deptid
        else deptid
    end as dept_id,
    

    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || claimid
        when Patientid like 'HOSP2-%' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m19:57:23.918649 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:57:24.554107 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdef5d-0000-27fb-0027-cf8b0006d5a6
[0m19:57:24.556138 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 4
invalid identifier 'ENCOUNTERDATE'
[0m19:57:24.568286 [debug] [Thread-1 (]: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'ENCOUNTERDATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m19:57:24.584184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3db092ff-5a22-44b7-9c6f-f9dbf9b491f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8E6619280>]}
[0m19:57:24.586239 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_transactions ................... [[31mERROR[0m in 0.75s]
[0m19:57:24.588259 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m19:57:24.590271 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_transactions' to be skipped because of status 'error'.  Reason: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'ENCOUNTERDATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql.
[0m19:57:24.594287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:24.594287 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:57:24.596298 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:57:24.747787 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m19:57:24.749807 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m19:57:24.896409 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m19:57:24.896409 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m19:57:25.060390 [info ] [MainThread]: 
[0m19:57:25.060908 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m19:57:25.062932 [debug] [MainThread]: Command end result
[0m19:57:25.125869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:57:25.135274 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:57:25.148454 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:57:25.150476 [info ] [MainThread]: 
[0m19:57:25.153074 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:57:25.157175 [info ] [MainThread]: 
[0m19:57:25.157175 [error] [MainThread]: [31mFailure in model src_transactions (models\healthcare\staging\src_transactions.sql)[0m
[0m19:57:25.166584 [error] [MainThread]:   Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'ENCOUNTERDATE'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m19:57:25.168455 [info ] [MainThread]: 
[0m19:57:25.171895 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_transactions.sql
[0m19:57:25.173384 [info ] [MainThread]: 
[0m19:57:25.175411 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:57:25.178744 [debug] [MainThread]: Command `dbt run` failed at 19:57:25.178744 after 7.91 seconds
[0m19:57:25.181613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8E3FAC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8FF63E6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8E717E300>]}
[0m19:57:25.183636 [debug] [MainThread]: Flushing usage events
[0m19:57:26.275681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:49.345311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019407069FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019407B1B140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019407F4D4C0>]}


============================== 19:59:49.345311 | d34eecc8-5c2d-4b2b-9f7c-adfbaea095a6 ==============================
[0m19:59:49.345311 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:59:49.358438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_transactions', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:59:51.867399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd34eecc8-5c2d-4b2b-9f7c-adfbaea095a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001942052A780>]}
[0m19:59:52.007235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd34eecc8-5c2d-4b2b-9f7c-adfbaea095a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019405026CF0>]}
[0m19:59:52.011005 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:59:52.601324 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:59:52.839324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:52.839324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:52.847614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m19:59:52.919698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd34eecc8-5c2d-4b2b-9f7c-adfbaea095a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019422165B50>]}
[0m19:59:53.067781 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:59:53.067781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:59:53.260014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd34eecc8-5c2d-4b2b-9f7c-adfbaea095a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019420863920>]}
[0m19:59:53.260014 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m19:59:53.260014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd34eecc8-5c2d-4b2b-9f7c-adfbaea095a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019420A735C0>]}
[0m19:59:53.275837 [info ] [MainThread]: 
[0m19:59:53.275837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:53.280277 [info ] [MainThread]: 
[0m19:59:53.280277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:59:53.284323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m19:59:53.398059 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m19:59:53.398059 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m19:59:53.398059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:54.202342 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.808 seconds
[0m19:59:54.225445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m19:59:54.233986 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:59:54.233986 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:59:54.249814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:54.865110 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.621 seconds
[0m19:59:54.865110 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:59:54.865110 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m19:59:54.995146 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.114 seconds
[0m19:59:54.999176 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m19:59:54.999176 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:59:55.099477 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m19:59:55.103519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m19:59:55.110593 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:59:55.112607 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:59:55.216601 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m19:59:55.219634 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:59:55.219634 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m19:59:55.340483 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.119 seconds
[0m19:59:55.342500 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m19:59:55.344515 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:59:55.428192 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m19:59:55.443421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd34eecc8-5c2d-4b2b-9f7c-adfbaea095a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194224FBE30>]}
[0m19:59:55.443421 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m19:59:55.443421 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m19:59:55.459389 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m19:59:55.459389 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m19:59:55.475134 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m19:59:55.480911 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m19:59:55.533093 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m19:59:55.541479 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m19:59:55.541479 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || TransactionID
        when Patientid like 'HOSP2-%' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || EncounterID
        when Patientid like 'HOSP2-%' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(PatientID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add provider_id prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || ProviderID
        when Patientid like 'HOSP2-%' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || DeptID
        when Patientid like 'HOSP2-%' then 'H2-' || DeptID
        else DeptID
    end as Dept_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Patientid like 'HOSP1-%' then 'H1-' || claimid
        when Patientid like 'HOSP2-%' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m19:59:55.541479 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:59:56.498122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.961 seconds
[0m19:59:56.546647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd34eecc8-5c2d-4b2b-9f7c-adfbaea095a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019404C19700>]}
[0m19:59:56.546647 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 1.09s]
[0m19:59:56.560371 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m19:59:56.560371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:56.560371 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m19:59:56.560371 [debug] [MainThread]: On list_DBT_DB: Close
[0m19:59:56.770707 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m19:59:56.770707 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m19:59:56.943689 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m19:59:56.943689 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m19:59:57.099006 [info ] [MainThread]: 
[0m19:59:57.099006 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m19:59:57.099006 [debug] [MainThread]: Command end result
[0m19:59:57.170507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m19:59:57.174770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m19:59:57.184325 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m19:59:57.186076 [info ] [MainThread]: 
[0m19:59:57.187732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:57.187732 [info ] [MainThread]: 
[0m19:59:57.189800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:59:57.191816 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:57.191816 after 8.19 seconds
[0m19:59:57.191816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019421EC0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019407069FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019420A719A0>]}
[0m19:59:57.193831 [debug] [MainThread]: Flushing usage events
[0m19:59:58.010623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:03.253078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9F7D0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9CBED160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9FFE95E0>]}


============================== 20:10:03.253078 | a245d23b-aa3b-4aaf-ab03-30ee57017800 ==============================
[0m20:10:03.253078 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:10:03.268811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:10:05.592921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a245d23b-aa3b-4aaf-ab03-30ee57017800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB89209E0>]}
[0m20:10:05.734231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a245d23b-aa3b-4aaf-ab03-30ee57017800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB87B42C0>]}
[0m20:10:05.734231 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:10:06.268077 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:10:06.501668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:06.517493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:06.517493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m20:10:06.591861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a245d23b-aa3b-4aaf-ab03-30ee57017800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDBA0F5EE0>]}
[0m20:10:06.726476 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:10:06.726476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:10:06.896573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a245d23b-aa3b-4aaf-ab03-30ee57017800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9D68F2C0>]}
[0m20:10:06.896573 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m20:10:06.896573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a245d23b-aa3b-4aaf-ab03-30ee57017800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB8C050D0>]}
[0m20:10:06.908708 [info ] [MainThread]: 
[0m20:10:06.908708 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:06.908708 [info ] [MainThread]: 
[0m20:10:06.912946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:06.912946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m20:10:07.031590 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m20:10:07.031590 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m20:10:07.031590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:07.961439 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.931 seconds
[0m20:10:07.976037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m20:10:07.999239 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:10:07.999239 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:10:07.999239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:08.567189 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.559 seconds
[0m20:10:08.573239 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:10:08.575257 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m20:10:08.706062 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.133 seconds
[0m20:10:08.710942 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:10:08.710942 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:10:08.800931 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m20:10:08.810502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m20:10:08.814606 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:10:08.814606 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:10:08.910296 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m20:10:08.912312 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:10:08.912312 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m20:10:09.032849 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.118 seconds
[0m20:10:09.034864 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:10:09.036875 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:10:09.131227 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m20:10:09.140528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a245d23b-aa3b-4aaf-ab03-30ee57017800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDBA5578F0>]}
[0m20:10:09.147167 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m20:10:09.147167 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_patients ................................ [RUN]
[0m20:10:09.147167 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_patients'
[0m20:10:09.156114 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m20:10:09.171373 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m20:10:09.173601 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m20:10:09.237502 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m20:10:09.239517 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m20:10:09.242424 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    Patientid as patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m20:10:09.242424 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:09.802105 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m20:10:09.853722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a245d23b-aa3b-4aaf-ab03-30ee57017800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9CCCD550>]}
[0m20:10:09.856547 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_patients ........................... [[32mSUCCESS 1[0m in 0.70s]
[0m20:10:09.857580 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m20:10:09.857580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:09.857580 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m20:10:09.857580 [debug] [MainThread]: On list_DBT_DB: Close
[0m20:10:10.002327 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m20:10:10.002327 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m20:10:10.157605 [debug] [MainThread]: Connection 'model.healthcare.src_patients' was left open.
[0m20:10:10.157605 [debug] [MainThread]: On model.healthcare.src_patients: Close
[0m20:10:10.303151 [info ] [MainThread]: 
[0m20:10:10.303151 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m20:10:10.314339 [debug] [MainThread]: Command end result
[0m20:10:10.374425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:10:10.380559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:10:10.392671 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m20:10:10.392671 [info ] [MainThread]: 
[0m20:10:10.395237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:10.395237 [info ] [MainThread]: 
[0m20:10:10.397250 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:10:10.399264 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:10.399264 after 7.53 seconds
[0m20:10:10.399264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9CBED160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9D6F8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA0011AC0>]}
[0m20:10:10.399264 [debug] [MainThread]: Flushing usage events
[0m20:10:11.394204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:23.453325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0C54E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0C54D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0C85FC80>]}


============================== 20:17:23.469061 | 5b0437e0-1a24-4c99-8790-51236e79ccb0 ==============================
[0m20:17:23.469061 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:17:23.469061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select src_departments', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:17:26.151497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b0437e0-1a24-4c99-8790-51236e79ccb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F25883830>]}
[0m20:17:26.293121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b0437e0-1a24-4c99-8790-51236e79ccb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F252EEF90>]}
[0m20:17:26.293121 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:17:26.839345 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:17:27.091940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:17:27.091940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:17:27.109416 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m20:17:27.174275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b0437e0-1a24-4c99-8790-51236e79ccb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F26E2B650>]}
[0m20:17:27.327461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:17:27.327461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:17:27.527892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b0437e0-1a24-4c99-8790-51236e79ccb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F27265550>]}
[0m20:17:27.527892 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m20:17:27.527892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b0437e0-1a24-4c99-8790-51236e79ccb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F27265490>]}
[0m20:17:27.527892 [info ] [MainThread]: 
[0m20:17:27.527892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:27.527892 [info ] [MainThread]: 
[0m20:17:27.527892 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:17:27.539952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m20:17:27.646565 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m20:17:27.646565 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m20:17:27.646565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:28.619446 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.980 seconds
[0m20:17:28.635217 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m20:17:28.650945 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:17:28.650945 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:17:28.650945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:29.342566 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.684 seconds
[0m20:17:29.350306 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:17:29.350306 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m20:17:29.461882 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.106 seconds
[0m20:17:29.461882 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:17:29.461882 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:17:29.556710 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m20:17:29.556710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m20:17:29.572438 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:17:29.572438 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:17:29.667306 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m20:17:29.667306 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:17:29.667306 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m20:17:29.808554 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.129 seconds
[0m20:17:29.808554 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:17:29.808554 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:17:29.919266 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m20:17:29.919266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b0437e0-1a24-4c99-8790-51236e79ccb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2762C290>]}
[0m20:17:29.919266 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m20:17:29.934356 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_departments ............................. [RUN]
[0m20:17:29.935382 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_departments'
[0m20:17:29.935382 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m20:17:29.935382 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m20:17:29.961929 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m20:17:30.016069 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m20:17:30.016069 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m20:17:30.016069 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    
    -- Add encounter prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPARTMENT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPARTMENT_ID
        else Department_id
    end as department_id,
    
    DEPARTMENT_Name as department_name
from RAW_DEPARTMENTS
  );
[0m20:17:30.016069 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:17:30.546983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m20:17:30.594152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b0437e0-1a24-4c99-8790-51236e79ccb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F09A496A0>]}
[0m20:17:30.594152 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_departments ........................ [[32mSUCCESS 1[0m in 0.66s]
[0m20:17:30.594152 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m20:17:30.609937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:30.609937 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m20:17:30.609937 [debug] [MainThread]: On list_DBT_DB: Close
[0m20:17:30.764248 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m20:17:30.764248 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m20:17:30.892020 [debug] [MainThread]: Connection 'model.healthcare.src_departments' was left open.
[0m20:17:30.907845 [debug] [MainThread]: On model.healthcare.src_departments: Close
[0m20:17:31.050061 [info ] [MainThread]: 
[0m20:17:31.050061 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m20:17:31.050061 [debug] [MainThread]: Command end result
[0m20:17:31.114533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:17:31.114533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:17:31.130698 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m20:17:31.130698 [info ] [MainThread]: 
[0m20:17:31.130698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:17:31.130698 [info ] [MainThread]: 
[0m20:17:31.130698 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:17:31.136911 [debug] [MainThread]: Command `dbt run` succeeded at 20:17:31.136911 after 8.00 seconds
[0m20:17:31.136911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0CA018E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F256B16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0C54D6A0>]}
[0m20:17:31.136911 [debug] [MainThread]: Flushing usage events
[0m20:17:32.002118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:29.254000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A800B03FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A800B03E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A800B03020>]}


============================== 20:53:29.269773 | 54dd97a4-6055-49cc-ad54-b67fac819e12 ==============================
[0m20:53:29.269773 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:53:29.269773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select src_claims', 'send_anonymous_usage_stats': 'True'}
[0m20:53:31.686762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54dd97a4-6055-49cc-ad54-b67fac819e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A81B33F500>]}
[0m20:53:31.811534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54dd97a4-6055-49cc-ad54-b67fac819e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A800508AA0>]}
[0m20:53:31.827330 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:53:32.375432 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:53:32.616279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:53:32.616279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:53:32.624764 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m20:53:32.698384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54dd97a4-6055-49cc-ad54-b67fac819e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A81B708530>]}
[0m20:53:32.851541 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:53:32.857162 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:53:33.015375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54dd97a4-6055-49cc-ad54-b67fac819e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A819C495E0>]}
[0m20:53:33.015375 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m20:53:33.015375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54dd97a4-6055-49cc-ad54-b67fac819e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A81B8EF7A0>]}
[0m20:53:33.015375 [info ] [MainThread]: 
[0m20:53:33.015375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:33.015375 [info ] [MainThread]: 
[0m20:53:33.032067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:53:33.032067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m20:53:33.146578 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m20:53:33.146578 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m20:53:33.146578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:34.071223 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.925 seconds
[0m20:53:34.087117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m20:53:34.102935 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:53:34.102935 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:53:34.102935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:34.668481 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.565 seconds
[0m20:53:34.684268 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:53:34.684268 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m20:53:34.806367 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.130 seconds
[0m20:53:34.822112 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:53:34.822112 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:53:34.917254 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m20:53:34.917254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m20:53:34.933041 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:53:34.933041 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:53:35.056014 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m20:53:35.059106 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:53:35.059106 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m20:53:35.387929 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.333 seconds
[0m20:53:35.387929 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:53:35.387929 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:53:35.514087 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m20:53:35.529859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54dd97a4-6055-49cc-ad54-b67fac819e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A81B55C080>]}
[0m20:53:35.529859 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m20:53:35.529859 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_claims .................................. [RUN]
[0m20:53:35.529859 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m20:53:35.529859 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m20:53:35.557236 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m20:53:35.563918 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m20:53:35.618234 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m20:53:35.618234 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m20:53:35.618234 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

 -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m20:53:35.618234 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:53:36.377038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m20:53:36.408630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54dd97a4-6055-49cc-ad54-b67fac819e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A81B52EF90>]}
[0m20:53:36.424400 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.88s]
[0m20:53:36.424400 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m20:53:36.424400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:36.424400 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m20:53:36.424400 [debug] [MainThread]: On list_DBT_DB: Close
[0m20:53:36.580411 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m20:53:36.580411 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m20:53:36.723124 [debug] [MainThread]: Connection 'model.healthcare.src_claims' was left open.
[0m20:53:36.723124 [debug] [MainThread]: On model.healthcare.src_claims: Close
[0m20:53:36.878056 [info ] [MainThread]: 
[0m20:53:36.878056 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m20:53:36.878056 [debug] [MainThread]: Command end result
[0m20:53:36.938222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:53:36.942264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:53:36.960670 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m20:53:36.960670 [info ] [MainThread]: 
[0m20:53:36.962684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:36.962684 [info ] [MainThread]: 
[0m20:53:36.967055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:53:36.970761 [debug] [MainThread]: Command `dbt run` succeeded at 20:53:36.970761 after 8.08 seconds
[0m20:53:36.970761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80139BEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A81B4B4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A81B7081D0>]}
[0m20:53:36.973090 [debug] [MainThread]: Flushing usage events
[0m20:53:37.870519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:25:12.340392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DB51FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DAFDCF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260D7FBB770>]}


============================== 21:25:12.348191 | 4d5e2eda-c88b-46fe-986d-051f34617520 ==============================
[0m21:25:12.348191 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:25:12.348191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m21:25:14.244034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d5e2eda-c88b-46fe-986d-051f34617520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DA177FE0>]}
[0m21:25:14.354343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d5e2eda-c88b-46fe-986d-051f34617520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F3686F90>]}
[0m21:25:14.358122 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:25:14.772180 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:25:14.941048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:25:14.941048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:25:14.948863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:25:15.001505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d5e2eda-c88b-46fe-986d-051f34617520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F5742C00>]}
[0m21:25:15.111433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:25:15.115217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:25:15.263479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d5e2eda-c88b-46fe-986d-051f34617520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F53E85F0>]}
[0m21:25:15.263479 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:25:15.263479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d5e2eda-c88b-46fe-986d-051f34617520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F3EA7770>]}
[0m21:25:15.265492 [info ] [MainThread]: 
[0m21:25:15.267501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:25:15.269515 [info ] [MainThread]: 
[0m21:25:15.270598 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:25:15.271718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:25:15.373374 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:25:15.373374 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:25:15.373374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:16.348114 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.975 seconds
[0m21:25:16.360226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:25:16.376099 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:25:16.377854 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:25:16.377854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:16.928147 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.554 seconds
[0m21:25:16.928147 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:25:16.928147 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:25:17.049731 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.107 seconds
[0m21:25:17.053121 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:25:17.053838 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:25:17.162734 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:25:17.166775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:25:17.172833 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:25:17.174853 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:25:17.276113 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m21:25:17.278132 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:25:17.280153 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:25:17.397908 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.118 seconds
[0m21:25:17.401941 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:25:17.401941 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:25:17.507290 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m21:25:17.512790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d5e2eda-c88b-46fe-986d-051f34617520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F5CE6030>]}
[0m21:25:17.522453 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m21:25:17.522453 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m21:25:17.524468 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m21:25:17.524468 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m21:25:17.538226 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m21:25:17.542261 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m21:25:17.580492 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m21:25:17.582500 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m21:25:17.585387 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2-%' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(PatientID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m21:25:17.586243 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:25:18.158646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:25:18.196771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5e2eda-c88b-46fe-986d-051f34617520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260D82095E0>]}
[0m21:25:18.196771 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m21:25:18.198789 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m21:25:18.201511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:18.201511 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:25:18.201511 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:25:18.351889 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:25:18.352906 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:25:18.488867 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m21:25:18.488867 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m21:25:18.678775 [info ] [MainThread]: 
[0m21:25:18.680795 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m21:25:18.680795 [debug] [MainThread]: Command end result
[0m21:25:18.716127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:25:18.718804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:25:18.728841 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:25:18.728841 [info ] [MainThread]: 
[0m21:25:18.730857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:25:18.730857 [info ] [MainThread]: 
[0m21:25:18.730857 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:25:18.732874 [debug] [MainThread]: Command `dbt run` succeeded at 21:25:18.732874 after 6.69 seconds
[0m21:25:18.732874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DB58BE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F3CD8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F560A6C0>]}
[0m21:25:18.734895 [debug] [MainThread]: Flushing usage events
[0m21:25:19.486427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:56.121615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6FEED070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA7284FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA71D65580>]}


============================== 21:30:56.130370 | 84299dca-f9f1-466a-b247-7f77347a1a2e ==============================
[0m21:30:56.130370 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:30:56.130370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m21:30:57.839793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84299dca-f9f1-466a-b247-7f77347a1a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA732CFF50>]}
[0m21:30:57.952543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84299dca-f9f1-466a-b247-7f77347a1a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA0D2EA840>]}
[0m21:30:57.954554 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:30:58.345937 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:30:58.524143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:58.524143 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:58.530170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:30:58.579790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84299dca-f9f1-466a-b247-7f77347a1a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA0D32C4A0>]}
[0m21:30:58.683446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:30:58.687348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:30:58.817293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84299dca-f9f1-466a-b247-7f77347a1a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA70993020>]}
[0m21:30:58.817293 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:30:58.817293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84299dca-f9f1-466a-b247-7f77347a1a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA0BC4A0C0>]}
[0m21:30:58.817293 [info ] [MainThread]: 
[0m21:30:58.817293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:58.817293 [info ] [MainThread]: 
[0m21:30:58.826334 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:30:58.828521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:30:58.953515 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:30:58.953515 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:30:58.953515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:59.777375 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.823 seconds
[0m21:30:59.785075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:30:59.806760 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:30:59.806760 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:30:59.808773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:00.377720 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.581 seconds
[0m21:31:00.394183 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:31:00.394183 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:31:00.508753 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.113 seconds
[0m21:31:00.512790 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:31:00.512790 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:31:00.614911 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:31:00.616651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:31:00.625048 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:31:00.625048 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:31:00.721286 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m21:31:00.733049 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:31:00.733049 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:31:00.875358 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.141 seconds
[0m21:31:00.877375 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:31:00.878893 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:31:00.978957 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m21:31:00.993799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84299dca-f9f1-466a-b247-7f77347a1a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA0D7552E0>]}
[0m21:31:00.995811 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m21:31:00.995811 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m21:31:01.002970 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m21:31:01.002970 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m21:31:01.017213 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m21:31:01.021303 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m21:31:01.057334 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m21:31:01.057334 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m21:31:01.057334 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2-%' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(PatientID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m21:31:01.057334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:31:01.912175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m21:31:01.963890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84299dca-f9f1-466a-b247-7f77347a1a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6FFCD580>]}
[0m21:31:01.963890 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.96s]
[0m21:31:01.963890 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m21:31:01.963890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:01.963890 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:31:01.963890 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:31:02.334822 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:31:02.334822 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:31:02.475104 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m21:31:02.475104 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m21:31:02.625546 [info ] [MainThread]: 
[0m21:31:02.625546 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m21:31:02.625546 [debug] [MainThread]: Command end result
[0m21:31:02.657990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:31:02.663812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:31:02.671506 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:31:02.671506 [info ] [MainThread]: 
[0m21:31:02.673513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:02.673513 [info ] [MainThread]: 
[0m21:31:02.675522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:31:02.675522 [debug] [MainThread]: Command `dbt run` succeeded at 21:31:02.675522 after 6.91 seconds
[0m21:31:02.677529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA0B5DEA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA725EEB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA731D7E00>]}
[0m21:31:02.677529 [debug] [MainThread]: Flushing usage events
[0m21:31:03.386208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:41.822978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042FAB0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042FAB04A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042FAB1700>]}


============================== 21:39:41.835387 | 4778e634-b9f6-44a2-ae23-f89e11c9d210 ==============================
[0m21:39:41.835387 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:39:41.837020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select src_transactions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:39:43.641631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4778e634-b9f6-44a2-ae23-f89e11c9d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020449C0B890>]}
[0m21:39:43.746095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4778e634-b9f6-44a2-ae23-f89e11c9d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042EBFCFE0>]}
[0m21:39:43.752237 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:39:44.354632 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:39:44.554160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:39:44.554160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:39:44.554160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m21:39:44.615880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4778e634-b9f6-44a2-ae23-f89e11c9d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020449C7FEF0>]}
[0m21:39:44.773315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:39:44.777424 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:39:44.968418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4778e634-b9f6-44a2-ae23-f89e11c9d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042D13F140>]}
[0m21:39:44.970823 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:39:44.972516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4778e634-b9f6-44a2-ae23-f89e11c9d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044A03DC70>]}
[0m21:39:44.974621 [info ] [MainThread]: 
[0m21:39:44.974621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:44.976515 [info ] [MainThread]: 
[0m21:39:44.976515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:44.979002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:39:45.057242 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:39:45.057242 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:39:45.057242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:46.122743 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.062 seconds
[0m21:39:46.138771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m21:39:46.157387 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:46.167054 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:39:46.167054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:46.743810 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.577 seconds
[0m21:39:46.762176 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:46.764190 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:39:46.883663 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.117 seconds
[0m21:39:46.893246 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:46.896116 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:39:47.011125 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m21:39:47.019264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m21:39:47.035399 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:47.039193 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:39:47.131249 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m21:39:47.131249 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:47.131249 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:39:47.272701 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.129 seconds
[0m21:39:47.281372 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:47.282780 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:39:47.388412 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m21:39:47.398514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4778e634-b9f6-44a2-ae23-f89e11c9d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020449BDCBF0>]}
[0m21:39:47.411325 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m21:39:47.418054 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m21:39:47.418054 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m21:39:47.421538 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m21:39:47.456965 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m21:39:47.460400 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m21:39:47.561102 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m21:39:47.576979 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m21:39:47.579006 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(PatientID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m21:39:47.581039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:39:48.048396 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdefc3-0000-27fb-0027-cf8b0006d8be
[0m21:39:48.050423 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'SILVER'
[0m21:39:48.066576 [debug] [Thread-1 (]: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'SILVER'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:39:48.078983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4778e634-b9f6-44a2-ae23-f89e11c9d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042FB323C0>]}
[0m21:39:48.078983 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_transactions ................... [[31mERROR[0m in 0.65s]
[0m21:39:48.084441 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m21:39:48.088694 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_transactions' to be skipped because of status 'error'.  Reason: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'SILVER'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql.
[0m21:39:48.092868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:48.092868 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:39:48.092868 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:39:48.252567 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m21:39:48.252567 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m21:39:48.402031 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m21:39:48.404053 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m21:39:48.557358 [info ] [MainThread]: 
[0m21:39:48.559378 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m21:39:48.563977 [debug] [MainThread]: Command end result
[0m21:39:48.658994 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:39:48.667053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:39:48.691421 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:39:48.693447 [info ] [MainThread]: 
[0m21:39:48.695469 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:39:48.699511 [info ] [MainThread]: 
[0m21:39:48.701540 [error] [MainThread]: [31mFailure in model src_transactions (models\healthcare\staging\src_transactions.sql)[0m
[0m21:39:48.705854 [error] [MainThread]:   Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'SILVER'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:39:48.711147 [info ] [MainThread]: 
[0m21:39:48.714712 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:39:48.715442 [info ] [MainThread]: 
[0m21:39:48.715442 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:39:48.720949 [debug] [MainThread]: Command `dbt run` failed at 21:39:48.720949 after 7.23 seconds
[0m21:39:48.724656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020449C09A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020449C6A720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044A0244D0>]}
[0m21:39:48.725879 [debug] [MainThread]: Flushing usage events
[0m21:39:50.552408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:12.085251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B70602E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B70602DD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B70682FFE0>]}


============================== 21:41:12.087003 | a0b14438-f9ef-48ab-a71b-e3d2f7da3ec7 ==============================
[0m21:41:12.087003 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:41:12.087003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m21:41:13.832778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0b14438-f9ef-48ab-a71b-e3d2f7da3ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B72082F740>]}
[0m21:41:13.934231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0b14438-f9ef-48ab-a71b-e3d2f7da3ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B72091A120>]}
[0m21:41:13.938248 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:41:14.352002 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:41:14.521041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:41:14.521041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:41:14.528516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:41:14.579112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0b14438-f9ef-48ab-a71b-e3d2f7da3ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B720A51A60>]}
[0m21:41:14.673958 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:41:14.681614 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:41:14.815287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0b14438-f9ef-48ab-a71b-e3d2f7da3ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B703EF10D0>]}
[0m21:41:14.815287 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:41:14.826607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b14438-f9ef-48ab-a71b-e3d2f7da3ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B705DFB470>]}
[0m21:41:14.829520 [info ] [MainThread]: 
[0m21:41:14.829520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:41:14.831264 [info ] [MainThread]: 
[0m21:41:14.832296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:41:14.834125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:41:14.929146 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:41:14.929146 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:41:14.929146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:15.808722 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.881 seconds
[0m21:41:15.820124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m21:41:15.835946 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:41:15.835946 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:41:15.835946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:16.447352 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.610 seconds
[0m21:41:16.447352 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:41:16.447352 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:41:16.573725 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.116 seconds
[0m21:41:16.573725 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:41:16.573725 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:41:16.670789 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m21:41:16.670789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m21:41:16.670789 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:41:16.670789 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:41:16.827825 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m21:41:16.829839 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:41:16.831856 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:41:16.938757 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.106 seconds
[0m21:41:16.940772 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:41:16.942792 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:41:17.048846 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m21:41:17.052874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b14438-f9ef-48ab-a71b-e3d2f7da3ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B720DB7860>]}
[0m21:41:17.060471 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m21:41:17.060471 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m21:41:17.062482 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m21:41:17.062482 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m21:41:17.073587 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m21:41:17.077629 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m21:41:17.128651 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m21:41:17.132530 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m21:41:17.132530 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(PatientID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m21:41:17.132530 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:17.530539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdefc5-0000-2795-0027-cf8b000720ee
[0m21:41:17.530539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'SILVER'
[0m21:41:17.536346 [debug] [Thread-1 (]: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'SILVER'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:41:17.540390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0b14438-f9ef-48ab-a71b-e3d2f7da3ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B705949160>]}
[0m21:41:17.542412 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_transactions ................... [[31mERROR[0m in 0.48s]
[0m21:41:17.542412 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m21:41:17.544433 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_transactions' to be skipped because of status 'error'.  Reason: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'SILVER'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql.
[0m21:41:17.546453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:17.548215 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:41:17.548215 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:41:17.693354 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m21:41:17.693354 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m21:41:17.832303 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m21:41:17.832303 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m21:41:17.971283 [info ] [MainThread]: 
[0m21:41:17.974145 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m21:41:17.975099 [debug] [MainThread]: Command end result
[0m21:41:18.009866 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:41:18.015055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:41:18.022346 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:41:18.022346 [info ] [MainThread]: 
[0m21:41:18.024360 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:41:18.025781 [info ] [MainThread]: 
[0m21:41:18.025781 [error] [MainThread]: [31mFailure in model src_transactions (models\healthcare\staging\src_transactions.sql)[0m
[0m21:41:18.028182 [error] [MainThread]:   Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'SILVER'
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:41:18.030117 [info ] [MainThread]: 
[0m21:41:18.034029 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:41:18.034029 [info ] [MainThread]: 
[0m21:41:18.035938 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:41:18.038562 [debug] [MainThread]: Command `dbt run` failed at 21:41:18.037574 after 6.23 seconds
[0m21:41:18.039111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B70602DD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B71F4B6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7064AE210>]}
[0m21:41:18.039111 [debug] [MainThread]: Flushing usage events
[0m21:41:18.755422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:44.300427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D08AD220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D348E330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D348D670>]}


============================== 21:43:44.300427 | 6a0e3df2-e93b-4530-956d-01547baa5edc ==============================
[0m21:43:44.300427 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:43:44.300427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:43:46.060281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a0e3df2-e93b-4530-956d-01547baa5edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EDC97380>]}
[0m21:43:46.147452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a0e3df2-e93b-4530-956d-01547baa5edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EDCF9BE0>]}
[0m21:43:46.147452 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:43:46.544117 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:43:46.747514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:43:46.747514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:43:46.747514 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:43:46.804755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a0e3df2-e93b-4530-956d-01547baa5edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EE05C110>]}
[0m21:43:46.890528 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:43:46.906255 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:43:47.048722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a0e3df2-e93b-4530-956d-01547baa5edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EBE60200>]}
[0m21:43:47.048722 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:43:47.048722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a0e3df2-e93b-4530-956d-01547baa5edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EB7B22A0>]}
[0m21:43:47.048722 [info ] [MainThread]: 
[0m21:43:47.048722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:47.048722 [info ] [MainThread]: 
[0m21:43:47.058286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:43:47.061025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:43:47.145241 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:43:47.145241 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:43:47.145241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:48.112156 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.959 seconds
[0m21:43:48.112156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m21:43:48.143792 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:43:48.143792 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:43:48.143792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:48.847935 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.708 seconds
[0m21:43:48.856512 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:43:48.856512 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:43:48.975711 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.121 seconds
[0m21:43:48.975711 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:43:48.975711 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:43:49.086644 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m21:43:49.086644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m21:43:49.102393 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:43:49.102393 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:43:49.213135 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:43:49.213135 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:43:49.213135 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:43:49.320921 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.103 seconds
[0m21:43:49.320921 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:43:49.320921 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:43:49.415865 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m21:43:49.415865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a0e3df2-e93b-4530-956d-01547baa5edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D1353050>]}
[0m21:43:49.431669 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m21:43:49.431669 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m21:43:49.431669 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m21:43:49.431669 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m21:43:49.451004 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m21:43:49.451004 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m21:43:49.496469 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m21:43:49.496469 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m21:43:49.496469 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(PatientID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m21:43:49.504568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:43:50.059884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m21:43:50.107037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0e3df2-e93b-4530-956d-01547baa5edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D0989790>]}
[0m21:43:50.107037 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 0.68s]
[0m21:43:50.107037 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m21:43:50.107037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:50.107037 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:43:50.107037 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:43:50.246244 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m21:43:50.262031 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m21:43:50.387206 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m21:43:50.387206 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m21:43:50.529625 [info ] [MainThread]: 
[0m21:43:50.529625 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m21:43:50.529625 [debug] [MainThread]: Command end result
[0m21:43:50.570888 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:43:50.576084 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:43:50.585392 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:43:50.585392 [info ] [MainThread]: 
[0m21:43:50.585392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:43:50.592425 [info ] [MainThread]: 
[0m21:43:50.592425 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:43:50.595088 [debug] [MainThread]: Command `dbt run` succeeded at 21:43:50.595088 after 6.64 seconds
[0m21:43:50.595088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D34D1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EC4BFC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D2592B70>]}
[0m21:43:50.595088 [debug] [MainThread]: Flushing usage events
[0m21:43:51.316505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:49:20.835675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCACFB1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAF4ED6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAF4EDF10>]}


============================== 21:49:20.843917 | 3c973611-4ff2-48ef-9615-d75cabf0d995 ==============================
[0m21:49:20.843917 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:49:20.850098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m21:49:22.824559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c973611-4ff2-48ef-9615-d75cabf0d995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC8CDB140>]}
[0m21:49:22.924123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c973611-4ff2-48ef-9615-d75cabf0d995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCA4305F0>]}
[0m21:49:22.924123 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:49:23.314092 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:49:23.484450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:49:23.484450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:49:23.492512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m21:49:23.541952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c973611-4ff2-48ef-9615-d75cabf0d995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCA5D79B0>]}
[0m21:49:23.650206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:49:23.653655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:49:23.789032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c973611-4ff2-48ef-9615-d75cabf0d995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCADA9C140>]}
[0m21:49:23.789032 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:49:23.797175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c973611-4ff2-48ef-9615-d75cabf0d995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC7C03CB0>]}
[0m21:49:23.797175 [info ] [MainThread]: 
[0m21:49:23.797175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:23.797175 [info ] [MainThread]: 
[0m21:49:23.797175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:49:23.797175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:49:23.896504 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:49:23.896504 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:49:23.896504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:24.738219 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.840 seconds
[0m21:49:24.746449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:49:24.762893 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:49:24.771135 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:49:24.771135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:25.334616 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.565 seconds
[0m21:49:25.334616 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:49:25.342816 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:49:25.474284 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.131 seconds
[0m21:49:25.477538 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:49:25.477538 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:49:25.572801 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m21:49:25.581171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:49:25.586462 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:49:25.586970 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:49:25.679357 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m21:49:25.681867 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:49:25.683878 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:49:25.809629 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.130 seconds
[0m21:49:25.817877 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:49:25.819464 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:49:25.921709 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m21:49:25.927737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c973611-4ff2-48ef-9615-d75cabf0d995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAFBDD6D0>]}
[0m21:49:25.940021 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m21:49:25.942742 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m21:49:25.945196 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m21:49:25.945196 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m21:49:25.965116 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m21:49:25.971967 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m21:49:26.006873 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m21:49:26.019461 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m21:49:26.021483 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    case 
        when HospitalID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when HospitalID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id
    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m21:49:26.023292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:49:26.558764 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdefcd-0000-27fb-0027-cf8b0006d906
[0m21:49:26.558764 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 4 unexpected 'case'.
[0m21:49:26.558764 [debug] [Thread-1 (]: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 4 unexpected 'case'.
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:49:26.566948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c973611-4ff2-48ef-9615-d75cabf0d995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAF4B9430>]}
[0m21:49:26.566948 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_transactions ................... [[31mERROR[0m in 0.62s]
[0m21:49:26.566948 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m21:49:26.566948 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_transactions' to be skipped because of status 'error'.  Reason: Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 4 unexpected 'case'.
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql.
[0m21:49:26.575154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:26.575154 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:49:26.575154 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:49:26.714176 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:49:26.714176 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:49:26.854128 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m21:49:26.854128 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m21:49:26.994769 [info ] [MainThread]: 
[0m21:49:26.994769 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m21:49:26.994769 [debug] [MainThread]: Command end result
[0m21:49:27.024830 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:49:27.024830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:49:27.041105 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:49:27.041105 [info ] [MainThread]: 
[0m21:49:27.041105 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:49:27.041105 [info ] [MainThread]: 
[0m21:49:27.041105 [error] [MainThread]: [31mFailure in model src_transactions (models\healthcare\staging\src_transactions.sql)[0m
[0m21:49:27.041105 [error] [MainThread]:   Database Error in model src_transactions (models\healthcare\staging\src_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 4 unexpected 'case'.
  compiled code at target\run\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:49:27.049218 [info ] [MainThread]: 
[0m21:49:27.049218 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_transactions.sql
[0m21:49:27.049218 [info ] [MainThread]: 
[0m21:49:27.055227 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:49:27.057362 [debug] [MainThread]: Command `dbt run` failed at 21:49:27.057362 after 6.57 seconds
[0m21:49:27.057362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAF984D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCA4301D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC90C0EC0>]}
[0m21:49:27.057362 [debug] [MainThread]: Flushing usage events
[0m21:49:27.762912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:11.070038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015142D1E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001513FFCC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001513FFCF5F0>]}


============================== 21:50:11.073998 | 162c3a09-c755-494b-93bd-8feb746c84fb ==============================
[0m21:50:11.073998 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:50:11.073998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:50:13.057729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '162c3a09-c755-494b-93bd-8feb746c84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515B55A0F0>]}
[0m21:50:13.165954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '162c3a09-c755-494b-93bd-8feb746c84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D5669F0>]}
[0m21:50:13.165954 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:50:13.562559 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:50:13.762836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:13.762836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:13.770916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:50:13.824217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '162c3a09-c755-494b-93bd-8feb746c84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D767D10>]}
[0m21:50:13.926334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:50:13.937643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:50:14.089511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '162c3a09-c755-494b-93bd-8feb746c84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015140C4CDA0>]}
[0m21:50:14.089511 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:50:14.091942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162c3a09-c755-494b-93bd-8feb746c84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515C073E60>]}
[0m21:50:14.093443 [info ] [MainThread]: 
[0m21:50:14.093443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:14.093443 [info ] [MainThread]: 
[0m21:50:14.097710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:14.097710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:50:14.179370 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:50:14.187532 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:50:14.187532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:15.024878 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.837 seconds
[0m21:50:15.039339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:50:15.059463 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:50:15.060986 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:50:15.060986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:15.595682 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.536 seconds
[0m21:50:15.603767 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:50:15.603767 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:50:15.710834 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.106 seconds
[0m21:50:15.712897 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:50:15.712897 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:50:15.813257 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:50:15.816852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:50:15.824958 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:50:15.824958 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:50:15.915618 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m21:50:15.923785 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:50:15.923785 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:50:16.026800 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.101 seconds
[0m21:50:16.030547 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:50:16.030547 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:50:16.129687 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m21:50:16.131702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162c3a09-c755-494b-93bd-8feb746c84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D598860>]}
[0m21:50:16.139788 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m21:50:16.139788 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_transactions ............................ [RUN]
[0m21:50:16.141799 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_transactions'
[0m21:50:16.146750 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m21:50:16.174497 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m21:50:16.178946 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m21:50:16.218803 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m21:50:16.222301 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m21:50:16.222301 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    case 
        when HospitalID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when HospitalID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id,
    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m21:50:16.224315 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:17.145243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.923 seconds
[0m21:50:17.186037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '162c3a09-c755-494b-93bd-8feb746c84fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151402197F0>]}
[0m21:50:17.186037 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_transactions ....................... [[32mSUCCESS 1[0m in 1.04s]
[0m21:50:17.186037 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m21:50:17.192716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:17.193233 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:50:17.194564 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:50:17.349741 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:50:17.349741 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:50:17.496223 [debug] [MainThread]: Connection 'model.healthcare.src_transactions' was left open.
[0m21:50:17.496223 [debug] [MainThread]: On model.healthcare.src_transactions: Close
[0m21:50:17.642843 [info ] [MainThread]: 
[0m21:50:17.642843 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m21:50:17.650957 [debug] [MainThread]: Command end result
[0m21:50:17.683569 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:50:17.683569 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:50:17.698295 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:50:17.698295 [info ] [MainThread]: 
[0m21:50:17.701369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:50:17.701369 [info ] [MainThread]: 
[0m21:50:17.703131 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:50:17.705160 [debug] [MainThread]: Command `dbt run` succeeded at 21:50:17.703131 after 6.92 seconds
[0m21:50:17.705160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D6A7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001513FFCC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001513FFCF5F0>]}
[0m21:50:17.705160 [debug] [MainThread]: Flushing usage events
[0m21:50:18.481614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:59.315842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029363535190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029363CC1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029363CC16A0>]}


============================== 21:53:59.328651 | 6e6e1df4-d3dc-4231-beb3-dd4dca914a98 ==============================
[0m21:53:59.328651 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:53:59.328651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select src_claims', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:54:01.180443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e6e1df4-d3dc-4231-beb3-dd4dca914a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937C5B9D60>]}
[0m21:54:01.297210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e6e1df4-d3dc-4231-beb3-dd4dca914a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937DEC00B0>]}
[0m21:54:01.297210 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:54:01.689656 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:54:01.865684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:54:01.865684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:54:01.865684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m21:54:01.930704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e6e1df4-d3dc-4231-beb3-dd4dca914a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937DD0AD20>]}
[0m21:54:02.024894 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:54:02.024894 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:54:02.176498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e6e1df4-d3dc-4231-beb3-dd4dca914a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937DE7B4D0>]}
[0m21:54:02.176498 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:54:02.176498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e6e1df4-d3dc-4231-beb3-dd4dca914a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029361329A00>]}
[0m21:54:02.192256 [info ] [MainThread]: 
[0m21:54:02.192256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:54:02.192256 [info ] [MainThread]: 
[0m21:54:02.197489 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:54:02.199001 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:54:02.334787 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:54:02.334787 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:54:02.334787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:03.332245 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.994 seconds
[0m21:54:03.332245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m21:54:03.362855 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:54:03.365048 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:54:03.365555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:04.018375 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.660 seconds
[0m21:54:04.026733 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:54:04.026733 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:54:04.145067 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.114 seconds
[0m21:54:04.145067 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:54:04.145067 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:54:04.241405 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m21:54:04.257245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m21:54:04.257245 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:54:04.257245 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:54:04.384024 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m21:54:04.384024 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:54:04.384024 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:54:04.510699 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.121 seconds
[0m21:54:04.510699 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:54:04.510699 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:54:04.605663 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m21:54:04.605663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e6e1df4-d3dc-4231-beb3-dd4dca914a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937E186C90>]}
[0m21:54:04.605663 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m21:54:04.621499 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_claims .................................. [RUN]
[0m21:54:04.621499 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m21:54:04.621499 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m21:54:04.627610 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m21:54:04.627610 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m21:54:04.666613 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m21:54:04.666613 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m21:54:04.666613 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

    case 
        when Hospital_ID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when Hospital_ID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id,
    
    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m21:54:04.666613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:05.099656 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdefd2-0000-27ff-0027-cf8b00066966
[0m21:54:05.099656 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 48
invalid identifier 'PATIENTID'
[0m21:54:05.099656 [debug] [Thread-1 (]: Database Error in model src_claims (models\healthcare\staging\src_claims.sql)
  000904 (42000): SQL compilation error: error line 24 at position 48
  invalid identifier 'PATIENTID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_claims.sql
[0m21:54:05.099656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6e1df4-d3dc-4231-beb3-dd4dca914a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029362DB9250>]}
[0m21:54:05.099656 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_claims ......................... [[31mERROR[0m in 0.48s]
[0m21:54:05.099656 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m21:54:05.099656 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_claims' to be skipped because of status 'error'.  Reason: Database Error in model src_claims (models\healthcare\staging\src_claims.sql)
  000904 (42000): SQL compilation error: error line 24 at position 48
  invalid identifier 'PATIENTID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_claims.sql.
[0m21:54:05.115450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:05.115450 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:54:05.115450 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:54:05.256406 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m21:54:05.256406 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m21:54:05.386227 [debug] [MainThread]: Connection 'model.healthcare.src_claims' was left open.
[0m21:54:05.386227 [debug] [MainThread]: On model.healthcare.src_claims: Close
[0m21:54:05.543913 [info ] [MainThread]: 
[0m21:54:05.559621 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m21:54:05.559621 [debug] [MainThread]: Command end result
[0m21:54:05.585247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:54:05.585247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:54:05.600367 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:54:05.600367 [info ] [MainThread]: 
[0m21:54:05.600367 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:54:05.600367 [info ] [MainThread]: 
[0m21:54:05.600367 [error] [MainThread]: [31mFailure in model src_claims (models\healthcare\staging\src_claims.sql)[0m
[0m21:54:05.600367 [error] [MainThread]:   Database Error in model src_claims (models\healthcare\staging\src_claims.sql)
  000904 (42000): SQL compilation error: error line 24 at position 48
  invalid identifier 'PATIENTID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_claims.sql
[0m21:54:05.600367 [info ] [MainThread]: 
[0m21:54:05.607915 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_claims.sql
[0m21:54:05.607915 [info ] [MainThread]: 
[0m21:54:05.607915 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:54:05.607915 [debug] [MainThread]: Command `dbt run` failed at 21:54:05.607915 after 6.61 seconds
[0m21:54:05.613419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937E684D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937DE79040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937C4DFE60>]}
[0m21:54:05.614046 [debug] [MainThread]: Flushing usage events
[0m21:54:06.334736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:30.619141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE1B61730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE1B60DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE1B613D0>]}


============================== 21:55:30.637429 | f2ccd82d-da01-44f0-bc45-b9edd0d5c165 ==============================
[0m21:55:30.637429 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:55:30.637887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select src_claims', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:32.739637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2ccd82d-da01-44f0-bc45-b9edd0d5c165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFA0C7470>]}
[0m21:55:32.868245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2ccd82d-da01-44f0-bc45-b9edd0d5c165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE0D18D70>]}
[0m21:55:32.872577 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:55:33.269171 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:55:33.440345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:55:33.440345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:55:33.458860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m21:55:33.521884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2ccd82d-da01-44f0-bc45-b9edd0d5c165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFBF0C410>]}
[0m21:55:33.619708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:55:33.633459 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:55:33.816367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2ccd82d-da01-44f0-bc45-b9edd0d5c165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDF1FB590>]}
[0m21:55:33.816367 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:55:33.816367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2ccd82d-da01-44f0-bc45-b9edd0d5c165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDF1C5BE0>]}
[0m21:55:33.824017 [info ] [MainThread]: 
[0m21:55:33.824017 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:33.828106 [info ] [MainThread]: 
[0m21:55:33.828106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:55:33.830350 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:55:33.922541 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:55:33.930788 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:55:33.930788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:34.758109 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.832 seconds
[0m21:55:34.774364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m21:55:34.792227 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:55:34.792227 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:55:34.792227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:35.391550 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.608 seconds
[0m21:55:35.411252 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:55:35.411252 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:55:35.532573 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.120 seconds
[0m21:55:35.536602 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:55:35.536602 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:55:35.627338 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m21:55:35.627338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m21:55:35.643007 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:55:35.643007 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:55:35.748294 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:55:35.748294 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:55:35.748294 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:55:35.880606 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.125 seconds
[0m21:55:35.882622 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:55:35.884638 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:55:35.989127 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m21:55:35.993351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2ccd82d-da01-44f0-bc45-b9edd0d5c165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFC633110>]}
[0m21:55:36.005067 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m21:55:36.005067 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_claims .................................. [RUN]
[0m21:55:36.005067 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_claims'
[0m21:55:36.005067 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m21:55:36.019484 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m21:55:36.023240 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m21:55:36.067230 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m21:55:36.069762 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m21:55:36.069762 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

    case 
        when Hospital_ID = 'HOSP1' then replace(Patient_ID, 'HOSP1-', 'H1-')
        when Hospital_ID = 'HOSP2' then replace(Patient_ID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else Patient_ID
    end as patient_id,
    
    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m21:55:36.071773 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:55:36.642845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m21:55:36.676263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2ccd82d-da01-44f0-bc45-b9edd0d5c165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDE839700>]}
[0m21:55:36.676263 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_claims ............................. [[32mSUCCESS 1[0m in 0.67s]
[0m21:55:36.676263 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m21:55:36.676263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:36.689330 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:55:36.689330 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:55:36.831931 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m21:55:36.833950 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m21:55:36.967999 [debug] [MainThread]: Connection 'model.healthcare.src_claims' was left open.
[0m21:55:36.970014 [debug] [MainThread]: On model.healthcare.src_claims: Close
[0m21:55:37.112312 [info ] [MainThread]: 
[0m21:55:37.112312 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m21:55:37.112312 [debug] [MainThread]: Command end result
[0m21:55:37.148983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:55:37.148983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:55:37.159497 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:55:37.159497 [info ] [MainThread]: 
[0m21:55:37.166355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:37.166355 [info ] [MainThread]: 
[0m21:55:37.167863 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:55:37.169873 [debug] [MainThread]: Command `dbt run` succeeded at 21:55:37.167863 after 6.85 seconds
[0m21:55:37.169873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDF1F92B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFBB75190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFDF1C7BF0>]}
[0m21:55:37.169873 [debug] [MainThread]: Flushing usage events
[0m21:55:37.960864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:43.756961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEFB30860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEFB30560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEFB30590>]}


============================== 21:59:43.764667 | 0c7a715b-124c-45f1-815b-760f1149f8ff ==============================
[0m21:59:43.764667 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:59:43.764667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients', 'send_anonymous_usage_stats': 'True'}
[0m21:59:45.672486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c7a715b-124c-45f1-815b-760f1149f8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C89BCB530>]}
[0m21:59:45.821292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c7a715b-124c-45f1-815b-760f1149f8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C88A5B6B0>]}
[0m21:59:45.823316 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:59:46.325006 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:59:46.567312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:59:46.568188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:59:46.578157 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m21:59:46.676803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c7a715b-124c-45f1-815b-760f1149f8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEC96C200>]}
[0m21:59:46.774607 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:59:46.774607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:59:46.922545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c7a715b-124c-45f1-815b-760f1149f8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CED228F80>]}
[0m21:59:46.922545 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:59:46.922545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7a715b-124c-45f1-815b-760f1149f8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CED187CB0>]}
[0m21:59:46.930794 [info ] [MainThread]: 
[0m21:59:46.934598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:59:46.935251 [info ] [MainThread]: 
[0m21:59:46.938170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:59:46.941201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:59:47.022533 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:59:47.022533 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:59:47.030707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:47.954912 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.931 seconds
[0m21:59:47.971994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:59:47.996518 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:59:47.996518 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:59:47.996518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:48.661301 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.662 seconds
[0m21:59:48.667987 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:59:48.667987 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:59:48.780219 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.112 seconds
[0m21:59:48.780219 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:59:48.786441 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:59:48.888950 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m21:59:48.892980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:59:48.897380 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:59:48.900007 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:59:48.996531 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m21:59:48.996531 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:59:49.002625 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:59:49.144746 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.141 seconds
[0m21:59:49.148502 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:59:49.148502 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:59:49.262315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m21:59:49.270985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7a715b-124c-45f1-815b-760f1149f8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C89BC8500>]}
[0m21:59:49.279069 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m21:59:49.279069 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_patients ................................. [RUN]
[0m21:59:49.283550 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_patients'
[0m21:59:49.283550 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m21:59:49.297577 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m21:59:49.304019 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m21:59:49.345408 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m21:59:49.345408 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m21:59:49.345408 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
    

    
    as (

with base as (
    select * 
    from DBT_DB.SILVER.src_patients
),

deduplicated as (
    select * 
    from base
    qualify row_number() over (partition by patient_id order by modified_date desc) = 1
),

final as (
    select
        patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated
)

select * from final
    )
;
[0m21:59:49.351946 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:59:51.216362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.869 seconds
[0m21:59:51.269964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7a715b-124c-45f1-815b-760f1149f8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEC7F96A0>]}
[0m21:59:51.270961 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.dim_patients ............................ [[32mSUCCESS 1[0m in 1.98s]
[0m21:59:51.270961 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m21:59:51.273797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:51.273797 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:59:51.273797 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:59:51.430627 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:59:51.430627 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:59:51.561799 [debug] [MainThread]: Connection 'model.healthcare.dim_patients' was left open.
[0m21:59:51.561799 [debug] [MainThread]: On model.healthcare.dim_patients: Close
[0m21:59:51.706891 [info ] [MainThread]: 
[0m21:59:51.706891 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m21:59:51.708901 [debug] [MainThread]: Command end result
[0m21:59:51.745487 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:59:51.747499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:59:51.758072 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:59:51.758072 [info ] [MainThread]: 
[0m21:59:51.759584 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:59:51.759584 [info ] [MainThread]: 
[0m21:59:51.759584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:59:51.763615 [debug] [MainThread]: Command `dbt run` succeeded at 21:59:51.763042 after 8.30 seconds
[0m21:59:51.763615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C89D3A5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C89D382F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8A514E90>]}
[0m21:59:51.763615 [debug] [MainThread]: Flushing usage events
[0m21:59:52.524284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:30.027575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016732860410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016732861730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016732860200>]}


============================== 00:37:30.037585 | 7569e65e-6034-4bcd-916f-019071558008 ==============================
[0m00:37:30.037585 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:37:30.037585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_providers', 'send_anonymous_usage_stats': 'True'}
[0m00:37:33.929342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7569e65e-6034-4bcd-916f-019071558008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001674A14A360>]}
[0m00:37:34.052041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7569e65e-6034-4bcd-916f-019071558008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F58A420>]}
[0m00:37:34.060180 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:37:34.561118 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:37:34.764036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:34.771427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:34.774932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m00:37:34.822236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7569e65e-6034-4bcd-916f-019071558008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001674C9B5FA0>]}
[0m00:37:34.931001 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m00:37:34.938654 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m00:37:35.112629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7569e65e-6034-4bcd-916f-019071558008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672FEBBA10>]}
[0m00:37:35.112629 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m00:37:35.116004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7569e65e-6034-4bcd-916f-019071558008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672FEB9CA0>]}
[0m00:37:35.116004 [warn ] [MainThread]: The selection criterion 'dim_providers' does not match any enabled nodes
[0m00:37:35.117994 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:37:35.121945 [debug] [MainThread]: Command end result
[0m00:37:35.150634 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m00:37:35.158876 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m00:37:35.164879 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m00:37:35.166880 [debug] [MainThread]: Command `dbt run` succeeded at 00:37:35.166880 after 5.47 seconds
[0m00:37:35.166880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001674C907980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001674C907EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001674C9078C0>]}
[0m00:37:35.166880 [debug] [MainThread]: Flushing usage events
[0m00:37:36.120930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:39:21.546535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C771CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C55AD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C543F470>]}


============================== 00:39:21.560271 | 3306068a-b82c-4a9e-b1b3-317f26f6655a ==============================
[0m00:39:21.560271 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:39:21.560575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_providers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:39:23.635176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3306068a-b82c-4a9e-b1b3-317f26f6655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C89FEF00>]}
[0m00:39:23.774642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3306068a-b82c-4a9e-b1b3-317f26f6655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E13850D0>]}
[0m00:39:23.776653 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:39:24.242226 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m00:39:24.440938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:24.440938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:24.446959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m00:39:24.510574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3306068a-b82c-4a9e-b1b3-317f26f6655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E298B230>]}
[0m00:39:24.611625 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m00:39:24.619819 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m00:39:24.767749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3306068a-b82c-4a9e-b1b3-317f26f6655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C604F260>]}
[0m00:39:24.774047 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m00:39:24.774047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3306068a-b82c-4a9e-b1b3-317f26f6655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C6015A60>]}
[0m00:39:24.775799 [warn ] [MainThread]: The selection criterion 'dim_providers' does not match any enabled nodes
[0m00:39:24.775799 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:39:24.783718 [debug] [MainThread]: Command end result
[0m00:39:24.851404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m00:39:24.856815 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m00:39:24.862788 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m00:39:24.865138 [debug] [MainThread]: Command `dbt run` succeeded at 00:39:24.865138 after 3.63 seconds
[0m00:39:24.866148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C6017B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E2A5ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E2A5B8C0>]}
[0m00:39:24.866148 [debug] [MainThread]: Flushing usage events
[0m00:39:25.666026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:22:55.904510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECD480B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECD480A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECD480860>]}


============================== 01:22:55.910415 | c78c25fb-80bd-4f1a-b40f-cf14230c1c44 ==============================
[0m01:22:55.910415 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:22:55.910415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dim_providers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:22:59.237381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c78c25fb-80bd-4f1a-b40f-cf14230c1c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE59E9190>]}
[0m01:22:59.302589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c78c25fb-80bd-4f1a-b40f-cf14230c1c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE5C8FB00>]}
[0m01:22:59.304334 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:22:59.755965 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:23:01.434188 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m01:23:01.436191 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\dim\dim_providers.sql
[0m01:23:01.436191 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\healthcare\dim\dim_provider.sql
[0m01:23:01.718813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:23:01.737390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c78c25fb-80bd-4f1a-b40f-cf14230c1c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE758AF60>]}
[0m01:23:01.806798 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:23:01.826764 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:23:01.866141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c78c25fb-80bd-4f1a-b40f-cf14230c1c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE794F4D0>]}
[0m01:23:01.866141 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:23:01.867141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78c25fb-80bd-4f1a-b40f-cf14230c1c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE7829D00>]}
[0m01:23:01.869178 [info ] [MainThread]: 
[0m01:23:01.869178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:23:01.870142 [info ] [MainThread]: 
[0m01:23:01.870142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:23:01.872557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:23:04.839614 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:23:04.839614 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:23:04.839614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:05.699822 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.860 seconds
[0m01:23:05.706926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:23:05.710940 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:23:05.715811 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:23:05.715811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:06.234453 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.529 seconds
[0m01:23:06.246065 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:23:06.246065 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:23:06.395816 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.146 seconds
[0m01:23:06.395816 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:23:06.395816 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:23:06.503762 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m01:23:06.508510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:23:06.510518 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:23:06.510518 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:23:06.806818 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.297 seconds
[0m01:23:06.806818 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:23:06.806818 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:23:06.935217 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.126 seconds
[0m01:23:06.937224 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:23:06.937224 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:23:07.037128 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m01:23:07.039137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78c25fb-80bd-4f1a-b40f-cf14230c1c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE732A4B0>]}
[0m01:23:07.042461 [debug] [Thread-1 (]: Began running node model.healthcare.dim_providers
[0m01:23:07.042461 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_providers ................................ [RUN]
[0m01:23:07.042461 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_providers'
[0m01:23:07.042461 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_providers
[0m01:23:07.055868 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_providers"
[0m01:23:07.056883 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_providers
[0m01:23:07.078423 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_providers"
[0m01:23:07.086261 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_providers"
[0m01:23:07.086261 [debug] [Thread-1 (]: On model.healthcare.dim_providers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_providers"} */
create or replace transient table DBT_DB.GOLD.dim_providers
    

    
    as (

WITH base AS (
    SELECT * 
    FROM DBT_DB.SILVER.src_providers
),

deduplicated AS (
    SELECT *
    FROM base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY provider_id ORDER BY npi DESC) = 1
),

final AS (
    SELECT
        provider_id,
        INITCAP(first_name) AS first_name,
        INITCAP(last_name) AS last_name,
        INITCAP(specialization) AS specialization,
        dept_id,
        npi,

        -- Derived: full name
        CONCAT(INITCAP(first_name), ' ', INITCAP(last_name)) AS full_name
    FROM deduplicated
)

SELECT * FROM final
    )
;
[0m01:23:07.086261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:23:08.591152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.510 seconds
[0m01:23:08.615123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78c25fb-80bd-4f1a-b40f-cf14230c1c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECA1498B0>]}
[0m01:23:08.615123 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.dim_providers ........................... [[32mSUCCESS 1[0m in 1.57s]
[0m01:23:08.615123 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_providers
[0m01:23:08.615123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:08.615123 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:23:08.615123 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:23:08.774684 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:23:08.774684 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:23:08.916516 [debug] [MainThread]: Connection 'model.healthcare.dim_providers' was left open.
[0m01:23:08.916516 [debug] [MainThread]: On model.healthcare.dim_providers: Close
[0m01:23:09.058483 [info ] [MainThread]: 
[0m01:23:09.060490 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m01:23:09.060490 [debug] [MainThread]: Command end result
[0m01:23:09.094932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:23:09.094932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:23:09.101068 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:23:09.101068 [info ] [MainThread]: 
[0m01:23:09.106444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:09.106444 [info ] [MainThread]: 
[0m01:23:09.106444 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:23:09.109514 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:09.109514 after 13.38 seconds
[0m01:23:09.110637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECD4CE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE754AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE75D4650>]}
[0m01:23:09.110637 [debug] [MainThread]: Flushing usage events
[0m01:23:09.737160 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:03.550264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579B3B9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579E4C3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579E4C35C0>]}


============================== 01:27:03.554904 | 58557de6-39ae-4489-b1f1-2ce399ff615e ==============================
[0m01:27:03.554904 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:27:03.557012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_departments', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:27:04.734394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58557de6-39ae-4489-b1f1-2ce399ff615e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B7479D60>]}
[0m01:27:04.819884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58557de6-39ae-4489-b1f1-2ce399ff615e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EA98140>]}
[0m01:27:04.822458 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:27:05.147683 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:27:05.299570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:27:05.300569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:27:05.306289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:27:05.349935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58557de6-39ae-4489-b1f1-2ce399ff615e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B8C722A0>]}
[0m01:27:05.447663 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:27:05.451661 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:27:05.575245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58557de6-39ae-4489-b1f1-2ce399ff615e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B74F3830>]}
[0m01:27:05.576289 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:27:05.577285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58557de6-39ae-4489-b1f1-2ce399ff615e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B900DA90>]}
[0m01:27:05.577285 [warn ] [MainThread]: The selection criterion 'dim_departments' does not match any enabled nodes
[0m01:27:05.579283 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:27:05.582326 [debug] [MainThread]: Command end result
[0m01:27:05.610644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:27:05.613648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:27:05.618602 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:27:05.619603 [debug] [MainThread]: Command `dbt run` succeeded at 01:27:05.619603 after 2.26 seconds
[0m01:27:05.620604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579C0B99A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579B3B9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B8A0A840>]}
[0m01:27:05.620604 [debug] [MainThread]: Flushing usage events
[0m01:27:06.334025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:40.536534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F918B8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F91A13E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F91A12A20>]}


============================== 01:27:40.541517 | 5d081754-643d-44f3-93aa-7a9521363dce ==============================
[0m01:27:40.541517 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:27:40.542518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_departments', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:27:41.828680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d081754-643d-44f3-93aa-7a9521363dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FAB9FAFC0>]}
[0m01:27:41.917570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d081754-643d-44f3-93aa-7a9521363dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FABC12E10>]}
[0m01:27:41.920214 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:27:42.250014 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:27:42.403529 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m01:27:42.404652 [debug] [MainThread]: Partial parsing: added file: healthcare://models\healthcare\dim\dim_departments.sql
[0m01:27:42.404652 [debug] [MainThread]: Partial parsing: deleted file: healthcare://models\healthcare\dim\dim_department.sql
[0m01:27:42.734809 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.healthcare.department_revenue_summary' (models\healthcare\fact\department_revenue_summary.sql) depends on a node named 'dim_department' which was not found
[0m01:27:42.737033 [debug] [MainThread]: Command `dbt run` failed at 01:27:42.736709 after 2.39 seconds
[0m01:27:42.737033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F90FFBB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F91A58080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FAC02A6C0>]}
[0m01:27:42.737033 [debug] [MainThread]: Flushing usage events
[0m01:27:43.461559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:28:46.102036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFF52D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F821EDA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F82938410>]}


============================== 01:28:46.109928 | 544c31b0-1a59-41ee-9a3c-9e049efdee31 ==============================
[0m01:28:46.109928 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:28:46.110929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_departments', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:28:47.389747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '544c31b0-1a59-41ee-9a3c-9e049efdee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9B4C1850>]}
[0m01:28:47.478155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '544c31b0-1a59-41ee-9a3c-9e049efdee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9C9B0260>]}
[0m01:28:47.480166 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:28:47.811682 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:28:47.962774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:47.963776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:47.969776 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:28:48.014994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '544c31b0-1a59-41ee-9a3c-9e049efdee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F8298B650>]}
[0m01:28:48.102899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:28:48.105906 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:28:48.227747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '544c31b0-1a59-41ee-9a3c-9e049efdee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9C709C10>]}
[0m01:28:48.227747 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:28:48.228749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '544c31b0-1a59-41ee-9a3c-9e049efdee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9AEA9370>]}
[0m01:28:48.230749 [info ] [MainThread]: 
[0m01:28:48.231749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:28:48.232746 [info ] [MainThread]: 
[0m01:28:48.233747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:28:48.234761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:28:48.317227 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:28:48.318228 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:28:48.318228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:49.064691 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.746 seconds
[0m01:28:49.072546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:28:49.084345 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:28:49.084345 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:28:49.084345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:49.482535 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.397 seconds
[0m01:28:49.486528 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:28:49.486528 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:28:49.616742 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.130 seconds
[0m01:28:49.618802 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:28:49.619801 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:28:49.904175 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.285 seconds
[0m01:28:49.905771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:28:49.910791 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:28:49.910791 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:28:50.200772 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.289 seconds
[0m01:28:50.202769 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:28:50.202769 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:28:50.336859 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.134 seconds
[0m01:28:50.338875 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:28:50.339875 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:28:50.447982 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.108 seconds
[0m01:28:50.450984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '544c31b0-1a59-41ee-9a3c-9e049efdee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9CCE8980>]}
[0m01:28:50.455983 [debug] [Thread-1 (]: Began running node model.healthcare.dim_departments
[0m01:28:50.455983 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_departments .............................. [RUN]
[0m01:28:50.457109 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_departments'
[0m01:28:50.457985 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_departments
[0m01:28:50.463812 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_departments"
[0m01:28:50.465812 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_departments
[0m01:28:50.493777 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_departments"
[0m01:28:50.495779 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_departments"
[0m01:28:50.496775 [debug] [Thread-1 (]: On model.healthcare.dim_departments: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_departments"} */
create or replace transient table DBT_DB.GOLD.dim_departments
    

    
    as (

WITH deduplicated_departments AS (
    SELECT DISTINCT department_id, department_name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    department_id AS department_key,
    INITCAP(department_name) AS department_name
FROM deduplicated_departments
    )
;
[0m01:28:50.496775 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:28:51.850097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.353 seconds
[0m01:28:51.867907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '544c31b0-1a59-41ee-9a3c-9e049efdee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFF60D1C0>]}
[0m01:28:51.867907 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.dim_departments ......................... [[32mSUCCESS 1[0m in 1.41s]
[0m01:28:51.868908 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_departments
[0m01:28:51.870914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:51.870914 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:28:51.870914 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:28:52.030973 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:28:52.031979 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:28:52.175504 [debug] [MainThread]: Connection 'model.healthcare.dim_departments' was left open.
[0m01:28:52.175504 [debug] [MainThread]: On model.healthcare.dim_departments: Close
[0m01:28:52.324188 [info ] [MainThread]: 
[0m01:28:52.324188 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m01:28:52.325183 [debug] [MainThread]: Command end result
[0m01:28:52.349048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:28:52.352048 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:28:52.357048 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:28:52.357048 [info ] [MainThread]: 
[0m01:28:52.358040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:52.359042 [info ] [MainThread]: 
[0m01:28:52.359042 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:28:52.360044 [debug] [MainThread]: Command `dbt run` succeeded at 01:28:52.360044 after 6.55 seconds
[0m01:28:52.361043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F82444110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9CED9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F81A6F530>]}
[0m01:28:52.362380 [debug] [MainThread]: Flushing usage events
[0m01:28:52.997054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:03.288145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C53AD1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C834ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C87A8230>]}


============================== 01:37:03.293145 | a7b5ccff-17fe-4b12-8a8c-6563a1c6e0c3 ==============================
[0m01:37:03.293145 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:37:03.294145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_cptcodes', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:37:04.525276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7b5ccff-17fe-4b12-8a8c-6563a1c6e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E13E6C00>]}
[0m01:37:04.621538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7b5ccff-17fe-4b12-8a8c-6563a1c6e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E15A22A0>]}
[0m01:37:04.623503 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:37:04.990572 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:37:05.158984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:37:05.158984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:37:05.165983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:37:05.213201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7b5ccff-17fe-4b12-8a8c-6563a1c6e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E29C5730>]}
[0m01:37:05.312529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:37:05.315529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:37:05.464531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7b5ccff-17fe-4b12-8a8c-6563a1c6e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E2D17830>]}
[0m01:37:05.465533 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:37:05.467531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b5ccff-17fe-4b12-8a8c-6563a1c6e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E2D4D190>]}
[0m01:37:05.471125 [info ] [MainThread]: 
[0m01:37:05.474124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:05.475119 [info ] [MainThread]: 
[0m01:37:05.477120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:37:05.479119 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:37:05.571123 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:37:05.572111 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:37:05.573090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:06.410307 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.838 seconds
[0m01:37:06.416346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:37:06.426181 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:37:06.426181 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:37:06.427192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:07.069481 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.643 seconds
[0m01:37:07.073642 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:37:07.073642 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:37:07.196415 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.123 seconds
[0m01:37:07.198414 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:37:07.198414 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:37:07.289465 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m01:37:07.290465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:37:07.293461 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:37:07.293461 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:37:07.385261 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m01:37:07.387508 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:37:07.387508 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:37:07.489861 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.102 seconds
[0m01:37:07.491860 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:37:07.491860 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:37:07.578622 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m01:37:07.580616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b5ccff-17fe-4b12-8a8c-6563a1c6e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E31A7950>]}
[0m01:37:07.585603 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m01:37:07.585603 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_cptcodes ................................. [RUN]
[0m01:37:07.591327 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_cptcodes'
[0m01:37:07.591327 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m01:37:07.597306 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m01:37:07.598306 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m01:37:07.623887 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m01:37:07.625890 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m01:37:07.625890 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
    

    
    as (

WITH cleaned_cpt AS (

    SELECT DISTINCT
        cpt_codes AS cpt_code,
        INITCAP(procedure_code_category) AS category,
        INITCAP(procedure_code_descriptions) AS description
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE cpt_codes IS NOT NULL
)

SELECT * FROM cleaned_cpt
    )
;
[0m01:37:07.626938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:37:09.121232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m01:37:09.142635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b5ccff-17fe-4b12-8a8c-6563a1c6e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C54896D0>]}
[0m01:37:09.143658 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.dim_cptcodes ............................ [[32mSUCCESS 1[0m in 1.55s]
[0m01:37:09.144634 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m01:37:09.146589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:09.146589 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:37:09.146589 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:37:09.275160 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:37:09.275160 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:37:09.404716 [debug] [MainThread]: Connection 'model.healthcare.dim_cptcodes' was left open.
[0m01:37:09.405583 [debug] [MainThread]: On model.healthcare.dim_cptcodes: Close
[0m01:37:09.536186 [info ] [MainThread]: 
[0m01:37:09.537184 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m01:37:09.538115 [debug] [MainThread]: Command end result
[0m01:37:09.560320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:37:09.563320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:37:09.569327 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:37:09.569327 [info ] [MainThread]: 
[0m01:37:09.570321 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:09.571319 [info ] [MainThread]: 
[0m01:37:09.572320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:37:09.575322 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:09.574323 after 6.52 seconds
[0m01:37:09.575322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C5547D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C70D8E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E2D175C0>]}
[0m01:37:09.576318 [debug] [MainThread]: Flushing usage events
[0m01:37:10.369149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:58.795940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5EEEC530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5EEEC920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5FB513A0>]}


============================== 01:39:58.802240 | 9d870c99-8c48-48f9-96d5-7c0a025ad732 ==============================
[0m01:39:58.802240 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:39:58.803241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select department_revenue_summary', 'send_anonymous_usage_stats': 'True'}
[0m01:40:00.053204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d870c99-8c48-48f9-96d5-7c0a025ad732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5ECF8620>]}
[0m01:40:00.156299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d870c99-8c48-48f9-96d5-7c0a025ad732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5F35C3E0>]}
[0m01:40:00.158302 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:40:00.494790 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:40:00.658123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:40:00.659123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:40:00.664953 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:40:00.707564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d870c99-8c48-48f9-96d5-7c0a025ad732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF79EF4770>]}
[0m01:40:00.801563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:40:00.804564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:40:00.923479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d870c99-8c48-48f9-96d5-7c0a025ad732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF77F259D0>]}
[0m01:40:00.923479 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:40:00.924467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d870c99-8c48-48f9-96d5-7c0a025ad732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF77C96E70>]}
[0m01:40:00.926425 [info ] [MainThread]: 
[0m01:40:00.927472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:00.928469 [info ] [MainThread]: 
[0m01:40:00.929428 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:40:00.931772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:40:01.007847 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:40:01.007847 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:40:01.008851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:01.828726 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.820 seconds
[0m01:40:01.835480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m01:40:01.843536 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:40:01.844440 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:40:01.844440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:02.398492 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.555 seconds
[0m01:40:02.403020 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:40:02.404020 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:40:02.549858 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.145 seconds
[0m01:40:02.551930 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:40:02.551930 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:40:02.651784 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m01:40:02.653800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m01:40:02.656800 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:40:02.656800 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:40:02.760104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m01:40:02.761088 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:40:02.762094 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:40:02.888134 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.125 seconds
[0m01:40:02.889136 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:40:02.890135 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:40:02.989543 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m01:40:02.992558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d870c99-8c48-48f9-96d5-7c0a025ad732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7A034D40>]}
[0m01:40:02.996541 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:40:02.996541 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.department_revenue_summary ................... [RUN]
[0m01:40:02.997559 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.department_revenue_summary'
[0m01:40:02.998560 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:40:03.004738 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:40:03.006721 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:40:03.035994 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:40:03.037889 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:40:03.038998 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
    

    
    as (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        dept_id,
        COALESCE(amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.dept_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.dept_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        dept_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY dept_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
    )
;
[0m01:40:03.038998 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:03.661946 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf0b4-0000-27d7-0027-cf8b0006eb5e
[0m01:40:03.662949 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 8
invalid identifier 'DEPT_ID'
[0m01:40:03.678519 [debug] [Thread-1 (]: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:40:03.680520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d870c99-8c48-48f9-96d5-7c0a025ad732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5EC38FE0>]}
[0m01:40:03.681520 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.department_revenue_summary .......... [[31mERROR[0m in 0.68s]
[0m01:40:03.682519 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:40:03.682519 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.department_revenue_summary' to be skipped because of status 'error'.  Reason: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql.
[0m01:40:03.685306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:03.686321 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:40:03.686321 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:40:03.838016 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m01:40:03.839033 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m01:40:03.974386 [debug] [MainThread]: Connection 'model.healthcare.department_revenue_summary' was left open.
[0m01:40:03.975385 [debug] [MainThread]: On model.healthcare.department_revenue_summary: Close
[0m01:40:04.105159 [info ] [MainThread]: 
[0m01:40:04.106159 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m01:40:04.107157 [debug] [MainThread]: Command end result
[0m01:40:04.131754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:40:04.134761 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:40:04.141756 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:40:04.141756 [info ] [MainThread]: 
[0m01:40:04.142757 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:40:04.143756 [info ] [MainThread]: 
[0m01:40:04.144755 [error] [MainThread]: [31mFailure in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)[0m
[0m01:40:04.145758 [error] [MainThread]:   Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:40:04.146757 [info ] [MainThread]: 
[0m01:40:04.147757 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:40:04.148761 [info ] [MainThread]: 
[0m01:40:04.153757 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:40:04.155759 [debug] [MainThread]: Command `dbt run` failed at 01:40:04.154756 after 5.56 seconds
[0m01:40:04.156755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF79D1F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5FB509B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5FB513A0>]}
[0m01:40:04.156755 [debug] [MainThread]: Flushing usage events
[0m01:40:04.803616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:54.338035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1587ECF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15BBF16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15BBF2DE0>]}


============================== 01:40:54.343042 | b427d8d1-9086-4be5-a143-5ce93e27bbd9 ==============================
[0m01:40:54.343042 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:40:54.344036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select department_revenue_summary', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:40:55.719445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b427d8d1-9086-4be5-a143-5ce93e27bbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A174626E70>]}
[0m01:40:55.811545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b427d8d1-9086-4be5-a143-5ce93e27bbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1745EFB00>]}
[0m01:40:55.813541 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:40:56.151334 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:40:56.309468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:40:56.310213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:40:56.316447 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:40:56.359018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b427d8d1-9086-4be5-a143-5ce93e27bbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A175DBD5B0>]}
[0m01:40:56.449852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:40:56.452851 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:40:56.568451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b427d8d1-9086-4be5-a143-5ce93e27bbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A174200FB0>]}
[0m01:40:56.569451 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:40:56.570452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b427d8d1-9086-4be5-a143-5ce93e27bbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15928B380>]}
[0m01:40:56.572448 [info ] [MainThread]: 
[0m01:40:56.573448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:56.574448 [info ] [MainThread]: 
[0m01:40:56.575448 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:40:56.577669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:40:56.653468 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:40:56.654469 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:40:56.654469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:57.415032 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.760 seconds
[0m01:40:57.421031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m01:40:57.431334 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:40:57.431334 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:40:57.431334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:57.994984 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.563 seconds
[0m01:40:57.998619 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:40:57.998619 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:40:58.112287 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.113 seconds
[0m01:40:58.114748 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:40:58.114748 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:40:58.205804 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m01:40:58.207804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m01:40:58.209802 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:40:58.209802 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:40:58.303290 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m01:40:58.305378 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:40:58.305378 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:40:58.413567 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.108 seconds
[0m01:40:58.415569 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:40:58.415569 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:40:58.505826 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m01:40:58.507823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b427d8d1-9086-4be5-a143-5ce93e27bbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1741689B0>]}
[0m01:40:58.512807 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:40:58.512807 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.department_revenue_summary ................... [RUN]
[0m01:40:58.513911 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.department_revenue_summary'
[0m01:40:58.513911 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:40:58.519902 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:40:58.520903 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:40:58.548568 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:40:58.550567 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:40:58.551569 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
    

    
    as (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        dept_id,
        COALESCE(amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.dept_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.dept_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY dept_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
    )
;
[0m01:40:58.551569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:59.225444 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf0b4-0000-27ff-0027-cf8b00066ab6
[0m01:40:59.225444 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 8
invalid identifier 'DEPT_ID'
[0m01:40:59.228473 [debug] [Thread-1 (]: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:40:59.230128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b427d8d1-9086-4be5-a143-5ce93e27bbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A176702960>]}
[0m01:40:59.231218 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.department_revenue_summary .......... [[31mERROR[0m in 0.71s]
[0m01:40:59.232187 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:40:59.232187 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.department_revenue_summary' to be skipped because of status 'error'.  Reason: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql.
[0m01:40:59.234176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:59.234176 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:40:59.235169 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:40:59.404783 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m01:40:59.404783 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m01:40:59.543471 [debug] [MainThread]: Connection 'model.healthcare.department_revenue_summary' was left open.
[0m01:40:59.543471 [debug] [MainThread]: On model.healthcare.department_revenue_summary: Close
[0m01:40:59.674077 [info ] [MainThread]: 
[0m01:40:59.675077 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m01:40:59.676077 [debug] [MainThread]: Command end result
[0m01:40:59.707510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:40:59.709508 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:40:59.717507 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:40:59.717507 [info ] [MainThread]: 
[0m01:40:59.718510 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:40:59.719509 [info ] [MainThread]: 
[0m01:40:59.719509 [error] [MainThread]: [31mFailure in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)[0m
[0m01:40:59.720512 [error] [MainThread]:   Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:40:59.721546 [info ] [MainThread]: 
[0m01:40:59.721546 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:40:59.722541 [info ] [MainThread]: 
[0m01:40:59.722541 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:40:59.724511 [debug] [MainThread]: Command `dbt run` failed at 01:40:59.724511 after 5.58 seconds
[0m01:40:59.724511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1736E2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A175DBF470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17618FEC0>]}
[0m01:40:59.725509 [debug] [MainThread]: Flushing usage events
[0m01:41:00.406753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:36.075715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255B20D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255B20C1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255B35B290>]}


============================== 01:43:36.075715 | 5855ebf9-eb98-47c8-a232-283c955c2ce3 ==============================
[0m01:43:36.075715 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:43:36.075715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select department_revenue_summary', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:43:37.381869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5855ebf9-eb98-47c8-a232-283c955c2ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002257351DB50>]}
[0m01:43:37.479021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5855ebf9-eb98-47c8-a232-283c955c2ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255BA7A660>]}
[0m01:43:37.480920 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:43:37.816762 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:43:37.974630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:43:37.974630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:43:37.974630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:43:38.027965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5855ebf9-eb98-47c8-a232-283c955c2ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022575C46810>]}
[0m01:43:38.125429 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:43:38.125429 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:43:38.240943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5855ebf9-eb98-47c8-a232-283c955c2ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022575BFE5D0>]}
[0m01:43:38.240943 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:43:38.240943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5855ebf9-eb98-47c8-a232-283c955c2ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225744F32C0>]}
[0m01:43:38.240943 [info ] [MainThread]: 
[0m01:43:38.240943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:43:38.240943 [info ] [MainThread]: 
[0m01:43:38.240943 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:43:38.256636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:43:38.342894 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:43:38.343894 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:43:38.343894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:39.108305 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.775 seconds
[0m01:43:39.124004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:43:39.124004 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:43:39.124004 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:43:39.124004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:39.794539 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.660 seconds
[0m01:43:39.794539 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:43:39.794539 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:43:39.905560 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.107 seconds
[0m01:43:39.905560 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:43:39.905560 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:43:40.000227 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m01:43:40.000227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:43:40.000227 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:43:40.000227 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:43:40.094684 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m01:43:40.094684 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:43:40.094684 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:43:40.205605 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.114 seconds
[0m01:43:40.205605 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:43:40.205605 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:43:40.307445 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m01:43:40.309339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5855ebf9-eb98-47c8-a232-283c955c2ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225764F5CD0>]}
[0m01:43:40.312863 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:43:40.312863 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.department_revenue_summary ................... [RUN]
[0m01:43:40.312863 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.department_revenue_summary'
[0m01:43:40.312863 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:43:40.312863 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:43:40.312863 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:43:40.347906 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:43:40.347906 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:43:40.347906 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
    

    
    as (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        department_id,
        COALESCE(amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.department_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.department_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY department_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
    )
;
[0m01:43:40.347906 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:43:41.019880 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf0b7-0000-27fb-0027-cf8b0006daaa
[0m01:43:41.019880 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 17
invalid identifier 'AMOUNT'
[0m01:43:41.019880 [debug] [Thread-1 (]: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 11 at position 17
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:43:41.019880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5855ebf9-eb98-47c8-a232-283c955c2ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255AB29400>]}
[0m01:43:41.035624 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.department_revenue_summary .......... [[31mERROR[0m in 0.71s]
[0m01:43:41.035624 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:43:41.035624 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.department_revenue_summary' to be skipped because of status 'error'.  Reason: Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 11 at position 17
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql.
[0m01:43:41.035624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:41.035624 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:43:41.035624 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:43:41.168206 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:43:41.168206 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:43:41.289406 [debug] [MainThread]: Connection 'model.healthcare.department_revenue_summary' was left open.
[0m01:43:41.289406 [debug] [MainThread]: On model.healthcare.department_revenue_summary: Close
[0m01:43:41.428404 [info ] [MainThread]: 
[0m01:43:41.444574 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m01:43:41.444574 [debug] [MainThread]: Command end result
[0m01:43:41.465753 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:43:41.467747 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:43:41.473259 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:43:41.473259 [info ] [MainThread]: 
[0m01:43:41.474259 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:43:41.475258 [info ] [MainThread]: 
[0m01:43:41.475258 [error] [MainThread]: [31mFailure in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)[0m
[0m01:43:41.476259 [error] [MainThread]:   Database Error in model department_revenue_summary (models\healthcare\fact\department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 11 at position 17
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:43:41.476259 [info ] [MainThread]: 
[0m01:43:41.477259 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\department_revenue_summary.sql
[0m01:43:41.477259 [info ] [MainThread]: 
[0m01:43:41.478258 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:43:41.479260 [debug] [MainThread]: Command `dbt run` failed at 01:43:41.479260 after 5.61 seconds
[0m01:43:41.481259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255B35B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255BA30C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255BA31640>]}
[0m01:43:41.481259 [debug] [MainThread]: Flushing usage events
[0m01:43:42.116686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:04.400274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8EC1D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8EFD1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8EFD1C40>]}


============================== 01:45:04.408408 | 27a020fc-6515-4e8f-a67a-c6632d3d7c3e ==============================
[0m01:45:04.408408 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:45:04.408408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select department_revenue_summary', 'send_anonymous_usage_stats': 'True'}
[0m01:45:05.743843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27a020fc-6515-4e8f-a67a-c6632d3d7c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCABFFF5C0>]}
[0m01:45:05.832246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27a020fc-6515-4e8f-a67a-c6632d3d7c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCAC06BF50>]}
[0m01:45:05.832246 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:45:06.188930 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:45:06.347082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:45:06.347082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:45:06.347082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:45:06.409636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27a020fc-6515-4e8f-a67a-c6632d3d7c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCAC237A10>]}
[0m01:45:06.503871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:45:06.507051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:45:06.611787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27a020fc-6515-4e8f-a67a-c6632d3d7c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8F689850>]}
[0m01:45:06.611787 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:45:06.611787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27a020fc-6515-4e8f-a67a-c6632d3d7c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCAA58EE70>]}
[0m01:45:06.619056 [info ] [MainThread]: 
[0m01:45:06.621068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:06.621068 [info ] [MainThread]: 
[0m01:45:06.621068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:45:06.621068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:45:06.706135 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:45:06.706135 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:45:06.707134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:07.521781 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.815 seconds
[0m01:45:07.527304 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:45:07.537343 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:45:07.537343 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:45:07.537343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:07.866274 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.329 seconds
[0m01:45:07.868283 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:45:07.868283 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:45:07.967586 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.107 seconds
[0m01:45:07.967586 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:45:07.967586 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:45:08.078502 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m01:45:08.078502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:45:08.078502 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:45:08.078502 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:45:08.181000 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m01:45:08.181000 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:45:08.181000 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:45:08.295431 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.110 seconds
[0m01:45:08.297441 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:45:08.297441 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:45:08.371169 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m01:45:08.371169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27a020fc-6515-4e8f-a67a-c6632d3d7c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCACA192B0>]}
[0m01:45:08.386929 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:45:08.386929 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.department_revenue_summary ................... [RUN]
[0m01:45:08.386929 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.department_revenue_summary'
[0m01:45:08.386929 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:45:08.386929 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:45:08.386929 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:45:08.420126 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:45:08.420126 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:45:08.420126 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
    

    
    as (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        department_id,
        COALESCE(CHARGE_amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.department_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.department_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY department_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
    )
;
[0m01:45:08.420126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:45:10.018286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.589 seconds
[0m01:45:10.038224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27a020fc-6515-4e8f-a67a-c6632d3d7c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCACAED310>]}
[0m01:45:10.038224 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.department_revenue_summary .............. [[32mSUCCESS 1[0m in 1.65s]
[0m01:45:10.038224 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:45:10.038224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:10.038224 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:45:10.038224 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:45:10.168593 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:45:10.168593 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:45:10.318608 [debug] [MainThread]: Connection 'model.healthcare.department_revenue_summary' was left open.
[0m01:45:10.318608 [debug] [MainThread]: On model.healthcare.department_revenue_summary: Close
[0m01:45:10.451423 [info ] [MainThread]: 
[0m01:45:10.451423 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m01:45:10.451423 [debug] [MainThread]: Command end result
[0m01:45:10.474821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:45:10.474821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:45:10.489721 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:45:10.489721 [info ] [MainThread]: 
[0m01:45:10.490718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:45:10.490718 [info ] [MainThread]: 
[0m01:45:10.491762 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:45:10.492759 [debug] [MainThread]: Command `dbt run` succeeded at 01:45:10.492759 after 6.29 seconds
[0m01:45:10.493759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC910E6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC917D3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC920215E0>]}
[0m01:45:10.493759 [debug] [MainThread]: Flushing usage events
[0m01:45:11.303644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:48:13.689279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FFF0D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023382FE7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023382FE62A0>]}


============================== 01:48:13.694343 | 135fd671-fa69-4a3e-b805-df6e33944cdd ==============================
[0m01:48:13.694343 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:48:13.696341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select claims_status_metrics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:48:15.045492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '135fd671-fa69-4a3e-b805-df6e33944cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002339B42D160>]}
[0m01:48:15.142647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '135fd671-fa69-4a3e-b805-df6e33944cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FFC9F1A0>]}
[0m01:48:15.144644 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:48:15.572652 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:48:15.756042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:48:15.756042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:48:15.763907 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:48:15.813402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '135fd671-fa69-4a3e-b805-df6e33944cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002339DD556A0>]}
[0m01:48:15.911223 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:48:15.915183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:48:16.053337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '135fd671-fa69-4a3e-b805-df6e33944cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002339BC85190>]}
[0m01:48:16.054345 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:48:16.055337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '135fd671-fa69-4a3e-b805-df6e33944cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233811C9610>]}
[0m01:48:16.058744 [info ] [MainThread]: 
[0m01:48:16.059977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:48:16.060934 [info ] [MainThread]: 
[0m01:48:16.061938 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:48:16.063935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:48:16.182431 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:48:16.183430 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:48:16.183430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:16.968651 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.785 seconds
[0m01:48:16.976268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:48:16.986392 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:48:16.986392 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:48:16.986392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:17.346203 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.360 seconds
[0m01:48:17.351203 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:48:17.351203 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:48:17.501328 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.149 seconds
[0m01:48:17.503295 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:48:17.503295 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:48:17.608347 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m01:48:17.610017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:48:17.612132 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:48:17.612132 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:48:17.723238 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m01:48:17.724241 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:48:17.725242 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:48:17.843626 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.118 seconds
[0m01:48:17.845621 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:48:17.846621 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:48:17.940582 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m01:48:17.944967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '135fd671-fa69-4a3e-b805-df6e33944cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002339DEEC0E0>]}
[0m01:48:17.951060 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:48:17.952105 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.claims_status_metrics ........................ [RUN]
[0m01:48:17.954114 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.claims_status_metrics'
[0m01:48:17.954114 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:48:17.965520 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:48:17.967526 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:48:18.002481 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:48:18.005482 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:48:18.005482 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
    

    
    as (

WITH base_claims AS (
    SELECT
        claim_id,
        claim_status,
        claim_date,
        paid_amount,
        claim_amount,
        coalesce(claim_date, inserted_date) AS submission_date,
        coalesce(paid_amount, 0) AS paid_amt,
        try_to_date(paid_date) AS paid_date
    FROM DBT_DB.SILVER.src_claims
),

metrics AS (
    SELECT
        claim_id,
        INITCAP(claim_status) AS claim_status,
        submission_date,
        paid_date,
        claim_amount,
        paid_amt AS paid_amount,

        -- Time between claim submission and payment
        DATEDIFF('day', submission_date, paid_date) AS days_to_payment,

        -- Flag for denied claims
        CASE 
            WHEN lower(claim_status) IN ('denied', 'rejected') THEN 1
            ELSE 0
        END AS is_denied
    FROM base_claims
)

SELECT * FROM metrics
    )
;
[0m01:48:18.006482 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:48:18.410562 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf0bc-0000-27fb-0027-cf8b0006dace
[0m01:48:18.410562 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 29
invalid identifier 'INSERTED_DATE'
[0m01:48:18.413681 [debug] [Thread-1 (]: Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  000904 (42000): SQL compilation error: error line 14 at position 29
  invalid identifier 'INSERTED_DATE'
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:48:18.416679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135fd671-fa69-4a3e-b805-df6e33944cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023382C19370>]}
[0m01:48:18.417672 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.claims_status_metrics ............... [[31mERROR[0m in 0.46s]
[0m01:48:18.418680 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:48:18.418680 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.claims_status_metrics' to be skipped because of status 'error'.  Reason: Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  000904 (42000): SQL compilation error: error line 14 at position 29
  invalid identifier 'INSERTED_DATE'
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql.
[0m01:48:18.421677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:18.421677 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:48:18.422674 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:48:18.553307 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:48:18.554307 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:48:18.686844 [debug] [MainThread]: Connection 'model.healthcare.claims_status_metrics' was left open.
[0m01:48:18.687843 [debug] [MainThread]: On model.healthcare.claims_status_metrics: Close
[0m01:48:18.819935 [info ] [MainThread]: 
[0m01:48:18.820948 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m01:48:18.821941 [debug] [MainThread]: Command end result
[0m01:48:18.843439 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:48:18.846415 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:48:18.852398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:48:18.853403 [info ] [MainThread]: 
[0m01:48:18.854400 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:48:18.854400 [info ] [MainThread]: 
[0m01:48:18.855399 [error] [MainThread]: [31mFailure in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)[0m
[0m01:48:18.856399 [error] [MainThread]:   Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  000904 (42000): SQL compilation error: error line 14 at position 29
  invalid identifier 'INSERTED_DATE'
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:48:18.857402 [info ] [MainThread]: 
[0m01:48:18.857402 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:48:18.858362 [info ] [MainThread]: 
[0m01:48:18.859358 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:48:18.861055 [debug] [MainThread]: Command `dbt run` failed at 01:48:18.860616 after 5.38 seconds
[0m01:48:18.862145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338339B440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002339BE66990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002339C471610>]}
[0m01:48:18.863144 [debug] [MainThread]: Flushing usage events
[0m01:48:19.652343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:54.837602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA8FBADB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA8F95B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA900FD670>]}


============================== 01:49:54.837602 | 8a96ed36-805f-49bc-9242-f715d919c831 ==============================
[0m01:49:54.837602 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:49:54.837602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select claims_status_metrics', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:49:56.225477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a96ed36-805f-49bc-9242-f715d919c831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA8F2B8C20>]}
[0m01:49:56.321451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a96ed36-805f-49bc-9242-f715d919c831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAAA2CFB00>]}
[0m01:49:56.321451 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:49:56.684528 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:49:56.858679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:56.858679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:56.858679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:49:56.910708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a96ed36-805f-49bc-9242-f715d919c831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA9014B680>]}
[0m01:49:57.006098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:49:57.006098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:49:57.121701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a96ed36-805f-49bc-9242-f715d919c831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAAA5E5580>]}
[0m01:49:57.121701 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:49:57.123435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a96ed36-805f-49bc-9242-f715d919c831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA8D7D8140>]}
[0m01:49:57.125503 [info ] [MainThread]: 
[0m01:49:57.127514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:49:57.127514 [info ] [MainThread]: 
[0m01:49:57.129528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:49:57.131475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:49:57.208388 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:49:57.208388 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:49:57.208388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:57.923935 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.715 seconds
[0m01:49:57.929693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:49:57.939719 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:49:57.941467 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:49:57.941467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:58.477057 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.537 seconds
[0m01:49:58.477057 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:49:58.477057 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:49:58.604223 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.123 seconds
[0m01:49:58.604223 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:49:58.604223 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:49:58.692870 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m01:49:58.708171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:49:58.708171 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:49:58.708171 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:49:58.806204 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m01:49:58.808215 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:49:58.808215 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:49:58.906933 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.102 seconds
[0m01:49:58.906933 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:49:58.906933 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:49:58.993968 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m01:49:58.993968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a96ed36-805f-49bc-9242-f715d919c831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAAA22E600>]}
[0m01:49:59.013660 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:49:59.013660 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.claims_status_metrics ........................ [RUN]
[0m01:49:59.015669 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.claims_status_metrics'
[0m01:49:59.015669 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:49:59.021691 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:49:59.023698 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:49:59.052522 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:49:59.052522 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:49:59.054529 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
    

    
    as (

WITH base_claims AS (
    SELECT
        claim_id,
        claim_status,
        claim_date,
        paid_amount,
        claim_amount,
        coalesce(claim_date, insert_date) AS submission_date,
        coalesce(paid_amount, 0) AS paid_amt,
        try_to_date(paid_date) AS paid_date
    FROM DBT_DB.SILVER.src_claims
),

metrics AS (
    SELECT
        claim_id,
        INITCAP(claim_status) AS claim_status,
        submission_date,
        paid_date,
        claim_amount,
        paid_amt AS paid_amount,

        -- Time between claim submission and payment
        DATEDIFF('day', submission_date, paid_date) AS days_to_payment,

        -- Flag for denied claims
        CASE 
            WHEN lower(claim_status) IN ('denied', 'rejected') THEN 1
            ELSE 0
        END AS is_denied
    FROM base_claims
)

SELECT * FROM metrics
    )
;
[0m01:49:59.054529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:49:59.718194 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf0bd-0000-2803-0027-cf8b0006fafa
[0m01:49:59.718194 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 20
invalid identifier 'PAID_DATE'
[0m01:49:59.725128 [debug] [Thread-1 (]: Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  000904 (42000): SQL compilation error: error line 16 at position 20
  invalid identifier 'PAID_DATE'
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:49:59.725128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a96ed36-805f-49bc-9242-f715d919c831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA8F1F9160>]}
[0m01:49:59.725128 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.claims_status_metrics ............... [[31mERROR[0m in 0.71s]
[0m01:49:59.725128 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:49:59.725128 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.claims_status_metrics' to be skipped because of status 'error'.  Reason: Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  000904 (42000): SQL compilation error: error line 16 at position 20
  invalid identifier 'PAID_DATE'
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql.
[0m01:49:59.730530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:59.730530 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:49:59.730530 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:49:59.864393 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:49:59.864393 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:50:00.016784 [debug] [MainThread]: Connection 'model.healthcare.claims_status_metrics' was left open.
[0m01:50:00.016784 [debug] [MainThread]: On model.healthcare.claims_status_metrics: Close
[0m01:50:00.153260 [info ] [MainThread]: 
[0m01:50:00.155264 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m01:50:00.155264 [debug] [MainThread]: Command end result
[0m01:50:00.179765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:50:00.182762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:50:00.187761 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:50:00.188762 [info ] [MainThread]: 
[0m01:50:00.189761 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:50:00.190765 [info ] [MainThread]: 
[0m01:50:00.191765 [error] [MainThread]: [31mFailure in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)[0m
[0m01:50:00.191765 [error] [MainThread]:   Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  000904 (42000): SQL compilation error: error line 16 at position 20
  invalid identifier 'PAID_DATE'
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:50:00.192798 [info ] [MainThread]: 
[0m01:50:00.193763 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:50:00.193763 [info ] [MainThread]: 
[0m01:50:00.195230 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:50:00.195230 [debug] [MainThread]: Command `dbt run` failed at 01:50:00.195230 after 5.57 seconds
[0m01:50:00.195230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA900FC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA900FE4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA900FC3E0>]}
[0m01:50:00.195230 [debug] [MainThread]: Flushing usage events
[0m01:50:00.857380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:53:27.686787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2356EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B24C8D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B24C8C0B0>]}


============================== 01:53:27.693784 | 35291062-8e62-40a8-a3a6-10011be04246 ==============================
[0m01:53:27.693784 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:53:27.694783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select claims_status_metrics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:53:29.175728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35291062-8e62-40a8-a3a6-10011be04246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3EC76570>]}
[0m01:53:29.275563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35291062-8e62-40a8-a3a6-10011be04246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3EAFB2C0>]}
[0m01:53:29.277566 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:53:29.681765 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:53:29.855238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:53:29.856233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:53:29.863242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:53:29.912602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35291062-8e62-40a8-a3a6-10011be04246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3ED8E0C0>]}
[0m01:53:30.015432 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:53:30.020102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:53:30.146789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35291062-8e62-40a8-a3a6-10011be04246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B24E18F80>]}
[0m01:53:30.147789 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:53:30.148787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35291062-8e62-40a8-a3a6-10011be04246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3D8F58E0>]}
[0m01:53:30.150790 [info ] [MainThread]: 
[0m01:53:30.152225 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:53:30.153343 [info ] [MainThread]: 
[0m01:53:30.154354 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:53:30.156357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:53:30.244678 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:53:30.245678 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:53:30.245678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:31.054245 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.808 seconds
[0m01:53:31.062241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m01:53:31.074916 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:53:31.075914 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:53:31.075914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:31.594712 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.519 seconds
[0m01:53:31.598714 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:53:31.599756 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:53:31.707198 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.107 seconds
[0m01:53:31.709193 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:53:31.709193 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:53:31.799166 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m01:53:31.800166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m01:53:31.803429 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:53:31.804549 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:53:31.899931 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m01:53:31.901928 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:53:31.902729 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:53:32.009843 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.107 seconds
[0m01:53:32.011849 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:53:32.011849 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:53:32.120232 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.108 seconds
[0m01:53:32.122740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35291062-8e62-40a8-a3a6-10011be04246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B22329BE0>]}
[0m01:53:32.127742 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:53:32.128733 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.claims_status_metrics ........................ [RUN]
[0m01:53:32.129735 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.claims_status_metrics'
[0m01:53:32.129735 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:53:32.136775 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:53:32.138317 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:53:32.167320 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:53:32.169870 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:53:32.170924 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
    

    
    as (

WITH base_claims AS (
    SELECT
        claim_id,
        claim_status,
        claim_date,
        COALESCE(claim_date, insert_date) AS submission_date,
        modified_date AS payment_candidate_date,
        claim_amount,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

final_metrics AS (
    SELECT
        claim_id,
        INITCAP(claim_status) AS claim_status,
        submission_date,
        
        -- Only use modified_date as paid_date if paid_amount > 0
        CASE 
            WHEN paid_amount > 0 THEN payment_candidate_date
            ELSE NULL
        END AS paid_date,

        claim_amount,
        paid_amount,

        -- Days to payment (only if paid)
        CASE 
            WHEN paid_amount > 0 THEN DATEDIFF('day', submission_date, payment_candidate_date)
            ELSE NULL
        END AS days_to_payment,

        -- Denial flag
        CASE 
            WHEN LOWER(claim_status) IN ('denied', 'rejected') THEN 1
            ELSE 0
        END AS is_denied
    FROM base_claims
)

SELECT * FROM final_metrics
    )
;
[0m01:53:32.170924 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:53:33.232910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.062 seconds
[0m01:53:33.257138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35291062-8e62-40a8-a3a6-10011be04246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2196D550>]}
[0m01:53:33.258130 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.claims_status_metrics ................... [[32mSUCCESS 1[0m in 1.13s]
[0m01:53:33.259008 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:53:33.261042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:53:33.261042 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:53:33.261042 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:53:33.398423 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m01:53:33.398423 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m01:53:33.529814 [debug] [MainThread]: Connection 'model.healthcare.claims_status_metrics' was left open.
[0m01:53:33.529814 [debug] [MainThread]: On model.healthcare.claims_status_metrics: Close
[0m01:53:33.665353 [info ] [MainThread]: 
[0m01:53:33.666354 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m01:53:33.668353 [debug] [MainThread]: Command end result
[0m01:53:33.697350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:53:33.701348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:53:33.720346 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:53:33.721350 [info ] [MainThread]: 
[0m01:53:33.724352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:53:33.726859 [info ] [MainThread]: 
[0m01:53:33.728870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:53:33.731871 [debug] [MainThread]: Command `dbt run` succeeded at 01:53:33.730873 after 6.28 seconds
[0m01:53:33.731871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B24E18F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3F502BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3F1F7C80>]}
[0m01:53:33.732872 [debug] [MainThread]: Flushing usage events
[0m01:53:34.565874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:55:58.170658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D568FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D22911C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D4E801A0>]}


============================== 01:55:58.177262 | eff24f5d-bd37-4b00-a8ee-e15deff2ede5 ==============================
[0m01:55:58.177262 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:55:58.178221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select claims_status_metrics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:55:59.596999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eff24f5d-bd37-4b00-a8ee-e15deff2ede5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D40A2180>]}
[0m01:55:59.706251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eff24f5d-bd37-4b00-a8ee-e15deff2ede5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232ECFDFEC0>]}
[0m01:55:59.707252 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:56:00.101637 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:56:00.280186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:56:00.280186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:56:00.287262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:56:00.343506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eff24f5d-bd37-4b00-a8ee-e15deff2ede5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EF899520>]}
[0m01:56:00.454622 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:56:00.457623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:56:00.587291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eff24f5d-bd37-4b00-a8ee-e15deff2ede5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D2D05B20>]}
[0m01:56:00.588287 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:56:00.589288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eff24f5d-bd37-4b00-a8ee-e15deff2ede5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EE2F9280>]}
[0m01:56:00.591290 [info ] [MainThread]: 
[0m01:56:00.592609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:00.593852 [info ] [MainThread]: 
[0m01:56:00.596023 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:56:00.598987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:56:00.685598 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:56:00.686598 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:56:00.687598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:01.440304 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.753 seconds
[0m01:56:01.447520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m01:56:01.457516 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:56:01.458516 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:56:01.458516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:02.041140 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.582 seconds
[0m01:56:02.045092 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:56:02.046050 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:56:02.170779 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.125 seconds
[0m01:56:02.172775 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:56:02.173779 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:56:02.277347 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m01:56:02.278324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m01:56:02.280532 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:56:02.281527 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:56:02.391492 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m01:56:02.393489 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:56:02.394533 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:56:02.508197 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.113 seconds
[0m01:56:02.510196 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:56:02.510196 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:56:02.604519 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m01:56:02.607517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eff24f5d-bd37-4b00-a8ee-e15deff2ede5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EFC473E0>]}
[0m01:56:02.612928 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:56:02.613889 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.claims_status_metrics ........................ [RUN]
[0m01:56:02.614925 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.claims_status_metrics'
[0m01:56:02.615923 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:56:02.622930 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:56:02.623936 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:56:02.656681 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:56:02.658682 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:56:02.659682 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
    

    
    as (

WITH base_claims AS (
    SELECT
        claim_id,
        INITCAP(claim_status) AS claim_status,
        COALESCE(claim_date, insert_date) AS submission_date,
        modified_date AS raw_paid_date,
        claim_amount,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

final_metrics AS (
    SELECT
        claim_id,
        claim_status,
        submission_date,

        -- Only use paid_date if it comes AFTER submission_date
        CASE 
            WHEN paid_amount > 0 AND raw_paid_date >= submission_date THEN raw_paid_date
            ELSE NULL
        END AS paid_date,

        claim_amount,
        paid_amount,

        CASE 
            WHEN paid_amount > 0 AND raw_paid_date >= submission_date
            THEN DATEDIFF('day', submission_date, raw_paid_date)
            ELSE NULL
        END AS days_to_payment,

        CASE 
            WHEN LOWER(claim_status) IN ('denied', 'rejected') THEN 1
            ELSE 0
        END AS is_denied
    FROM base_claims
)

SELECT * FROM final_metrics
    )
;
[0m01:56:02.659682 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:56:03.772810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.112 seconds
[0m01:56:03.793600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eff24f5d-bd37-4b00-a8ee-e15deff2ede5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D23796D0>]}
[0m01:56:03.793600 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.claims_status_metrics ................... [[32mSUCCESS 1[0m in 1.18s]
[0m01:56:03.795666 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:56:03.797211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:03.798210 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:56:03.798210 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:56:03.940791 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m01:56:03.940791 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m01:56:04.072231 [debug] [MainThread]: Connection 'model.healthcare.claims_status_metrics' was left open.
[0m01:56:04.073230 [debug] [MainThread]: On model.healthcare.claims_status_metrics: Close
[0m01:56:04.219316 [info ] [MainThread]: 
[0m01:56:04.220316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m01:56:04.221316 [debug] [MainThread]: Command end result
[0m01:56:04.240851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:56:04.244248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:56:04.252586 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:56:04.252586 [info ] [MainThread]: 
[0m01:56:04.253551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:56:04.254551 [info ] [MainThread]: 
[0m01:56:04.255550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:56:04.256545 [debug] [MainThread]: Command `dbt run` succeeded at 01:56:04.256545 after 6.31 seconds
[0m01:56:04.256545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D47CA150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D4764B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D52D7E00>]}
[0m01:56:04.257545 [debug] [MainThread]: Flushing usage events
[0m01:56:04.957457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:58:16.909742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE63223E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE62E3C530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE62F77C80>]}


============================== 01:58:16.915736 | 28f16f4a-b9d2-4bf9-9c9b-87f6f4af53bc ==============================
[0m01:58:16.915736 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:58:16.916732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select claims_status_metrics', 'send_anonymous_usage_stats': 'True'}
[0m01:58:18.320790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28f16f4a-b9d2-4bf9-9c9b-87f6f4af53bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE7B35A390>]}
[0m01:58:18.427553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28f16f4a-b9d2-4bf9-9c9b-87f6f4af53bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE7DA8E9C0>]}
[0m01:58:18.429593 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:58:18.817259 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:58:18.992548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:58:18.993548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:58:19.000548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:58:19.050592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28f16f4a-b9d2-4bf9-9c9b-87f6f4af53bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE7DC803E0>]}
[0m01:58:19.151049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:58:19.155043 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:58:19.283905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28f16f4a-b9d2-4bf9-9c9b-87f6f4af53bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE7DFE7AA0>]}
[0m01:58:19.284905 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:58:19.284905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f16f4a-b9d2-4bf9-9c9b-87f6f4af53bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE7C7F32C0>]}
[0m01:58:19.287906 [info ] [MainThread]: 
[0m01:58:19.288905 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:58:19.288905 [info ] [MainThread]: 
[0m01:58:19.290893 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:58:19.293209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:58:19.377855 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:58:19.378412 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:58:19.378412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:20.071397 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.692 seconds
[0m01:58:20.080200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:58:20.090247 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:58:20.091255 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:58:20.091255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:20.679311 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.588 seconds
[0m01:58:20.683061 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:58:20.684061 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:58:20.794144 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.110 seconds
[0m01:58:20.796143 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:58:20.796143 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:58:20.884660 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m01:58:20.886658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:58:20.889661 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:58:20.889661 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:58:21.404701 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.514 seconds
[0m01:58:21.406785 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:58:21.406785 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:58:21.524299 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.118 seconds
[0m01:58:21.526832 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:58:21.526832 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:58:21.638980 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m01:58:21.642647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f16f4a-b9d2-4bf9-9c9b-87f6f4af53bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE7E509580>]}
[0m01:58:21.647430 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:58:21.648425 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.claims_status_metrics ........................ [RUN]
[0m01:58:21.649425 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.claims_status_metrics'
[0m01:58:21.649425 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:58:21.655432 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:58:21.656428 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:58:21.686661 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:58:21.688663 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:58:21.689666 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
    

    
    as (

WITH base_claims AS (
    SELECT
        claim_id,
        INITCAP(claim_status) AS claim_status,
        COALESCE(claim_date, insert_date) AS submission_date,
        modified_date AS raw_paid_date,
        claim_amount,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

claims_metrics AS (
    SELECT
        claim_id,
        claim_status,
        submission_date,

        -- Treat modified_date as paid_date only if paid_amount > 0 AND it's not earlier than submission
        CASE 
            WHEN paid_amount > 0 AND raw_paid_date >= submission_date THEN raw_paid_date
            ELSE NULL
        END AS paid_date,

        claim_amount,
        paid_amount,

        -- Calculate days to payment only if paid_date is valid
        CASE 
            WHEN paid_amount > 0 AND raw_paid_date >= submission_date
            THEN DATEDIFF('day', submission_date, raw_paid_date)
            ELSE NULL
        END AS days_to_payment,

        -- Denied or rejected flag
        CASE 
            WHEN LOWER(claim_status) IN ('denied', 'rejected') THEN 1
            ELSE 0
        END AS is_denied
    FROM base_claims
)

SELECT * FROM claims_metrics;
[0m01:58:21.689666 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:58:22.213326 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf0c6-0000-27ff-0027-cf8b00066b12
[0m01:58:22.213326 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 48 at position 28 unexpected ';'.
[0m01:58:22.216318 [debug] [Thread-1 (]: Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 28 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:58:22.218318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f16f4a-b9d2-4bf9-9c9b-87f6f4af53bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE62B69370>]}
[0m01:58:22.219321 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.claims_status_metrics ............... [[31mERROR[0m in 0.57s]
[0m01:58:22.220320 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:58:22.220320 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.claims_status_metrics' to be skipped because of status 'error'.  Reason: Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 28 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql.
[0m01:58:22.223324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:58:22.224323 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:58:22.224323 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:58:22.370983 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:58:22.370983 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:58:22.503388 [debug] [MainThread]: Connection 'model.healthcare.claims_status_metrics' was left open.
[0m01:58:22.503388 [debug] [MainThread]: On model.healthcare.claims_status_metrics: Close
[0m01:58:22.651436 [info ] [MainThread]: 
[0m01:58:22.652474 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m01:58:22.653433 [debug] [MainThread]: Command end result
[0m01:58:22.674461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:58:22.677464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:58:22.683514 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:58:22.684517 [info ] [MainThread]: 
[0m01:58:22.684517 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:58:22.685517 [info ] [MainThread]: 
[0m01:58:22.686517 [error] [MainThread]: [31mFailure in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)[0m
[0m01:58:22.687515 [error] [MainThread]:   Database Error in model claims_status_metrics (models\healthcare\fact\claims_status_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 28 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:58:22.687515 [info ] [MainThread]: 
[0m01:58:22.688515 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\claims_status_metrics.sql
[0m01:58:22.689514 [info ] [MainThread]: 
[0m01:58:22.689514 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:58:22.691517 [debug] [MainThread]: Command `dbt run` failed at 01:58:22.690515 after 5.99 seconds
[0m01:58:22.692516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE636A5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE7B7594F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EE62352BD0>]}
[0m01:58:22.692516 [debug] [MainThread]: Flushing usage events
[0m01:58:23.369438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:41.999027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3AF6FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD37A1B650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3AF6FDA0>]}


============================== 01:59:42.004467 | 78fc5276-6318-4c69-9364-a3f7e840b47a ==============================
[0m01:59:42.004467 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:59:42.005468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select claims_status_metrics', 'send_anonymous_usage_stats': 'True'}
[0m01:59:43.375499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78fc5276-6318-4c69-9364-a3f7e840b47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD54F6F440>]}
[0m01:59:43.477224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78fc5276-6318-4c69-9364-a3f7e840b47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD37C6E2D0>]}
[0m01:59:43.479734 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:59:43.866847 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:59:44.049407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:59:44.050410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:59:44.057408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:59:44.108722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78fc5276-6318-4c69-9364-a3f7e840b47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD551A7BF0>]}
[0m01:59:44.211955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:59:44.216014 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:59:44.343966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78fc5276-6318-4c69-9364-a3f7e840b47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD385F9B50>]}
[0m01:59:44.345064 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m01:59:44.345772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78fc5276-6318-4c69-9364-a3f7e840b47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD54F00B30>]}
[0m01:59:44.347841 [info ] [MainThread]: 
[0m01:59:44.348844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:59:44.349916 [info ] [MainThread]: 
[0m01:59:44.350837 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:59:44.352834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:59:44.447382 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:59:44.447382 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:59:44.448380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:59:45.236368 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.788 seconds
[0m01:59:45.246238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m01:59:45.259411 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:59:45.259411 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:59:45.260365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:59:45.799438 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.539 seconds
[0m01:59:45.804442 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:59:45.804442 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:59:45.913907 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.109 seconds
[0m01:59:45.915980 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:59:45.916979 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:59:46.010692 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m01:59:46.013569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m01:59:46.017733 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:59:46.017733 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:59:46.120239 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m01:59:46.123235 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:59:46.123235 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:59:46.243987 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.120 seconds
[0m01:59:46.245986 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:59:46.247077 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:59:46.351748 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m01:59:46.355855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78fc5276-6318-4c69-9364-a3f7e840b47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD55562540>]}
[0m01:59:46.361746 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:59:46.361746 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.claims_status_metrics ........................ [RUN]
[0m01:59:46.363754 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.claims_status_metrics'
[0m01:59:46.364815 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:59:46.372813 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:59:46.374819 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:59:46.415025 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:59:46.418023 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:59:46.419023 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
    

    
    as (

WITH base_claims AS (
    SELECT
        claim_id,
        INITCAP(claim_status) AS claim_status,
        COALESCE(claim_date, insert_date) AS submission_date,
        modified_date AS raw_paid_date,
        claim_amount,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

claims_metrics AS (
    SELECT
        claim_id,
        claim_status,
        submission_date,

        -- Treat modified_date as paid_date only if paid_amount > 0 AND it's not earlier than submission
        CASE 
            WHEN paid_amount > 0 AND raw_paid_date >= submission_date THEN raw_paid_date
            ELSE NULL
        END AS paid_date,

        claim_amount,
        paid_amount,

        -- Calculate days to payment only if paid_date is valid
        CASE 
            WHEN paid_amount > 0 AND raw_paid_date >= submission_date
            THEN DATEDIFF('day', submission_date, raw_paid_date)
            ELSE NULL
        END AS days_to_payment,

        -- Denied or rejected flag
        CASE 
            WHEN LOWER(claim_status) IN ('denied', 'rejected') THEN 1
            ELSE 0
        END AS is_denied
    FROM base_claims
)

SELECT * FROM claims_metrics
    )
;
[0m01:59:46.419023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:59:47.834117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.414 seconds
[0m01:59:47.858523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78fc5276-6318-4c69-9364-a3f7e840b47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD37C6D4F0>]}
[0m01:59:47.859489 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.claims_status_metrics ................... [[32mSUCCESS 1[0m in 1.49s]
[0m01:59:47.860491 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:59:47.862540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:59:47.863590 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:59:47.863590 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:59:47.994404 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m01:59:47.995451 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m01:59:48.127391 [debug] [MainThread]: Connection 'model.healthcare.claims_status_metrics' was left open.
[0m01:59:48.128399 [debug] [MainThread]: On model.healthcare.claims_status_metrics: Close
[0m01:59:48.261321 [info ] [MainThread]: 
[0m01:59:48.262214 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m01:59:48.263214 [debug] [MainThread]: Command end result
[0m01:59:48.287254 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:59:48.289254 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:59:48.297362 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:59:48.298361 [info ] [MainThread]: 
[0m01:59:48.299365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:59:48.301362 [info ] [MainThread]: 
[0m01:59:48.301362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:59:48.303412 [debug] [MainThread]: Command `dbt run` succeeded at 01:59:48.303412 after 6.54 seconds
[0m01:59:48.303412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3A7715B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD55562540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD53BA44A0>]}
[0m01:59:48.304359 [debug] [MainThread]: Flushing usage events
[0m01:59:49.043361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:20.028390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020793ECC1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020793ECDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020793ECC0B0>]}


============================== 20:52:20.046136 | 0c602ba4-ff33-4d6e-8fd0-ec3298108d65 ==============================
[0m20:52:20.046136 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:52:20.046136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select provider_performance_summary', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:31.903284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c602ba4-ff33-4d6e-8fd0-ec3298108d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AD2B6270>]}
[0m20:52:32.067683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c602ba4-ff33-4d6e-8fd0-ec3298108d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AE706990>]}
[0m20:52:32.068968 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:52:33.218417 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:52:33.604115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:33.604115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:33.629030 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m20:52:33.777396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c602ba4-ff33-4d6e-8fd0-ec3298108d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AE8BE5A0>]}
[0m20:52:33.985889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:52:34.102815 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:52:34.418472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c602ba4-ff33-4d6e-8fd0-ec3298108d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020791D5BC20>]}
[0m20:52:34.419563 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m20:52:34.421241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c602ba4-ff33-4d6e-8fd0-ec3298108d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AD2DF7D0>]}
[0m20:52:34.421241 [info ] [MainThread]: 
[0m20:52:34.429596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:34.429596 [info ] [MainThread]: 
[0m20:52:34.434842 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:52:34.438082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m20:52:43.303201 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m20:52:43.303201 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m20:52:43.303201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:46.228798 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.923 seconds
[0m20:52:46.249980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m20:52:46.279433 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:52:46.279433 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:52:46.281336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:46.850818 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.574 seconds
[0m20:52:46.863440 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:52:46.863440 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m20:52:47.015256 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.149 seconds
[0m20:52:47.018613 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:52:47.018613 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:52:47.131985 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m20:52:47.131985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m20:52:47.146152 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:52:47.146676 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:52:47.267616 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m20:52:47.272488 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:52:47.274012 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m20:52:47.420781 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.147 seconds
[0m20:52:47.420781 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:52:47.420781 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:52:47.522820 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m20:52:47.530011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c602ba4-ff33-4d6e-8fd0-ec3298108d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AE81E480>]}
[0m20:52:47.547154 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m20:52:47.552653 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.provider_performance_summary ................. [RUN]
[0m20:52:47.552653 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.provider_performance_summary'
[0m20:52:47.552653 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_performance_summary
[0m20:52:47.585701 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_performance_summary"
[0m20:52:47.585701 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_performance_summary
[0m20:52:47.697402 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_performance_summary"
[0m20:52:47.704048 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_performance_summary"
[0m20:52:47.704048 [debug] [Thread-1 (]: On model.healthcare.provider_performance_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_performance_summary"} */
create or replace transient table DBT_DB.GOLD.provider_performance_summary
    

    
    as (

-- Step 1: Aggregate encounter counts
WITH encounter_counts AS (
    SELECT
        provider_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY provider_id
),

-- Step 2: Aggregate charges from transactions
transaction_sums AS (
    SELECT
        provider_id,
        SUM(COALESCE(amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY provider_id
),

-- Step 3: Join claims to transactions for payment info
claims_with_providers AS (
    SELECT
        t.provider_id,
        SUM(COALESCE(c.paid_amount, 0)) AS total_payments
    FROM DBT_DB.SILVER.src_transactions t
    LEFT JOIN DBT_DB.SILVER.src_claims c
        ON t.transaction_id = c.transaction_id
    GROUP BY t.provider_id
),

-- Step 4: Combine all metrics
combined_metrics AS (
    SELECT
        COALESCE(e.provider_id, t.provider_id, c.provider_id) AS provider_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_charges, 0) AS total_charges,
        COALESCE(total_payments, 0) AS total_payments
    FROM encounter_counts e
    FULL OUTER JOIN transaction_sums t ON e.provider_id = t.provider_id
    FULL OUTER JOIN claims_with_providers c ON COALESCE(e.provider_id, t.provider_id) = c.provider_id
),

-- Step 5: Join with dimension for readable names
final AS (
    SELECT
        cm.provider_id,
        p.full_name,
        p.specialization,
        p.dept_id,
        cm.total_encounters,
        cm.total_charges,
        cm.total_payments,
        -- Derived metric
        ROUND(CASE 
            WHEN cm.total_encounters > 0 THEN cm.total_charges / cm.total_encounters
            ELSE NULL
        END, 2) AS avg_charge_per_encounter
    FROM combined_metrics cm
    LEFT JOIN DBT_DB.GOLD.dim_providers p
        ON cm.provider_id = p.provider_id
)

SELECT * FROM final
    )
;
[0m20:52:47.704048 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:52:49.071802 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf534-0000-27fb-0027-cf8b0006dd22
[0m20:52:49.071802 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 21
invalid identifier 'AMOUNT'
[0m20:52:49.126242 [debug] [Thread-1 (]: Database Error in model provider_performance_summary (models\healthcare\fact\provider_performance_summary.sql)
  000904 (42000): SQL compilation error: error line 20 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\provider_performance_summary.sql
[0m20:52:49.134595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c602ba4-ff33-4d6e-8fd0-ec3298108d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207937E92B0>]}
[0m20:52:49.138089 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.provider_performance_summary ........ [[31mERROR[0m in 1.58s]
[0m20:52:49.138089 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m20:52:49.138089 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.provider_performance_summary' to be skipped because of status 'error'.  Reason: Database Error in model provider_performance_summary (models\healthcare\fact\provider_performance_summary.sql)
  000904 (42000): SQL compilation error: error line 20 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\provider_performance_summary.sql.
[0m20:52:49.143012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:49.148018 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m20:52:49.148018 [debug] [MainThread]: On list_DBT_DB: Close
[0m20:52:49.291902 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m20:52:49.297496 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m20:52:49.438864 [debug] [MainThread]: Connection 'model.healthcare.provider_performance_summary' was left open.
[0m20:52:49.438864 [debug] [MainThread]: On model.healthcare.provider_performance_summary: Close
[0m20:52:49.582650 [info ] [MainThread]: 
[0m20:52:49.582650 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.15 seconds (15.15s).
[0m20:52:49.588517 [debug] [MainThread]: Command end result
[0m20:52:49.680371 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:52:49.688603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:52:49.719775 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m20:52:49.723335 [info ] [MainThread]: 
[0m20:52:49.728481 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:52:49.733379 [info ] [MainThread]: 
[0m20:52:49.737676 [error] [MainThread]: [31mFailure in model provider_performance_summary (models\healthcare\fact\provider_performance_summary.sql)[0m
[0m20:52:49.737676 [error] [MainThread]:   Database Error in model provider_performance_summary (models\healthcare\fact\provider_performance_summary.sql)
  000904 (42000): SQL compilation error: error line 20 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\provider_performance_summary.sql
[0m20:52:49.741536 [info ] [MainThread]: 
[0m20:52:49.745890 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\provider_performance_summary.sql
[0m20:52:49.753534 [info ] [MainThread]: 
[0m20:52:49.758543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:52:49.769689 [debug] [MainThread]: Command `dbt run` failed at 20:52:49.767665 after 30.17 seconds
[0m20:52:49.771725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020794848770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AEF7DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002079419BE30>]}
[0m20:52:49.771725 [debug] [MainThread]: Flushing usage events
[0m20:52:50.887702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:56.661375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6E390DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6E42E5AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6E126F530>]}


============================== 20:53:56.673110 | d3ef45da-d030-4274-b532-c11f598bb2e2 ==============================
[0m20:53:56.673110 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:53:56.673110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select provider_performance_summary', 'send_anonymous_usage_stats': 'True'}
[0m20:54:00.089430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3ef45da-d030-4274-b532-c11f598bb2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6FE7C6360>]}
[0m20:54:00.249371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3ef45da-d030-4274-b532-c11f598bb2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6FE88B230>]}
[0m20:54:00.249371 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:54:01.099312 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:54:01.411581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:01.411581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:01.427673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m20:54:01.509087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3ef45da-d030-4274-b532-c11f598bb2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6FE9F5F10>]}
[0m20:54:01.714698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:54:01.732969 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:54:01.987548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3ef45da-d030-4274-b532-c11f598bb2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6FCDDD2E0>]}
[0m20:54:01.987548 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m20:54:01.987548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ef45da-d030-4274-b532-c11f598bb2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6E1E49220>]}
[0m20:54:01.987548 [info ] [MainThread]: 
[0m20:54:01.987548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:02.001552 [info ] [MainThread]: 
[0m20:54:02.004330 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:54:02.009538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m20:54:02.240972 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m20:54:02.240972 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m20:54:02.240972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:03.475081 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.228 seconds
[0m20:54:03.485345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m20:54:03.497566 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:54:03.497566 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:54:03.497566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:04.156104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.651 seconds
[0m20:54:04.160149 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:54:04.160149 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m20:54:04.279188 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.113 seconds
[0m20:54:04.279188 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m20:54:04.286513 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:54:04.377840 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m20:54:04.383611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m20:54:04.391055 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:54:04.391055 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:54:04.500643 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m20:54:04.503165 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:54:04.503165 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m20:54:04.635059 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.128 seconds
[0m20:54:04.636698 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m20:54:04.636698 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:54:04.733485 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m20:54:04.753864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ef45da-d030-4274-b532-c11f598bb2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6FE828260>]}
[0m20:54:04.765804 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m20:54:04.767822 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.provider_performance_summary ................. [RUN]
[0m20:54:04.771674 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.provider_performance_summary'
[0m20:54:04.771674 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_performance_summary
[0m20:54:04.803278 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_performance_summary"
[0m20:54:04.815123 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_performance_summary
[0m20:54:04.884059 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_performance_summary"
[0m20:54:04.898540 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_performance_summary"
[0m20:54:04.898540 [debug] [Thread-1 (]: On model.healthcare.provider_performance_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_performance_summary"} */
create or replace transient table DBT_DB.GOLD.provider_performance_summary
    

    
    as (

-- Step 1: Aggregate encounter counts
WITH encounter_counts AS (
    SELECT
        provider_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY provider_id
),

-- Step 2: Aggregate charges from transactions
transaction_sums AS (
    SELECT
        provider_id,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY provider_id
),

-- Step 3: Join claims to transactions for payment info
claims_with_providers AS (
    SELECT
        t.provider_id,
        SUM(COALESCE(c.paid_amount, 0)) AS total_payments
    FROM DBT_DB.SILVER.src_transactions t
    LEFT JOIN DBT_DB.SILVER.src_claims c
        ON t.transaction_id = c.transaction_id
    GROUP BY t.provider_id
),

-- Step 4: Combine all metrics
combined_metrics AS (
    SELECT
        COALESCE(e.provider_id, t.provider_id, c.provider_id) AS provider_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_charges, 0) AS total_charges,
        COALESCE(total_payments, 0) AS total_payments
    FROM encounter_counts e
    FULL OUTER JOIN transaction_sums t ON e.provider_id = t.provider_id
    FULL OUTER JOIN claims_with_providers c ON COALESCE(e.provider_id, t.provider_id) = c.provider_id
),

-- Step 5: Join with dimension for readable names
final AS (
    SELECT
        cm.provider_id,
        p.full_name,
        p.specialization,
        p.dept_id,
        cm.total_encounters,
        cm.total_charges,
        cm.total_payments,
        -- Derived metric
        ROUND(CASE 
            WHEN cm.total_encounters > 0 THEN cm.total_charges / cm.total_encounters
            ELSE NULL
        END, 2) AS avg_charge_per_encounter
    FROM combined_metrics cm
    LEFT JOIN DBT_DB.GOLD.dim_providers p
        ON cm.provider_id = p.provider_id
)

SELECT * FROM final
    )
;
[0m20:54:04.898540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:54:07.639993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.742 seconds
[0m20:54:07.690889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ef45da-d030-4274-b532-c11f598bb2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6E14BD3D0>]}
[0m20:54:07.690889 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.provider_performance_summary ............ [[32mSUCCESS 1[0m in 2.92s]
[0m20:54:07.690889 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m20:54:07.701807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:07.703539 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m20:54:07.703539 [debug] [MainThread]: On list_DBT_DB: Close
[0m20:54:07.849156 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m20:54:07.849156 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m20:54:08.013385 [debug] [MainThread]: Connection 'model.healthcare.provider_performance_summary' was left open.
[0m20:54:08.013385 [debug] [MainThread]: On model.healthcare.provider_performance_summary: Close
[0m20:54:08.156850 [info ] [MainThread]: 
[0m20:54:08.156850 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m20:54:08.164575 [debug] [MainThread]: Command end result
[0m20:54:08.252967 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m20:54:08.259508 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m20:54:08.277391 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m20:54:08.279432 [info ] [MainThread]: 
[0m20:54:08.279432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:08.283364 [info ] [MainThread]: 
[0m20:54:08.285648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:54:08.291478 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:08.291478 after 12.12 seconds
[0m20:54:08.293756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6E437EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6E47DEC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6E30C2AB0>]}
[0m20:54:08.296198 [debug] [MainThread]: Flushing usage events
[0m20:54:09.379747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:56.834193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015099FFCFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509D409F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509D409760>]}


============================== 21:28:56.850054 | 4f97372f-33db-4120-a47b-6949d8ed53c1 ==============================
[0m21:28:56.850054 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:28:56.850054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select provider_performance_summary', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:28:59.105497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f97372f-33db-4120-a47b-6949d8ed53c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B74D9FD0>]}
[0m21:28:59.248062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f97372f-33db-4120-a47b-6949d8ed53c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509CBDCE60>]}
[0m21:28:59.248062 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:28:59.810062 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:29:00.095367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:00.095367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:00.111816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m21:29:00.185928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f97372f-33db-4120-a47b-6949d8ed53c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509D42D520>]}
[0m21:29:00.344988 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:29:00.344988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:29:00.534983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f97372f-33db-4120-a47b-6949d8ed53c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B7977920>]}
[0m21:29:00.534983 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:29:00.534983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f97372f-33db-4120-a47b-6949d8ed53c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4F7B2C0>]}
[0m21:29:00.550828 [info ] [MainThread]: 
[0m21:29:00.550828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:00.550828 [info ] [MainThread]: 
[0m21:29:00.555801 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:00.558073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:29:00.662195 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:29:00.662195 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:29:00.662195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:01.558112 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.905 seconds
[0m21:29:01.573958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:29:01.605775 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:29:01.605775 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:29:01.605775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:02.006903 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.398 seconds
[0m21:29:02.012928 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:29:02.014937 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:29:02.140785 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.136 seconds
[0m21:29:02.140785 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:29:02.140785 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:29:02.260244 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m21:29:02.264260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:29:02.270287 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:29:02.270287 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:29:02.380458 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m21:29:02.380458 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:29:02.380458 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:29:02.522977 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.138 seconds
[0m21:29:02.526887 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:29:02.528894 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:29:02.628189 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:29:02.633989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f97372f-33db-4120-a47b-6949d8ed53c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B7C9E000>]}
[0m21:29:02.633989 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m21:29:02.633989 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.provider_performance_summary ................. [RUN]
[0m21:29:02.647154 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.provider_performance_summary'
[0m21:29:02.647154 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_performance_summary
[0m21:29:02.649702 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_performance_summary"
[0m21:29:02.666738 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_performance_summary
[0m21:29:02.743768 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_performance_summary"
[0m21:29:02.748191 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_performance_summary"
[0m21:29:02.751425 [debug] [Thread-1 (]: On model.healthcare.provider_performance_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_performance_summary"} */
create or replace transient table DBT_DB.GOLD.provider_performance_summary
    

    
    as (

WITH encounter_counts AS (
    SELECT
        provider_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY provider_id
),

transaction_sums AS (
    SELECT
        provider_id,
        SUM(COALESCE(amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY provider_id
),

claims_with_providers AS (
    SELECT
        t.provider_id,
        SUM(COALESCE(c.paid_amount, 0)) AS total_payments
    FROM DBT_DB.SILVER.src_transactions t
    LEFT JOIN DBT_DB.SILVER.src_claims c
        ON t.transaction_id = c.transaction_id
    GROUP BY t.provider_id
),

combined_metrics AS (
    SELECT
        COALESCE(e.provider_id, t.provider_id, c.provider_id) AS provider_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_charges, 0) AS total_charges,
        COALESCE(total_payments, 0) AS total_payments
    FROM encounter_counts e
    FULL OUTER JOIN transaction_sums t ON e.provider_id = t.provider_id
    FULL OUTER JOIN claims_with_providers c ON COALESCE(e.provider_id, t.provider_id) = c.provider_id
),

final AS (
    SELECT
        cm.provider_id,
        p.full_name,
        p.specialization,
        p.dept_id,
        cm.total_encounters,
        cm.total_charges,
        cm.total_payments,
        ROUND(CASE 
            WHEN cm.total_encounters > 0 THEN cm.total_charges / cm.total_encounters
            ELSE NULL
        END, 2) AS avg_charge_per_encounter
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_providers p
        ON cm.provider_id = p.provider_id
)

SELECT * FROM final;
[0m21:29:02.753448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:03.175031 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf559-0000-2803-0027-cf8b0006fdde
[0m21:29:03.175031 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 62 at position 19 unexpected ';'.
[0m21:29:03.175031 [debug] [Thread-1 (]: Database Error in model provider_performance_summary (models\healthcare\fact\provider_performance_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\provider_performance_summary.sql
[0m21:29:03.175031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f97372f-33db-4120-a47b-6949d8ed53c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509C4F9340>]}
[0m21:29:03.175031 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.provider_performance_summary ........ [[31mERROR[0m in 0.54s]
[0m21:29:03.190851 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m21:29:03.190851 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.provider_performance_summary' to be skipped because of status 'error'.  Reason: Database Error in model provider_performance_summary (models\healthcare\fact\provider_performance_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\provider_performance_summary.sql.
[0m21:29:03.190851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:03.190851 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:29:03.190851 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:29:03.343061 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:29:03.343061 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:29:03.470196 [debug] [MainThread]: Connection 'model.healthcare.provider_performance_summary' was left open.
[0m21:29:03.470196 [debug] [MainThread]: On model.healthcare.provider_performance_summary: Close
[0m21:29:03.612510 [info ] [MainThread]: 
[0m21:29:03.612510 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m21:29:03.628231 [debug] [MainThread]: Command end result
[0m21:29:03.681309 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:29:03.685688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:29:03.708828 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:29:03.708828 [info ] [MainThread]: 
[0m21:29:03.708828 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:29:03.712980 [info ] [MainThread]: 
[0m21:29:03.712980 [error] [MainThread]: [31mFailure in model provider_performance_summary (models\healthcare\fact\provider_performance_summary.sql)[0m
[0m21:29:03.714571 [error] [MainThread]:   Database Error in model provider_performance_summary (models\healthcare\fact\provider_performance_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\provider_performance_summary.sql
[0m21:29:03.722316 [info ] [MainThread]: 
[0m21:29:03.722316 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\provider_performance_summary.sql
[0m21:29:03.722316 [info ] [MainThread]: 
[0m21:29:03.722316 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:29:03.729348 [debug] [MainThread]: Command `dbt run` failed at 21:29:03.729348 after 7.21 seconds
[0m21:29:03.729348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509D408B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509CF04170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509D05E720>]}
[0m21:29:03.729348 [debug] [MainThread]: Flushing usage events
[0m21:29:04.616942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:38.216470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DA7EF81D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DA7A8ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DA7EF84A0>]}


============================== 21:29:38.227247 | 39f4ab69-6705-4089-8b5d-8e926b86a868 ==============================
[0m21:29:38.227247 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:29:38.235385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select provider_performance_summary', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:29:40.581948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39f4ab69-6705-4089-8b5d-8e926b86a868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC1EDF560>]}
[0m21:29:40.730365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39f4ab69-6705-4089-8b5d-8e926b86a868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC1F4A0F0>]}
[0m21:29:40.739958 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:29:41.305139 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:29:41.555103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:41.571035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:41.571035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:29:41.651728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39f4ab69-6705-4089-8b5d-8e926b86a868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC2117320>]}
[0m21:29:41.794258 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:29:41.794258 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:29:41.993894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39f4ab69-6705-4089-8b5d-8e926b86a868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DA805C410>]}
[0m21:29:41.993894 [info ] [MainThread]: Found 16 models, 4 data tests, 2 sources, 477 macros
[0m21:29:41.993894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f4ab69-6705-4089-8b5d-8e926b86a868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DBFA52E10>]}
[0m21:29:42.009680 [info ] [MainThread]: 
[0m21:29:42.009680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:42.009680 [info ] [MainThread]: 
[0m21:29:42.009680 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:42.016314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:29:42.120309 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:29:42.133682 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:29:42.133682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:43.013905 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.891 seconds
[0m21:29:43.036299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m21:29:43.061683 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:29:43.061683 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:29:43.061683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:43.579330 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.521 seconds
[0m21:29:43.595071 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:29:43.595071 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:29:43.689760 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.101 seconds
[0m21:29:43.689760 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:29:43.689760 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:29:43.800675 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m21:29:43.800675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m21:29:43.800675 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:29:43.816558 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:29:43.911554 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m21:29:43.911554 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:29:43.911554 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:29:44.032280 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.114 seconds
[0m21:29:44.034292 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:29:44.034292 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:29:44.121931 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m21:29:44.132066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f4ab69-6705-4089-8b5d-8e926b86a868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC28E0DD0>]}
[0m21:29:44.146534 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m21:29:44.146534 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.provider_performance_summary ................. [RUN]
[0m21:29:44.146534 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.provider_performance_summary'
[0m21:29:44.146534 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_performance_summary
[0m21:29:44.165641 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_performance_summary"
[0m21:29:44.165641 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_performance_summary
[0m21:29:44.239082 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_performance_summary"
[0m21:29:44.239082 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_performance_summary"
[0m21:29:44.244186 [debug] [Thread-1 (]: On model.healthcare.provider_performance_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_performance_summary"} */
create or replace transient table DBT_DB.GOLD.provider_performance_summary
    

    
    as (

WITH encounter_counts AS (
    SELECT
        provider_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY provider_id
),

transaction_sums AS (
    SELECT
        provider_id,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY provider_id
),

claims_with_providers AS (
    SELECT
        t.provider_id,
        SUM(COALESCE(c.paid_amount, 0)) AS total_payments
    FROM DBT_DB.SILVER.src_transactions t
    LEFT JOIN DBT_DB.SILVER.src_claims c
        ON t.transaction_id = c.transaction_id
    GROUP BY t.provider_id
),

combined_metrics AS (
    SELECT
        COALESCE(e.provider_id, t.provider_id, c.provider_id) AS provider_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_charges, 0) AS total_charges,
        COALESCE(total_payments, 0) AS total_payments
    FROM encounter_counts e
    FULL OUTER JOIN transaction_sums t ON e.provider_id = t.provider_id
    FULL OUTER JOIN claims_with_providers c ON COALESCE(e.provider_id, t.provider_id) = c.provider_id
),

final AS (
    SELECT
        cm.provider_id,
        p.full_name,
        p.specialization,
        p.dept_id,
        cm.total_encounters,
        cm.total_charges,
        cm.total_payments,
        ROUND(CASE 
            WHEN cm.total_encounters > 0 THEN cm.total_charges / cm.total_encounters
            ELSE NULL
        END, 2) AS avg_charge_per_encounter
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_providers p
        ON cm.provider_id = p.provider_id
)

SELECT * FROM final
    )
;
[0m21:29:44.244186 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:46.357884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.119 seconds
[0m21:29:46.405206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f4ab69-6705-4089-8b5d-8e926b86a868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DA4BCD490>]}
[0m21:29:46.405206 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.provider_performance_summary ............ [[32mSUCCESS 1[0m in 2.26s]
[0m21:29:46.405206 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m21:29:46.405206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:46.405206 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:29:46.405206 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:29:46.565894 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m21:29:46.565894 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m21:29:46.709667 [debug] [MainThread]: Connection 'model.healthcare.provider_performance_summary' was left open.
[0m21:29:46.717485 [debug] [MainThread]: On model.healthcare.provider_performance_summary: Close
[0m21:29:46.852051 [info ] [MainThread]: 
[0m21:29:46.852051 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m21:29:46.852051 [debug] [MainThread]: Command end result
[0m21:29:46.919459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:29:46.933790 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:29:46.945054 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:29:46.945054 [info ] [MainThread]: 
[0m21:29:46.950705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:46.950705 [info ] [MainThread]: 
[0m21:29:46.950705 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:29:46.957013 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:46.957013 after 9.07 seconds
[0m21:29:46.957013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DA7B4F980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DA7B4FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC0559760>]}
[0m21:29:46.957013 [debug] [MainThread]: Flushing usage events
[0m21:29:47.861789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:33.638042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBFEB1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC32AFB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC22DAF00>]}


============================== 21:32:33.638042 | 3eb080a7-8add-40bd-b441-5bdc1de011e6 ==============================
[0m21:32:33.638042 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:32:33.653804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select MISSING_PROVIDERS_AUDIT', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:32:36.167678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eb080a7-8add-40bd-b441-5bdc1de011e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BDBC2BB30>]}
[0m21:32:36.321378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3eb080a7-8add-40bd-b441-5bdc1de011e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BDD376D20>]}
[0m21:32:36.325043 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:32:36.871188 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:32:37.107743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:32:37.107743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:32:37.127173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:32:37.199027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3eb080a7-8add-40bd-b441-5bdc1de011e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BDD49D6A0>]}
[0m21:32:37.333506 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:32:37.341653 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:32:37.547652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3eb080a7-8add-40bd-b441-5bdc1de011e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BDBEE8200>]}
[0m21:32:37.547652 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:32:37.547652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eb080a7-8add-40bd-b441-5bdc1de011e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BDD83BFB0>]}
[0m21:32:37.547652 [warn ] [MainThread]: The selection criterion 'MISSING_PROVIDERS_AUDIT' does not match any enabled nodes
[0m21:32:37.547652 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:32:37.564613 [debug] [MainThread]: Command end result
[0m21:32:37.637405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:32:37.647881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:32:37.663491 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:32:37.667539 [debug] [MainThread]: Command `dbt run` succeeded at 21:32:37.665514 after 4.37 seconds
[0m21:32:37.669566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC0A4ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BDD4259D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BDD426C60>]}
[0m21:32:37.669566 [debug] [MainThread]: Flushing usage events
[0m21:32:38.631356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:22.475697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE830C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE830C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE830C680>]}


============================== 21:33:22.475697 | 0b7f389f-2634-416e-b2eb-1885f3b78c3c ==============================
[0m21:33:22.475697 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:33:22.475697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select missing_providers_audit', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:33:24.952778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b7f389f-2634-416e-b2eb-1885f3b78c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA82367500>]}
[0m21:33:25.110953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b7f389f-2634-416e-b2eb-1885f3b78c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA823C8E30>]}
[0m21:33:25.110953 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:33:25.707652 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:33:25.940025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:33:25.940025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:33:25.956112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:33:26.022453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b7f389f-2634-416e-b2eb-1885f3b78c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE7464200>]}
[0m21:33:26.180713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:33:26.180713 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:33:26.374865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b7f389f-2634-416e-b2eb-1885f3b78c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA82728350>]}
[0m21:33:26.374865 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:33:26.374865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b7f389f-2634-416e-b2eb-1885f3b78c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA82728260>]}
[0m21:33:26.379389 [info ] [MainThread]: 
[0m21:33:26.379389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:33:26.379389 [info ] [MainThread]: 
[0m21:33:26.386245 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:33:26.387758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:33:26.491029 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:33:26.491029 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:33:26.491029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:27.391748 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.903 seconds
[0m21:33:27.400731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:33:27.431430 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:33:27.431430 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:33:27.431430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:27.993936 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.557 seconds
[0m21:33:28.003755 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:33:28.003755 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:33:28.125205 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.131 seconds
[0m21:33:28.140881 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:33:28.140881 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:33:28.244668 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m21:33:28.244668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:33:28.244668 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:33:28.244668 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:33:28.360959 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m21:33:28.371553 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:33:28.371553 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:33:28.498866 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.134 seconds
[0m21:33:28.498866 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:33:28.498866 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:33:28.609197 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m21:33:28.624934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b7f389f-2634-416e-b2eb-1885f3b78c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA82E0A4E0>]}
[0m21:33:28.624934 [debug] [Thread-1 (]: Began running node model.healthcare.missing_providers_audit
[0m21:33:28.624934 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.missing_providers_audit ...................... [RUN]
[0m21:33:28.624934 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.missing_providers_audit'
[0m21:33:28.640681 [debug] [Thread-1 (]: Began compiling node model.healthcare.missing_providers_audit
[0m21:33:28.660370 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.missing_providers_audit"
[0m21:33:28.660370 [debug] [Thread-1 (]: Began executing node model.healthcare.missing_providers_audit
[0m21:33:28.742471 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.missing_providers_audit"
[0m21:33:28.742471 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.missing_providers_audit"
[0m21:33:28.742471 [debug] [Thread-1 (]: On model.healthcare.missing_providers_audit: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.missing_providers_audit"} */
create or replace transient table DBT_DB.GOLD.missing_providers_audit
    

    
    as (

SELECT
    provider_id,
    COUNT(*) AS occurrence_count,
    'encounters' AS source_table
FROM DBT_DB.SILVER.src_encounters
WHERE provider_id NOT IN (SELECT provider_id FROM DBT_DB.GOLD.dim_providers)
GROUP BY provider_id

UNION ALL

SELECT
    provider_id,
    COUNT(*) AS occurrence_count,
    'transactions' AS source_table
FROM DBT_DB.SILVER.src_transactions
WHERE provider_id NOT IN (SELECT provider_id FROM DBT_DB.GOLD.dim_providers)
GROUP BY provider_id
    )
;
[0m21:33:28.742471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:33:30.462742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.719 seconds
[0m21:33:30.510043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7f389f-2634-416e-b2eb-1885f3b78c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA82E4D0A0>]}
[0m21:33:30.510043 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.missing_providers_audit ................. [[32mSUCCESS 1[0m in 1.87s]
[0m21:33:30.510043 [debug] [Thread-1 (]: Finished running node model.healthcare.missing_providers_audit
[0m21:33:30.510043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:30.510043 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:33:30.510043 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:33:30.654092 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:33:30.654092 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:33:30.795433 [debug] [MainThread]: Connection 'model.healthcare.missing_providers_audit' was left open.
[0m21:33:30.795433 [debug] [MainThread]: On model.healthcare.missing_providers_audit: Close
[0m21:33:30.953179 [info ] [MainThread]: 
[0m21:33:30.953179 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m21:33:30.953179 [debug] [MainThread]: Command end result
[0m21:33:31.010500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:33:31.019838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:33:31.035268 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:33:31.035268 [info ] [MainThread]: 
[0m21:33:31.035268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:31.035268 [info ] [MainThread]: 
[0m21:33:31.035268 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:33:31.043438 [debug] [MainThread]: Command `dbt run` succeeded at 21:33:31.043438 after 8.92 seconds
[0m21:33:31.043438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE7B89C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE82EBD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE7F454C0>]}
[0m21:33:31.043438 [debug] [MainThread]: Flushing usage events
[0m21:33:31.931345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:53.023373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905A1D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905A1D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905A1C410>]}


============================== 21:35:53.033453 | 31579484-250b-4215-af96-3f531321eb37 ==============================
[0m21:35:53.033453 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:35:53.035470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select patient_utilization_summary', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:35:55.530830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31579484-250b-4215-af96-3f531321eb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905A41250>]}
[0m21:35:55.690626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31579484-250b-4215-af96-3f531321eb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E5A1280>]}
[0m21:35:55.694648 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:35:56.290427 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:35:56.528357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:56.528357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:56.546384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:35:56.613848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31579484-250b-4215-af96-3f531321eb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FC37A40>]}
[0m21:35:56.768018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:35:56.774054 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:35:56.951685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31579484-250b-4215-af96-3f531321eb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FF8BBC0>]}
[0m21:35:56.951685 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:35:56.955473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31579484-250b-4215-af96-3f531321eb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FDD03B0>]}
[0m21:35:56.955473 [info ] [MainThread]: 
[0m21:35:56.955473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:56.961620 [info ] [MainThread]: 
[0m21:35:56.961620 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:56.964558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:35:57.064083 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:35:57.064083 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:35:57.064083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:57.933528 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.866 seconds
[0m21:35:57.948504 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:35:57.972018 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:35:57.974031 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:35:57.974031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:58.532970 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.559 seconds
[0m21:35:58.540003 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:35:58.542010 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:35:58.676688 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.134 seconds
[0m21:35:58.680457 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:35:58.681637 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:35:58.788634 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m21:35:58.792664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:35:58.798759 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:35:58.798759 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:35:58.913459 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m21:35:58.913459 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:35:58.913459 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:35:59.041622 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.122 seconds
[0m21:35:59.044399 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:35:59.044399 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:35:59.140255 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m21:35:59.144277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31579484-250b-4215-af96-3f531321eb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FB28B90>]}
[0m21:35:59.154348 [debug] [Thread-1 (]: Began running node model.healthcare.patient_utilization_summary
[0m21:35:59.156364 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.patient_utilization_summary .................. [RUN]
[0m21:35:59.158378 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.patient_utilization_summary'
[0m21:35:59.158378 [debug] [Thread-1 (]: Began compiling node model.healthcare.patient_utilization_summary
[0m21:35:59.174239 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.patient_utilization_summary"
[0m21:35:59.180586 [debug] [Thread-1 (]: Began executing node model.healthcare.patient_utilization_summary
[0m21:35:59.242788 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.patient_utilization_summary"
[0m21:35:59.246819 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.patient_utilization_summary"
[0m21:35:59.248832 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.patient_utilization_summary"} */
create or replace transient table DBT_DB.GOLD.patient_utilization_summary
    

    
    as (

-- Step 1: encounter counts per patient
WITH encounter_summary AS (
    SELECT
        patient_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY patient_id
),

-- Step 2: transaction summary per patient
transaction_summary AS (
    SELECT
        patient_id,
        COUNT(*) AS total_procedures,
        SUM(COALESCE(amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY patient_id
),

-- Step 3: combine metrics at patient level
combined_metrics AS (
    SELECT
        COALESCE(e.patient_id, t.patient_id) AS patient_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_procedures, 0) AS total_procedures,
        COALESCE(total_charges, 0) AS total_charges
    FROM encounter_summary e
    FULL OUTER JOIN transaction_summary t
        ON e.patient_id = t.patient_id
),

-- Step 4: enrich with demographic data
final AS (
    SELECT
        cm.patient_id,
        p.first_name,
        p.last_name,
        p.gender_flag,
        p.age,
        p.age_group,
        cm.total_encounters,
        cm.total_procedures,
        cm.total_charges
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_patients p
        ON cm.patient_id = p.patient_key
)

SELECT * FROM final
    )
;
[0m21:35:59.248832 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:35:59.919953 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf55f-0000-2795-0027-cf8b00072606
[0m21:35:59.919953 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 21
invalid identifier 'AMOUNT'
[0m21:35:59.926001 [debug] [Thread-1 (]: Database Error in model patient_utilization_summary (models\healthcare\fact\patient_utilization_summary.sql)
  000904 (42000): SQL compilation error: error line 21 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\patient_utilization_summary.sql
[0m21:35:59.936072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31579484-250b-4215-af96-3f531321eb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021904B18EF0>]}
[0m21:35:59.938083 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.patient_utilization_summary ......... [[31mERROR[0m in 0.77s]
[0m21:35:59.940093 [debug] [Thread-1 (]: Finished running node model.healthcare.patient_utilization_summary
[0m21:35:59.940603 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.patient_utilization_summary' to be skipped because of status 'error'.  Reason: Database Error in model patient_utilization_summary (models\healthcare\fact\patient_utilization_summary.sql)
  000904 (42000): SQL compilation error: error line 21 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\patient_utilization_summary.sql.
[0m21:35:59.945320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:59.945320 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:35:59.945320 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:36:00.116210 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:36:00.116210 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:36:00.284954 [debug] [MainThread]: Connection 'model.healthcare.patient_utilization_summary' was left open.
[0m21:36:00.285916 [debug] [MainThread]: On model.healthcare.patient_utilization_summary: Close
[0m21:36:00.446299 [info ] [MainThread]: 
[0m21:36:00.446299 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m21:36:00.450343 [debug] [MainThread]: Command end result
[0m21:36:00.515070 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:36:00.521128 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:36:00.540281 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:36:00.540281 [info ] [MainThread]: 
[0m21:36:00.543736 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:36:00.543736 [info ] [MainThread]: 
[0m21:36:00.545918 [error] [MainThread]: [31mFailure in model patient_utilization_summary (models\healthcare\fact\patient_utilization_summary.sql)[0m
[0m21:36:00.549441 [error] [MainThread]:   Database Error in model patient_utilization_summary (models\healthcare\fact\patient_utilization_summary.sql)
  000904 (42000): SQL compilation error: error line 21 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\patient_utilization_summary.sql
[0m21:36:00.549441 [info ] [MainThread]: 
[0m21:36:00.554124 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\patient_utilization_summary.sql
[0m21:36:00.554124 [info ] [MainThread]: 
[0m21:36:00.558168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:36:00.562388 [debug] [MainThread]: Command `dbt run` failed at 21:36:00.562388 after 7.93 seconds
[0m21:36:00.569140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FF8BE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FDD02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905A1CBC0>]}
[0m21:36:00.571155 [debug] [MainThread]: Flushing usage events
[0m21:36:01.522343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:29.503940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6EB651C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED71BFDA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED71BFCEF0>]}


============================== 21:36:29.505949 | 9c3e7c62-c87d-4b03-a45f-a7ae3972e6df ==============================
[0m21:36:29.505949 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:36:29.517747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select patient_utilization_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:36:31.779898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c3e7c62-c87d-4b03-a45f-a7ae3972e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0ADB71A0>]}
[0m21:36:31.918392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c3e7c62-c87d-4b03-a45f-a7ae3972e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED71128D10>]}
[0m21:36:31.920406 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:36:32.478053 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:36:32.726810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:32.728825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:32.736877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:36:32.808259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c3e7c62-c87d-4b03-a45f-a7ae3972e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0C324050>]}
[0m21:36:32.943131 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:36:32.947164 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:36:33.114807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c3e7c62-c87d-4b03-a45f-a7ae3972e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0A5BC2C0>]}
[0m21:36:33.117687 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:36:33.121331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c3e7c62-c87d-4b03-a45f-a7ae3972e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0AE58BC0>]}
[0m21:36:33.121331 [info ] [MainThread]: 
[0m21:36:33.121331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:36:33.130307 [info ] [MainThread]: 
[0m21:36:33.133021 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:36:33.137316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:36:33.249151 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:36:33.249151 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:36:33.249151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:34.170913 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.918 seconds
[0m21:36:34.188073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:36:34.214680 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:36:34.216708 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:36:34.216708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:34.766604 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.552 seconds
[0m21:36:34.766604 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:36:34.766604 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:36:34.909295 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.130 seconds
[0m21:36:34.913087 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:36:34.915106 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:36:35.005357 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m21:36:35.009377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:36:35.017177 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:36:35.019197 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:36:35.129167 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:36:35.133187 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:36:35.135198 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:36:35.244379 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.109 seconds
[0m21:36:35.248419 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:36:35.250438 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:36:35.339704 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m21:36:35.345768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c3e7c62-c87d-4b03-a45f-a7ae3972e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0C14CA40>]}
[0m21:36:35.355619 [debug] [Thread-1 (]: Began running node model.healthcare.patient_utilization_summary
[0m21:36:35.357639 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.patient_utilization_summary .................. [RUN]
[0m21:36:35.359660 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.patient_utilization_summary'
[0m21:36:35.359660 [debug] [Thread-1 (]: Began compiling node model.healthcare.patient_utilization_summary
[0m21:36:35.377610 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.patient_utilization_summary"
[0m21:36:35.383372 [debug] [Thread-1 (]: Began executing node model.healthcare.patient_utilization_summary
[0m21:36:35.459668 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.patient_utilization_summary"
[0m21:36:35.467263 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.patient_utilization_summary"
[0m21:36:35.469291 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.patient_utilization_summary"} */
create or replace transient table DBT_DB.GOLD.patient_utilization_summary
    

    
    as (

-- Step 1: encounter counts per patient
WITH encounter_summary AS (
    SELECT
        patient_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY patient_id
),

-- Step 2: transaction summary per patient
transaction_summary AS (
    SELECT
        patient_id,
        COUNT(*) AS total_procedures,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY patient_id
),

-- Step 3: combine metrics at patient level
combined_metrics AS (
    SELECT
        COALESCE(e.patient_id, t.patient_id) AS patient_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_procedures, 0) AS total_procedures,
        COALESCE(total_charges, 0) AS total_charges
    FROM encounter_summary e
    FULL OUTER JOIN transaction_summary t
        ON e.patient_id = t.patient_id
),

-- Step 4: enrich with demographic data
final AS (
    SELECT
        cm.patient_id,
        p.first_name,
        p.last_name,
        p.gender_flag,
        p.age,
        p.age_group,
        cm.total_encounters,
        cm.total_procedures,
        cm.total_charges
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_patients p
        ON cm.patient_id = p.patient_key
)

SELECT * FROM final
    )
;
[0m21:36:35.471310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:36:36.981738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.511 seconds
[0m21:36:37.023899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c3e7c62-c87d-4b03-a45f-a7ae3972e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6EC4D580>]}
[0m21:36:37.025913 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.patient_utilization_summary ............. [[32mSUCCESS 1[0m in 1.66s]
[0m21:36:37.027927 [debug] [Thread-1 (]: Finished running node model.healthcare.patient_utilization_summary
[0m21:36:37.030773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:37.030773 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:36:37.032793 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:36:37.174856 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:36:37.174856 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:36:37.318001 [debug] [MainThread]: Connection 'model.healthcare.patient_utilization_summary' was left open.
[0m21:36:37.318001 [debug] [MainThread]: On model.healthcare.patient_utilization_summary: Close
[0m21:36:37.458417 [info ] [MainThread]: 
[0m21:36:37.460435 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m21:36:37.462447 [debug] [MainThread]: Command end result
[0m21:36:37.520740 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:36:37.524904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:36:37.539998 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:36:37.542019 [info ] [MainThread]: 
[0m21:36:37.543696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:37.543696 [info ] [MainThread]: 
[0m21:36:37.545717 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:36:37.547734 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:37.547734 after 8.37 seconds
[0m21:36:37.547734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED71F5BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0C562840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0C34E0F0>]}
[0m21:36:37.547734 [debug] [MainThread]: Flushing usage events
[0m21:36:38.472746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:19.535811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D4391730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D43913A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D4390320>]}


============================== 21:39:19.542196 | 56b2ac5f-290b-4bef-a47f-a2d447d064af ==============================
[0m21:39:19.542196 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:39:19.542196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select procedure_statistics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:39:22.055199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56b2ac5f-290b-4bef-a47f-a2d447d064af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253EE37F470>]}
[0m21:39:22.202369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56b2ac5f-290b-4bef-a47f-a2d447d064af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253ECB74800>]}
[0m21:39:22.202369 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:39:22.724393 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:39:22.995700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:39:22.995700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:39:23.004547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:39:23.077993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56b2ac5f-290b-4bef-a47f-a2d447d064af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253EE5A2360>]}
[0m21:39:23.213183 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:39:23.216566 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:39:23.386900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56b2ac5f-290b-4bef-a47f-a2d447d064af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253EE55B920>]}
[0m21:39:23.388418 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:39:23.391911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b2ac5f-290b-4bef-a47f-a2d447d064af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D1A2B410>]}
[0m21:39:23.394922 [info ] [MainThread]: 
[0m21:39:23.396944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:23.399215 [info ] [MainThread]: 
[0m21:39:23.400134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:23.400134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:39:23.517605 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:39:23.517605 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:39:23.517605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:24.478645 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.957 seconds
[0m21:39:24.482663 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:39:24.512095 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:24.517863 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:39:24.519822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:25.171361 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.658 seconds
[0m21:39:25.180440 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:25.188062 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:39:25.298865 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.110 seconds
[0m21:39:25.302436 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:25.304448 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:39:25.411698 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m21:39:25.413716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:39:25.419750 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:25.421766 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:39:25.516578 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m21:39:25.518587 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:25.518587 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:39:25.661650 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.142 seconds
[0m21:39:25.665685 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:25.665685 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:39:25.764605 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m21:39:25.770388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b2ac5f-290b-4bef-a47f-a2d447d064af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253EEE8D9A0>]}
[0m21:39:25.779042 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m21:39:25.779558 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m21:39:25.782829 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m21:39:25.782829 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m21:39:25.820706 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m21:39:25.824736 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m21:39:25.884029 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m21:39:25.888072 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m21:39:25.890091 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate transaction data by procedure code
WITH procedure_summary AS (
    SELECT
        procedure_code AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension for descriptions
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final;
[0m21:39:25.892108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:39:26.451874 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf563-0000-2795-0027-cf8b0007262a
[0m21:39:26.460274 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 32 at position 19 unexpected ';'.
[0m21:39:26.465872 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:39:26.471952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b2ac5f-290b-4bef-a47f-a2d447d064af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D34892E0>]}
[0m21:39:26.471952 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.69s]
[0m21:39:26.476840 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m21:39:26.476840 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m21:39:26.484881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:26.484881 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:39:26.484881 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:39:26.654185 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:39:26.654185 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:39:26.800651 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m21:39:26.802664 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m21:39:26.943913 [info ] [MainThread]: 
[0m21:39:26.945959 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m21:39:26.947613 [debug] [MainThread]: Command end result
[0m21:39:27.019288 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:39:27.025046 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:39:27.037576 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:39:27.037576 [info ] [MainThread]: 
[0m21:39:27.040329 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:39:27.040329 [info ] [MainThread]: 
[0m21:39:27.044240 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m21:39:27.044240 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 19 unexpected ';'.
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:39:27.048377 [info ] [MainThread]: 
[0m21:39:27.052111 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:39:27.057552 [info ] [MainThread]: 
[0m21:39:27.059486 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:39:27.061503 [debug] [MainThread]: Command `dbt run` failed at 21:39:27.061503 after 7.88 seconds
[0m21:39:27.063513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D4277DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D43AD850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253EE74C3E0>]}
[0m21:39:27.069478 [debug] [MainThread]: Flushing usage events
[0m21:39:27.989336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:47.533170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204DFBF1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E2781E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E2782300>]}


============================== 21:39:47.539209 | 71a78629-2959-46d9-a1f1-600191783b18 ==============================
[0m21:39:47.539209 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:39:47.539209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select procedure_statistics', 'send_anonymous_usage_stats': 'True'}
[0m21:39:49.309328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71a78629-2959-46d9-a1f1-600191783b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FCF8D0A0>]}
[0m21:39:49.408981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71a78629-2959-46d9-a1f1-600191783b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FD01FC80>]}
[0m21:39:49.410998 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:39:49.807472 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:39:49.979195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:39:49.981206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:39:49.987245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:39:50.036641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71a78629-2959-46d9-a1f1-600191783b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FD35C200>]}
[0m21:39:50.137299 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:39:50.140926 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:39:50.312290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71a78629-2959-46d9-a1f1-600191783b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E0609EE0>]}
[0m21:39:50.312290 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:39:50.312290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71a78629-2959-46d9-a1f1-600191783b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E2A12C60>]}
[0m21:39:50.327985 [info ] [MainThread]: 
[0m21:39:50.327985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:50.327985 [info ] [MainThread]: 
[0m21:39:50.327985 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:50.334070 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:39:50.439087 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:39:50.439087 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:39:50.439087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:51.449502 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.010 seconds
[0m21:39:51.469075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:39:51.492063 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:51.494088 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:39:51.494088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:51.888096 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.392 seconds
[0m21:39:51.894162 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:51.895931 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:39:52.022125 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.125 seconds
[0m21:39:52.026146 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:39:52.028156 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:39:52.131107 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m21:39:52.135138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:39:52.139173 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:52.139173 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:39:52.244065 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:39:52.248097 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:52.248097 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:39:52.381429 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.132 seconds
[0m21:39:52.386674 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:39:52.386674 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:39:52.476710 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m21:39:52.476710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71a78629-2959-46d9-a1f1-600191783b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FD168500>]}
[0m21:39:52.496494 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m21:39:52.498504 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m21:39:52.500513 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m21:39:52.502524 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m21:39:52.523909 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m21:39:52.531299 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m21:39:52.636080 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m21:39:52.641416 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m21:39:52.641416 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate transaction data by procedure code
WITH procedure_summary AS (
    SELECT
        procedure_code AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension for descriptions
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
    )
;
[0m21:39:52.643440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:39:53.233404 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf563-0000-2803-0027-cf8b0006fe12
[0m21:39:53.233404 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 21
invalid identifier 'AMOUNT'
[0m21:39:53.240473 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:39:53.246528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71a78629-2959-46d9-a1f1-600191783b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E2099220>]}
[0m21:39:53.248553 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.74s]
[0m21:39:53.250742 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m21:39:53.252756 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m21:39:53.257769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:53.258550 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:39:53.258550 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:39:53.423579 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:39:53.423579 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:39:53.583434 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m21:39:53.585522 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m21:39:53.728866 [info ] [MainThread]: 
[0m21:39:53.730878 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m21:39:53.732887 [debug] [MainThread]: Command end result
[0m21:39:53.795048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:39:53.804289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:39:53.821157 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:39:53.821157 [info ] [MainThread]: 
[0m21:39:53.824910 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:39:53.826927 [info ] [MainThread]: 
[0m21:39:53.827666 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m21:39:53.830959 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:39:53.834819 [info ] [MainThread]: 
[0m21:39:53.839884 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:39:53.841813 [info ] [MainThread]: 
[0m21:39:53.844041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:39:53.847652 [debug] [MainThread]: Command `dbt run` failed at 21:39:53.847652 after 6.63 seconds
[0m21:39:53.847652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FBC0E000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FAA620C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E0609A30>]}
[0m21:39:53.847652 [debug] [MainThread]: Flushing usage events
[0m21:39:54.673259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:30.389931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CD8E616A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CD8E61EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CD8E600E0>]}


============================== 21:40:30.397712 | cb89aa9e-d401-40a5-b0f1-df464efabed7 ==============================
[0m21:40:30.397712 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:40:30.397712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select procedure_statistics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:40:32.871441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb89aa9e-d401-40a5-b0f1-df464efabed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF11FE9F0>]}
[0m21:40:33.012113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb89aa9e-d401-40a5-b0f1-df464efabed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF12C05F0>]}
[0m21:40:33.028208 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:40:33.566040 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:40:33.807407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:40:33.807407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:40:33.823299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m21:40:33.887732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb89aa9e-d401-40a5-b0f1-df464efabed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF2F660F0>]}
[0m21:40:34.052110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:40:34.056279 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:40:34.221569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb89aa9e-d401-40a5-b0f1-df464efabed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF302CDD0>]}
[0m21:40:34.221569 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:40:34.221569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb89aa9e-d401-40a5-b0f1-df464efabed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF0D26990>]}
[0m21:40:34.221569 [info ] [MainThread]: 
[0m21:40:34.221569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:34.221569 [info ] [MainThread]: 
[0m21:40:34.232108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:40:34.232108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:40:34.356447 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:40:34.356447 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:40:34.358460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:35.375800 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.017 seconds
[0m21:40:35.400117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:40:35.472495 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:40:35.475082 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:40:35.475708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:36.151640 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.676 seconds
[0m21:40:36.157674 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:40:36.159685 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:40:36.305255 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.144 seconds
[0m21:40:36.307273 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:40:36.309288 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:40:36.404679 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m21:40:36.408708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:40:36.414760 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:40:36.416524 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:40:36.519505 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m21:40:36.523534 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:40:36.523534 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:40:36.648845 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.124 seconds
[0m21:40:36.650603 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:40:36.652647 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:40:36.761398 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.108 seconds
[0m21:40:36.767463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb89aa9e-d401-40a5-b0f1-df464efabed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3349310>]}
[0m21:40:36.776051 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m21:40:36.777069 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m21:40:36.779974 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m21:40:36.781990 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m21:40:36.801201 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m21:40:36.805118 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m21:40:36.878151 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m21:40:36.882619 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m21:40:36.882619 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate transaction data by procedure code
WITH procedure_summary AS (
    SELECT
        procedure_code AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(acharge_mount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension for descriptions
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
    )
;
[0m21:40:36.882619 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:40:37.515046 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf564-0000-2803-0027-cf8b0006fe1a
[0m21:40:37.516800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 21
invalid identifier 'ACHARGE_MOUNT'
[0m21:40:37.520823 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'ACHARGE_MOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:40:37.520823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb89aa9e-d401-40a5-b0f1-df464efabed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CD7F49370>]}
[0m21:40:37.520823 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.74s]
[0m21:40:37.520823 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m21:40:37.520823 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'ACHARGE_MOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m21:40:37.536126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:37.536126 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:40:37.536126 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:40:37.684405 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:40:37.689645 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:40:37.831132 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m21:40:37.833145 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m21:40:37.969700 [info ] [MainThread]: 
[0m21:40:37.969700 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m21:40:37.973112 [debug] [MainThread]: Command end result
[0m21:40:38.027223 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:40:38.033288 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:40:38.048122 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:40:38.048122 [info ] [MainThread]: 
[0m21:40:38.050140 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:40:38.050140 [info ] [MainThread]: 
[0m21:40:38.052158 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m21:40:38.052793 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'ACHARGE_MOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:40:38.058146 [info ] [MainThread]: 
[0m21:40:38.059760 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:40:38.062297 [info ] [MainThread]: 
[0m21:40:38.063313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:40:38.066725 [debug] [MainThread]: Command `dbt run` failed at 21:40:38.066725 after 8.02 seconds
[0m21:40:38.066725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF305C9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3443E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF1A74500>]}
[0m21:40:38.068751 [debug] [MainThread]: Flushing usage events
[0m21:40:38.934826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:05.278834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026843E612B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026846A2DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026846A2D100>]}


============================== 21:41:05.289779 | e278ff8b-30a5-4c9f-b00d-03440e44589c ==============================
[0m21:41:05.289779 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:41:05.292661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select procedure_statistics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:41:07.805499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e278ff8b-30a5-4c9f-b00d-03440e44589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002686128F590>]}
[0m21:41:07.963501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e278ff8b-30a5-4c9f-b00d-03440e44589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F9AEBA0>]}
[0m21:41:07.963501 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:41:08.548355 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:41:08.792953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:41:08.794961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:41:08.800716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:41:08.865709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e278ff8b-30a5-4c9f-b00d-03440e44589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268614056A0>]}
[0m21:41:08.992516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:41:09.005400 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:41:09.207998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e278ff8b-30a5-4c9f-b00d-03440e44589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685FB5D820>]}
[0m21:41:09.207998 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:41:09.207998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e278ff8b-30a5-4c9f-b00d-03440e44589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F128170>]}
[0m21:41:09.207998 [info ] [MainThread]: 
[0m21:41:09.207998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:41:09.207998 [info ] [MainThread]: 
[0m21:41:09.219470 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:41:09.222028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:41:09.339668 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:41:09.339668 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:41:09.339668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:10.312425 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.968 seconds
[0m21:41:10.327700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:41:10.350889 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:41:10.350889 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:41:10.352653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:10.958594 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.608 seconds
[0m21:41:10.966785 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:41:10.966785 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:41:11.080824 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.110 seconds
[0m21:41:11.082832 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:41:11.084841 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:41:11.169791 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m21:41:11.184457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:41:11.192332 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:41:11.192332 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:41:11.290731 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m21:41:11.292740 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:41:11.294748 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:41:11.413946 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.119 seconds
[0m21:41:11.415957 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:41:11.415957 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:41:11.517820 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:41:11.525876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e278ff8b-30a5-4c9f-b00d-03440e44589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026861D03980>]}
[0m21:41:11.534875 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m21:41:11.537407 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m21:41:11.539419 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m21:41:11.539419 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m21:41:11.569665 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m21:41:11.569665 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m21:41:11.641589 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m21:41:11.641589 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m21:41:11.649694 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate transaction data by procedure code
WITH procedure_summary AS (
    SELECT
        procedure_code AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension for descriptions
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
    )
;
[0m21:41:11.649694 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:12.708618 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf565-0000-27ff-0027-cf8b00066e26
[0m21:41:12.708618 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'Open repair of infrarenal aortic aneurysm or dissection, plus repair of associated arterial trauma, following unsuccessful endovascular repair; tube prosthesis' is not recognized
[0m21:41:12.714413 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  100038 (22018): Numeric value 'Open repair of infrarenal aortic aneurysm or dissection, plus repair of associated arterial trauma, following unsuccessful endovascular repair; tube prosthesis' is not recognized
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:41:12.720453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e278ff8b-30a5-4c9f-b00d-03440e44589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026846349340>]}
[0m21:41:12.720453 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 1.18s]
[0m21:41:12.723683 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m21:41:12.723683 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  100038 (22018): Numeric value 'Open repair of infrarenal aortic aneurysm or dissection, plus repair of associated arterial trauma, following unsuccessful endovascular repair; tube prosthesis' is not recognized
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m21:41:12.728963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:12.728963 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:41:12.728963 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:41:12.868570 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:41:12.868570 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:41:13.025861 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m21:41:13.027620 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m21:41:13.172641 [info ] [MainThread]: 
[0m21:41:13.174656 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m21:41:13.177022 [debug] [MainThread]: Command end result
[0m21:41:13.239225 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:41:13.245321 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:41:13.257427 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:41:13.257427 [info ] [MainThread]: 
[0m21:41:13.260208 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:41:13.261469 [info ] [MainThread]: 
[0m21:41:13.262641 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m21:41:13.263831 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  100038 (22018): Numeric value 'Open repair of infrarenal aortic aneurysm or dissection, plus repair of associated arterial trauma, following unsuccessful endovascular repair; tube prosthesis' is not recognized
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:41:13.272825 [info ] [MainThread]: 
[0m21:41:13.274844 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m21:41:13.277082 [info ] [MainThread]: 
[0m21:41:13.278267 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:41:13.279563 [debug] [MainThread]: Command `dbt run` failed at 21:41:13.279563 after 8.35 seconds
[0m21:41:13.279563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026846B5B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002686147DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002686189A0F0>]}
[0m21:41:13.281930 [debug] [MainThread]: Flushing usage events
[0m21:41:14.314470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:10.856804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263241C13D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263262D36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263262D2270>]}


============================== 21:43:10.863370 | 69e993e2-9332-4b20-b57d-83f5478d203c ==============================
[0m21:43:10.863370 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:43:10.863370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select procedure_statistics', 'send_anonymous_usage_stats': 'True'}
[0m21:43:13.645692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69e993e2-9332-4b20-b57d-83f5478d203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263404923C0>]}
[0m21:43:13.788248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69e993e2-9332-4b20-b57d-83f5478d203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026341679A30>]}
[0m21:43:13.788248 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m21:43:14.313804 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:43:14.566575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:43:14.569105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:43:14.578252 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m21:43:14.642762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69e993e2-9332-4b20-b57d-83f5478d203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263417E8E30>]}
[0m21:43:14.794448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:43:14.800503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:43:14.999989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69e993e2-9332-4b20-b57d-83f5478d203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263417EBA40>]}
[0m21:43:14.999989 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m21:43:15.004031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e993e2-9332-4b20-b57d-83f5478d203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026326AFF7A0>]}
[0m21:43:15.004031 [info ] [MainThread]: 
[0m21:43:15.007586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:15.007586 [info ] [MainThread]: 
[0m21:43:15.010777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:43:15.011924 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m21:43:15.123813 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m21:43:15.123813 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m21:43:15.131891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:16.500638 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.369 seconds
[0m21:43:16.514664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m21:43:16.525883 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:43:16.525883 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:43:16.525883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:17.124606 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.586 seconds
[0m21:43:17.132653 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:43:17.132653 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m21:43:17.275501 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.141 seconds
[0m21:43:17.277511 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m21:43:17.279525 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:43:17.379827 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:43:17.382575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m21:43:17.386607 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:43:17.386607 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m21:43:17.493249 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m21:43:17.495259 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:43:17.497277 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m21:43:17.623463 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.126 seconds
[0m21:43:17.627238 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m21:43:17.627238 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m21:43:17.736054 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m21:43:17.740083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e993e2-9332-4b20-b57d-83f5478d203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026341BE96A0>]}
[0m21:43:17.747376 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m21:43:17.749390 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m21:43:17.751400 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m21:43:17.753032 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m21:43:17.782716 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m21:43:17.786856 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m21:43:17.864473 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m21:43:17.868506 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m21:43:17.868506 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate transaction data by procedure code
WITH procedure_summary AS (
    SELECT
        procedure_code AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension for descriptions
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
    ON CAST(ps.cpt_code AS STRING) = CAST(c.cpt_code AS STRING)

)

SELECT * FROM final
    )
;
[0m21:43:17.868506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:43:19.260276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.390 seconds
[0m21:43:19.301583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69e993e2-9332-4b20-b57d-83f5478d203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263242A97C0>]}
[0m21:43:19.302644 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.procedure_statistics .................... [[32mSUCCESS 1[0m in 1.55s]
[0m21:43:19.302644 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m21:43:19.308869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:19.308869 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m21:43:19.308869 [debug] [MainThread]: On list_DBT_DB: Close
[0m21:43:19.469259 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m21:43:19.471657 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m21:43:19.611886 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m21:43:19.611886 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m21:43:19.754873 [info ] [MainThread]: 
[0m21:43:19.756885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m21:43:19.759155 [debug] [MainThread]: Command end result
[0m21:43:19.815458 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m21:43:19.822503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m21:43:19.834765 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m21:43:19.834765 [info ] [MainThread]: 
[0m21:43:19.836810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:43:19.837907 [info ] [MainThread]: 
[0m21:43:19.838594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:43:19.841381 [debug] [MainThread]: Command `dbt run` succeeded at 21:43:19.841381 after 9.30 seconds
[0m21:43:19.843399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026341C19FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026341DC7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026326C01520>]}
[0m21:43:19.843399 [debug] [MainThread]: Flushing usage events
[0m21:43:20.841007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:08.105387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82433D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82704B6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C827049CA0>]}


============================== 22:04:08.121215 | 679ec28c-86ab-4f72-951a-5ce31df3cd2a ==============================
[0m22:04:08.121215 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:04:08.121215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select procedure_statistics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:10.257514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '679ec28c-86ab-4f72-951a-5ce31df3cd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C83EFCC4A0>]}
[0m22:04:10.409615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '679ec28c-86ab-4f72-951a-5ce31df3cd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C83F1F22A0>]}
[0m22:04:10.409615 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:04:11.006771 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:04:11.291341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:11.291341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:11.291341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m22:04:11.368458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '679ec28c-86ab-4f72-951a-5ce31df3cd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C840284CE0>]}
[0m22:04:11.525758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:04:11.541512 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:04:11.715065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '679ec28c-86ab-4f72-951a-5ce31df3cd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8418F9A30>]}
[0m22:04:11.715065 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:04:11.715065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679ec28c-86ab-4f72-951a-5ce31df3cd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C84006CC80>]}
[0m22:04:11.730817 [info ] [MainThread]: 
[0m22:04:11.730817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:04:11.730817 [info ] [MainThread]: 
[0m22:04:11.730817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:04:11.739231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:04:11.860815 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:04:11.860815 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:04:11.860815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:12.829503 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.969 seconds
[0m22:04:12.829503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:04:12.862016 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:04:12.862016 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:04:12.862016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:13.500055 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.633 seconds
[0m22:04:13.508928 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:04:13.508928 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:04:13.644160 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.143 seconds
[0m22:04:13.644160 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:04:13.644160 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:04:13.764931 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m22:04:13.764931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:04:13.770985 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:04:13.770985 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:04:13.881837 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m22:04:13.881837 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:04:13.881837 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:04:14.008529 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.119 seconds
[0m22:04:14.008529 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:04:14.008529 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:04:14.120668 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m22:04:14.129339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679ec28c-86ab-4f72-951a-5ce31df3cd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C841EEE6C0>]}
[0m22:04:14.137433 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:04:14.145638 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:04:14.146002 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:04:14.146002 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:04:14.165830 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:04:14.170947 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:04:14.236062 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:04:14.236062 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:04:14.236062 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate transaction data by procedure code
WITH procedure_summary AS (
    SELECT
        procedure_code AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension for descriptions
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
    ON c.procedure_code = ps.cpt_code

)

SELECT * FROM final
    )
;
[0m22:04:14.236062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:04:14.679667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf57c-0000-2803-0027-cf8b0006fe92
[0m22:04:14.679667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 7
invalid identifier 'C.PROCEDURE_CODE'
[0m22:04:14.687472 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 7
  invalid identifier 'C.PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:04:14.687472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '679ec28c-86ab-4f72-951a-5ce31df3cd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C841957500>]}
[0m22:04:14.687472 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.54s]
[0m22:04:14.687472 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:04:14.687472 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 7
  invalid identifier 'C.PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m22:04:14.703312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:14.703312 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:04:14.703312 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:04:14.867665 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:04:14.867665 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:04:15.372068 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:04:15.372068 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:04:15.530330 [info ] [MainThread]: 
[0m22:04:15.530330 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m22:04:15.530330 [debug] [MainThread]: Command end result
[0m22:04:15.587948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:04:15.597404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:04:15.604036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:04:15.604036 [info ] [MainThread]: 
[0m22:04:15.604036 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:04:15.604036 [info ] [MainThread]: 
[0m22:04:15.612098 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m22:04:15.621056 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 7
  invalid identifier 'C.PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:04:15.622485 [info ] [MainThread]: 
[0m22:04:15.622485 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:04:15.622485 [info ] [MainThread]: 
[0m22:04:15.622485 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:04:15.636797 [debug] [MainThread]: Command `dbt run` failed at 22:04:15.636797 after 7.84 seconds
[0m22:04:15.638654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C841D23E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C827763680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82773CBC0>]}
[0m22:04:15.638654 [debug] [MainThread]: Flushing usage events
[0m22:04:16.534124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:52.842866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA4AC7A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA481413D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA4AF187A0>]}


============================== 22:04:52.858711 | 16e79411-3614-4186-933a-f32a398ba47c ==============================
[0m22:04:52.858711 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:04:52.858711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select procedure_statistics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:04:55.942443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16e79411-3614-4186-933a-f32a398ba47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA634727E0>]}
[0m22:04:56.100705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16e79411-3614-4186-933a-f32a398ba47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA63B885F0>]}
[0m22:04:56.116471 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:04:56.865860 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:04:57.168671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:57.168671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:57.168671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m22:04:57.274146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16e79411-3614-4186-933a-f32a398ba47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA657025A0>]}
[0m22:04:57.457706 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:04:57.457706 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:04:57.743203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16e79411-3614-4186-933a-f32a398ba47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA48B6BB30>]}
[0m22:04:57.743203 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:04:57.743203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e79411-3614-4186-933a-f32a398ba47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA642032C0>]}
[0m22:04:57.743203 [info ] [MainThread]: 
[0m22:04:57.743203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:04:57.743203 [info ] [MainThread]: 
[0m22:04:57.760747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:04:57.762503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:04:57.920685 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:04:57.920685 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:04:57.920685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:58.925688 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.011 seconds
[0m22:04:58.941609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:04:58.993143 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:04:58.993143 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:04:59.000263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:59.541756 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.545 seconds
[0m22:04:59.550284 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:04:59.550284 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:04:59.670550 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.117 seconds
[0m22:04:59.670550 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:04:59.670550 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:04:59.765997 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m22:04:59.765997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:04:59.781784 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:04:59.781784 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:04:59.876772 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m22:04:59.876772 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:04:59.892648 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:05:00.004647 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.120 seconds
[0m22:05:00.019734 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:05:00.019734 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:05:00.115691 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m22:05:00.115691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e79411-3614-4186-933a-f32a398ba47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA4B577440>]}
[0m22:05:00.131546 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:05:00.131546 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:05:00.147351 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:05:00.147351 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:05:00.170521 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:05:00.170521 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:05:00.266895 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:05:00.266895 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:05:00.266895 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate transaction data by procedure code
WITH procedure_summary AS (
    SELECT
        procedure_code AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension for descriptions
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
    ON ps.procedure_code = c.cpt_code

)

SELECT * FROM final
    )
;
[0m22:05:00.266895 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:00.855689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf57c-0000-27c1-0027-cf8b0006ceae
[0m22:05:00.855689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 7
invalid identifier 'PS.PROCEDURE_CODE'
[0m22:05:00.871570 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 7
  invalid identifier 'PS.PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:05:00.871570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e79411-3614-4186-933a-f32a398ba47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA4A5F9310>]}
[0m22:05:00.871570 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.74s]
[0m22:05:00.887357 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:05:00.887357 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 7
  invalid identifier 'PS.PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m22:05:00.887357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:00.887357 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:05:00.887357 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:05:01.050247 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:05:01.052275 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:05:01.216436 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:05:01.216436 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:05:01.373458 [info ] [MainThread]: 
[0m22:05:01.375483 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m22:05:01.380271 [debug] [MainThread]: Command end result
[0m22:05:01.467402 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:05:01.475928 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:05:01.505286 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:05:01.508346 [info ] [MainThread]: 
[0m22:05:01.510376 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:01.514432 [info ] [MainThread]: 
[0m22:05:01.516464 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m22:05:01.521043 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 7
  invalid identifier 'PS.PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:05:01.528367 [info ] [MainThread]: 
[0m22:05:01.531047 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:05:01.534167 [info ] [MainThread]: 
[0m22:05:01.537367 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:05:01.544585 [debug] [MainThread]: Command `dbt run` failed at 22:05:01.543987 after 9.12 seconds
[0m22:05:01.544585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA481413D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA635027B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA656557C0>]}
[0m22:05:01.547278 [debug] [MainThread]: Flushing usage events
[0m22:05:02.535417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:47.183238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002956EE2D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029572242000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295722413A0>]}


============================== 22:05:47.183238 | 94de8d13-3c47-49f7-8fee-0b88745f3a22 ==============================
[0m22:05:47.183238 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:05:47.199021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select procedure_statistics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:49.706592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94de8d13-3c47-49f7-8fee-0b88745f3a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950C2ED610>]}
[0m22:05:49.864388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94de8d13-3c47-49f7-8fee-0b88745f3a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950A6A6F90>]}
[0m22:05:49.864388 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:05:50.427476 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:05:50.680271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:50.680271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:50.696447 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m22:05:50.767476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94de8d13-3c47-49f7-8fee-0b88745f3a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950C6724E0>]}
[0m22:05:50.902022 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:05:50.917825 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:05:51.119005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94de8d13-3c47-49f7-8fee-0b88745f3a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002956F899940>]}
[0m22:05:51.119005 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:05:51.119005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94de8d13-3c47-49f7-8fee-0b88745f3a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950A3D6C60>]}
[0m22:05:51.134876 [info ] [MainThread]: 
[0m22:05:51.134876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:05:51.134876 [info ] [MainThread]: 
[0m22:05:51.139229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:51.142971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:05:51.249087 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:05:51.249087 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:05:51.257179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:52.184042 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.927 seconds
[0m22:05:52.184042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m22:05:52.215687 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:05:52.215687 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:05:52.215687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:52.652753 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.435 seconds
[0m22:05:52.661826 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:05:52.661826 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:05:52.774461 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.110 seconds
[0m22:05:52.774461 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:05:52.774461 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:05:52.885493 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m22:05:52.885493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m22:05:52.885493 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:05:52.901287 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:05:52.983219 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.092 seconds
[0m22:05:52.999234 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:05:52.999234 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:05:53.111554 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.118 seconds
[0m22:05:53.111554 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:05:53.111554 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:05:53.204843 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m22:05:53.220619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94de8d13-3c47-49f7-8fee-0b88745f3a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950CB3D0A0>]}
[0m22:05:53.220619 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:05:53.220619 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:05:53.220619 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:05:53.236400 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:05:53.252138 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:05:53.254268 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:05:53.325129 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:05:53.333272 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:05:53.333272 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate transaction data by procedure code
WITH procedure_summary AS (
    SELECT
        procedure_code AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension for descriptions
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
    ON LPAD(CAST(procedure_code AS STRING), 5, '0') = LPAD(cpt_code, 5, '0')


)

SELECT * FROM final
    )
;
[0m22:05:53.333272 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:54.101746 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf57d-0000-27c1-0027-cf8b0006ceb6
[0m22:05:54.101746 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 17
invalid identifier 'PROCEDURE_CODE'
[0m22:05:54.101746 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:05:54.117553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94de8d13-3c47-49f7-8fee-0b88745f3a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029571329310>]}
[0m22:05:54.117553 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.88s]
[0m22:05:54.117553 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:05:54.117553 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m22:05:54.117553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:54.117553 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:05:54.117553 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:05:54.314133 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m22:05:54.314133 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m22:05:54.613680 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:05:54.613680 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:05:54.854870 [info ] [MainThread]: 
[0m22:05:54.854870 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m22:05:54.870616 [debug] [MainThread]: Command end result
[0m22:05:54.918700 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:05:54.930180 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:05:54.947557 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:05:54.947557 [info ] [MainThread]: 
[0m22:05:54.947557 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:54.961315 [info ] [MainThread]: 
[0m22:05:54.962785 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m22:05:54.962785 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'PROCEDURE_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:05:54.962785 [info ] [MainThread]: 
[0m22:05:54.962785 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:05:54.969352 [info ] [MainThread]: 
[0m22:05:54.972068 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:05:54.974090 [debug] [MainThread]: Command `dbt run` failed at 22:05:54.974090 after 8.13 seconds
[0m22:05:54.974090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950C6B9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950C43AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950CB4A360>]}
[0m22:05:54.974090 [debug] [MainThread]: Flushing usage events
[0m22:05:55.917253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:11.732204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9A9BD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9CE9A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9D4E69F0>]}


============================== 22:22:11.748030 | 29f0e904-70b8-49aa-9bfb-466508b41bc8 ==============================
[0m22:22:11.748030 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:22:11.748030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select procedure_statistics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:14.782083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29f0e904-70b8-49aa-9bfb-466508b41bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9CF28D10>]}
[0m22:22:14.923794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29f0e904-70b8-49aa-9bfb-466508b41bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB66698E0>]}
[0m22:22:14.923794 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:22:15.688053 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:22:15.973466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:15.973466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:15.973466 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m22:22:16.070116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29f0e904-70b8-49aa-9bfb-466508b41bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9DD9DF10>]}
[0m22:22:16.229696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:22:16.234754 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:22:16.510466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29f0e904-70b8-49aa-9bfb-466508b41bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB82F8A10>]}
[0m22:22:16.510466 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:22:16.525255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f0e904-70b8-49aa-9bfb-466508b41bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB7C5A510>]}
[0m22:22:16.525255 [info ] [MainThread]: 
[0m22:22:16.525255 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:16.525255 [info ] [MainThread]: 
[0m22:22:16.535916 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:22:16.535916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:22:16.690501 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:22:16.706320 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:22:16.706320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:17.884960 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.179 seconds
[0m22:22:17.898947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m22:22:17.938284 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:22:17.940304 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:22:17.942324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:18.486302 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.556 seconds
[0m22:22:18.502428 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:22:18.502428 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:22:18.636660 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.129 seconds
[0m22:22:18.643354 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:22:18.645929 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:22:18.734322 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m22:22:18.739678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m22:22:18.746157 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:22:18.746157 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:22:18.846434 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m22:22:18.851473 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:22:18.851473 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:22:18.960379 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.107 seconds
[0m22:22:18.962960 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:22:18.962960 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:22:19.066256 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m22:22:19.066256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f0e904-70b8-49aa-9bfb-466508b41bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB7E86510>]}
[0m22:22:19.088139 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:22:19.088139 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:22:19.088139 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:22:19.088139 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:22:19.116733 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:22:19.124666 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:22:19.198943 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:22:19.206722 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:22:19.206722 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = LPAD(c.cpt_code, 5, '0')
)

SELECT * FROM final
    )
;
[0m22:22:19.209594 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:19.893908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf58e-0000-27c1-0027-cf8b0006ced2
[0m22:22:19.893908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 21
invalid identifier 'AMOUNT'
[0m22:22:19.893908 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:22:19.909638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f0e904-70b8-49aa-9bfb-466508b41bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9CE69430>]}
[0m22:22:19.909638 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.81s]
[0m22:22:19.918448 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:22:19.918448 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m22:22:19.938502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:19.938502 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:22:19.941551 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:22:20.100727 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m22:22:20.100727 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m22:22:20.238940 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:22:20.240961 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:22:20.381531 [info ] [MainThread]: 
[0m22:22:20.381531 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m22:22:20.381531 [debug] [MainThread]: Command end result
[0m22:22:20.461185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:22:20.472382 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:22:20.491857 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:22:20.493883 [info ] [MainThread]: 
[0m22:22:20.496082 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:22:20.498366 [info ] [MainThread]: 
[0m22:22:20.503908 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m22:22:20.506612 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 12 at position 21
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:22:20.510839 [info ] [MainThread]: 
[0m22:22:20.514335 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:22:20.514335 [info ] [MainThread]: 
[0m22:22:20.518502 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:22:20.523576 [debug] [MainThread]: Command `dbt run` failed at 22:22:20.523576 after 9.25 seconds
[0m22:22:20.526609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9D9CD4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB852A9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB83179B0>]}
[0m22:22:20.528944 [debug] [MainThread]: Flushing usage events
[0m22:22:21.521423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:43.808194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FE7D02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FE7D1A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FE7D0560>]}


============================== 22:22:43.815586 | e5547964-e732-4088-9739-25770d68dacf ==============================
[0m22:22:43.815586 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:22:43.815586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select procedure_statistics', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:46.505893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5547964-e732-4088-9739-25770d68dacf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263988CB680>]}
[0m22:22:46.673869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5547964-e732-4088-9739-25770d68dacf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FED71070>]}
[0m22:22:46.673869 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:22:47.344010 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:22:47.656542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:47.656542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:47.666603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m22:22:47.763728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5547964-e732-4088-9739-25770d68dacf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026398A3AC00>]}
[0m22:22:47.932725 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:22:47.945870 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:22:48.177007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5547964-e732-4088-9739-25770d68dacf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FBE5B290>]}
[0m22:22:48.180236 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:22:48.193461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5547964-e732-4088-9739-25770d68dacf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FBE280B0>]}
[0m22:22:48.200481 [info ] [MainThread]: 
[0m22:22:48.205833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:48.205833 [info ] [MainThread]: 
[0m22:22:48.209081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:22:48.213460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:22:48.338556 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:22:48.338556 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:22:48.338556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:49.372648 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.033 seconds
[0m22:22:49.397120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m22:22:49.428957 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:22:49.428957 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:22:49.430976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:50.029200 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.600 seconds
[0m22:22:50.043014 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:22:50.045031 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:22:50.156390 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.125 seconds
[0m22:22:50.172185 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:22:50.172185 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:22:50.263221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.092 seconds
[0m22:22:50.263221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m22:22:50.281374 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:22:50.281374 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:22:50.376854 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m22:22:50.376854 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:22:50.376854 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:22:50.486263 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.103 seconds
[0m22:22:50.486263 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:22:50.486263 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:22:50.593803 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m22:22:50.599898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5547964-e732-4088-9739-25770d68dacf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639930F290>]}
[0m22:22:50.613543 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:22:50.616309 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:22:50.616309 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:22:50.616309 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:22:50.641849 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:22:50.650197 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:22:50.735778 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:22:50.740957 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:22:50.742977 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = LPAD(c.cpt_code, 5, '0')
)

SELECT * FROM final
    )
;
[0m22:22:50.742977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:52.185764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.446 seconds
[0m22:22:52.248478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5547964-e732-4088-9739-25770d68dacf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FB4A96A0>]}
[0m22:22:52.250412 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.procedure_statistics .................... [[32mSUCCESS 1[0m in 1.63s]
[0m22:22:52.250412 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:22:52.250412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:52.250412 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:22:52.250412 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:22:52.390497 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m22:22:52.390497 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m22:22:52.536639 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:22:52.536639 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:22:52.691593 [info ] [MainThread]: 
[0m22:22:52.691593 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m22:22:52.707444 [debug] [MainThread]: Command end result
[0m22:22:52.798484 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:22:52.804128 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:22:52.815494 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:22:52.815494 [info ] [MainThread]: 
[0m22:22:52.820750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:22:52.820750 [info ] [MainThread]: 
[0m22:22:52.824418 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:22:52.828610 [debug] [MainThread]: Command `dbt run` succeeded at 22:22:52.824418 after 9.33 seconds
[0m22:22:52.828610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FE6B7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FE35A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263FE7D06B0>]}
[0m22:22:52.831920 [debug] [MainThread]: Flushing usage events
[0m22:22:53.869322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:52.902229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2ACEC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2ACEF380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2E25C200>]}


============================== 22:24:52.914725 | 70a33542-3429-4fb6-970a-7ffdee6a83a4 ==============================
[0m22:24:52.914725 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:24:52.917782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select procedure_statistics', 'send_anonymous_usage_stats': 'True'}
[0m22:24:55.189518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70a33542-3429-4fb6-970a-7ffdee6a83a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC45E15DF0>]}
[0m22:24:55.356743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70a33542-3429-4fb6-970a-7ffdee6a83a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4810BEC0>]}
[0m22:24:55.360772 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:24:56.002439 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:24:56.290343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:56.290343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:56.306540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m22:24:56.413892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70a33542-3429-4fb6-970a-7ffdee6a83a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC48475310>]}
[0m22:24:56.556643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:24:56.567824 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:24:56.822252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70a33542-3429-4fb6-970a-7ffdee6a83a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4860C440>]}
[0m22:24:56.822252 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:24:56.828258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a33542-3429-4fb6-970a-7ffdee6a83a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4841B6E0>]}
[0m22:24:56.834694 [info ] [MainThread]: 
[0m22:24:56.836480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:56.836480 [info ] [MainThread]: 
[0m22:24:56.836480 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:56.842367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:24:56.985762 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:24:56.987749 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:24:56.987749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:58.171044 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.183 seconds
[0m22:24:58.195409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:24:58.237347 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:24:58.237347 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:24:58.237347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:58.841805 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.598 seconds
[0m22:24:58.850210 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:24:58.858328 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:24:58.989735 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.137 seconds
[0m22:24:59.004128 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:24:59.006437 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:24:59.117486 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m22:24:59.180914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:24:59.196040 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:24:59.203124 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:24:59.307311 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m22:24:59.315544 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:24:59.315544 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:24:59.436544 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.117 seconds
[0m22:24:59.438488 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:24:59.438488 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:24:59.547698 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m22:24:59.563432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a33542-3429-4fb6-970a-7ffdee6a83a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2B903290>]}
[0m22:24:59.579196 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:24:59.579196 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:24:59.588986 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:24:59.588986 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:24:59.622494 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:24:59.626807 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:24:59.755661 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:24:59.771888 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:24:59.771888 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
    )
;
[0m22:24:59.775734 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:25:01.079278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.311 seconds
[0m22:25:01.200532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a33542-3429-4fb6-970a-7ffdee6a83a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2AF3D310>]}
[0m22:25:01.203117 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.procedure_statistics .................... [[32mSUCCESS 1[0m in 1.61s]
[0m22:25:01.207143 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:25:01.207143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:01.207143 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:25:01.216616 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:25:01.376103 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:25:01.379566 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:25:01.535013 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:25:01.535013 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:25:01.694973 [info ] [MainThread]: 
[0m22:25:01.694973 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m22:25:01.694973 [debug] [MainThread]: Command end result
[0m22:25:01.805184 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:25:01.821064 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:25:01.859307 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:25:01.859307 [info ] [MainThread]: 
[0m22:25:01.868918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:25:01.868918 [info ] [MainThread]: 
[0m22:25:01.868918 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:25:01.884674 [debug] [MainThread]: Command `dbt run` succeeded at 22:25:01.884674 after 9.33 seconds
[0m22:25:01.884674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2D3098E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2ACEC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2CF32BA0>]}
[0m22:25:01.890297 [debug] [MainThread]: Flushing usage events
[0m22:25:03.843200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:34:07.416949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236606B1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023662F8A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023662F8B8C0>]}


============================== 22:34:07.416949 | d0b9be89-5392-444e-96b2-f76627dabfd5 ==============================
[0m22:34:07.416949 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:34:07.416949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_cptcodes', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:34:09.784916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0b9be89-5392-444e-96b2-f76627dabfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367DC16F00>]}
[0m22:34:09.947439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0b9be89-5392-444e-96b2-f76627dabfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367C8F7B00>]}
[0m22:34:09.947439 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:34:10.455863 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:34:10.683141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:10.683141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:10.694614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m22:34:10.856988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0b9be89-5392-444e-96b2-f76627dabfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367DAD58E0>]}
[0m22:34:10.984064 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:34:10.984064 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:34:11.149992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0b9be89-5392-444e-96b2-f76627dabfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366349D370>]}
[0m22:34:11.154417 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:34:11.154417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0b9be89-5392-444e-96b2-f76627dabfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367C60B2C0>]}
[0m22:34:11.154417 [info ] [MainThread]: 
[0m22:34:11.154417 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:34:11.154417 [info ] [MainThread]: 
[0m22:34:11.154417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:34:11.165779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:34:11.283678 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:34:11.283678 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:34:11.283678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:12.182281 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.887 seconds
[0m22:34:12.196917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m22:34:12.221882 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:34:12.221882 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:34:12.223907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:12.756445 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.537 seconds
[0m22:34:12.756445 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:34:12.756445 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:34:12.883483 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.124 seconds
[0m22:34:12.883483 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:34:12.899231 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:34:13.015791 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m22:34:13.017804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m22:34:13.023852 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:34:13.025864 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:34:13.115740 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m22:34:13.115740 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:34:13.115740 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:34:13.249588 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.122 seconds
[0m22:34:13.254145 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:34:13.254145 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:34:13.354957 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m22:34:13.361005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0b9be89-5392-444e-96b2-f76627dabfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023660857DD0>]}
[0m22:34:13.373741 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m22:34:13.373741 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_cptcodes ................................. [RUN]
[0m22:34:13.376837 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_cptcodes'
[0m22:34:13.376837 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m22:34:13.394544 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m22:34:13.401230 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m22:34:13.471231 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m22:34:13.473246 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m22:34:13.475257 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
    

    
    as (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        category AS cpt_code,               -- numeric code
        cpt_code AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE category IS NOT NULL
)

SELECT * FROM cleaned_cpt
    )
;
[0m22:34:13.475257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:34:14.101472 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf59a-0000-27ff-0027-cf8b00066f0e
[0m22:34:14.101472 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 8
invalid identifier 'CATEGORY'
[0m22:34:14.108656 [debug] [Thread-1 (]: Database Error in model dim_cptcodes (models\healthcare\dim\dim_cptcodes.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\dim\dim_cptcodes.sql
[0m22:34:14.112690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b9be89-5392-444e-96b2-f76627dabfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367E57D640>]}
[0m22:34:14.114708 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.dim_cptcodes ........................ [[31mERROR[0m in 0.73s]
[0m22:34:14.116875 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m22:34:14.116875 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.dim_cptcodes' to be skipped because of status 'error'.  Reason: Database Error in model dim_cptcodes (models\healthcare\dim\dim_cptcodes.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\dim\dim_cptcodes.sql.
[0m22:34:14.121510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:14.121510 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:34:14.123520 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:34:14.263803 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m22:34:14.263803 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m22:34:14.407536 [debug] [MainThread]: Connection 'model.healthcare.dim_cptcodes' was left open.
[0m22:34:14.407536 [debug] [MainThread]: On model.healthcare.dim_cptcodes: Close
[0m22:34:14.556081 [info ] [MainThread]: 
[0m22:34:14.557096 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m22:34:14.558108 [debug] [MainThread]: Command end result
[0m22:34:14.620533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:34:14.625099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:34:14.636913 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:34:14.638929 [info ] [MainThread]: 
[0m22:34:14.639912 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:34:14.639912 [info ] [MainThread]: 
[0m22:34:14.641930 [error] [MainThread]: [31mFailure in model dim_cptcodes (models\healthcare\dim\dim_cptcodes.sql)[0m
[0m22:34:14.641930 [error] [MainThread]:   Database Error in model dim_cptcodes (models\healthcare\dim\dim_cptcodes.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\dim\dim_cptcodes.sql
[0m22:34:14.646285 [info ] [MainThread]: 
[0m22:34:14.653413 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\dim\dim_cptcodes.sql
[0m22:34:14.653413 [info ] [MainThread]: 
[0m22:34:14.656190 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:34:14.661456 [debug] [MainThread]: Command `dbt run` failed at 22:34:14.661456 after 7.60 seconds
[0m22:34:14.661456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367DC7AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236637510D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367E0AA210>]}
[0m22:34:14.665362 [debug] [MainThread]: Flushing usage events
[0m22:34:15.577557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:35:58.380890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE991117C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE99111EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE99111610>]}


============================== 22:35:58.388572 | bf509324-965d-4ad8-993e-ac1419ee5bbd ==============================
[0m22:35:58.388572 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:35:58.388572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_cptcodes', 'send_anonymous_usage_stats': 'True'}
[0m22:36:00.785892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf509324-965d-4ad8-993e-ac1419ee5bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEB14DABA0>]}
[0m22:36:00.933358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf509324-965d-4ad8-993e-ac1419ee5bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEB3126B40>]}
[0m22:36:00.935372 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:36:01.478217 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:36:01.811128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:36:01.811128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:36:01.820704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m22:36:01.891342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf509324-965d-4ad8-993e-ac1419ee5bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEB3157320>]}
[0m22:36:02.052662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:36:02.060739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:36:02.254637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf509324-965d-4ad8-993e-ac1419ee5bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE96769A60>]}
[0m22:36:02.254637 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:36:02.256657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf509324-965d-4ad8-993e-ac1419ee5bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEB07AB170>]}
[0m22:36:02.258676 [info ] [MainThread]: 
[0m22:36:02.258676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:36:02.258676 [info ] [MainThread]: 
[0m22:36:02.258676 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:36:02.264512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:36:02.377070 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:36:02.377070 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:36:02.377070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:03.265419 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.887 seconds
[0m22:36:03.281320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m22:36:03.306680 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:36:03.307735 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:36:03.308419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:03.849513 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.541 seconds
[0m22:36:03.855286 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:36:03.857294 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:36:03.981013 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.124 seconds
[0m22:36:03.985042 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:36:03.987058 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:36:04.081498 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m22:36:04.085933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m22:36:04.089807 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:36:04.089807 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:36:04.181245 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.087 seconds
[0m22:36:04.184486 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:36:04.184486 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:36:04.400286 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.214 seconds
[0m22:36:04.402302 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:36:04.404315 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:36:04.513087 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m22:36:04.521139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf509324-965d-4ad8-993e-ac1419ee5bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE95E97D40>]}
[0m22:36:04.529027 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m22:36:04.531041 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_cptcodes ................................. [RUN]
[0m22:36:04.533656 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_cptcodes'
[0m22:36:04.533656 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m22:36:04.557139 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m22:36:04.557139 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m22:36:04.611649 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m22:36:04.627182 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m22:36:04.627182 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
    

    
    as (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_code AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE category IS NOT NULL
)

SELECT * FROM cleaned_cpt
    )
;
[0m22:36:04.627182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:36:05.215355 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf59c-0000-2803-0027-cf8b0006fefa
[0m22:36:05.217368 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 10
invalid identifier 'CATEGORY'
[0m22:36:05.223430 [debug] [Thread-1 (]: Database Error in model dim_cptcodes (models\healthcare\dim\dim_cptcodes.sql)
  000904 (42000): SQL compilation error: error line 12 at position 10
  invalid identifier 'CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\dim\dim_cptcodes.sql
[0m22:36:05.229034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf509324-965d-4ad8-993e-ac1419ee5bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEB3C0D0A0>]}
[0m22:36:05.230545 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.dim_cptcodes ........................ [[31mERROR[0m in 0.69s]
[0m22:36:05.233721 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m22:36:05.235092 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.dim_cptcodes' to be skipped because of status 'error'.  Reason: Database Error in model dim_cptcodes (models\healthcare\dim\dim_cptcodes.sql)
  000904 (42000): SQL compilation error: error line 12 at position 10
  invalid identifier 'CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\dim\dim_cptcodes.sql.
[0m22:36:05.238991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:05.238991 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:36:05.238991 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:36:05.380590 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m22:36:05.380590 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m22:36:05.525015 [debug] [MainThread]: Connection 'model.healthcare.dim_cptcodes' was left open.
[0m22:36:05.527028 [debug] [MainThread]: On model.healthcare.dim_cptcodes: Close
[0m22:36:05.673232 [info ] [MainThread]: 
[0m22:36:05.673232 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m22:36:05.676145 [debug] [MainThread]: Command end result
[0m22:36:05.731340 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:36:05.735380 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:36:05.745599 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:36:05.747614 [info ] [MainThread]: 
[0m22:36:05.749631 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:36:05.750149 [info ] [MainThread]: 
[0m22:36:05.751995 [error] [MainThread]: [31mFailure in model dim_cptcodes (models\healthcare\dim\dim_cptcodes.sql)[0m
[0m22:36:05.753111 [error] [MainThread]:   Database Error in model dim_cptcodes (models\healthcare\dim\dim_cptcodes.sql)
  000904 (42000): SQL compilation error: error line 12 at position 10
  invalid identifier 'CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\dim\dim_cptcodes.sql
[0m22:36:05.756624 [info ] [MainThread]: 
[0m22:36:05.758642 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\dim\dim_cptcodes.sql
[0m22:36:05.759154 [info ] [MainThread]: 
[0m22:36:05.761078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:36:05.763102 [debug] [MainThread]: Command `dbt run` failed at 22:36:05.763102 after 7.72 seconds
[0m22:36:05.763102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEB367BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEB3125F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE991306B0>]}
[0m22:36:05.763102 [debug] [MainThread]: Flushing usage events
[0m22:36:06.624904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:36:55.496035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A461D430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A461CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A497BEF0>]}


============================== 22:36:55.496035 | fbb4776e-6bd3-4440-bcb4-3df7750fbce8 ==============================
[0m22:36:55.496035 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:36:55.496035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_cptcodes', 'send_anonymous_usage_stats': 'True'}
[0m22:36:57.507459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbb4776e-6bd3-4440-bcb4-3df7750fbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BC570440>]}
[0m22:36:57.675608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbb4776e-6bd3-4440-bcb4-3df7750fbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BE98F380>]}
[0m22:36:57.682595 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:36:58.181255 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:36:58.399159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:36:58.399159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:36:58.415839 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m22:36:58.472757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbb4776e-6bd3-4440-bcb4-3df7750fbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BEB683E0>]}
[0m22:36:58.571130 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:36:58.571130 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:36:58.710503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbb4776e-6bd3-4440-bcb4-3df7750fbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A1FF9A30>]}
[0m22:36:58.710503 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:36:58.710503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb4776e-6bd3-4440-bcb4-3df7750fbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BCD70170>]}
[0m22:36:58.726285 [info ] [MainThread]: 
[0m22:36:58.726285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:36:58.726285 [info ] [MainThread]: 
[0m22:36:58.734178 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:36:58.737270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:36:58.822591 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:36:58.822591 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:36:58.822591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:59.772647 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.949 seconds
[0m22:36:59.784299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m22:36:59.800076 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:36:59.800076 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:36:59.800076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:00.289574 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.491 seconds
[0m22:37:00.305321 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:37:00.305321 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:37:00.416278 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.119 seconds
[0m22:37:00.432052 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:37:00.432052 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:37:00.528224 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m22:37:00.528224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m22:37:00.533825 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:37:00.536631 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:37:00.624106 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m22:37:00.639885 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:37:00.639885 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:37:00.766625 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.133 seconds
[0m22:37:00.775799 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:37:00.775799 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:37:00.861506 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m22:37:00.877332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb4776e-6bd3-4440-bcb4-3df7750fbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BE9F85F0>]}
[0m22:37:00.877332 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m22:37:00.877332 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_cptcodes ................................. [RUN]
[0m22:37:00.877332 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_cptcodes'
[0m22:37:00.877332 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m22:37:00.902397 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m22:37:00.902397 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m22:37:00.951072 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m22:37:00.951072 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m22:37:00.951072 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
    

    
    as (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_code AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE procedure_code_category IS NOT NULL
)

SELECT * FROM cleaned_cpt
    )
;
[0m22:37:00.951072 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:01.839170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m22:37:01.886436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbb4776e-6bd3-4440-bcb4-3df7750fbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A166D3D0>]}
[0m22:37:01.886436 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.dim_cptcodes ............................ [[32mSUCCESS 1[0m in 1.00s]
[0m22:37:01.886436 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m22:37:01.886436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:01.886436 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:37:01.886436 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:37:02.023584 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m22:37:02.023584 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m22:37:02.182746 [debug] [MainThread]: Connection 'model.healthcare.dim_cptcodes' was left open.
[0m22:37:02.182746 [debug] [MainThread]: On model.healthcare.dim_cptcodes: Close
[0m22:37:02.340853 [info ] [MainThread]: 
[0m22:37:02.340853 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m22:37:02.340853 [debug] [MainThread]: Command end result
[0m22:37:02.372803 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:37:02.380291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:37:02.385378 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:37:02.385378 [info ] [MainThread]: 
[0m22:37:02.385378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:37:02.385378 [info ] [MainThread]: 
[0m22:37:02.385378 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:37:02.393455 [debug] [MainThread]: Command `dbt run` succeeded at 22:37:02.393455 after 7.24 seconds
[0m22:37:02.393455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A497BD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A461D430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BC5222A0>]}
[0m22:37:02.393455 [debug] [MainThread]: Flushing usage events
[0m22:37:03.140320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:38:16.827183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5EC88830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5E97E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5E97E4E0>]}


============================== 22:38:16.837037 | aceabd8e-5246-42c4-b3c6-e6953991743d ==============================
[0m22:38:16.837037 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:38:16.837037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_cptcodes', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:38:18.623105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aceabd8e-5246-42c4-b3c6-e6953991743d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E779C84A0>]}
[0m22:38:18.727730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aceabd8e-5246-42c4-b3c6-e6953991743d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E76972BA0>]}
[0m22:38:18.727730 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:38:19.104853 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:38:19.288073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:38:19.288073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:38:19.298139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m22:38:19.349262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aceabd8e-5246-42c4-b3c6-e6953991743d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E78FF6240>]}
[0m22:38:19.458357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:38:19.462426 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:38:19.600543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aceabd8e-5246-42c4-b3c6-e6953991743d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E77BA5820>]}
[0m22:38:19.600543 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:38:19.600543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aceabd8e-5246-42c4-b3c6-e6953991743d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E7939B620>]}
[0m22:38:19.600543 [info ] [MainThread]: 
[0m22:38:19.600543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:19.600543 [info ] [MainThread]: 
[0m22:38:19.600543 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:38:19.609923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:38:19.690256 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:38:19.690256 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:38:19.690256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:20.564089 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.872 seconds
[0m22:38:20.567868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:38:20.597974 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:38:20.597974 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:38:20.599735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:21.191261 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.605 seconds
[0m22:38:21.209296 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:38:21.209296 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:38:21.329297 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.121 seconds
[0m22:38:21.335185 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:38:21.335185 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:38:21.418426 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m22:38:21.428121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:38:21.434230 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:38:21.436241 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:38:21.540531 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m22:38:21.544569 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:38:21.544569 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:38:21.662383 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.118 seconds
[0m22:38:21.662383 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:38:21.662383 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:38:21.757807 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m22:38:21.766987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aceabd8e-5246-42c4-b3c6-e6953991743d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E77A16F00>]}
[0m22:38:21.774403 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m22:38:21.774403 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_cptcodes ................................. [RUN]
[0m22:38:21.774403 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_cptcodes'
[0m22:38:21.774403 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m22:38:21.784876 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m22:38:21.784876 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m22:38:21.841819 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m22:38:21.843828 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m22:38:21.845677 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
    

    
    as (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_codes AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE procedure_code_category IS NOT NULL
)

SELECT * FROM cleaned_cpt
    )
;
[0m22:38:21.845677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:22.734510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.898 seconds
[0m22:38:22.782610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aceabd8e-5246-42c4-b3c6-e6953991743d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5BABD580>]}
[0m22:38:22.782610 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.dim_cptcodes ............................ [[32mSUCCESS 1[0m in 0.99s]
[0m22:38:22.786808 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m22:38:22.786808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:22.786808 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:38:22.786808 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:38:22.946722 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:38:22.947736 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:38:23.094937 [debug] [MainThread]: Connection 'model.healthcare.dim_cptcodes' was left open.
[0m22:38:23.094937 [debug] [MainThread]: On model.healthcare.dim_cptcodes: Close
[0m22:38:23.244920 [info ] [MainThread]: 
[0m22:38:23.244920 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m22:38:23.244920 [debug] [MainThread]: Command end result
[0m22:38:23.279952 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:38:23.283974 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:38:23.293137 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:38:23.293137 [info ] [MainThread]: 
[0m22:38:23.295143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:38:23.295143 [info ] [MainThread]: 
[0m22:38:23.295143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:38:23.297152 [debug] [MainThread]: Command `dbt run` succeeded at 22:38:23.297152 after 6.77 seconds
[0m22:38:23.299163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E79369AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E791900E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5E8E58B0>]}
[0m22:38:23.299163 [debug] [MainThread]: Flushing usage events
[0m22:38:24.069967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:38:51.813603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55F2806E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55F280620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55F280650>]}


============================== 22:38:51.829444 | c1fecf91-d930-4e2e-9fed-c6cdc8b264fd ==============================
[0m22:38:51.829444 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:38:51.829444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select procedure_statistics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:38:53.552950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1fecf91-d930-4e2e-9fed-c6cdc8b264fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5780E2270>]}
[0m22:38:53.669562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1fecf91-d930-4e2e-9fed-c6cdc8b264fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55EEE2120>]}
[0m22:38:53.669562 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:38:54.052251 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:38:54.258274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:38:54.258274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:38:54.258274 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m22:38:54.311858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1fecf91-d930-4e2e-9fed-c6cdc8b264fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F579628440>]}
[0m22:38:54.448085 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:38:54.448085 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:38:54.606251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1fecf91-d930-4e2e-9fed-c6cdc8b264fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55C8EBD10>]}
[0m22:38:54.606251 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:38:54.606251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1fecf91-d930-4e2e-9fed-c6cdc8b264fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55C95C200>]}
[0m22:38:54.621950 [info ] [MainThread]: 
[0m22:38:54.621950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:54.621950 [info ] [MainThread]: 
[0m22:38:54.621950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:38:54.621950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:38:54.703536 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:38:54.703536 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:38:54.703536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:55.577542 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.869 seconds
[0m22:38:55.577542 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:38:55.605043 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:38:55.609185 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:38:55.609185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:56.137406 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.530 seconds
[0m22:38:56.146512 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:38:56.146512 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:38:56.272915 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.134 seconds
[0m22:38:56.272915 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:38:56.272915 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:38:56.377284 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m22:38:56.377284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:38:56.377284 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:38:56.393110 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:38:56.497855 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m22:38:56.497855 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:38:56.497855 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:38:56.608916 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.109 seconds
[0m22:38:56.608916 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:38:56.608916 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:38:56.720203 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m22:38:56.720203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1fecf91-d930-4e2e-9fed-c6cdc8b264fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5797F9AC0>]}
[0m22:38:56.720203 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:38:56.735988 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:38:56.735988 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:38:56.735988 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:38:56.753309 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:38:56.754534 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:38:56.812263 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:38:56.812263 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:38:56.812263 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.category,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
    )
;
[0m22:38:56.812263 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:57.516073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf59e-0000-27d7-0027-cf8b0006efe2
[0m22:38:57.516073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 8
invalid identifier 'C.CATEGORY'
[0m22:38:57.531858 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'C.CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:38:57.531858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1fecf91-d930-4e2e-9fed-c6cdc8b264fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55E3792E0>]}
[0m22:38:57.531858 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.80s]
[0m22:38:57.531858 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:38:57.531858 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'C.CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m22:38:57.531858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:57.547874 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:38:57.547874 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:38:57.685233 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:38:57.685233 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:38:57.844003 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:38:57.844003 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:38:58.003153 [info ] [MainThread]: 
[0m22:38:58.003153 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m22:38:58.003153 [debug] [MainThread]: Command end result
[0m22:38:58.032997 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:38:58.032997 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:38:58.047770 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:38:58.047770 [info ] [MainThread]: 
[0m22:38:58.055319 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:38:58.055319 [info ] [MainThread]: 
[0m22:38:58.055319 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m22:38:58.055319 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'C.CATEGORY'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:38:58.055319 [info ] [MainThread]: 
[0m22:38:58.055319 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:38:58.065489 [info ] [MainThread]: 
[0m22:38:58.066068 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:38:58.066068 [debug] [MainThread]: Command `dbt run` failed at 22:38:58.066068 after 6.61 seconds
[0m22:38:58.069780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5792F1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55E6CFE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5793D5A90>]}
[0m22:38:58.069780 [debug] [MainThread]: Flushing usage events
[0m22:38:58.789201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:04.025264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016951101280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169544FFF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169544FFCE0>]}


============================== 22:41:04.025264 | df0f4a03-ae84-4be8-bc9d-8e2f5d0fa621 ==============================
[0m22:41:04.025264 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:41:04.025264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select procedure_statistics', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:05.685158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df0f4a03-ae84-4be8-bc9d-8e2f5d0fa621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001696C49A390>]}
[0m22:41:05.780388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df0f4a03-ae84-4be8-bc9d-8e2f5d0fa621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001696CE50530>]}
[0m22:41:05.780388 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:41:06.190625 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:41:06.379578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:06.379578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:06.379578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m22:41:06.445170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df0f4a03-ae84-4be8-bc9d-8e2f5d0fa621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001696E735460>]}
[0m22:41:06.548423 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:41:06.548423 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:41:06.721610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df0f4a03-ae84-4be8-bc9d-8e2f5d0fa621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001696C49A390>]}
[0m22:41:06.721610 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:41:06.721610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0f4a03-ae84-4be8-bc9d-8e2f5d0fa621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001696D3FB2C0>]}
[0m22:41:06.737344 [info ] [MainThread]: 
[0m22:41:06.737344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:06.740516 [info ] [MainThread]: 
[0m22:41:06.742418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:41:06.742418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:41:06.821444 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:41:06.821444 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:41:06.821444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:07.681625 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.871 seconds
[0m22:41:07.697273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:41:07.729024 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:41:07.729024 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:41:07.729024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:08.325379 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:41:08.325379 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:41:08.325379 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:41:08.507699 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.169 seconds
[0m22:41:08.509712 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:41:08.511728 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:41:08.639519 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m22:41:08.639519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:41:08.643774 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:41:08.643774 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:41:08.734147 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m22:41:08.734147 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:41:08.734147 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:41:08.861535 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.117 seconds
[0m22:41:08.863549 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:41:08.863549 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:41:08.957829 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m22:41:08.973734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0f4a03-ae84-4be8-bc9d-8e2f5d0fa621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001696E64C2F0>]}
[0m22:41:08.973734 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:41:08.973734 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:41:08.973734 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:41:08.973734 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:41:08.998536 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:41:09.008621 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:41:09.040007 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:41:09.047693 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:41:09.050647 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        c.cpt_code,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
    )
;
[0m22:41:09.050647 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:41:09.495363 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf5a1-0000-27d7-0027-cf8b0006eff2
[0m22:41:09.497374 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CPT_CODE'
[0m22:41:09.501398 [debug] [Thread-1 (]: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CPT_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:41:09.503415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0f4a03-ae84-4be8-bc9d-8e2f5d0fa621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016953609160>]}
[0m22:41:09.507157 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.procedure_statistics ................ [[31mERROR[0m in 0.53s]
[0m22:41:09.508893 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:41:09.508893 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.procedure_statistics' to be skipped because of status 'error'.  Reason: Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CPT_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql.
[0m22:41:09.508893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:09.508893 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:41:09.515317 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:41:09.670223 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:41:09.673791 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:41:09.811526 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:41:09.815597 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:41:09.942896 [info ] [MainThread]: 
[0m22:41:09.942896 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m22:41:09.942896 [debug] [MainThread]: Command end result
[0m22:41:09.993794 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:41:09.993794 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:41:10.009612 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:41:10.009612 [info ] [MainThread]: 
[0m22:41:10.009612 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:41:10.009612 [info ] [MainThread]: 
[0m22:41:10.009612 [error] [MainThread]: [31mFailure in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)[0m
[0m22:41:10.009612 [error] [MainThread]:   Database Error in model procedure_statistics (models\healthcare\fact\procedure_statistics.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CPT_CODE'
  compiled code at target\run\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:41:10.009612 [info ] [MainThread]: 
[0m22:41:10.009612 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\procedure_statistics.sql
[0m22:41:10.023595 [info ] [MainThread]: 
[0m22:41:10.026277 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:41:10.026277 [debug] [MainThread]: Command `dbt run` failed at 22:41:10.026277 after 6.33 seconds
[0m22:41:10.026277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695416E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169545A1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001696D10F770>]}
[0m22:41:10.026277 [debug] [MainThread]: Flushing usage events
[0m22:41:10.708111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:59.238292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390A9011C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390DD21E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390DD214F0>]}


============================== 22:41:59.247372 | 049d0a78-987d-4d9c-835b-d08d6580a42c ==============================
[0m22:41:59.247372 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:41:59.249386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select procedure_statistics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:42:01.321750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '049d0a78-987d-4d9c-835b-d08d6580a42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023927E4EF00>]}
[0m22:42:01.434235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '049d0a78-987d-4d9c-835b-d08d6580a42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023927D6ABD0>]}
[0m22:42:01.434235 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:42:01.871808 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:42:02.048916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:42:02.049426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:42:02.056167 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m22:42:02.104182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '049d0a78-987d-4d9c-835b-d08d6580a42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239282BBCE0>]}
[0m22:42:02.204172 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:42:02.206435 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:42:02.337149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '049d0a78-987d-4d9c-835b-d08d6580a42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926B1B830>]}
[0m22:42:02.337149 [info ] [MainThread]: Found 17 models, 4 data tests, 2 sources, 477 macros
[0m22:42:02.337149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '049d0a78-987d-4d9c-835b-d08d6580a42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926479C40>]}
[0m22:42:02.337149 [info ] [MainThread]: 
[0m22:42:02.337149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:42:02.344861 [info ] [MainThread]: 
[0m22:42:02.346521 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:42:02.350457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:42:02.444537 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:42:02.444537 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:42:02.446559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:03.301221 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.858 seconds
[0m22:42:03.314396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:42:03.335101 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:42:03.335101 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:42:03.335101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:03.701223 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.365 seconds
[0m22:42:03.701223 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:42:03.701223 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:42:03.819626 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.112 seconds
[0m22:42:03.821643 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:42:03.823661 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:42:03.912497 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m22:42:03.915231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:42:03.917468 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:42:03.922842 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:42:04.017936 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m22:42:04.019952 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:42:04.019952 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:42:04.136755 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.117 seconds
[0m22:42:04.140788 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:42:04.140788 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:42:04.232478 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m22:42:04.237007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '049d0a78-987d-4d9c-835b-d08d6580a42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023927ED8500>]}
[0m22:42:04.242462 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m22:42:04.243473 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.procedure_statistics ......................... [RUN]
[0m22:42:04.244593 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.procedure_statistics'
[0m22:42:04.245232 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m22:42:04.257325 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m22:42:04.262636 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m22:42:04.305468 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m22:42:04.306981 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m22:42:04.306981 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
    

    
    as (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
    )
;
[0m22:42:04.308999 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:42:05.885413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.576 seconds
[0m22:42:05.925858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '049d0a78-987d-4d9c-835b-d08d6580a42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390A9ED490>]}
[0m22:42:05.925858 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.procedure_statistics .................... [[32mSUCCESS 1[0m in 1.68s]
[0m22:42:05.929165 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m22:42:05.931047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:05.931047 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:42:05.931047 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:42:06.067491 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:42:06.067491 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:42:06.280154 [debug] [MainThread]: Connection 'model.healthcare.procedure_statistics' was left open.
[0m22:42:06.280154 [debug] [MainThread]: On model.healthcare.procedure_statistics: Close
[0m22:42:06.419839 [info ] [MainThread]: 
[0m22:42:06.419839 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m22:42:06.422744 [debug] [MainThread]: Command end result
[0m22:42:06.457628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:42:06.460363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:42:06.467627 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:42:06.467627 [info ] [MainThread]: 
[0m22:42:06.473972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:42:06.479740 [info ] [MainThread]: 
[0m22:42:06.480740 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:42:06.482199 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:06.482199 after 7.54 seconds
[0m22:42:06.482199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390D971C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023927D687D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390B379970>]}
[0m22:42:06.482199 [debug] [MainThread]: Flushing usage events
[0m22:42:07.178890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:51.396106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BCAA1F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BCBFB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BCAA20C0>]}


============================== 22:55:51.405414 | a7ad52ba-2005-476c-95e2-f0befe478eda ==============================
[0m22:55:51.405414 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:55:51.405414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select provider_department_revenue_summary', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:55:53.257565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7ad52ba-2005-476c-95e2-f0befe478eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D7315E80>]}
[0m22:55:53.358258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7ad52ba-2005-476c-95e2-f0befe478eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D7501F70>]}
[0m22:55:53.360009 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:55:53.762261 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:55:53.932138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:53.932138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:53.938166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m22:55:53.989097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7ad52ba-2005-476c-95e2-f0befe478eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D78B3DD0>]}
[0m22:55:54.109546 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:55:54.113579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:55:54.271988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7ad52ba-2005-476c-95e2-f0befe478eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BA9590A0>]}
[0m22:55:54.271988 [info ] [MainThread]: Found 18 models, 4 data tests, 2 sources, 477 macros
[0m22:55:54.271988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ad52ba-2005-476c-95e2-f0befe478eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D5E4A8A0>]}
[0m22:55:54.284458 [info ] [MainThread]: 
[0m22:55:54.286020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:55:54.286020 [info ] [MainThread]: 
[0m22:55:54.286020 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:54.288970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:55:54.377265 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:55:54.377265 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:55:54.377265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:55.232594 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.855 seconds
[0m22:55:55.244537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:55:55.264356 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:55:55.264356 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:55:55.264356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:55.854489 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.600 seconds
[0m22:55:55.873831 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:55:55.875847 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:55:56.066228 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.196 seconds
[0m22:55:56.074782 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:55:56.074782 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:55:56.179669 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m22:55:56.189921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:55:56.191937 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:55:56.191937 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:55:56.310099 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m22:55:56.310099 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:55:56.310099 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:55:56.426805 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.113 seconds
[0m22:55:56.426805 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:55:56.426805 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:55:56.530651 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m22:55:56.530651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ad52ba-2005-476c-95e2-f0befe478eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BA997260>]}
[0m22:55:56.530651 [debug] [Thread-1 (]: Began running node model.healthcare.provider_department_revenue_summary
[0m22:55:56.530651 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.provider_department_revenue_summary .......... [RUN]
[0m22:55:56.530651 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.provider_department_revenue_summary'
[0m22:55:56.530651 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_department_revenue_summary
[0m22:55:56.550410 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_department_revenue_summary"
[0m22:55:56.550410 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_department_revenue_summary
[0m22:55:56.608454 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_department_revenue_summary"
[0m22:55:56.608454 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_department_revenue_summary"
[0m22:55:56.612513 [debug] [Thread-1 (]: On model.healthcare.provider_department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.provider_department_revenue_summary
    

    
    as (

WITH txn AS (
    SELECT
        provider_id,
        dept_id,
        COALESCE(amount, 0) AS charge_amount
    FROM DBT_DB.SILVER.src_transactions
),

providers AS (
    SELECT
        provider_id,
        full_name,
        specialization
    FROM DBT_DB.GOLD.dim_providers
),

departments AS (
    SELECT
        department_key,
        department_name
    FROM DBT_DB.GOLD.dim_departments
),

joined AS (
    SELECT
        t.provider_id,
        p.full_name,
        p.specialization,
        t.dept_id,
        d.department_name,
        t.charge_amount
    FROM txn t
    LEFT JOIN providers p ON t.provider_id = p.provider_id
    LEFT JOIN departments d ON t.dept_id = d.department_key
),

aggregated AS (
    SELECT
        provider_id,
        full_name,
        specialization,
        dept_id,
        department_name,
        SUM(charge_amount) AS total_charges,
        COUNT(*) AS total_visits
    FROM joined
    GROUP BY provider_id, full_name, specialization, dept_id, department_name
)

SELECT * FROM aggregated
    )
;
[0m22:55:56.612513 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:57.301805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf5af-0000-27d7-0027-cf8b0007303a
[0m22:55:57.301805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 8
invalid identifier 'DEPT_ID'
[0m22:55:57.317561 [debug] [Thread-1 (]: Database Error in model provider_department_revenue_summary (models\healthcare\fact\provider_department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\provider_department_revenue_summary.sql
[0m22:55:57.319580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ad52ba-2005-476c-95e2-f0befe478eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BC3E92B0>]}
[0m22:55:57.319580 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.provider_department_revenue_summary . [[31mERROR[0m in 0.79s]
[0m22:55:57.323467 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_department_revenue_summary
[0m22:55:57.323467 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.provider_department_revenue_summary' to be skipped because of status 'error'.  Reason: Database Error in model provider_department_revenue_summary (models\healthcare\fact\provider_department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\provider_department_revenue_summary.sql.
[0m22:55:57.323467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:57.329285 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:55:57.329285 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:55:57.479408 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:55:57.479408 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:55:57.622018 [debug] [MainThread]: Connection 'model.healthcare.provider_department_revenue_summary' was left open.
[0m22:55:57.622018 [debug] [MainThread]: On model.healthcare.provider_department_revenue_summary: Close
[0m22:55:57.763444 [info ] [MainThread]: 
[0m22:55:57.763444 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m22:55:57.763444 [debug] [MainThread]: Command end result
[0m22:55:57.795602 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:55:57.795602 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:55:57.811712 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:55:57.811712 [info ] [MainThread]: 
[0m22:55:57.814674 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:55:57.814674 [info ] [MainThread]: 
[0m22:55:57.814674 [error] [MainThread]: [31mFailure in model provider_department_revenue_summary (models\healthcare\fact\provider_department_revenue_summary.sql)[0m
[0m22:55:57.814674 [error] [MainThread]:   Database Error in model provider_department_revenue_summary (models\healthcare\fact\provider_department_revenue_summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'DEPT_ID'
  compiled code at target\run\healthcare\models\healthcare\fact\provider_department_revenue_summary.sql
[0m22:55:57.814674 [info ] [MainThread]: 
[0m22:55:57.814674 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\provider_department_revenue_summary.sql
[0m22:55:57.814674 [info ] [MainThread]: 
[0m22:55:57.820984 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:55:57.822257 [debug] [MainThread]: Command `dbt run` failed at 22:55:57.822257 after 6.80 seconds
[0m22:55:57.822257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BCF4E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D7CAE150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D5A051C0>]}
[0m22:55:57.822257 [debug] [MainThread]: Flushing usage events
[0m22:55:58.643065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:17.867858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879D7D11F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187A03C46B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187A03C5DC0>]}


============================== 22:58:17.875106 | ff35bd16-adad-4255-9018-0d699a280c66 ==============================
[0m22:58:17.875106 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:58:17.875106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select provider_department_revenue_summary', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:58:19.706844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff35bd16-adad-4255-9018-0d699a280c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879DBDB530>]}
[0m22:58:19.801397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff35bd16-adad-4255-9018-0d699a280c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879FD98B90>]}
[0m22:58:19.801397 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m22:58:20.301653 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:58:20.490714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:20.490714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:20.490714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m22:58:20.546573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff35bd16-adad-4255-9018-0d699a280c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BADF7A40>]}
[0m22:58:20.666260 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:58:20.674312 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:58:20.800337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff35bd16-adad-4255-9018-0d699a280c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BAF940B0>]}
[0m22:58:20.800337 [info ] [MainThread]: Found 18 models, 4 data tests, 2 sources, 477 macros
[0m22:58:20.800337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff35bd16-adad-4255-9018-0d699a280c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187B9655940>]}
[0m22:58:20.800337 [info ] [MainThread]: 
[0m22:58:20.800337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:58:20.800337 [info ] [MainThread]: 
[0m22:58:20.800337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:58:20.812275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m22:58:20.894680 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m22:58:20.894680 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m22:58:20.894680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:21.745450 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.854 seconds
[0m22:58:21.761715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m22:58:21.777739 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:58:21.777739 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:58:21.777739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:22.389666 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.610 seconds
[0m22:58:22.389666 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:58:22.389666 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m22:58:22.519475 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.120 seconds
[0m22:58:22.519475 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m22:58:22.519475 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:58:22.619820 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m22:58:22.619820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m22:58:22.626868 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:58:22.626868 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m22:58:22.722056 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m22:58:22.722056 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:58:22.722056 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m22:58:22.843323 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.122 seconds
[0m22:58:22.843323 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m22:58:22.843323 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m22:58:22.937986 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m22:58:22.953708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff35bd16-adad-4255-9018-0d699a280c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BADF53A0>]}
[0m22:58:22.953708 [debug] [Thread-1 (]: Began running node model.healthcare.provider_department_revenue_summary
[0m22:58:22.953708 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.provider_department_revenue_summary .......... [RUN]
[0m22:58:22.953708 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.provider_department_revenue_summary'
[0m22:58:22.953708 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_department_revenue_summary
[0m22:58:22.980720 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_department_revenue_summary"
[0m22:58:22.980720 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_department_revenue_summary
[0m22:58:23.036228 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_department_revenue_summary"
[0m22:58:23.036228 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_department_revenue_summary"
[0m22:58:23.036228 [debug] [Thread-1 (]: On model.healthcare.provider_department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.provider_department_revenue_summary
    

    
    as (

WITH txn AS (
    SELECT
        provider_id,
        department_id,
        COALESCE(charge_amount, 0) AS charge_amount
    FROM DBT_DB.SILVER.src_transactions
),

providers AS (
    SELECT
        provider_id,
        full_name,
        specialization
    FROM DBT_DB.GOLD.dim_providers
),

departments AS (
    SELECT
        department_key,
        department_name
    FROM DBT_DB.GOLD.dim_departments
),

joined AS (
    SELECT
        t.provider_id,
        p.full_name,
        p.specialization,
        t.department_id,
        d.department_name,
        t.charge_amount
    FROM txn t
    LEFT JOIN providers p ON t.provider_id = p.provider_id
    LEFT JOIN departments d ON t.department_id = d.department_key
),

aggregated AS (
    SELECT
        provider_id,
        full_name,
        specialization,
        department_id,
        department_name,
        SUM(charge_amount) AS total_charges,
        COUNT(*) AS total_visits
    FROM joined
    GROUP BY provider_id, full_name, specialization, department_id, department_name
)

SELECT * FROM aggregated
    )
;
[0m22:58:23.036228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:58:24.931261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.888 seconds
[0m22:58:24.963007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff35bd16-adad-4255-9018-0d699a280c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879FCD90A0>]}
[0m22:58:24.963007 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.provider_department_revenue_summary ..... [[32mSUCCESS 1[0m in 2.01s]
[0m22:58:24.963007 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_department_revenue_summary
[0m22:58:24.963007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:24.963007 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m22:58:24.963007 [debug] [MainThread]: On list_DBT_DB: Close
[0m22:58:25.103759 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m22:58:25.103759 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m22:58:25.246052 [debug] [MainThread]: Connection 'model.healthcare.provider_department_revenue_summary' was left open.
[0m22:58:25.246052 [debug] [MainThread]: On model.healthcare.provider_department_revenue_summary: Close
[0m22:58:25.372482 [info ] [MainThread]: 
[0m22:58:25.372482 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m22:58:25.388292 [debug] [MainThread]: Command end result
[0m22:58:25.416638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m22:58:25.416638 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m22:58:25.432131 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m22:58:25.432131 [info ] [MainThread]: 
[0m22:58:25.432131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:58:25.432131 [info ] [MainThread]: 
[0m22:58:25.432131 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:58:25.432131 [debug] [MainThread]: Command `dbt run` succeeded at 22:58:25.432131 after 7.91 seconds
[0m22:58:25.438730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187A025C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BAA3E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187A042A900>]}
[0m22:58:25.438730 [debug] [MainThread]: Flushing usage events
[0m22:58:26.172076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:29.336109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257D80904A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257D84BBFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257D815C5F0>]}


============================== 23:08:29.344405 | 17dc71ec-86f8-4d5c-b27c-25cc3f040ed9 ==============================
[0m23:08:29.344405 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:08:29.344405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select denials_by_dept_provider', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:08:31.317199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17dc71ec-86f8-4d5c-b27c-25cc3f040ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F2978140>]}
[0m23:08:31.437894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17dc71ec-86f8-4d5c-b27c-25cc3f040ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257D88FAA20>]}
[0m23:08:31.439902 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:08:31.834070 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:08:32.001096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:32.001096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:32.014548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m23:08:32.067649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17dc71ec-86f8-4d5c-b27c-25cc3f040ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F2C54AA0>]}
[0m23:08:32.169680 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:08:32.181432 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:08:32.319615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17dc71ec-86f8-4d5c-b27c-25cc3f040ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F2D92210>]}
[0m23:08:32.319615 [info ] [MainThread]: Found 19 models, 4 data tests, 2 sources, 477 macros
[0m23:08:32.319615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17dc71ec-86f8-4d5c-b27c-25cc3f040ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F2E8CD70>]}
[0m23:08:32.321623 [info ] [MainThread]: 
[0m23:08:32.321623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:08:32.321623 [info ] [MainThread]: 
[0m23:08:32.321623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:08:32.328199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m23:08:32.408833 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m23:08:32.408833 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m23:08:32.408833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:33.273073 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.863 seconds
[0m23:08:33.285728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m23:08:33.302288 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:08:33.302288 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:08:33.302288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:33.814095 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.508 seconds
[0m23:08:33.820776 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:08:33.820776 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m23:08:34.061044 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.243 seconds
[0m23:08:34.068654 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:08:34.068654 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:08:34.175423 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m23:08:34.179447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m23:08:34.184904 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:08:34.186920 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:08:34.270987 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.087 seconds
[0m23:08:34.277023 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:08:34.277023 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m23:08:34.395550 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.117 seconds
[0m23:08:34.398578 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:08:34.398578 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:08:34.478327 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m23:08:34.494101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17dc71ec-86f8-4d5c-b27c-25cc3f040ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F29DD010>]}
[0m23:08:34.494101 [debug] [Thread-1 (]: Began running node model.healthcare.denials_by_dept_provider
[0m23:08:34.494101 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.denials_by_dept_provider ..................... [RUN]
[0m23:08:34.494101 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.denials_by_dept_provider'
[0m23:08:34.509971 [debug] [Thread-1 (]: Began compiling node model.healthcare.denials_by_dept_provider
[0m23:08:34.522051 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.denials_by_dept_provider"
[0m23:08:34.527420 [debug] [Thread-1 (]: Began executing node model.healthcare.denials_by_dept_provider
[0m23:08:34.569925 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.denials_by_dept_provider"
[0m23:08:34.569925 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.denials_by_dept_provider"
[0m23:08:34.569925 [debug] [Thread-1 (]: On model.healthcare.denials_by_dept_provider: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.denials_by_dept_provider"} */
create or replace transient table DBT_DB.GOLD.denials_by_dept_provider
    

    
    as (

with base as (
    select
        provider_id,
        dept_id,
        claim_status
    from DBT_DB.SILVER.src_claims
    where upper(claim_status) = 'DENIED'
),

agg as (
    select
        provider_id,
        dept_id,
        count(*) as denial_count
    from base
    group by provider_id, dept_id
)

select 
    a.provider_id,
    p.full_name,
    p.specialization,
    a.dept_id,
    d.department_name,
    a.denial_count
from agg a
left join DBT_DB.GOLD.dim_providers p on a.provider_id = p.provider_id
left join DBT_DB.GOLD.dim_departments d on a.dept_id = d.department_key
order by denial_count desc
    )
;
[0m23:08:34.569925 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:08:35.704442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.131 seconds
[0m23:08:35.737650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17dc71ec-86f8-4d5c-b27c-25cc3f040ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257D558D340>]}
[0m23:08:35.737650 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.denials_by_dept_provider ................ [[32mSUCCESS 1[0m in 1.24s]
[0m23:08:35.737650 [debug] [Thread-1 (]: Finished running node model.healthcare.denials_by_dept_provider
[0m23:08:35.737650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:35.737650 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m23:08:35.737650 [debug] [MainThread]: On list_DBT_DB: Close
[0m23:08:35.890932 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m23:08:35.892950 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m23:08:36.031590 [debug] [MainThread]: Connection 'model.healthcare.denials_by_dept_provider' was left open.
[0m23:08:36.033606 [debug] [MainThread]: On model.healthcare.denials_by_dept_provider: Close
[0m23:08:36.188484 [info ] [MainThread]: 
[0m23:08:36.188484 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m23:08:36.188484 [debug] [MainThread]: Command end result
[0m23:08:36.226110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:08:36.231120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:08:36.239329 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m23:08:36.239329 [info ] [MainThread]: 
[0m23:08:36.239329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:08:36.241339 [info ] [MainThread]: 
[0m23:08:36.241339 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:08:36.243348 [debug] [MainThread]: Command `dbt run` succeeded at 23:08:36.243348 after 7.30 seconds
[0m23:08:36.243348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257D7EBCD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257D88D0F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257D84BBFE0>]}
[0m23:08:36.245356 [debug] [MainThread]: Flushing usage events
[0m23:08:36.964934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:51.497229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A753B11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A77DD0B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A77DD3380>]}


============================== 23:12:51.497229 | e989f3dd-ddd3-4125-9ec7-8239056ff1dd ==============================
[0m23:12:51.497229 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:12:51.497229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select claims_status_metrics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:12:53.447743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e989f3dd-ddd3-4125-9ec7-8239056ff1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A128FEF00>]}
[0m23:12:53.544416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e989f3dd-ddd3-4125-9ec7-8239056ff1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A77978BF0>]}
[0m23:12:53.551537 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:12:53.999106 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:12:54.177368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:54.179378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:54.187439 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m23:12:54.257576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e989f3dd-ddd3-4125-9ec7-8239056ff1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A129E6240>]}
[0m23:12:54.377314 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:12:54.381333 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:12:54.510451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e989f3dd-ddd3-4125-9ec7-8239056ff1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A11435EE0>]}
[0m23:12:54.510451 [info ] [MainThread]: Found 19 models, 4 data tests, 2 sources, 477 macros
[0m23:12:54.510451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e989f3dd-ddd3-4125-9ec7-8239056ff1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A101A3740>]}
[0m23:12:54.523300 [info ] [MainThread]: 
[0m23:12:54.523300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:12:54.523300 [info ] [MainThread]: 
[0m23:12:54.526334 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:12:54.528364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m23:12:54.616715 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m23:12:54.618011 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m23:12:54.618011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:55.510222 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.906 seconds
[0m23:12:55.539505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m23:12:55.557925 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:12:55.557925 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:12:55.557925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:56.122925 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.562 seconds
[0m23:12:56.127333 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:12:56.127333 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m23:12:56.259469 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.125 seconds
[0m23:12:56.262668 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:12:56.262668 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:12:56.361333 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m23:12:56.363435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m23:12:56.370322 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:12:56.370322 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:12:56.467614 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m23:12:56.476059 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:12:56.476059 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m23:12:56.595165 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.123 seconds
[0m23:12:56.595165 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:12:56.595165 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:12:56.702852 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m23:12:56.707970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e989f3dd-ddd3-4125-9ec7-8239056ff1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A13010E30>]}
[0m23:12:56.712863 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m23:12:56.712863 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.claims_status_metrics ........................ [RUN]
[0m23:12:56.718698 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.claims_status_metrics'
[0m23:12:56.718698 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m23:12:56.730698 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m23:12:56.732717 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m23:12:56.769739 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m23:12:56.777212 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m23:12:56.777212 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
    

    
    as (

with base as (
    select
        claim_status,
        try_to_date(claim_date) as claim_date
    from DBT_DB.SILVER.src_claims
    where claim_status is not null
),

agg as (
    select
        to_char(claim_date, 'YYYY-MM') as claim_month,
        upper(claim_status) as claim_status,
        count(*) as claim_count
    from base
    group by claim_month, claim_status
)

select * from agg
order by claim_month, claim_status
    )
;
[0m23:12:56.777212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:12:58.381320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.603 seconds
[0m23:12:58.413288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e989f3dd-ddd3-4125-9ec7-8239056ff1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A131BF110>]}
[0m23:12:58.413288 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.claims_status_metrics ................... [[32mSUCCESS 1[0m in 1.69s]
[0m23:12:58.413288 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m23:12:58.429188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:58.429188 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m23:12:58.429188 [debug] [MainThread]: On list_DBT_DB: Close
[0m23:12:58.568152 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m23:12:58.573463 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m23:12:58.775655 [debug] [MainThread]: Connection 'model.healthcare.claims_status_metrics' was left open.
[0m23:12:58.775655 [debug] [MainThread]: On model.healthcare.claims_status_metrics: Close
[0m23:12:58.935331 [info ] [MainThread]: 
[0m23:12:58.935970 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m23:12:58.938214 [debug] [MainThread]: Command end result
[0m23:12:58.970988 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:12:58.975200 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:12:58.981237 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m23:12:58.981237 [info ] [MainThread]: 
[0m23:12:58.985043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:12:58.985043 [info ] [MainThread]: 
[0m23:12:58.985043 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:12:58.988300 [debug] [MainThread]: Command `dbt run` succeeded at 23:12:58.988300 after 7.83 seconds
[0m23:12:58.988300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A753B11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A1318B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A75E2E210>]}
[0m23:12:58.988300 [debug] [MainThread]: Flushing usage events
[0m23:12:59.790335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:30.698559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F10DD070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F44D9BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F44D95E0>]}


============================== 23:14:30.702513 | 2b4284be-8cb1-4583-9fd2-35937ffabde3 ==============================
[0m23:14:30.702513 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:14:30.702513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select ar_balance_summary', 'send_anonymous_usage_stats': 'True'}
[0m23:14:33.087850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b4284be-8cb1-4583-9fd2-35937ffabde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D98C92E1B0>]}
[0m23:14:33.200049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b4284be-8cb1-4583-9fd2-35937ffabde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F40EB170>]}
[0m23:14:33.200049 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:14:33.617400 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:14:33.798635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:14:33.798635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:14:33.816041 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m23:14:33.862621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b4284be-8cb1-4583-9fd2-35937ffabde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D98E5EE0F0>]}
[0m23:14:33.969955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:14:33.973989 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:14:34.111606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b4284be-8cb1-4583-9fd2-35937ffabde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D98EAFD8B0>]}
[0m23:14:34.115147 [info ] [MainThread]: Found 20 models, 4 data tests, 2 sources, 477 macros
[0m23:14:34.117207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b4284be-8cb1-4583-9fd2-35937ffabde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D98D0432C0>]}
[0m23:14:34.117886 [info ] [MainThread]: 
[0m23:14:34.122918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:14:34.125337 [info ] [MainThread]: 
[0m23:14:34.126065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:14:34.126065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m23:14:34.207377 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m23:14:34.207377 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m23:14:34.207377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:35.018982 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.804 seconds
[0m23:14:35.029559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m23:14:35.049426 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:14:35.049426 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:14:35.051440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:35.650954 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.600 seconds
[0m23:14:35.652967 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:14:35.652967 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m23:14:35.774711 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.114 seconds
[0m23:14:35.778745 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:14:35.779393 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:14:35.895415 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m23:14:35.896453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m23:14:35.902742 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:14:35.902742 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:14:36.002358 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m23:14:36.006683 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:14:36.006683 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m23:14:36.159190 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.152 seconds
[0m23:14:36.161207 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:14:36.163220 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:14:36.273215 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m23:14:36.278513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b4284be-8cb1-4583-9fd2-35937ffabde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F1B4B950>]}
[0m23:14:36.286586 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m23:14:36.286586 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.ar_balance_summary ........................... [RUN]
[0m23:14:36.288599 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.ar_balance_summary'
[0m23:14:36.288599 [debug] [Thread-1 (]: Began compiling node model.healthcare.ar_balance_summary
[0m23:14:36.298413 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.ar_balance_summary"
[0m23:14:36.300427 [debug] [Thread-1 (]: Began executing node model.healthcare.ar_balance_summary
[0m23:14:36.341730 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.ar_balance_summary"
[0m23:14:36.344578 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.ar_balance_summary"
[0m23:14:36.344578 [debug] [Thread-1 (]: On model.healthcare.ar_balance_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.ar_balance_summary"} */
create or replace transient table DBT_DB.GOLD.ar_balance_summary
    

    
    as (

with txn as (
    select
        transaction_id,
        provider_id,
        coalesce(amount, 0) as billed_amount
    from DBT_DB.SILVER.src_transactions
),

claims as (
    select
        transaction_id,
        coalesce(paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims
),

joined as (
    select
        t.provider_id,
        t.billed_amount,
        c.paid_amount
    from txn t
    left join claims c
    on t.transaction_id = c.transaction_id
),

agg as (
    select
        provider_id,
        sum(billed_amount) as total_billed,
        sum(paid_amount) as total_paid,
        sum(billed_amount - paid_amount) as ar_balance
    from joined
    group by provider_id
)

select 
    a.provider_id,
    p.full_name,
    p.specialization,
    a.total_billed,
    a.total_paid,
    a.ar_balance
from agg a
left join DBT_DB.GOLD.dim_providers p on a.provider_id = p.provider_id
order by ar_balance desc
    )
;
[0m23:14:36.344578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:14:36.785850 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdf5c2-0000-27ff-0027-cf8b00066fda
[0m23:14:36.785850 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 17
invalid identifier 'AMOUNT'
[0m23:14:36.789689 [debug] [Thread-1 (]: Database Error in model ar_balance_summary (models\healthcare\fact\ar_balance_summary.sql)
  000904 (42000): SQL compilation error: error line 11 at position 17
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\ar_balance_summary.sql
[0m23:14:36.793716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b4284be-8cb1-4583-9fd2-35937ffabde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F35D9460>]}
[0m23:14:36.795728 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model GOLD.ar_balance_summary .................. [[31mERROR[0m in 0.50s]
[0m23:14:36.797172 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m23:14:36.797904 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.ar_balance_summary' to be skipped because of status 'error'.  Reason: Database Error in model ar_balance_summary (models\healthcare\fact\ar_balance_summary.sql)
  000904 (42000): SQL compilation error: error line 11 at position 17
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\ar_balance_summary.sql.
[0m23:14:36.799189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:36.801199 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m23:14:36.801715 [debug] [MainThread]: On list_DBT_DB: Close
[0m23:14:36.956372 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m23:14:36.958384 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m23:14:37.110106 [debug] [MainThread]: Connection 'model.healthcare.ar_balance_summary' was left open.
[0m23:14:37.110106 [debug] [MainThread]: On model.healthcare.ar_balance_summary: Close
[0m23:14:37.251378 [info ] [MainThread]: 
[0m23:14:37.254130 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m23:14:37.255086 [debug] [MainThread]: Command end result
[0m23:14:37.289941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:14:37.293972 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:14:37.300017 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m23:14:37.300017 [info ] [MainThread]: 
[0m23:14:37.302912 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:14:37.302912 [info ] [MainThread]: 
[0m23:14:37.305740 [error] [MainThread]: [31mFailure in model ar_balance_summary (models\healthcare\fact\ar_balance_summary.sql)[0m
[0m23:14:37.306886 [error] [MainThread]:   Database Error in model ar_balance_summary (models\healthcare\fact\ar_balance_summary.sql)
  000904 (42000): SQL compilation error: error line 11 at position 17
  invalid identifier 'AMOUNT'
  compiled code at target\run\healthcare\models\healthcare\fact\ar_balance_summary.sql
[0m23:14:37.308075 [info ] [MainThread]: 
[0m23:14:37.308075 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\fact\ar_balance_summary.sql
[0m23:14:37.313155 [info ] [MainThread]: 
[0m23:14:37.313155 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:14:37.315845 [debug] [MainThread]: Command `dbt run` failed at 23:14:37.315172 after 6.88 seconds
[0m23:14:37.315845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F1492090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D98EB5D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D98E4F3CE0>]}
[0m23:14:37.315845 [debug] [MainThread]: Flushing usage events
[0m23:14:38.126839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:06.844025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FE21220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E103545AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1035DAE40>]}


============================== 23:15:06.852066 | 3c06976a-5494-41fc-b602-874156e806c6 ==============================
[0m23:15:06.852066 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:15:06.854075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select ar_balance_summary', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:15:08.653785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c06976a-5494-41fc-b602-874156e806c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11C8B2750>]}
[0m23:15:08.764107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c06976a-5494-41fc-b602-874156e806c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11B5C0410>]}
[0m23:15:08.766120 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:15:09.170350 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:15:09.366550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:15:09.367329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:15:09.375393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m23:15:09.434619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c06976a-5494-41fc-b602-874156e806c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11DB567E0>]}
[0m23:15:09.532238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:15:09.536272 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:15:09.667408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c06976a-5494-41fc-b602-874156e806c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1010C9910>]}
[0m23:15:09.667408 [info ] [MainThread]: Found 20 models, 4 data tests, 2 sources, 477 macros
[0m23:15:09.667408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c06976a-5494-41fc-b602-874156e806c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10113C1D0>]}
[0m23:15:09.669417 [info ] [MainThread]: 
[0m23:15:09.671426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:15:09.671426 [info ] [MainThread]: 
[0m23:15:09.673435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:15:09.675444 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m23:15:09.800261 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m23:15:09.802273 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m23:15:09.802273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:10.662012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.859 seconds
[0m23:15:10.671139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m23:15:10.695035 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:15:10.695035 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:15:10.697045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:11.282737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.586 seconds
[0m23:15:11.288782 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:15:11.288782 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m23:15:11.405031 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.114 seconds
[0m23:15:11.406788 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:15:11.408799 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:15:11.510651 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m23:15:11.514673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m23:15:11.520467 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:15:11.520467 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:15:11.623809 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m23:15:11.627586 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:15:11.627586 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m23:15:11.746575 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.118 seconds
[0m23:15:11.748587 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:15:11.748587 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:15:11.851005 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m23:15:11.857040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c06976a-5494-41fc-b602-874156e806c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11DC09DF0>]}
[0m23:15:11.864835 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m23:15:11.866851 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.ar_balance_summary ........................... [RUN]
[0m23:15:11.866851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.ar_balance_summary'
[0m23:15:11.868870 [debug] [Thread-1 (]: Began compiling node model.healthcare.ar_balance_summary
[0m23:15:11.882396 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.ar_balance_summary"
[0m23:15:11.886611 [debug] [Thread-1 (]: Began executing node model.healthcare.ar_balance_summary
[0m23:15:11.924961 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.ar_balance_summary"
[0m23:15:11.926983 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.ar_balance_summary"
[0m23:15:11.926983 [debug] [Thread-1 (]: On model.healthcare.ar_balance_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.ar_balance_summary"} */
create or replace transient table DBT_DB.GOLD.ar_balance_summary
    

    
    as (

with txn as (
    select
        transaction_id,
        provider_id,
        coalesce(charge_amount, 0) as billed_amount
    from DBT_DB.SILVER.src_transactions
),

claims as (
    select
        transaction_id,
        coalesce(paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims
),

joined as (
    select
        t.provider_id,
        t.billed_amount,
        c.paid_amount
    from txn t
    left join claims c
    on t.transaction_id = c.transaction_id
),

agg as (
    select
        provider_id,
        sum(billed_amount) as total_billed,
        sum(paid_amount) as total_paid,
        sum(billed_amount - paid_amount) as ar_balance
    from joined
    group by provider_id
)

select 
    a.provider_id,
    p.full_name,
    p.specialization,
    a.total_billed,
    a.total_paid,
    a.ar_balance
from agg a
left join DBT_DB.GOLD.dim_providers p on a.provider_id = p.provider_id
order by ar_balance desc
    )
;
[0m23:15:11.929002 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:15:13.573745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.652 seconds
[0m23:15:13.605358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c06976a-5494-41fc-b602-874156e806c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FF0D580>]}
[0m23:15:13.605358 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.ar_balance_summary ...................... [[32mSUCCESS 1[0m in 1.74s]
[0m23:15:13.621112 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m23:15:13.621112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:13.621112 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m23:15:13.621112 [debug] [MainThread]: On list_DBT_DB: Close
[0m23:15:13.765762 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m23:15:13.765762 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m23:15:13.891835 [debug] [MainThread]: Connection 'model.healthcare.ar_balance_summary' was left open.
[0m23:15:13.891835 [debug] [MainThread]: On model.healthcare.ar_balance_summary: Close
[0m23:15:14.026663 [info ] [MainThread]: 
[0m23:15:14.026663 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m23:15:14.035779 [debug] [MainThread]: Command end result
[0m23:15:14.068371 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:15:14.074605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:15:14.083577 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m23:15:14.085946 [info ] [MainThread]: 
[0m23:15:14.085946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:15:14.085946 [info ] [MainThread]: 
[0m23:15:14.085946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:15:14.085946 [debug] [MainThread]: Command `dbt run` succeeded at 23:15:14.085946 after 7.53 seconds
[0m23:15:14.085946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FE21220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11DBA5D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11C3FEBA0>]}
[0m23:15:14.085946 [debug] [MainThread]: Flushing usage events
[0m23:15:14.776794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:56.210604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E958616A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E953FECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E95860500>]}


============================== 23:18:56.220157 | e6f21de7-9232-4e65-949f-9d3095a3eec1 ==============================
[0m23:18:56.220157 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:18:56.222166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select ar_balance_summary', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:58.108479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6f21de7-9232-4e65-949f-9d3095a3eec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAF89E270>]}
[0m23:18:58.208676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6f21de7-9232-4e65-949f-9d3095a3eec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAF80BDA0>]}
[0m23:18:58.210685 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:18:58.591929 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:18:58.758845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:58.760863 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:58.767344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m23:18:58.820301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6f21de7-9232-4e65-949f-9d3095a3eec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAFAD60C0>]}
[0m23:18:58.935112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:18:58.939144 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:18:59.087945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6f21de7-9232-4e65-949f-9d3095a3eec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E92EC9A00>]}
[0m23:18:59.089958 [info ] [MainThread]: Found 20 models, 4 data tests, 2 sources, 477 macros
[0m23:18:59.089958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f21de7-9232-4e65-949f-9d3095a3eec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAFA787A0>]}
[0m23:18:59.093727 [info ] [MainThread]: 
[0m23:18:59.093727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:59.095742 [info ] [MainThread]: 
[0m23:18:59.095742 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:18:59.098394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m23:18:59.173508 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m23:18:59.181838 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m23:18:59.181838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:00.059224 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.878 seconds
[0m23:19:00.073103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m23:19:00.088956 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:19:00.088956 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:19:00.088956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:00.599316 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.508 seconds
[0m23:19:00.603339 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:19:00.603339 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m23:19:00.736393 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.131 seconds
[0m23:19:00.738410 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:19:00.738410 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:19:00.839373 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m23:19:00.841383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m23:19:00.847412 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:19:00.847412 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:19:00.942721 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m23:19:00.944739 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:19:00.944739 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m23:19:01.069313 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.123 seconds
[0m23:19:01.071328 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:19:01.071328 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:19:01.208658 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.137 seconds
[0m23:19:01.214445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f21de7-9232-4e65-949f-9d3095a3eec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB03724E0>]}
[0m23:19:01.220487 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m23:19:01.222502 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.ar_balance_summary ........................... [RUN]
[0m23:19:01.224517 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.ar_balance_summary'
[0m23:19:01.224517 [debug] [Thread-1 (]: Began compiling node model.healthcare.ar_balance_summary
[0m23:19:01.238117 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.ar_balance_summary"
[0m23:19:01.240130 [debug] [Thread-1 (]: Began executing node model.healthcare.ar_balance_summary
[0m23:19:01.281743 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.ar_balance_summary"
[0m23:19:01.285776 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.ar_balance_summary"
[0m23:19:01.287793 [debug] [Thread-1 (]: On model.healthcare.ar_balance_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.ar_balance_summary"} */
create or replace transient table DBT_DB.GOLD.ar_balance_summary
    

    
    as (

with txn as (
    select
        provider_id,
        transaction_id,
        sum(coalesce(charge_amount, 0)) as total_billed
    from DBT_DB.SILVER.src_transactions
    group by provider_id, transaction_id
),

claims as (
    select
        transaction_id,
        sum(coalesce(paid_amount, 0)) as total_paid
    from DBT_DB.SILVER.src_claims
    group by transaction_id
),

joined as (
    select
        t.provider_id,
        t.total_billed,
        coalesce(c.total_paid, 0) as total_paid
    from txn t
    left join claims c
    on t.transaction_id = c.transaction_id
),

agg as (
    select
        provider_id,
        sum(total_billed) as total_billed,
        sum(total_paid) as total_paid,
        sum(total_billed - total_paid) as ar_balance
    from joined
    group by provider_id
)

select 
    a.provider_id,
    p.full_name,
    p.specialization,
    a.total_billed,
    a.total_paid,
    a.ar_balance
from agg a
left join DBT_DB.GOLD.dim_providers p on a.provider_id = p.provider_id
order by ar_balance desc
    )
;
[0m23:19:01.288684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:19:02.517865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.231 seconds
[0m23:19:02.558906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6f21de7-9232-4e65-949f-9d3095a3eec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB0391070>]}
[0m23:19:02.560924 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.ar_balance_summary ...................... [[32mSUCCESS 1[0m in 1.33s]
[0m23:19:02.560924 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m23:19:02.562936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:02.564947 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m23:19:02.565460 [debug] [MainThread]: On list_DBT_DB: Close
[0m23:19:02.721299 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m23:19:02.721299 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m23:19:02.872139 [debug] [MainThread]: Connection 'model.healthcare.ar_balance_summary' was left open.
[0m23:19:02.872139 [debug] [MainThread]: On model.healthcare.ar_balance_summary: Close
[0m23:19:03.036697 [info ] [MainThread]: 
[0m23:19:03.036697 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m23:19:03.038710 [debug] [MainThread]: Command end result
[0m23:19:03.070357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:19:03.074830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:19:03.082712 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m23:19:03.083740 [info ] [MainThread]: 
[0m23:19:03.084751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:19:03.086159 [info ] [MainThread]: 
[0m23:19:03.087503 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:19:03.088583 [debug] [MainThread]: Command `dbt run` succeeded at 23:19:03.088583 after 7.16 seconds
[0m23:19:03.088583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB0242C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAFA79340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E95860B90>]}
[0m23:19:03.088583 [debug] [MainThread]: Flushing usage events
[0m23:19:03.849987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:28:51.404767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622464FDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622464FD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622464FF20>]}


============================== 23:28:51.413023 | b172b401-eac1-4cb1-96d4-0f5231153f42 ==============================
[0m23:28:51.413023 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:28:51.413023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select ar_balance_summary', 'send_anonymous_usage_stats': 'True'}
[0m23:28:53.531711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b172b401-eac1-4cb1-96d4-0f5231153f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001623E4DBFE0>]}
[0m23:28:53.626613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b172b401-eac1-4cb1-96d4-0f5231153f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162246BD460>]}
[0m23:28:53.630372 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:28:54.017949 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:28:54.245990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:28:54.245990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:28:54.254133 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m23:28:54.311999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b172b401-eac1-4cb1-96d4-0f5231153f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001623E83E0C0>]}
[0m23:28:54.430244 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:28:54.430244 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:28:54.580707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b172b401-eac1-4cb1-96d4-0f5231153f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001623C268200>]}
[0m23:28:54.587815 [info ] [MainThread]: Found 20 models, 4 data tests, 2 sources, 477 macros
[0m23:28:54.587815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b172b401-eac1-4cb1-96d4-0f5231153f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001623CE06840>]}
[0m23:28:54.587815 [info ] [MainThread]: 
[0m23:28:54.587815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:28:54.587815 [info ] [MainThread]: 
[0m23:28:54.587815 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:28:54.598475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m23:28:54.703028 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m23:28:54.703028 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m23:28:54.703028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:55.632715 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.936 seconds
[0m23:28:55.653682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m23:28:55.664515 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:28:55.664515 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:28:55.664515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:56.265410 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.598 seconds
[0m23:28:56.278104 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:28:56.280121 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m23:28:56.422939 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.143 seconds
[0m23:28:56.424678 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:28:56.426690 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:28:56.520507 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m23:28:56.531483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m23:28:56.538426 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:28:56.538426 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:28:56.653941 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m23:28:56.658711 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:28:56.658711 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m23:28:56.766224 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.120 seconds
[0m23:28:56.782271 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:28:56.784289 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:28:56.885386 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m23:28:56.894127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b172b401-eac1-4cb1-96d4-0f5231153f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001623E73A060>]}
[0m23:28:56.894127 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m23:28:56.894127 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.ar_balance_summary ........................... [RUN]
[0m23:28:56.894127 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.ar_balance_summary'
[0m23:28:56.907408 [debug] [Thread-1 (]: Began compiling node model.healthcare.ar_balance_summary
[0m23:28:56.911438 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.ar_balance_summary"
[0m23:28:56.911438 [debug] [Thread-1 (]: Began executing node model.healthcare.ar_balance_summary
[0m23:28:56.965070 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.ar_balance_summary"
[0m23:28:56.965070 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.ar_balance_summary"
[0m23:28:56.968156 [debug] [Thread-1 (]: On model.healthcare.ar_balance_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.ar_balance_summary"} */
create or replace transient table DBT_DB.GOLD.ar_balance_summary
    

    
    as (

with txn as (
    select
        provider_id,
        transaction_id,
        coalesce(charge_amount, 0) as billed_amount
    from DBT_DB.SILVER.src_transactions
),

claims as (
    select
        transaction_id,
        coalesce(paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims
),

joined as (
    select
        t.provider_id,
        t.transaction_id,
        t.billed_amount,
        c.paid_amount
    from txn t
    left join claims c
        on t.transaction_id = c.transaction_id
),

aggregated as (
    select
        provider_id,
        count(*) as total_transactions,
        sum(billed_amount) as total_billed,
        sum(paid_amount) as total_paid,
        sum(greatest(billed_amount - paid_amount, 0)) as ar_balance
    from joined
    group by provider_id
),

with_provider_details as (
    select
        a.provider_id,
        p.full_name,
        p.specialization,
        a.total_transactions,
        a.total_billed,
        a.total_paid,
        a.ar_balance
    from aggregated a
    left join DBT_DB.GOLD.dim_providers p
        on a.provider_id = p.provider_id
)

select * from with_provider_details
    )
;
[0m23:28:56.968156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:28:58.315544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.348 seconds
[0m23:28:58.363047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b172b401-eac1-4cb1-96d4-0f5231153f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622134D580>]}
[0m23:28:58.363047 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.ar_balance_summary ...................... [[32mSUCCESS 1[0m in 1.45s]
[0m23:28:58.363047 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m23:28:58.363047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:58.363047 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m23:28:58.363047 [debug] [MainThread]: On list_DBT_DB: Close
[0m23:28:58.513555 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m23:28:58.513555 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m23:28:58.660516 [debug] [MainThread]: Connection 'model.healthcare.ar_balance_summary' was left open.
[0m23:28:58.660516 [debug] [MainThread]: On model.healthcare.ar_balance_summary: Close
[0m23:28:58.831058 [info ] [MainThread]: 
[0m23:28:58.831058 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m23:28:58.831058 [debug] [MainThread]: Command end result
[0m23:28:58.867568 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:28:58.871932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:28:58.877967 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m23:28:58.879978 [info ] [MainThread]: 
[0m23:28:58.883513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:28:58.885602 [info ] [MainThread]: 
[0m23:28:58.885602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:28:58.888022 [debug] [MainThread]: Command `dbt run` succeeded at 23:28:58.885602 after 7.78 seconds
[0m23:28:58.888022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016224174110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001623D01CA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016223E91250>]}
[0m23:28:58.889032 [debug] [MainThread]: Flushing usage events
[0m23:28:59.578182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:16.371913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90324D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F905E32090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F905E311C0>]}


============================== 23:49:16.378901 | f853283a-0e75-4f97-a210-bdd0050e46e2 ==============================
[0m23:49:16.378901 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:49:16.379934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select provider_productivity_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:49:20.722060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f853283a-0e75-4f97-a210-bdd0050e46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F91E329370>]}
[0m23:49:20.787491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f853283a-0e75-4f97-a210-bdd0050e46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90332E150>]}
[0m23:49:20.789488 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:49:21.341382 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:49:21.475725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:21.476725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:21.482144 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m23:49:21.516659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f853283a-0e75-4f97-a210-bdd0050e46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920867320>]}
[0m23:49:21.597239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:49:21.628209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:49:21.755943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f853283a-0e75-4f97-a210-bdd0050e46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920B32330>]}
[0m23:49:21.756942 [info ] [MainThread]: Found 21 models, 4 data tests, 2 sources, 477 macros
[0m23:49:21.757941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f853283a-0e75-4f97-a210-bdd0050e46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F91F1732C0>]}
[0m23:49:21.759944 [info ] [MainThread]: 
[0m23:49:21.760945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:49:21.761946 [info ] [MainThread]: 
[0m23:49:21.761946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:49:21.763944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m23:49:25.504981 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m23:49:25.504981 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m23:49:25.505977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:27.188198 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.683 seconds
[0m23:49:27.194528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m23:49:27.203749 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:49:27.204743 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:49:27.204743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:28.292985 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.088 seconds
[0m23:49:28.295982 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:49:28.295982 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m23:49:28.443805 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.147 seconds
[0m23:49:28.444805 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:49:28.445803 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:49:28.554354 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m23:49:28.556354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m23:49:28.558354 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:49:28.558354 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:49:28.662984 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m23:49:28.663980 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:49:28.664990 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m23:49:28.803302 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.138 seconds
[0m23:49:28.805409 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:49:28.805409 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:49:28.909985 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m23:49:28.912977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f853283a-0e75-4f97-a210-bdd0050e46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9033EFB00>]}
[0m23:49:28.925080 [debug] [Thread-1 (]: Began running node model.healthcare.provider_productivity_summary
[0m23:49:28.925080 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.provider_productivity_summary ............... [RUN]
[0m23:49:28.926073 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.provider_productivity_summary'
[0m23:49:28.927081 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_productivity_summary
[0m23:49:28.932094 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_productivity_summary"
[0m23:49:28.933087 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_productivity_summary
[0m23:49:28.957236 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_productivity_summary"
[0m23:49:28.959239 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_productivity_summary"
[0m23:49:28.959239 [debug] [Thread-1 (]: On model.healthcare.provider_productivity_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_productivity_summary"} */
create or replace   view DBT_DB.SILVER.provider_productivity_summary
  
   as (
    SELECT
    provider_id,
    COUNT(DISTINCT patient_id) AS unique_patients_seen,
    COUNT(*) AS total_transactions,
    SUM(charge_amount) AS total_billed_amount
FROM DBT_DB.SILVER.src_transactions
GROUP BY provider_id
  );
[0m23:49:28.959239 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:49:29.721989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m23:49:29.738983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f853283a-0e75-4f97-a210-bdd0050e46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90332D2B0>]}
[0m23:49:29.738983 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.provider_productivity_summary .......... [[32mSUCCESS 1[0m in 0.81s]
[0m23:49:29.739986 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_productivity_summary
[0m23:49:29.741958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:29.742951 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m23:49:29.742951 [debug] [MainThread]: On list_DBT_DB: Close
[0m23:49:29.894446 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m23:49:29.895377 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m23:49:30.044534 [debug] [MainThread]: Connection 'model.healthcare.provider_productivity_summary' was left open.
[0m23:49:30.045474 [debug] [MainThread]: On model.healthcare.provider_productivity_summary: Close
[0m23:49:30.203784 [info ] [MainThread]: 
[0m23:49:30.204782 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m23:49:30.205784 [debug] [MainThread]: Command end result
[0m23:49:30.232005 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:49:30.235998 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:49:30.241670 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m23:49:30.242676 [info ] [MainThread]: 
[0m23:49:30.243671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:30.243671 [info ] [MainThread]: 
[0m23:49:30.244670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:49:30.246670 [debug] [MainThread]: Command `dbt run` succeeded at 23:49:30.245670 after 14.07 seconds
[0m23:49:30.246670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90324D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9030DF710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920F2EB40>]}
[0m23:49:30.246670 [debug] [MainThread]: Flushing usage events
[0m23:49:30.897167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:50:43.026028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9182F4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9155BB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9182F6240>]}


============================== 23:50:43.031329 | 530d9ac1-0849-462b-9d4c-ab23891ca914 ==============================
[0m23:50:43.031329 [info ] [MainThread]: Running with dbt=1.10.2
[0m23:50:43.031329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select provider_productivity_summary', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:50:44.073362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '530d9ac1-0849-462b-9d4c-ab23891ca914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C932A6EE70>]}
[0m23:50:44.151910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '530d9ac1-0849-462b-9d4c-ab23891ca914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C931517500>]}
[0m23:50:44.153900 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:50:44.499106 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m23:50:44.643615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:50:44.644613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:50:44.650295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m23:50:44.688555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '530d9ac1-0849-462b-9d4c-ab23891ca914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C932D22840>]}
[0m23:50:44.768510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:50:44.771608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:50:44.879038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '530d9ac1-0849-462b-9d4c-ab23891ca914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9330062A0>]}
[0m23:50:44.879038 [info ] [MainThread]: Found 21 models, 4 data tests, 2 sources, 477 macros
[0m23:50:44.880036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530d9ac1-0849-462b-9d4c-ab23891ca914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C932CD9790>]}
[0m23:50:44.882004 [info ] [MainThread]: 
[0m23:50:44.883001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:50:44.883999 [info ] [MainThread]: 
[0m23:50:44.884999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:50:44.886999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m23:50:44.949637 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m23:50:44.950638 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m23:50:44.950638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:46.050509 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.100 seconds
[0m23:50:46.056509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m23:50:46.065550 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:50:46.066512 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:50:46.066512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:46.665934 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.599 seconds
[0m23:50:46.668353 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:50:46.669352 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m23:50:46.870249 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.201 seconds
[0m23:50:46.872299 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m23:50:46.872299 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:50:47.077152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.204 seconds
[0m23:50:47.078151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m23:50:47.080150 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:50:47.080150 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:50:47.280727 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.200 seconds
[0m23:50:47.281691 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:50:47.282691 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m23:50:47.484814 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.202 seconds
[0m23:50:47.486810 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m23:50:47.486810 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:50:47.693748 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.207 seconds
[0m23:50:47.696740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530d9ac1-0849-462b-9d4c-ab23891ca914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9314F64E0>]}
[0m23:50:47.702015 [debug] [Thread-1 (]: Began running node model.healthcare.provider_productivity_summary
[0m23:50:47.703000 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.provider_productivity_summary ................ [RUN]
[0m23:50:47.704019 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.provider_productivity_summary'
[0m23:50:47.704019 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_productivity_summary
[0m23:50:47.709004 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_productivity_summary"
[0m23:50:47.710004 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_productivity_summary
[0m23:50:47.734158 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_productivity_summary"
[0m23:50:47.736271 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_productivity_summary"
[0m23:50:47.736271 [debug] [Thread-1 (]: On model.healthcare.provider_productivity_summary: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_productivity_summary"} */
create or replace transient table DBT_DB.GOLD.provider_productivity_summary
    

    
    as (

SELECT
    provider_id,
    COUNT(DISTINCT patient_id) AS unique_patients_seen,
    COUNT(*) AS total_transactions,
    SUM(charge_amount) AS total_billed_amount
FROM DBT_DB.SILVER.src_transactions
GROUP BY provider_id
    )
;
[0m23:50:47.736271 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:50:49.188072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.451 seconds
[0m23:50:49.204028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '530d9ac1-0849-462b-9d4c-ab23891ca914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C932BE99D0>]}
[0m23:50:49.205076 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.provider_productivity_summary ........... [[32mSUCCESS 1[0m in 1.50s]
[0m23:50:49.206032 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_productivity_summary
[0m23:50:49.207030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:49.208027 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m23:50:49.208027 [debug] [MainThread]: On list_DBT_DB: Close
[0m23:50:49.389575 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m23:50:49.390523 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m23:50:49.546056 [debug] [MainThread]: Connection 'model.healthcare.provider_productivity_summary' was left open.
[0m23:50:49.546056 [debug] [MainThread]: On model.healthcare.provider_productivity_summary: Close
[0m23:50:49.703350 [info ] [MainThread]: 
[0m23:50:49.704317 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.82 seconds (4.82s).
[0m23:50:49.705349 [debug] [MainThread]: Command end result
[0m23:50:49.731837 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m23:50:49.735086 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m23:50:49.742097 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m23:50:49.743098 [info ] [MainThread]: 
[0m23:50:49.744098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:50:49.744098 [info ] [MainThread]: 
[0m23:50:49.745098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:50:49.747095 [debug] [MainThread]: Command `dbt run` succeeded at 23:50:49.746094 after 6.90 seconds
[0m23:50:49.747095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C918617E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9319837D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C91838B1A0>]}
[0m23:50:49.747095 [debug] [MainThread]: Flushing usage events
[0m23:50:50.401205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:28.764076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285514FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285514E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285514EFF0>]}


============================== 00:29:28.764076 | a82ec8c5-3401-46f0-aab6-642452f036a5 ==============================
[0m00:29:28.764076 [info ] [MainThread]: Running with dbt=1.10.2
[0m00:29:28.764076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:28.907035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a82ec8c5-3401-46f0-aab6-642452f036a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022854D64140>]}
[0m00:29:28.938773 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:29:28.938773 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:29:28.938773 [debug] [MainThread]: Command `cli deps` succeeded at 00:29:28.938773 after 0.40 seconds
[0m00:29:28.938773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285494E480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022855268D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022855268B60>]}
[0m00:29:28.938773 [debug] [MainThread]: Flushing usage events
[0m00:29:29.536780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:15.409815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DCA0C8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DCA0C86E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DCA0C8C80>]}


============================== 01:06:15.417845 | f12a441c-e26b-488a-b44d-54befc052aa7 ==============================
[0m01:06:15.417845 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:06:15.419813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m01:06:15.647261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f12a441c-e26b-488a-b44d-54befc052aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC91633E0>]}
[0m01:06:15.682521 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:06:15.685499 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:06:15.686500 [debug] [MainThread]: Command `cli deps` succeeded at 01:06:15.686500 after 0.52 seconds
[0m01:06:15.686500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC6F05010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DCA202870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC91633E0>]}
[0m01:06:15.687529 [debug] [MainThread]: Flushing usage events
[0m01:06:16.512878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:14.960302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A011DD1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A011DD1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A011DD1490>]}


============================== 01:18:14.962852 | 7a84c6b2-1afd-46ac-94f6-af2e4bccfa2f ==============================
[0m01:18:14.962852 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:18:14.962852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --target prod', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:18:14.982528 [info ] [MainThread]: dbt version: 1.10.2
[0m01:18:14.982528 [info ] [MainThread]: python version: 3.12.3
[0m01:18:14.982528 [info ] [MainThread]: python path: C:\Users\sanja\AppData\Local\Programs\Python\Python312\python.exe
[0m01:18:14.982528 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m01:18:14.982528 [info ] [MainThread]: Using profiles dir at C:\Users\sanja\.dbt
[0m01:18:14.982528 [info ] [MainThread]: Using profiles.yml file at C:\Users\sanja\.dbt\profiles.yml
[0m01:18:14.982528 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\dbt_project.yml
[0m01:18:15.077773 [info ] [MainThread]: Configuration:
[0m01:18:15.077773 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m01:18:15.077773 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:18:15.077773 [info ] [MainThread]: Required dependencies:
[0m01:18:15.077773 [debug] [MainThread]: Executing "git --help"
[0m01:18:15.130705 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:18:15.130705 [debug] [MainThread]: STDERR: "b''"
[0m01:18:15.130705 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:18:15.133164 [info ] [MainThread]: Connection test skipped since no profile was found
[0m01:18:15.133164 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:18:15.133164 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'healthcare' does not have a target named 'prod'. The valid target names for this profile are:
   - dev


[0m01:18:15.133164 [debug] [MainThread]: Command `dbt debug` failed at 01:18:15.133164 after 0.36 seconds
[0m01:18:15.133164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01227D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0117A87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01177BBC0>]}
[0m01:18:15.133164 [debug] [MainThread]: Flushing usage events
[0m01:18:15.708438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:50.708862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DD669FDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DD669FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DD669FCB0>]}


============================== 01:18:50.708862 | 81601f9f-c0de-4e16-8a7a-818494404010 ==============================
[0m01:18:50.708862 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:18:50.724696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjana assignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --target prod', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:18:50.724696 [info ] [MainThread]: dbt version: 1.10.2
[0m01:18:50.724696 [info ] [MainThread]: python version: 3.12.3
[0m01:18:50.740522 [info ] [MainThread]: python path: C:\Users\sanja\AppData\Local\Programs\Python\Python312\python.exe
[0m01:18:50.741766 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m01:18:51.344847 [info ] [MainThread]: Using profiles dir at C:\Users\sanja\.dbt
[0m01:18:51.344847 [info ] [MainThread]: Using profiles.yml file at C:\Users\sanja\.dbt\profiles.yml
[0m01:18:51.344847 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\sanja\OneDrive\Documents\sanjana assignments\snowflake\sf-org-pipeline\dbt\healthcare\dbt_project.yml
[0m01:18:51.344847 [info ] [MainThread]: adapter type: snowflake
[0m01:18:51.344847 [info ] [MainThread]: adapter version: 1.9.4
[0m01:18:51.450509 [info ] [MainThread]: Configuration:
[0m01:18:51.451514 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:18:51.452528 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:18:51.452528 [info ] [MainThread]: Required dependencies:
[0m01:18:51.453525 [debug] [MainThread]: Executing "git --help"
[0m01:18:51.496405 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:18:51.497431 [debug] [MainThread]: STDERR: "b''"
[0m01:18:51.497939 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:18:51.497939 [info ] [MainThread]: Connection:
[0m01:18:51.497939 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:18:51.497939 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:18:51.497939 [info ] [MainThread]:   database: DBT_DB
[0m01:18:51.497939 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:18:51.497939 [info ] [MainThread]:   role: DBT_ROLE
[0m01:18:51.497939 [info ] [MainThread]:   schema: GOLD
[0m01:18:51.497939 [info ] [MainThread]:   authenticator: None
[0m01:18:51.497939 [info ] [MainThread]:   oauth_client_id: None
[0m01:18:51.497939 [info ] [MainThread]:   query_tag: None
[0m01:18:51.497939 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:18:51.504725 [info ] [MainThread]:   host: None
[0m01:18:51.505745 [info ] [MainThread]:   port: None
[0m01:18:51.505745 [info ] [MainThread]:   proxy_host: None
[0m01:18:51.506740 [info ] [MainThread]:   proxy_port: None
[0m01:18:51.506740 [info ] [MainThread]:   protocol: None
[0m01:18:51.507740 [info ] [MainThread]:   connect_retries: 1
[0m01:18:51.507740 [info ] [MainThread]:   connect_timeout: None
[0m01:18:51.508739 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:18:51.509084 [info ] [MainThread]:   retry_all: False
[0m01:18:51.509084 [info ] [MainThread]:   insecure_mode: False
[0m01:18:51.509084 [info ] [MainThread]:   reuse_connections: True
[0m01:18:51.509084 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:18:51.837165 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:18:54.733876 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:18:54.733876 [debug] [MainThread]: On debug: select 1 as id
[0m01:18:54.733876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:56.144408 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.410 seconds
[0m01:18:56.144408 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:18:56.144408 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:18:56.144408 [debug] [MainThread]: Command `dbt debug` succeeded at 01:18:56.144408 after 5.64 seconds
[0m01:18:56.160179 [debug] [MainThread]: Connection 'debug' was left open.
[0m01:18:56.160179 [debug] [MainThread]: On debug: Close
[0m01:18:56.311986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DD50C3BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DD5F6C5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DD62F7470>]}
[0m01:18:56.311986 [debug] [MainThread]: Flushing usage events
[0m01:18:56.911091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:46.794568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812326e78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812331be330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812326e6ea0>]}


============================== 17:16:46.800165 | 592ce83a-948f-4b1f-9e3b-98aabe011c61 ==============================
[0m17:16:46.800165 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:16:46.802078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:46.825056 [info ] [MainThread]: dbt version: 1.8.8
[0m17:16:46.826112 [info ] [MainThread]: python version: 3.12.3
[0m17:16:46.827074 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:16:46.828193 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:16:47.100550 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:16:47.102829 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:16:47.104386 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:16:47.105957 [info ] [MainThread]: adapter type: snowflake
[0m17:16:47.107349 [info ] [MainThread]: adapter version: 1.8.4
[0m17:16:47.180572 [info ] [MainThread]: Configuration:
[0m17:16:47.182717 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:16:47.184623 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:16:47.186160 [info ] [MainThread]: Required dependencies:
[0m17:16:47.187511 [debug] [MainThread]: Executing "git --help"
[0m17:16:47.192673 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:16:47.194577 [debug] [MainThread]: STDERR: "b''"
[0m17:16:47.196144 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:16:47.197641 [info ] [MainThread]: Connection:
[0m17:16:47.199399 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:16:47.201011 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:16:47.202646 [info ] [MainThread]:   database: DBT_DB
[0m17:16:47.204409 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:16:47.205962 [info ] [MainThread]:   role: DBT_ROLE
[0m17:16:47.207488 [info ] [MainThread]:   schema: GOLD
[0m17:16:47.208970 [info ] [MainThread]:   authenticator: None
[0m17:16:47.210448 [info ] [MainThread]:   oauth_client_id: None
[0m17:16:47.212268 [info ] [MainThread]:   query_tag: None
[0m17:16:47.214081 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:16:47.215435 [info ] [MainThread]:   host: None
[0m17:16:47.217212 [info ] [MainThread]:   port: None
[0m17:16:47.218921 [info ] [MainThread]:   proxy_host: None
[0m17:16:47.220612 [info ] [MainThread]:   proxy_port: None
[0m17:16:47.222379 [info ] [MainThread]:   protocol: None
[0m17:16:47.223869 [info ] [MainThread]:   connect_retries: 1
[0m17:16:47.225453 [info ] [MainThread]:   connect_timeout: None
[0m17:16:47.226979 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:16:47.228473 [info ] [MainThread]:   retry_all: False
[0m17:16:47.229927 [info ] [MainThread]:   insecure_mode: False
[0m17:16:47.231596 [info ] [MainThread]:   reuse_connections: None
[0m17:16:47.233286 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:16:47.237240 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:16:47.239669 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:16:47.241370 [debug] [MainThread]: On debug: select 1 as id
[0m17:16:47.243101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:48.259440 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:16:48.263184 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:16:48.266607 [debug] [MainThread]: On debug: No close available on handle
[0m17:16:48.269626 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:16:48.272361 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:16:48.275209 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:16:48.278236 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.7403264, "process_user_time": 1.36236, "process_kernel_time": 0.192423, "process_mem_max_rss": "130092", "process_in_blocks": "14352", "process_out_blocks": "2496", "command_success": false}
[0m17:16:48.280830 [debug] [MainThread]: Command `dbt debug` failed at 17:16:48.280670 after 1.74 seconds
[0m17:16:48.283089 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:16:48.284743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78122fd31b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781231541ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781231541700>]}
[0m17:16:48.286734 [debug] [MainThread]: Flushing usage events
[0m17:16:52.499890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca1aef9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca1bfe7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca1c76be00>]}


============================== 17:16:52.503972 | d9860b4a-9037-4158-bd82-5d2be314ac20 ==============================
[0m17:16:52.503972 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:16:52.506665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:16:52.519736 [info ] [MainThread]: dbt version: 1.8.8
[0m17:16:52.521579 [info ] [MainThread]: python version: 3.12.3
[0m17:16:52.523354 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:16:52.524784 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:16:52.788159 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:16:52.790372 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:16:52.793215 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:16:52.794855 [info ] [MainThread]: adapter type: snowflake
[0m17:16:52.796367 [info ] [MainThread]: adapter version: 1.8.4
[0m17:16:52.868400 [info ] [MainThread]: Configuration:
[0m17:16:52.870974 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:16:52.873214 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:16:52.875234 [info ] [MainThread]: Required dependencies:
[0m17:16:52.877222 [debug] [MainThread]: Executing "git --help"
[0m17:16:52.880923 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:16:52.882864 [debug] [MainThread]: STDERR: "b''"
[0m17:16:52.884473 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:16:52.886208 [info ] [MainThread]: Connection:
[0m17:16:52.887978 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:16:52.889806 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:16:52.891593 [info ] [MainThread]:   database: DBT_DB
[0m17:16:52.893535 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:16:52.894706 [info ] [MainThread]:   role: DBT_ROLE
[0m17:16:52.896403 [info ] [MainThread]:   schema: GOLD
[0m17:16:52.898277 [info ] [MainThread]:   authenticator: None
[0m17:16:52.899821 [info ] [MainThread]:   oauth_client_id: None
[0m17:16:52.901545 [info ] [MainThread]:   query_tag: None
[0m17:16:52.903150 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:16:52.904666 [info ] [MainThread]:   host: None
[0m17:16:52.906514 [info ] [MainThread]:   port: None
[0m17:16:52.908175 [info ] [MainThread]:   proxy_host: None
[0m17:16:52.909860 [info ] [MainThread]:   proxy_port: None
[0m17:16:52.911728 [info ] [MainThread]:   protocol: None
[0m17:16:52.913368 [info ] [MainThread]:   connect_retries: 1
[0m17:16:52.915183 [info ] [MainThread]:   connect_timeout: None
[0m17:16:52.916732 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:16:52.918567 [info ] [MainThread]:   retry_all: False
[0m17:16:52.919757 [info ] [MainThread]:   insecure_mode: False
[0m17:16:52.921811 [info ] [MainThread]:   reuse_connections: None
[0m17:16:52.924028 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:16:52.927469 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:16:52.932322 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:16:52.934593 [debug] [MainThread]: On debug: select 1 as id
[0m17:16:52.936320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:53.443294 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:16:53.445160 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:16:53.446418 [debug] [MainThread]: On debug: No close available on handle
[0m17:16:53.447597 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:16:53.449195 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:16:53.451033 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:16:53.453614 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.0999893, "process_user_time": 1.330337, "process_kernel_time": 0.176593, "process_mem_max_rss": "128112", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:16:53.455364 [debug] [MainThread]: Command `dbt debug` failed at 17:16:53.455265 after 1.10 seconds
[0m17:16:53.456595 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:16:53.458374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca1ba44b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca1be944a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca19660ce0>]}
[0m17:16:53.460427 [debug] [MainThread]: Flushing usage events
[0m17:17:56.149246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7705b34c70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7705b23f89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7705b5262840>]}


============================== 17:17:56.153320 | 4c37b930-3780-41fb-8b55-3cefd92bffb4 ==============================
[0m17:17:56.153320 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:17:56.154994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'send_anonymous_usage_stats': 'True'}
[0m17:17:56.167327 [info ] [MainThread]: dbt version: 1.8.8
[0m17:17:56.169244 [info ] [MainThread]: python version: 3.12.3
[0m17:17:56.170680 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:17:56.171715 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:17:56.392854 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:17:56.395905 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:17:56.397616 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:17:56.399468 [info ] [MainThread]: adapter type: snowflake
[0m17:17:56.401455 [info ] [MainThread]: adapter version: 1.8.4
[0m17:17:56.470537 [info ] [MainThread]: Configuration:
[0m17:17:56.473086 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:17:56.475223 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:17:56.477220 [info ] [MainThread]: Required dependencies:
[0m17:17:56.478947 [debug] [MainThread]: Executing "git --help"
[0m17:17:56.482596 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:17:56.484001 [debug] [MainThread]: STDERR: "b''"
[0m17:17:56.485137 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:17:56.486033 [info ] [MainThread]: Connection:
[0m17:17:56.486703 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:17:56.487405 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:17:56.488057 [info ] [MainThread]:   database: DBT_DB
[0m17:17:56.488685 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:17:56.489314 [info ] [MainThread]:   role: DBT_ROLE
[0m17:17:56.489916 [info ] [MainThread]:   schema: GOLD
[0m17:17:56.490527 [info ] [MainThread]:   authenticator: None
[0m17:17:56.491177 [info ] [MainThread]:   oauth_client_id: None
[0m17:17:56.491953 [info ] [MainThread]:   query_tag: None
[0m17:17:56.492583 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:17:56.493199 [info ] [MainThread]:   host: None
[0m17:17:56.493838 [info ] [MainThread]:   port: None
[0m17:17:56.494459 [info ] [MainThread]:   proxy_host: None
[0m17:17:56.495094 [info ] [MainThread]:   proxy_port: None
[0m17:17:56.496193 [info ] [MainThread]:   protocol: None
[0m17:17:56.497070 [info ] [MainThread]:   connect_retries: 1
[0m17:17:56.498577 [info ] [MainThread]:   connect_timeout: None
[0m17:17:56.500182 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:17:56.502119 [info ] [MainThread]:   retry_all: False
[0m17:17:56.503696 [info ] [MainThread]:   insecure_mode: False
[0m17:17:56.506556 [info ] [MainThread]:   reuse_connections: None
[0m17:17:56.509670 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:17:56.514744 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:17:56.516238 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:17:56.518695 [debug] [MainThread]: On debug: select 1 as id
[0m17:17:56.520851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:57.084556 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:17:57.087356 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:17:57.092718 [debug] [MainThread]: On debug: No close available on handle
[0m17:17:57.095508 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:17:57.097162 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:17:57.098864 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:17:57.100980 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.0919411, "process_user_time": 1.169045, "process_kernel_time": 0.195616, "process_mem_max_rss": "128244", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:17:57.103439 [debug] [MainThread]: Command `dbt debug` failed at 17:17:57.103270 after 1.09 seconds
[0m17:17:57.105773 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:17:57.107581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7705b0082ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7705b00075f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7705afee78f0>]}
[0m17:17:57.109216 [debug] [MainThread]: Flushing usage events
[0m17:18:01.182408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7799fbfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7799f01970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7799f01b20>]}


============================== 17:18:01.186440 | df0f703f-edbd-4664-abe1-e80ecbae51f0 ==============================
[0m17:18:01.186440 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:18:01.188450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:18:01.199307 [info ] [MainThread]: dbt version: 1.8.8
[0m17:18:01.201160 [info ] [MainThread]: python version: 3.12.3
[0m17:18:01.202447 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:18:01.204132 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:18:01.425805 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:18:01.428326 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:18:01.430364 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:18:01.432551 [info ] [MainThread]: adapter type: snowflake
[0m17:18:01.434538 [info ] [MainThread]: adapter version: 1.8.4
[0m17:18:01.513798 [info ] [MainThread]: Configuration:
[0m17:18:01.515959 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:18:01.517974 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:18:01.519945 [info ] [MainThread]: Required dependencies:
[0m17:18:01.521602 [debug] [MainThread]: Executing "git --help"
[0m17:18:01.524927 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:18:01.526582 [debug] [MainThread]: STDERR: "b''"
[0m17:18:01.527860 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:18:01.529350 [info ] [MainThread]: Connection:
[0m17:18:01.531146 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:18:01.532294 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:18:01.533411 [info ] [MainThread]:   database: DBT_DB
[0m17:18:01.535145 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:18:01.536376 [info ] [MainThread]:   role: DBT_ROLE
[0m17:18:01.537692 [info ] [MainThread]:   schema: GOLD
[0m17:18:01.539325 [info ] [MainThread]:   authenticator: None
[0m17:18:01.541009 [info ] [MainThread]:   oauth_client_id: None
[0m17:18:01.542646 [info ] [MainThread]:   query_tag: None
[0m17:18:01.544506 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:18:01.545677 [info ] [MainThread]:   host: None
[0m17:18:01.546848 [info ] [MainThread]:   port: None
[0m17:18:01.547887 [info ] [MainThread]:   proxy_host: None
[0m17:18:01.549139 [info ] [MainThread]:   proxy_port: None
[0m17:18:01.550757 [info ] [MainThread]:   protocol: None
[0m17:18:01.551897 [info ] [MainThread]:   connect_retries: 1
[0m17:18:01.553106 [info ] [MainThread]:   connect_timeout: None
[0m17:18:01.554796 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:18:01.556084 [info ] [MainThread]:   retry_all: False
[0m17:18:01.557499 [info ] [MainThread]:   insecure_mode: False
[0m17:18:01.558784 [info ] [MainThread]:   reuse_connections: None
[0m17:18:01.560314 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:18:01.562919 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:18:01.564584 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:18:01.566251 [debug] [MainThread]: On debug: select 1 as id
[0m17:18:01.568576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:02.110710 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:18:02.113087 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:18:02.115326 [debug] [MainThread]: On debug: No close available on handle
[0m17:18:02.117444 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:18:02.119170 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:18:02.120924 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:18:02.124384 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.0633883, "process_user_time": 1.219065, "process_kernel_time": 0.144106, "process_mem_max_rss": "128588", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:18:02.126619 [debug] [MainThread]: Command `dbt debug` failed at 17:18:02.126394 after 1.07 seconds
[0m17:18:02.128862 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:18:02.131157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7799fbfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a779a2595b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7799ee8b00>]}
[0m17:18:02.133540 [debug] [MainThread]: Flushing usage events
[0m17:23:01.794774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7328dcf5dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7328dd04fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7328dda18320>]}


============================== 17:23:01.799173 | 5b13c30d-5c11-4c96-9ce8-bb35a4d142fe ==============================
[0m17:23:01.799173 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:23:01.801851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'send_anonymous_usage_stats': 'True'}
[0m17:23:01.818237 [info ] [MainThread]: dbt version: 1.8.8
[0m17:23:01.821175 [info ] [MainThread]: python version: 3.12.3
[0m17:23:01.822939 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:23:01.824281 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:23:02.096276 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:23:02.098156 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:23:02.099548 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:23:02.101404 [info ] [MainThread]: adapter type: snowflake
[0m17:23:02.102786 [info ] [MainThread]: adapter version: 1.8.4
[0m17:23:02.186554 [info ] [MainThread]: Configuration:
[0m17:23:02.188902 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:23:02.191060 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:23:02.193148 [info ] [MainThread]: Required dependencies:
[0m17:23:02.194739 [debug] [MainThread]: Executing "git --help"
[0m17:23:02.198652 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:23:02.200795 [debug] [MainThread]: STDERR: "b''"
[0m17:23:02.202761 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:23:02.204853 [info ] [MainThread]: Connection:
[0m17:23:02.206936 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:23:02.208644 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:23:02.210380 [info ] [MainThread]:   database: DBT_DB
[0m17:23:02.212034 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:23:02.213329 [info ] [MainThread]:   role: DBT_ROLE
[0m17:23:02.215173 [info ] [MainThread]:   schema: GOLD
[0m17:23:02.216492 [info ] [MainThread]:   authenticator: None
[0m17:23:02.217863 [info ] [MainThread]:   oauth_client_id: None
[0m17:23:02.219308 [info ] [MainThread]:   query_tag: None
[0m17:23:02.221024 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:23:02.222846 [info ] [MainThread]:   host: None
[0m17:23:02.224455 [info ] [MainThread]:   port: None
[0m17:23:02.225818 [info ] [MainThread]:   proxy_host: None
[0m17:23:02.227075 [info ] [MainThread]:   proxy_port: None
[0m17:23:02.228144 [info ] [MainThread]:   protocol: None
[0m17:23:02.229278 [info ] [MainThread]:   connect_retries: 1
[0m17:23:02.230847 [info ] [MainThread]:   connect_timeout: None
[0m17:23:02.232440 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:23:02.233701 [info ] [MainThread]:   retry_all: False
[0m17:23:02.235127 [info ] [MainThread]:   insecure_mode: False
[0m17:23:02.236134 [info ] [MainThread]:   reuse_connections: None
[0m17:23:02.237521 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:23:02.240647 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:23:02.243113 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:23:02.245003 [debug] [MainThread]: On debug: select 1 as id
[0m17:23:02.246917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:02.752157 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:23:02.755326 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:23:02.757780 [debug] [MainThread]: On debug: No close available on handle
[0m17:23:02.760781 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:23:02.763815 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:23:02.766647 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:23:02.769652 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.1441945, "process_user_time": 1.347262, "process_kernel_time": 0.197545, "process_mem_max_rss": "128656", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:23:02.772346 [debug] [MainThread]: Command `dbt debug` failed at 17:23:02.772161 after 1.15 seconds
[0m17:23:02.774689 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:23:02.776697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7328dd04fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7328dba317f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7328dea768d0>]}
[0m17:23:02.779036 [debug] [MainThread]: Flushing usage events
[0m17:23:07.297622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256224e9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256223d7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725621d96a20>]}


============================== 17:23:07.303558 | adc5ae45-cea9-4ca3-86d8-3838fb70b4a2 ==============================
[0m17:23:07.303558 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:23:07.305604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'version_check': 'True', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:23:07.316513 [info ] [MainThread]: dbt version: 1.8.8
[0m17:23:07.318694 [info ] [MainThread]: python version: 3.12.3
[0m17:23:07.320644 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:23:07.322183 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:23:07.570644 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:23:07.573210 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:23:07.575430 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:23:07.579149 [info ] [MainThread]: adapter type: snowflake
[0m17:23:07.581382 [info ] [MainThread]: adapter version: 1.8.4
[0m17:23:07.668124 [info ] [MainThread]: Configuration:
[0m17:23:07.670201 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:23:07.671987 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:23:07.673279 [info ] [MainThread]: Required dependencies:
[0m17:23:07.674517 [debug] [MainThread]: Executing "git --help"
[0m17:23:07.677244 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:23:07.679561 [debug] [MainThread]: STDERR: "b''"
[0m17:23:07.681700 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:23:07.683657 [info ] [MainThread]: Connection:
[0m17:23:07.685528 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:23:07.687023 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:23:07.688436 [info ] [MainThread]:   database: DBT_DB
[0m17:23:07.690092 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:23:07.691467 [info ] [MainThread]:   role: DBT_ROLE
[0m17:23:07.692968 [info ] [MainThread]:   schema: GOLD
[0m17:23:07.694601 [info ] [MainThread]:   authenticator: None
[0m17:23:07.697538 [info ] [MainThread]:   oauth_client_id: None
[0m17:23:07.699757 [info ] [MainThread]:   query_tag: None
[0m17:23:07.701381 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:23:07.703231 [info ] [MainThread]:   host: None
[0m17:23:07.705071 [info ] [MainThread]:   port: None
[0m17:23:07.706738 [info ] [MainThread]:   proxy_host: None
[0m17:23:07.708420 [info ] [MainThread]:   proxy_port: None
[0m17:23:07.710278 [info ] [MainThread]:   protocol: None
[0m17:23:07.712778 [info ] [MainThread]:   connect_retries: 1
[0m17:23:07.716136 [info ] [MainThread]:   connect_timeout: None
[0m17:23:07.718598 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:23:07.721210 [info ] [MainThread]:   retry_all: False
[0m17:23:07.723356 [info ] [MainThread]:   insecure_mode: False
[0m17:23:07.725569 [info ] [MainThread]:   reuse_connections: None
[0m17:23:07.727656 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:23:07.732688 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:23:07.735927 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:23:07.738101 [debug] [MainThread]: On debug: select 1 as id
[0m17:23:07.740204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:08.101880 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:23:08.104837 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:23:08.107886 [debug] [MainThread]: On debug: No close available on handle
[0m17:23:08.110110 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:23:08.111291 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:23:08.113941 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:23:08.116000 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.9659959, "process_user_time": 1.378157, "process_kernel_time": 0.170334, "process_mem_max_rss": "128624", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:23:08.118891 [debug] [MainThread]: Command `dbt debug` failed at 17:23:08.118729 after 0.97 seconds
[0m17:23:08.121942 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:23:08.122921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725621d3f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256214286b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725621e34d10>]}
[0m17:23:08.124842 [debug] [MainThread]: Flushing usage events
[0m17:24:57.788254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ae61230e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ae50bb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ae7b99d60>]}


============================== 17:24:57.793481 | 45ef391c-78b6-4a3a-9ccf-ea51770d8adb ==============================
[0m17:24:57.793481 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:24:57.795613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:57.808127 [info ] [MainThread]: dbt version: 1.8.8
[0m17:24:57.809921 [info ] [MainThread]: python version: 3.12.3
[0m17:24:57.811490 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:24:57.813009 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:24:58.087706 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:24:58.089327 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:24:58.090992 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:24:58.092559 [info ] [MainThread]: adapter type: snowflake
[0m17:24:58.094865 [info ] [MainThread]: adapter version: 1.8.4
[0m17:24:58.179938 [info ] [MainThread]: Configuration:
[0m17:24:58.182524 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:24:58.184888 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:24:58.186678 [info ] [MainThread]: Required dependencies:
[0m17:24:58.188519 [debug] [MainThread]: Executing "git --help"
[0m17:24:58.192964 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:24:58.194961 [debug] [MainThread]: STDERR: "b''"
[0m17:24:58.196523 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:24:58.198952 [info ] [MainThread]: Connection:
[0m17:24:58.201348 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:24:58.203490 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:24:58.206047 [info ] [MainThread]:   database: DBT_DB
[0m17:24:58.207965 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:24:58.209761 [info ] [MainThread]:   role: DBT_ROLE
[0m17:24:58.211931 [info ] [MainThread]:   schema: GOLD
[0m17:24:58.213566 [info ] [MainThread]:   authenticator: None
[0m17:24:58.215315 [info ] [MainThread]:   oauth_client_id: None
[0m17:24:58.216727 [info ] [MainThread]:   query_tag: None
[0m17:24:58.219746 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:24:58.221695 [info ] [MainThread]:   host: None
[0m17:24:58.223313 [info ] [MainThread]:   port: None
[0m17:24:58.225730 [info ] [MainThread]:   proxy_host: None
[0m17:24:58.227389 [info ] [MainThread]:   proxy_port: None
[0m17:24:58.228695 [info ] [MainThread]:   protocol: None
[0m17:24:58.230329 [info ] [MainThread]:   connect_retries: 1
[0m17:24:58.232971 [info ] [MainThread]:   connect_timeout: None
[0m17:24:58.235187 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:24:58.237162 [info ] [MainThread]:   retry_all: False
[0m17:24:58.239445 [info ] [MainThread]:   insecure_mode: False
[0m17:24:58.241107 [info ] [MainThread]:   reuse_connections: None
[0m17:24:58.243036 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:24:58.247007 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:24:58.255324 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:24:58.257155 [debug] [MainThread]: On debug: select 1 as id
[0m17:24:58.258281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:57.662718 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:24:57.666389 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:24:57.670878 [debug] [MainThread]: On debug: No close available on handle
[0m17:24:57.674292 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:24:57.679242 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:24:57.683310 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:24:57.688762 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.067099, "process_user_time": 1.386867, "process_kernel_time": 0.167986, "process_mem_max_rss": "128704", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:24:57.692543 [debug] [MainThread]: Command `dbt debug` failed at 17:24:57.691899 after 1.07 seconds
[0m17:24:57.695702 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:24:57.698485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ae61230e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ae266dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ae4f16f00>]}
[0m17:24:57.701417 [debug] [MainThread]: Flushing usage events
[0m17:28:06.627947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73132d29d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73132c95ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73132d0eb200>]}


============================== 17:28:06.632444 | d24fb021-531a-48dd-b7ad-b9fcba65c290 ==============================
[0m17:28:06.632444 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:28:06.634374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:28:06.647576 [info ] [MainThread]: dbt version: 1.8.8
[0m17:28:06.649684 [info ] [MainThread]: python version: 3.12.3
[0m17:28:06.651891 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:28:06.653487 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:28:06.911514 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:28:06.913218 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:28:06.914716 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:28:06.917133 [info ] [MainThread]: adapter type: snowflake
[0m17:28:06.918455 [info ] [MainThread]: adapter version: 1.8.4
[0m17:28:07.000772 [info ] [MainThread]: Configuration:
[0m17:28:07.002486 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:28:07.003647 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:28:07.005447 [info ] [MainThread]: Required dependencies:
[0m17:28:07.007259 [debug] [MainThread]: Executing "git --help"
[0m17:28:07.010967 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:28:07.013532 [debug] [MainThread]: STDERR: "b''"
[0m17:28:07.015417 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:28:07.017818 [info ] [MainThread]: Connection:
[0m17:28:07.020681 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:28:07.022729 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:28:07.024642 [info ] [MainThread]:   database: DBT_DB
[0m17:28:07.026792 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:28:07.028619 [info ] [MainThread]:   role: DBT_ROLE
[0m17:28:07.029974 [info ] [MainThread]:   schema: GOLD
[0m17:28:07.031572 [info ] [MainThread]:   authenticator: None
[0m17:28:07.032982 [info ] [MainThread]:   oauth_client_id: None
[0m17:28:07.034393 [info ] [MainThread]:   query_tag: None
[0m17:28:07.036509 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:28:07.037733 [info ] [MainThread]:   host: None
[0m17:28:07.039936 [info ] [MainThread]:   port: None
[0m17:28:07.041937 [info ] [MainThread]:   proxy_host: None
[0m17:28:07.043452 [info ] [MainThread]:   proxy_port: None
[0m17:28:07.044858 [info ] [MainThread]:   protocol: None
[0m17:28:07.046688 [info ] [MainThread]:   connect_retries: 1
[0m17:28:07.048695 [info ] [MainThread]:   connect_timeout: None
[0m17:28:07.049919 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:28:07.051574 [info ] [MainThread]:   retry_all: False
[0m17:28:07.053706 [info ] [MainThread]:   insecure_mode: False
[0m17:28:07.055580 [info ] [MainThread]:   reuse_connections: None
[0m17:28:07.057340 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:28:07.060738 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:28:07.064267 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:28:07.066587 [debug] [MainThread]: On debug: select 1 as id
[0m17:28:07.069166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:07.506051 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:28:07.511043 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:28:07.514529 [debug] [MainThread]: On debug: No close available on handle
[0m17:28:07.518090 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:28:07.520455 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:28:07.522489 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:28:07.524775 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.0366989, "process_user_time": 1.35614, "process_kernel_time": 0.168254, "process_mem_max_rss": "128836", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:28:07.526619 [debug] [MainThread]: Command `dbt debug` failed at 17:28:07.526462 after 1.04 seconds
[0m17:28:07.528398 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:28:07.531393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73132d6d9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73132e21aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73132d987b60>]}
[0m17:28:07.532736 [debug] [MainThread]: Flushing usage events
[0m17:30:02.127755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada42afda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada42ae570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada39eb1a0>]}


============================== 17:30:02.132985 | 85ec5965-4fce-4643-809a-3bcba8b2d234 ==============================
[0m17:30:02.132985 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:30:02.134639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:30:02.147500 [info ] [MainThread]: dbt version: 1.8.8
[0m17:30:02.149094 [info ] [MainThread]: python version: 3.12.3
[0m17:30:02.150625 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:30:02.152020 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:30:02.389320 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:30:02.392203 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:30:02.394735 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:30:02.397192 [info ] [MainThread]: adapter type: snowflake
[0m17:30:02.398705 [info ] [MainThread]: adapter version: 1.8.4
[0m17:30:02.479106 [info ] [MainThread]: Configuration:
[0m17:30:02.481693 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:30:02.483770 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:30:02.485501 [info ] [MainThread]: Required dependencies:
[0m17:30:02.487336 [debug] [MainThread]: Executing "git --help"
[0m17:30:02.490641 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:30:02.492298 [debug] [MainThread]: STDERR: "b''"
[0m17:30:02.493722 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:30:02.495408 [info ] [MainThread]: Connection:
[0m17:30:02.496943 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:30:02.498584 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:30:02.500070 [info ] [MainThread]:   database: DBT_DB
[0m17:30:02.502090 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:30:02.503674 [info ] [MainThread]:   role: DBT_ROLE
[0m17:30:02.504902 [info ] [MainThread]:   schema: GOLD
[0m17:30:02.506515 [info ] [MainThread]:   authenticator: None
[0m17:30:02.507842 [info ] [MainThread]:   oauth_client_id: None
[0m17:30:02.509129 [info ] [MainThread]:   query_tag: None
[0m17:30:02.510409 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:30:02.511868 [info ] [MainThread]:   host: None
[0m17:30:02.513600 [info ] [MainThread]:   port: None
[0m17:30:02.515290 [info ] [MainThread]:   proxy_host: None
[0m17:30:02.516983 [info ] [MainThread]:   proxy_port: None
[0m17:30:02.518854 [info ] [MainThread]:   protocol: None
[0m17:30:02.521082 [info ] [MainThread]:   connect_retries: 1
[0m17:30:02.522623 [info ] [MainThread]:   connect_timeout: None
[0m17:30:02.523975 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:30:02.525215 [info ] [MainThread]:   retry_all: False
[0m17:30:02.526843 [info ] [MainThread]:   insecure_mode: False
[0m17:30:02.527868 [info ] [MainThread]:   reuse_connections: None
[0m17:30:02.528911 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:30:02.531433 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:30:02.534019 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:30:02.537339 [debug] [MainThread]: On debug: select 1 as id
[0m17:30:02.541108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:02.900427 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:30:02.903467 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:30:02.906217 [debug] [MainThread]: On debug: No close available on handle
[0m17:30:02.908162 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:30:02.910100 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:30:02.911619 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:30:02.913420 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.9514681, "process_user_time": 1.263341, "process_kernel_time": 0.168184, "process_mem_max_rss": "128272", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:30:02.915358 [debug] [MainThread]: Command `dbt debug` failed at 17:30:02.915217 after 0.95 seconds
[0m17:30:02.916992 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:30:02.918890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada439fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada324ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada2106f30>]}
[0m17:30:02.921597 [debug] [MainThread]: Flushing usage events
[0m17:33:11.146204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64c3b6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64c3b6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64e7e2270>]}


============================== 17:33:11.150037 | f3c6e57f-bcdb-4a00-b8e0-71b30668389a ==============================
[0m17:33:11.150037 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:33:11.151312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:33:11.161870 [info ] [MainThread]: dbt version: 1.8.8
[0m17:33:11.163125 [info ] [MainThread]: python version: 3.12.3
[0m17:33:11.164303 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:33:11.165278 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:33:11.393275 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:33:11.395400 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:33:11.397527 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:33:11.399261 [info ] [MainThread]: adapter type: snowflake
[0m17:33:11.400670 [info ] [MainThread]: adapter version: 1.8.4
[0m17:33:11.470605 [info ] [MainThread]: Configuration:
[0m17:33:11.472785 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:33:11.474537 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:33:11.476132 [info ] [MainThread]: Required dependencies:
[0m17:33:11.478288 [debug] [MainThread]: Executing "git --help"
[0m17:33:11.482195 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:33:11.484412 [debug] [MainThread]: STDERR: "b''"
[0m17:33:11.486292 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:33:11.488276 [info ] [MainThread]: Connection:
[0m17:33:11.490248 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:33:11.492265 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:33:11.493792 [info ] [MainThread]:   database: DBT_DB
[0m17:33:11.494734 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:33:11.495693 [info ] [MainThread]:   role: DBT_ROLE
[0m17:33:11.496863 [info ] [MainThread]:   schema: GOLD
[0m17:33:11.497792 [info ] [MainThread]:   authenticator: None
[0m17:33:11.499116 [info ] [MainThread]:   oauth_client_id: None
[0m17:33:11.501423 [info ] [MainThread]:   query_tag: None
[0m17:33:11.503072 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:33:11.504190 [info ] [MainThread]:   host: None
[0m17:33:11.505756 [info ] [MainThread]:   port: None
[0m17:33:11.507590 [info ] [MainThread]:   proxy_host: None
[0m17:33:11.509758 [info ] [MainThread]:   proxy_port: None
[0m17:33:11.511583 [info ] [MainThread]:   protocol: None
[0m17:33:11.513061 [info ] [MainThread]:   connect_retries: 1
[0m17:33:11.514758 [info ] [MainThread]:   connect_timeout: None
[0m17:33:11.516493 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:33:11.517986 [info ] [MainThread]:   retry_all: False
[0m17:33:11.519684 [info ] [MainThread]:   insecure_mode: False
[0m17:33:11.521425 [info ] [MainThread]:   reuse_connections: None
[0m17:33:11.523171 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:33:11.526426 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:33:11.529631 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:33:11.532268 [debug] [MainThread]: On debug: select 1 as id
[0m17:33:11.534461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:11.919639 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:33:11.921744 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:33:11.923860 [debug] [MainThread]: On debug: No close available on handle
[0m17:33:11.925270 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:33:11.926572 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:33:11.927829 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Your user account has been temporarily locked. Try again later or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:33:11.929667 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.91510934, "process_user_time": 1.196315, "process_kernel_time": 0.159249, "process_mem_max_rss": "128464", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:33:11.931469 [debug] [MainThread]: Command `dbt debug` failed at 17:33:11.931344 after 0.92 seconds
[0m17:33:11.932678 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:33:11.933961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64c7932c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64bde1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64aaaa570>]}
[0m17:33:11.935458 [debug] [MainThread]: Flushing usage events
[0m17:46:34.404585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cad45d03a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cad469b3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cad4675e9c0>]}


============================== 17:46:34.408735 | d2003a2c-8237-4d06-8386-f27c91d3e38c ==============================
[0m17:46:34.408735 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:46:34.410870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:46:34.422870 [info ] [MainThread]: dbt version: 1.8.8
[0m17:46:34.425004 [info ] [MainThread]: python version: 3.12.3
[0m17:46:34.427005 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m17:46:34.428866 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m17:46:34.685819 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m17:46:34.687925 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m17:46:34.690030 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m17:46:34.692274 [info ] [MainThread]: adapter type: snowflake
[0m17:46:34.694387 [info ] [MainThread]: adapter version: 1.8.4
[0m17:46:34.770785 [info ] [MainThread]: Configuration:
[0m17:46:34.772922 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:46:34.775252 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:46:34.777153 [info ] [MainThread]: Required dependencies:
[0m17:46:34.779277 [debug] [MainThread]: Executing "git --help"
[0m17:46:34.783028 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:46:34.785361 [debug] [MainThread]: STDERR: "b''"
[0m17:46:34.786778 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:46:34.788509 [info ] [MainThread]: Connection:
[0m17:46:34.789758 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m17:46:34.790884 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m17:46:34.792151 [info ] [MainThread]:   database: DBT_DB
[0m17:46:34.793507 [info ] [MainThread]:   warehouse: DBT_WH
[0m17:46:34.795180 [info ] [MainThread]:   role: DBT_ROLE
[0m17:46:34.796916 [info ] [MainThread]:   schema: GOLD
[0m17:46:34.798438 [info ] [MainThread]:   authenticator: None
[0m17:46:34.799910 [info ] [MainThread]:   oauth_client_id: None
[0m17:46:34.801493 [info ] [MainThread]:   query_tag: None
[0m17:46:34.803524 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:46:34.804926 [info ] [MainThread]:   host: None
[0m17:46:34.806756 [info ] [MainThread]:   port: None
[0m17:46:34.808585 [info ] [MainThread]:   proxy_host: None
[0m17:46:34.810042 [info ] [MainThread]:   proxy_port: None
[0m17:46:34.811385 [info ] [MainThread]:   protocol: None
[0m17:46:34.812798 [info ] [MainThread]:   connect_retries: 1
[0m17:46:34.814326 [info ] [MainThread]:   connect_timeout: None
[0m17:46:34.815991 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:46:34.817852 [info ] [MainThread]:   retry_all: False
[0m17:46:34.819680 [info ] [MainThread]:   insecure_mode: False
[0m17:46:34.821351 [info ] [MainThread]:   reuse_connections: None
[0m17:46:34.823320 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:46:34.826077 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:46:34.828248 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:46:34.830188 [debug] [MainThread]: On debug: select 1 as id
[0m17:46:34.832216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:35.324378 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:46:35.327959 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:46:35.331024 [debug] [MainThread]: On debug: No close available on handle
[0m17:46:35.333917 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:46:35.336498 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:46:35.338382 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:46:35.342165 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.0795155, "process_user_time": 1.547676, "process_kernel_time": 0.217763, "process_mem_max_rss": "128544", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:46:35.343787 [debug] [MainThread]: Command `dbt debug` failed at 17:46:35.343576 after 1.08 seconds
[0m17:46:35.346085 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:46:35.348177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cad45d03a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cad4328fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cad45ac3fb0>]}
[0m17:46:35.350891 [debug] [MainThread]: Flushing usage events
[0m01:03:19.975165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a76d6e9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a76e60be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a76d6e9b80>]}


============================== 01:03:19.981071 | 1e36bbdf-7c08-4cf5-a790-b1b5e841436c ==============================
[0m01:03:19.981071 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:03:19.982468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:03:19.996617 [info ] [MainThread]: dbt version: 1.8.8
[0m01:03:19.998172 [info ] [MainThread]: python version: 3.12.3
[0m01:03:19.999299 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m01:03:20.000618 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m01:03:20.382377 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m01:03:20.385003 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m01:03:20.387510 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m01:03:20.389555 [info ] [MainThread]: adapter type: snowflake
[0m01:03:20.391757 [info ] [MainThread]: adapter version: 1.8.4
[0m01:03:20.472469 [info ] [MainThread]: Configuration:
[0m01:03:20.475406 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:03:20.477249 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:03:20.478528 [info ] [MainThread]: Required dependencies:
[0m01:03:20.480151 [debug] [MainThread]: Executing "git --help"
[0m01:03:20.496146 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:03:20.497991 [debug] [MainThread]: STDERR: "b''"
[0m01:03:20.499525 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:03:20.501675 [info ] [MainThread]: Connection:
[0m01:03:20.503298 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:03:20.504786 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:03:20.506879 [info ] [MainThread]:   database: DBT_DB
[0m01:03:20.509316 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:03:20.511170 [info ] [MainThread]:   role: DBT_ROLE
[0m01:03:20.512917 [info ] [MainThread]:   schema: GOLD
[0m01:03:20.514053 [info ] [MainThread]:   authenticator: None
[0m01:03:20.516114 [info ] [MainThread]:   oauth_client_id: None
[0m01:03:20.517334 [info ] [MainThread]:   query_tag: None
[0m01:03:20.518405 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:03:20.519399 [info ] [MainThread]:   host: None
[0m01:03:20.520455 [info ] [MainThread]:   port: None
[0m01:03:20.521513 [info ] [MainThread]:   proxy_host: None
[0m01:03:20.523646 [info ] [MainThread]:   proxy_port: None
[0m01:03:20.525414 [info ] [MainThread]:   protocol: None
[0m01:03:20.527207 [info ] [MainThread]:   connect_retries: 1
[0m01:03:20.528362 [info ] [MainThread]:   connect_timeout: None
[0m01:03:20.529723 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:03:20.530860 [info ] [MainThread]:   retry_all: False
[0m01:03:20.531904 [info ] [MainThread]:   insecure_mode: False
[0m01:03:20.532925 [info ] [MainThread]:   reuse_connections: None
[0m01:03:20.534088 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:03:20.537831 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:03:20.539944 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:03:20.541732 [debug] [MainThread]: On debug: select 1 as id
[0m01:03:20.543626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:03:21.113895 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m01:03:21.116324 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m01:03:21.117679 [debug] [MainThread]: On debug: No close available on handle
[0m01:03:21.118863 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:03:21.120107 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:03:21.121284 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:03:21.123344 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.3683655, "process_user_time": 1.344078, "process_kernel_time": 0.301654, "process_mem_max_rss": "128328", "process_in_blocks": "49336", "process_out_blocks": "16", "command_success": false}
[0m01:03:21.124422 [debug] [MainThread]: Command `dbt debug` failed at 01:03:21.124307 after 1.37 seconds
[0m01:03:21.125799 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:03:21.126925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a76bb2ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a76da5f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a76da5c920>]}
[0m01:03:21.128056 [debug] [MainThread]: Flushing usage events
[0m01:03:25.715611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4f56eceba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4f5605bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4f56f68dd0>]}


============================== 01:03:25.719282 | d9cdfbe5-71eb-4b93-836f-09f5116452d3 ==============================
[0m01:03:25.719282 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:03:25.720572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:03:25.730939 [info ] [MainThread]: dbt version: 1.8.8
[0m01:03:25.732626 [info ] [MainThread]: python version: 3.12.3
[0m01:03:25.734240 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m01:03:25.735888 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m01:03:25.992689 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m01:03:25.995429 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m01:03:25.997538 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m01:03:26.000067 [info ] [MainThread]: adapter type: snowflake
[0m01:03:26.002111 [info ] [MainThread]: adapter version: 1.8.4
[0m01:03:26.079816 [info ] [MainThread]: Configuration:
[0m01:03:26.081996 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:03:26.084006 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:03:26.086142 [info ] [MainThread]: Required dependencies:
[0m01:03:26.087828 [debug] [MainThread]: Executing "git --help"
[0m01:03:26.091360 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:03:26.093393 [debug] [MainThread]: STDERR: "b''"
[0m01:03:26.095017 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:03:26.096810 [info ] [MainThread]: Connection:
[0m01:03:26.098554 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:03:26.100276 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:03:26.102965 [info ] [MainThread]:   database: DBT_DB
[0m01:03:26.104904 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:03:26.106801 [info ] [MainThread]:   role: DBT_ROLE
[0m01:03:26.108517 [info ] [MainThread]:   schema: GOLD
[0m01:03:26.110367 [info ] [MainThread]:   authenticator: None
[0m01:03:26.112144 [info ] [MainThread]:   oauth_client_id: None
[0m01:03:26.114151 [info ] [MainThread]:   query_tag: None
[0m01:03:26.115803 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:03:26.117630 [info ] [MainThread]:   host: None
[0m01:03:26.121224 [info ] [MainThread]:   port: None
[0m01:03:26.123183 [info ] [MainThread]:   proxy_host: None
[0m01:03:26.124766 [info ] [MainThread]:   proxy_port: None
[0m01:03:26.126434 [info ] [MainThread]:   protocol: None
[0m01:03:26.127616 [info ] [MainThread]:   connect_retries: 1
[0m01:03:26.129358 [info ] [MainThread]:   connect_timeout: None
[0m01:03:26.131061 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:03:26.132713 [info ] [MainThread]:   retry_all: False
[0m01:03:26.134240 [info ] [MainThread]:   insecure_mode: False
[0m01:03:26.136569 [info ] [MainThread]:   reuse_connections: None
[0m01:03:26.139764 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:03:26.144866 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:03:26.149102 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:03:26.151964 [debug] [MainThread]: On debug: select 1 as id
[0m01:03:26.155921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:03:26.714847 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m01:03:26.718866 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m01:03:26.722831 [debug] [MainThread]: On debug: No close available on handle
[0m01:03:26.726246 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:03:26.728800 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:03:26.731219 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:03:26.733378 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.1484091, "process_user_time": 1.335734, "process_kernel_time": 0.22238, "process_mem_max_rss": "128452", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:03:26.735059 [debug] [MainThread]: Command `dbt debug` failed at 01:03:26.734915 after 1.15 seconds
[0m01:03:26.737171 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:03:26.739470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4f54fdb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4f5356e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4f5621e000>]}
[0m01:03:26.741476 [debug] [MainThread]: Flushing usage events
[0m01:08:24.580203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a122ee069f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a122dacade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a122f7eab70>]}


============================== 01:08:24.585385 | 10024286-797b-4d74-b162-2c64dfe3f023 ==============================
[0m01:08:24.585385 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:08:24.587579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:08:24.603963 [info ] [MainThread]: dbt version: 1.8.8
[0m01:08:24.607042 [info ] [MainThread]: python version: 3.12.3
[0m01:08:24.609043 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m01:08:24.611295 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m01:08:24.925120 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m01:08:24.928038 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m01:08:24.930059 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m01:08:24.932094 [info ] [MainThread]: adapter type: snowflake
[0m01:08:24.934021 [info ] [MainThread]: adapter version: 1.8.4
[0m01:08:25.029151 [info ] [MainThread]: Configuration:
[0m01:08:25.031344 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:08:25.033119 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:08:25.034987 [info ] [MainThread]: Required dependencies:
[0m01:08:25.036874 [debug] [MainThread]: Executing "git --help"
[0m01:08:25.040835 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:08:25.042612 [debug] [MainThread]: STDERR: "b''"
[0m01:08:25.044117 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:08:25.045854 [info ] [MainThread]: Connection:
[0m01:08:25.047660 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:08:25.049423 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:08:25.050836 [info ] [MainThread]:   database: DBT_DB
[0m01:08:25.052257 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:08:25.054502 [info ] [MainThread]:   role: DBT_ROLE
[0m01:08:25.055918 [info ] [MainThread]:   schema: GOLD
[0m01:08:25.057339 [info ] [MainThread]:   authenticator: None
[0m01:08:25.058600 [info ] [MainThread]:   oauth_client_id: None
[0m01:08:25.060228 [info ] [MainThread]:   query_tag: None
[0m01:08:25.061790 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:08:25.063549 [info ] [MainThread]:   host: None
[0m01:08:25.065206 [info ] [MainThread]:   port: None
[0m01:08:25.067391 [info ] [MainThread]:   proxy_host: None
[0m01:08:25.069431 [info ] [MainThread]:   proxy_port: None
[0m01:08:25.071616 [info ] [MainThread]:   protocol: None
[0m01:08:25.073401 [info ] [MainThread]:   connect_retries: 1
[0m01:08:25.075453 [info ] [MainThread]:   connect_timeout: None
[0m01:08:25.077199 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:08:25.079453 [info ] [MainThread]:   retry_all: False
[0m01:08:25.081646 [info ] [MainThread]:   insecure_mode: False
[0m01:08:25.083669 [info ] [MainThread]:   reuse_connections: None
[0m01:08:25.085917 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:08:25.089813 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:08:25.092842 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:08:25.095407 [debug] [MainThread]: On debug: select 1 as id
[0m01:08:25.097612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:25.619527 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m01:08:25.623044 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m01:08:25.625879 [debug] [MainThread]: On debug: No close available on handle
[0m01:08:25.628808 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:08:25.632840 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:08:25.635346 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:08:25.639249 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.2814997, "process_user_time": 1.707208, "process_kernel_time": 0.252071, "process_mem_max_rss": "128476", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:08:25.641170 [debug] [MainThread]: Command `dbt debug` failed at 01:08:25.641054 after 1.28 seconds
[0m01:08:25.643401 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:08:25.647630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a122ccc5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a122af20fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a122b0e7770>]}
[0m01:08:25.650149 [debug] [MainThread]: Flushing usage events
[0m01:08:31.811934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7033f6d37f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7033f933e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7033f6d346e0>]}


============================== 01:08:31.818295 | a1aa957f-8e80-443d-a967-653903894a37 ==============================
[0m01:08:31.818295 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:08:31.821211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'debug': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:08:31.837800 [info ] [MainThread]: dbt version: 1.8.8
[0m01:08:31.840518 [info ] [MainThread]: python version: 3.12.3
[0m01:08:31.842786 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m01:08:31.845139 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m01:08:32.133210 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m01:08:32.135656 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m01:08:32.138281 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m01:08:32.140313 [info ] [MainThread]: adapter type: snowflake
[0m01:08:32.141956 [info ] [MainThread]: adapter version: 1.8.4
[0m01:08:32.241309 [info ] [MainThread]: Configuration:
[0m01:08:32.243946 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:08:32.246097 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:08:32.248495 [info ] [MainThread]: Required dependencies:
[0m01:08:32.250958 [debug] [MainThread]: Executing "git --help"
[0m01:08:32.255209 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:08:32.257328 [debug] [MainThread]: STDERR: "b''"
[0m01:08:32.258676 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:08:32.260045 [info ] [MainThread]: Connection:
[0m01:08:32.262257 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:08:32.264415 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:08:32.266551 [info ] [MainThread]:   database: DBT_DB
[0m01:08:32.269355 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:08:32.271609 [info ] [MainThread]:   role: DBT_ROLE
[0m01:08:32.273719 [info ] [MainThread]:   schema: GOLD
[0m01:08:32.276805 [info ] [MainThread]:   authenticator: None
[0m01:08:32.278451 [info ] [MainThread]:   oauth_client_id: None
[0m01:08:32.279786 [info ] [MainThread]:   query_tag: None
[0m01:08:32.281008 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:08:32.283027 [info ] [MainThread]:   host: None
[0m01:08:32.284412 [info ] [MainThread]:   port: None
[0m01:08:32.285631 [info ] [MainThread]:   proxy_host: None
[0m01:08:32.286814 [info ] [MainThread]:   proxy_port: None
[0m01:08:32.288295 [info ] [MainThread]:   protocol: None
[0m01:08:32.290001 [info ] [MainThread]:   connect_retries: 1
[0m01:08:32.291566 [info ] [MainThread]:   connect_timeout: None
[0m01:08:32.293950 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:08:32.296477 [info ] [MainThread]:   retry_all: False
[0m01:08:32.298659 [info ] [MainThread]:   insecure_mode: False
[0m01:08:32.300686 [info ] [MainThread]:   reuse_connections: None
[0m01:08:32.303242 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:08:32.306407 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:08:32.308835 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:08:32.311832 [debug] [MainThread]: On debug: select 1 as id
[0m01:08:32.314079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:32.838502 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m01:08:32.842516 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m01:08:32.846762 [debug] [MainThread]: On debug: No close available on handle
[0m01:08:32.850310 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:08:32.853559 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:08:32.857065 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ATAHHHY-YLC89681.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:08:32.863710 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.2298497, "process_user_time": 1.438293, "process_kernel_time": 0.19457, "process_mem_max_rss": "128116", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:08:32.866415 [debug] [MainThread]: Command `dbt debug` failed at 01:08:32.866296 after 1.23 seconds
[0m01:08:32.869178 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:08:32.871703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7033f8321640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7033f68e8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7033f5031ac0>]}
[0m01:08:32.874300 [debug] [MainThread]: Flushing usage events
[0m01:17:41.165234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019764B1BF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001976531C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197624FB7A0>]}


============================== 01:17:41.165234 | d534e1cb-fa32-4a95-a2ae-a3112af0a7ca ==============================
[0m01:17:41.165234 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:17:41.165234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjanaassignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_providers.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:17:44.746226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd534e1cb-fa32-4a95-a2ae-a3112af0a7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977E42C770>]}
[0m01:17:44.809279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd534e1cb-fa32-4a95-a2ae-a3112af0a7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197650C0F80>]}
[0m01:17:44.809279 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:17:45.449791 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:17:48.085468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:48.085468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:48.101268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:17:48.124888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd534e1cb-fa32-4a95-a2ae-a3112af0a7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977FC960C0>]}
[0m01:17:48.190624 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:17:48.209413 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:17:48.317565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd534e1cb-fa32-4a95-a2ae-a3112af0a7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001970002DE80>]}
[0m01:17:48.317565 [info ] [MainThread]: Found 20 models, 4 data tests, 2 sources, 477 macros
[0m01:17:48.317565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd534e1cb-fa32-4a95-a2ae-a3112af0a7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977FF43200>]}
[0m01:17:48.317565 [info ] [MainThread]: 
[0m01:17:48.317565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:48.317565 [info ] [MainThread]: 
[0m01:17:48.317565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:48.317565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:17:51.424156 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:17:51.424156 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:17:51.424156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:53.057170 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.638 seconds
[0m01:17:53.057170 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_GOLD'
[0m01:17:53.072947 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:17:53.072947 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:17:53.072947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:53.629062 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.549 seconds
[0m01:17:53.629062 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:17:53.629062 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:17:53.764501 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.141 seconds
[0m01:17:53.764501 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:17:53.780366 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:17:53.876032 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.108 seconds
[0m01:17:53.876032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m01:17:53.891974 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:17:53.891974 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:17:53.986915 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m01:17:53.986915 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:17:53.986915 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:17:54.155258 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.159 seconds
[0m01:17:54.155258 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:17:54.155258 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:17:54.250163 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m01:17:54.250163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd534e1cb-fa32-4a95-a2ae-a3112af0a7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197630D9610>]}
[0m01:17:54.265976 [debug] [Thread-1 (]: Began running node model.healthcare.dim_providers
[0m01:17:54.265976 [info ] [Thread-1 (]: 1 of 1 START sql table model GOLD.dim_providers ................................ [RUN]
[0m01:17:54.265976 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.dim_providers'
[0m01:17:54.265976 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_providers
[0m01:17:54.265976 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_providers"
[0m01:17:54.265976 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_providers
[0m01:17:54.297778 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_providers"
[0m01:17:54.297778 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_providers"
[0m01:17:54.297778 [debug] [Thread-1 (]: On model.healthcare.dim_providers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_providers"} */
create or replace transient table DBT_DB.GOLD.dim_providers
    

    
    as (

WITH base AS (
    SELECT * 
    FROM DBT_DB.SILVER.src_providers
),

deduplicated AS (
    SELECT *
    FROM base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY provider_id ORDER BY npi DESC) = 1
),

final AS (
    SELECT
        provider_id,
        INITCAP(first_name) AS first_name,
        INITCAP(last_name) AS last_name,
        INITCAP(specialization) AS specialization,
        dept_id,
        npi,

        -- Derived: full name
        CONCAT(INITCAP(first_name), ' ', INITCAP(last_name)) AS full_name
    FROM deduplicated
)

SELECT * FROM final
    )
;
[0m01:17:54.297778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:17:55.852475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.550 seconds
[0m01:17:55.884125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd534e1cb-fa32-4a95-a2ae-a3112af0a7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019764B69430>]}
[0m01:17:55.884125 [info ] [Thread-1 (]: 1 of 1 OK created sql table model GOLD.dim_providers ........................... [[32mSUCCESS 1[0m in 1.62s]
[0m01:17:55.884125 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_providers
[0m01:17:55.884125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:55.884125 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:17:55.884125 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:17:56.043142 [debug] [MainThread]: Connection 'list_DBT_DB_SILVER' was left open.
[0m01:17:56.043142 [debug] [MainThread]: On list_DBT_DB_SILVER: Close
[0m01:17:56.240787 [debug] [MainThread]: Connection 'model.healthcare.dim_providers' was left open.
[0m01:17:56.240787 [debug] [MainThread]: On model.healthcare.dim_providers: Close
[0m01:17:56.378972 [info ] [MainThread]: 
[0m01:17:56.378972 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.06 seconds (8.06s).
[0m01:17:56.378972 [debug] [MainThread]: Command end result
[0m01:17:56.404658 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:17:56.406742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:17:56.415552 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:17:56.416804 [info ] [MainThread]: 
[0m01:17:56.416804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:56.417838 [info ] [MainThread]: 
[0m01:17:56.418839 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:17:56.419893 [debug] [MainThread]: Command `dbt run` succeeded at 01:17:56.419893 after 15.45 seconds
[0m01:17:56.419893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977FBD6CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977D570620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001976531C650>]}
[0m01:17:56.419893 [debug] [MainThread]: Flushing usage events
[0m01:17:57.045439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:08.554652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73350173ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733501ae2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7334fdff5a90>]}


============================== 01:19:08.559816 | 1c44729e-05d3-4e42-9146-de3dd56ad485 ==============================
[0m01:19:08.559816 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:19:08.561567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:08.573314 [info ] [MainThread]: dbt version: 1.8.8
[0m01:19:08.575154 [info ] [MainThread]: python version: 3.12.3
[0m01:19:08.577142 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m01:19:08.579545 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m01:19:08.845320 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m01:19:08.847773 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m01:19:08.849448 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m01:19:08.851150 [info ] [MainThread]: adapter type: snowflake
[0m01:19:08.852930 [info ] [MainThread]: adapter version: 1.8.4
[0m01:19:08.935142 [info ] [MainThread]: Configuration:
[0m01:19:08.937660 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:19:08.939223 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:19:08.940741 [info ] [MainThread]: Required dependencies:
[0m01:19:08.941955 [debug] [MainThread]: Executing "git --help"
[0m01:19:08.945772 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:19:08.947301 [debug] [MainThread]: STDERR: "b''"
[0m01:19:08.948784 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:19:08.950929 [info ] [MainThread]: Connection:
[0m01:19:08.952539 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:19:08.953487 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:19:08.954875 [info ] [MainThread]:   database: DBT_DB
[0m01:19:08.956196 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:19:08.957865 [info ] [MainThread]:   role: DBT_ROLE
[0m01:19:08.959127 [info ] [MainThread]:   schema: SILVER
[0m01:19:08.961206 [info ] [MainThread]:   authenticator: None
[0m01:19:08.963007 [info ] [MainThread]:   oauth_client_id: None
[0m01:19:08.965403 [info ] [MainThread]:   query_tag: None
[0m01:19:08.967361 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:19:08.969051 [info ] [MainThread]:   host: None
[0m01:19:08.970585 [info ] [MainThread]:   port: None
[0m01:19:08.972855 [info ] [MainThread]:   proxy_host: None
[0m01:19:08.974074 [info ] [MainThread]:   proxy_port: None
[0m01:19:08.975751 [info ] [MainThread]:   protocol: None
[0m01:19:08.977426 [info ] [MainThread]:   connect_retries: 1
[0m01:19:08.980023 [info ] [MainThread]:   connect_timeout: None
[0m01:19:08.982232 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:19:08.983661 [info ] [MainThread]:   retry_all: False
[0m01:19:08.985570 [info ] [MainThread]:   insecure_mode: False
[0m01:19:08.987003 [info ] [MainThread]:   reuse_connections: None
[0m01:19:08.988436 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:19:08.991163 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:19:08.993751 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:19:08.995928 [debug] [MainThread]: On debug: select 1 as id
[0m01:19:08.998959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:09.820686 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.822 seconds
[0m01:19:09.825226 [debug] [MainThread]: On debug: Close
[0m01:19:09.988900 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:19:09.991381 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:19:09.994265 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.626561, "process_user_time": 1.401681, "process_kernel_time": 0.168969, "process_mem_max_rss": "128092", "process_in_blocks": "592", "process_out_blocks": "16"}
[0m01:19:09.996701 [debug] [MainThread]: Command `dbt debug` succeeded at 01:19:09.996538 after 1.63 seconds
[0m01:19:09.998844 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:19:10.000826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73350173ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7334fc957f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73350069d370>]}
[0m01:19:10.002865 [debug] [MainThread]: Flushing usage events
[0m01:19:12.815344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70b40bdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70b4672090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70b5bd0590>]}


============================== 01:19:12.821122 | 1a7fcea3-f4a1-41ca-b3ad-8e3097773f32 ==============================
[0m01:19:12.821122 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:19:12.822206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:12.833209 [info ] [MainThread]: dbt version: 1.8.8
[0m01:19:12.834937 [info ] [MainThread]: python version: 3.12.3
[0m01:19:12.835992 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m01:19:12.837096 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m01:19:13.111118 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m01:19:13.113314 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m01:19:13.115789 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m01:19:13.118520 [info ] [MainThread]: adapter type: snowflake
[0m01:19:13.119917 [info ] [MainThread]: adapter version: 1.8.4
[0m01:19:13.202861 [info ] [MainThread]: Configuration:
[0m01:19:13.205047 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:19:13.207471 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:19:13.208979 [info ] [MainThread]: Required dependencies:
[0m01:19:13.210663 [debug] [MainThread]: Executing "git --help"
[0m01:19:13.214569 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:19:13.216445 [debug] [MainThread]: STDERR: "b''"
[0m01:19:13.217950 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:19:13.219605 [info ] [MainThread]: Connection:
[0m01:19:13.222105 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:19:13.223428 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:19:13.224996 [info ] [MainThread]:   database: DBT_DB
[0m01:19:13.226336 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:19:13.228194 [info ] [MainThread]:   role: DBT_ROLE
[0m01:19:13.229765 [info ] [MainThread]:   schema: SILVER
[0m01:19:13.231361 [info ] [MainThread]:   authenticator: None
[0m01:19:13.233227 [info ] [MainThread]:   oauth_client_id: None
[0m01:19:13.237387 [info ] [MainThread]:   query_tag: None
[0m01:19:13.239841 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:19:13.242445 [info ] [MainThread]:   host: None
[0m01:19:13.243578 [info ] [MainThread]:   port: None
[0m01:19:13.244959 [info ] [MainThread]:   proxy_host: None
[0m01:19:13.246267 [info ] [MainThread]:   proxy_port: None
[0m01:19:13.247313 [info ] [MainThread]:   protocol: None
[0m01:19:13.249212 [info ] [MainThread]:   connect_retries: 1
[0m01:19:13.251011 [info ] [MainThread]:   connect_timeout: None
[0m01:19:13.252777 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:19:13.255217 [info ] [MainThread]:   retry_all: False
[0m01:19:13.257030 [info ] [MainThread]:   insecure_mode: False
[0m01:19:13.258906 [info ] [MainThread]:   reuse_connections: None
[0m01:19:13.260333 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:19:13.263458 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:19:13.265337 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:19:13.267338 [debug] [MainThread]: On debug: select 1 as id
[0m01:19:13.269287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:13.894834 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.625 seconds
[0m01:19:13.900425 [debug] [MainThread]: On debug: Close
[0m01:19:14.060718 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:19:14.063510 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:19:14.066732 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3824911, "process_user_time": 1.44579, "process_kernel_time": 0.199352, "process_mem_max_rss": "128064", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m01:19:14.069754 [debug] [MainThread]: Command `dbt debug` succeeded at 01:19:14.069607 after 1.39 seconds
[0m01:19:14.072130 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:19:14.075797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70b231bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70b43d50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70b36c7830>]}
[0m01:19:14.080028 [debug] [MainThread]: Flushing usage events
[0m01:19:18.118511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1f568a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1d6f5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1d6f78f0>]}


============================== 01:19:18.122317 | 1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e ==============================
[0m01:19:18.122317 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:19:18.123549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'version_check': 'True', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:18.464134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1d66d0d0>]}
[0m01:19:18.510124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1f282990>]}
[0m01:19:18.512456 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:19:18.538730 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:19:18.649025 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:19:18.650610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1e0f65a0>]}
[0m01:19:20.441599 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:19:20.445990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1ba60830>]}
[0m01:19:20.705241 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:19:20.720797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1ab6fcb0>]}
[0m01:19:21.007404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1ab87e90>]}
[0m01:19:21.008741 [info ] [MainThread]: Found 20 models, 6 data tests, 2 sources, 455 macros
[0m01:19:21.010187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1bba94f0>]}
[0m01:19:21.013183 [info ] [MainThread]: 
[0m01:19:21.015360 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:19:21.022122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:19:21.035231 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:19:21.038121 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:19:21.040601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:21.714593 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.674 seconds
[0m01:19:21.719985 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:19:21.890973 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:19:21.897252 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:19:21.900881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:22.508122 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.607 seconds
[0m01:19:22.510699 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:19:22.655047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now list_DBT_DB_SILVER)
[0m01:19:22.663639 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:19:22.666274 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000
[0m01:19:22.668587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:23.216493 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.548 seconds
[0m01:19:23.220292 [debug] [ThreadPool]: On list_DBT_DB_SILVER: Close
[0m01:19:23.377617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:19:23.384786 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:19:23.386747 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000
[0m01:19:23.388829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:23.891554 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.503 seconds
[0m01:19:23.896686 [debug] [ThreadPool]: On list_DBT_DB_GOLD: Close
[0m01:19:24.060562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1aad3530>]}
[0m01:19:24.064284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:24.067581 [info ] [MainThread]: 
[0m01:19:24.072969 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m01:19:24.074789 [info ] [Thread-1 (]: 1 of 20 START sql view model SILVER.src_claims ................................. [RUN]
[0m01:19:24.076762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now model.healthcare.src_claims)
[0m01:19:24.078395 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m01:19:24.084961 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m01:19:24.133093 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m01:19:24.163790 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m01:19:24.222168 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m01:19:24.226728 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

    case 
        when Hospital_ID = 'HOSP1' then replace(Patient_ID, 'HOSP1-', 'H1-')
        when Hospital_ID = 'HOSP2' then replace(Patient_ID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else Patient_ID
    end as patient_id,
    
    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m01:19:24.230845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:24.837100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m01:19:24.865016 [debug] [Thread-1 (]: On model.healthcare.src_claims: Close
[0m01:19:25.014298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1e0f77a0>]}
[0m01:19:25.017654 [info ] [Thread-1 (]: 1 of 20 OK created sql view model SILVER.src_claims ............................ [[32mSUCCESS 1[0m in 0.94s]
[0m01:19:25.019669 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m01:19:25.021770 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m01:19:25.024162 [info ] [Thread-1 (]: 2 of 20 START sql view model SILVER.src_cptcodes ............................... [RUN]
[0m01:19:25.026822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m01:19:25.030110 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m01:19:25.033244 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m01:19:25.082895 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m01:19:25.090752 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m01:19:25.139616 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m01:19:25.142086 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m01:19:25.143864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:25.948146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m01:19:25.953412 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: Close
[0m01:19:26.104357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1a0f39e0>]}
[0m01:19:26.106771 [info ] [Thread-1 (]: 2 of 20 OK created sql view model SILVER.src_cptcodes .......................... [[32mSUCCESS 1[0m in 1.08s]
[0m01:19:26.108550 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m01:19:26.111213 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m01:19:26.113135 [info ] [Thread-1 (]: 3 of 20 START sql view model SILVER.src_departments ............................ [RUN]
[0m01:19:26.115130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m01:19:26.117746 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m01:19:26.120214 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m01:19:26.181291 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m01:19:26.197854 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m01:19:26.250079 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m01:19:26.253251 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    
    -- Add encounter prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPARTMENT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPARTMENT_ID
        else Department_id
    end as department_id,
    
    DEPARTMENT_Name as department_name
from RAW_DEPARTMENTS
  );
[0m01:19:26.255624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:26.992918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m01:19:26.998709 [debug] [Thread-1 (]: On model.healthcare.src_departments: Close
[0m01:19:27.157012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc19f370e0>]}
[0m01:19:27.159803 [info ] [Thread-1 (]: 3 of 20 OK created sql view model SILVER.src_departments ....................... [[32mSUCCESS 1[0m in 1.04s]
[0m01:19:27.162666 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m01:19:27.165139 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m01:19:27.167009 [info ] [Thread-1 (]: 4 of 20 START sql view model SILVER.src_encounters ............................. [RUN]
[0m01:19:27.169503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m01:19:27.170968 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m01:19:27.176243 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m01:19:27.230999 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m01:19:27.238537 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m01:19:27.312253 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m01:19:27.314682 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.raw.raw_encounters
)

select
    -- Add encounter prefix based on patient_id
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Encounter_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Encounter_ID
        else Encounter_ID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Provider_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || dept_id
        when Provider_key like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    Procedure_Code as procedure_code,
    Inserted_Date as inserted_date,
    Modified_Date as modified_date
from RAW_ENCOUNTERS
  );
[0m01:19:27.317398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:28.024757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m01:19:28.027656 [debug] [Thread-1 (]: On model.healthcare.src_encounters: Close
[0m01:19:28.181106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc19f94bf0>]}
[0m01:19:28.184826 [info ] [Thread-1 (]: 4 of 20 OK created sql view model SILVER.src_encounters ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m01:19:28.188017 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m01:19:28.190785 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m01:19:28.193124 [info ] [Thread-1 (]: 5 of 20 START sql view model SILVER.src_patients ............................... [RUN]
[0m01:19:28.195404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m01:19:28.197062 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m01:19:28.200148 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m01:19:28.247657 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m01:19:28.256536 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m01:19:28.314982 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m01:19:28.318670 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    Patientid as patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m01:19:28.322019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:28.896049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m01:19:28.899357 [debug] [Thread-1 (]: On model.healthcare.src_patients: Close
[0m01:19:29.051976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc19fbbd10>]}
[0m01:19:29.055606 [info ] [Thread-1 (]: 5 of 20 OK created sql view model SILVER.src_patients .......................... [[32mSUCCESS 1[0m in 0.86s]
[0m01:19:29.058464 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m01:19:29.061355 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m01:19:29.063569 [info ] [Thread-1 (]: 6 of 20 START sql view model SILVER.src_providers .............................. [RUN]
[0m01:19:29.066518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m01:19:29.068934 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m01:19:29.073269 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m01:19:29.121242 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m01:19:29.128644 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m01:19:29.181875 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m01:19:29.184821 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    DepartmentID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m01:19:29.186896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:29.838964 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be129b-0000-289f-0027-cf8b00095176
[0m01:19:29.841977 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'DEPARTMENTID'
[0m01:19:29.844938 [debug] [Thread-1 (]: On model.healthcare.src_providers: Close
[0m01:19:30.002725 [debug] [Thread-1 (]: Database Error in model src_providers (models/healthcare/staging/src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target/run/healthcare/models/healthcare/staging/src_providers.sql
[0m01:19:30.004504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc19fb8a10>]}
[0m01:19:30.006934 [error] [Thread-1 (]: 6 of 20 ERROR creating sql view model SILVER.src_providers ..................... [[31mERROR[0m in 0.94s]
[0m01:19:30.009215 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m01:19:30.011912 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m01:19:30.014133 [info ] [Thread-1 (]: 7 of 20 START sql view model SILVER.src_transactions ........................... [RUN]
[0m01:19:30.016204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m01:19:30.018201 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m01:19:30.022623 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m01:19:30.074209 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m01:19:30.080273 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m01:19:30.137784 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m01:19:30.139711 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    case 
        when HospitalID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when HospitalID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id,
    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m01:19:30.141995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:30.915326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m01:19:30.919854 [debug] [Thread-1 (]: On model.healthcare.src_transactions: Close
[0m01:19:31.074587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc19f34710>]}
[0m01:19:31.077239 [info ] [Thread-1 (]: 7 of 20 OK created sql view model SILVER.src_transactions ...................... [[32mSUCCESS 1[0m in 1.06s]
[0m01:19:31.080920 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m01:19:31.085022 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:19:31.087451 [info ] [Thread-1 (]: 8 of 20 START sql table model GOLD.claims_status_metrics ....................... [RUN]
[0m01:19:31.089826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.claims_status_metrics)
[0m01:19:31.092635 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:19:31.097394 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:19:31.153527 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:19:31.175305 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:19:31.223240 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:19:31.227056 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
         as
        (

with base as (
    select
        claim_status,
        try_to_date(claim_date) as claim_date
    from DBT_DB.SILVER.src_claims
    where claim_status is not null
),

agg as (
    select
        to_char(claim_date, 'YYYY-MM') as claim_month,
        upper(claim_status) as claim_status,
        count(*) as claim_count
    from base
    group by claim_month, claim_status
)

select * from agg
order by claim_month, claim_status
        );
[0m01:19:31.230745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:32.479895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.249 seconds
[0m01:19:32.484784 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: Close
[0m01:19:32.683265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc205a7ad0>]}
[0m01:19:32.690357 [info ] [Thread-1 (]: 8 of 20 OK created sql table model GOLD.claims_status_metrics .................. [[32mSUCCESS 1[0m in 1.59s]
[0m01:19:32.692262 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:19:32.695482 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m01:19:32.698345 [info ] [Thread-1 (]: 9 of 20 START sql table model GOLD.dim_cptcodes ................................ [RUN]
[0m01:19:32.701491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.claims_status_metrics, now model.healthcare.dim_cptcodes)
[0m01:19:32.704581 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m01:19:32.708836 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m01:19:32.760045 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m01:19:32.764713 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m01:19:32.808970 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m01:19:32.811811 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
         as
        (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_codes AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE procedure_code_category IS NOT NULL
)

SELECT * FROM cleaned_cpt
        );
[0m01:19:32.814928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:34.389625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.575 seconds
[0m01:19:34.394367 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: Close
[0m01:19:34.904728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc186bf8c0>]}
[0m01:19:34.907782 [info ] [Thread-1 (]: 9 of 20 OK created sql table model GOLD.dim_cptcodes ........................... [[32mSUCCESS 1[0m in 2.20s]
[0m01:19:34.910556 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m01:19:34.913612 [debug] [Thread-1 (]: Began running node model.healthcare.dim_departments
[0m01:19:34.917310 [info ] [Thread-1 (]: 10 of 20 START sql table model GOLD.dim_departments ............................ [RUN]
[0m01:19:34.921169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_cptcodes, now model.healthcare.dim_departments)
[0m01:19:34.924136 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_departments
[0m01:19:34.934822 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_departments"
[0m01:19:34.977674 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_departments
[0m01:19:34.982607 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_departments"
[0m01:19:35.032095 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_departments"
[0m01:19:35.034010 [debug] [Thread-1 (]: On model.healthcare.dim_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_departments"} */
create or replace transient table DBT_DB.GOLD.dim_departments
         as
        (

WITH deduplicated_departments AS (
    SELECT DISTINCT department_id, department_name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    department_id AS department_key,
    INITCAP(department_name) AS department_name
FROM deduplicated_departments
        );
[0m01:19:35.035911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:36.834707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.799 seconds
[0m01:19:36.838543 [debug] [Thread-1 (]: On model.healthcare.dim_departments: Close
[0m01:19:37.000325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc186dcd70>]}
[0m01:19:37.002267 [info ] [Thread-1 (]: 10 of 20 OK created sql table model GOLD.dim_departments ....................... [[32mSUCCESS 1[0m in 2.08s]
[0m01:19:37.004212 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_departments
[0m01:19:37.005867 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m01:19:37.007470 [info ] [Thread-1 (]: 11 of 20 START sql table model GOLD.dim_patients ............................... [RUN]
[0m01:19:37.009046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_departments, now model.healthcare.dim_patients)
[0m01:19:37.010686 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m01:19:37.015928 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m01:19:37.056047 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m01:19:37.060309 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m01:19:37.108393 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m01:19:37.111864 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (

with base as (
    select * 
    from DBT_DB.SILVER.src_patients
),

deduplicated as (
    select * 
    from base
    qualify row_number() over (partition by patient_id order by modified_date desc) = 1
),

final as (
    select
        patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated
)

select * from final
        );
[0m01:19:37.116114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:38.767123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.651 seconds
[0m01:19:38.769757 [debug] [Thread-1 (]: On model.healthcare.dim_patients: Close
[0m01:19:38.928202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1acbc9e0>]}
[0m01:19:38.931180 [info ] [Thread-1 (]: 11 of 20 OK created sql table model GOLD.dim_patients .......................... [[32mSUCCESS 1[0m in 1.92s]
[0m01:19:38.933743 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m01:19:38.935979 [debug] [Thread-1 (]: Began running node model.healthcare.dim_providers
[0m01:19:38.939008 [info ] [Thread-1 (]: 12 of 20 SKIP relation GOLD.dim_providers ...................................... [[33mSKIP[0m]
[0m01:19:38.941588 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_providers
[0m01:19:38.944046 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m01:19:38.946963 [info ] [Thread-1 (]: 13 of 20 START sql table model GOLD.procedure_statistics ....................... [RUN]
[0m01:19:38.948664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_patients, now model.healthcare.procedure_statistics)
[0m01:19:38.950523 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m01:19:38.954688 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m01:19:38.997129 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m01:19:39.001721 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m01:19:39.042907 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m01:19:39.044982 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
         as
        (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
        );
[0m01:19:39.046740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:40.875202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.828 seconds
[0m01:19:40.880803 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: Close
[0m01:19:41.026069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1a0ce750>]}
[0m01:19:41.030257 [info ] [Thread-1 (]: 13 of 20 OK created sql table model GOLD.procedure_statistics .................. [[32mSUCCESS 1[0m in 2.08s]
[0m01:19:41.032633 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m01:19:41.035367 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:19:41.037861 [info ] [Thread-1 (]: 14 of 20 START sql table model GOLD.department_revenue_summary ................. [RUN]
[0m01:19:41.039782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.procedure_statistics, now model.healthcare.department_revenue_summary)
[0m01:19:41.041556 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:19:41.045989 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:19:41.079731 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:19:41.083507 [debug] [Thread-1 (]: Dropping relation "DBT_DB"."GOLD"."DEPARTMENT_REVENUE_SUMMARY" because it is of type dynamic_table
[0m01:19:41.093093 [debug] [Thread-1 (]: Applying DROP to: "DBT_DB"."GOLD"."DEPARTMENT_REVENUE_SUMMARY"
[0m01:19:41.097162 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:19:41.098933 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
drop dynamic table if exists "DBT_DB"."GOLD"."DEPARTMENT_REVENUE_SUMMARY"
[0m01:19:41.100874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:41.698648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m01:19:41.703234 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:19:41.758474 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:19:41.761980 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        department_id,
        COALESCE(CHARGE_amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.department_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.department_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY department_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
        );
[0m01:19:41.219372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.010 seconds
[0m01:19:41.224473 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: Close
[0m01:19:41.373940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc19f36ae0>]}
[0m01:19:41.377558 [info ] [Thread-1 (]: 14 of 20 OK created sql table model GOLD.department_revenue_summary ............ [[32mSUCCESS 1[0m in 0.33s]
[0m01:19:41.381361 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:19:41.385293 [debug] [Thread-1 (]: Began running node model.healthcare.patient_utilization_summary
[0m01:19:41.389633 [info ] [Thread-1 (]: 15 of 20 START sql table model GOLD.patient_utilization_summary ................ [RUN]
[0m01:19:41.393553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.department_revenue_summary, now model.healthcare.patient_utilization_summary)
[0m01:19:41.396705 [debug] [Thread-1 (]: Began compiling node model.healthcare.patient_utilization_summary
[0m01:19:41.406556 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.patient_utilization_summary"
[0m01:19:41.472371 [debug] [Thread-1 (]: Began executing node model.healthcare.patient_utilization_summary
[0m01:19:41.483222 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.patient_utilization_summary"
[0m01:19:41.534914 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.patient_utilization_summary"
[0m01:19:41.538156 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.patient_utilization_summary"} */
create or replace transient table DBT_DB.GOLD.patient_utilization_summary
         as
        (

-- Step 1: encounter counts per patient
WITH encounter_summary AS (
    SELECT
        patient_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY patient_id
),

-- Step 2: transaction summary per patient
transaction_summary AS (
    SELECT
        patient_id,
        COUNT(*) AS total_procedures,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY patient_id
),

-- Step 3: combine metrics at patient level
combined_metrics AS (
    SELECT
        COALESCE(e.patient_id, t.patient_id) AS patient_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_procedures, 0) AS total_procedures,
        COALESCE(total_charges, 0) AS total_charges
    FROM encounter_summary e
    FULL OUTER JOIN transaction_summary t
        ON e.patient_id = t.patient_id
),

-- Step 4: enrich with demographic data
final AS (
    SELECT
        cm.patient_id,
        p.first_name,
        p.last_name,
        p.gender_flag,
        p.age,
        p.age_group,
        cm.total_encounters,
        cm.total_procedures,
        cm.total_charges
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_patients p
        ON cm.patient_id = p.patient_key
)

SELECT * FROM final
        );
[0m01:19:41.541326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:43.141069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.600 seconds
[0m01:19:43.144614 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: Close
[0m01:19:43.287767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8c8de3-7c8e-4189-bdc6-2e3fa728be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc186c3bc0>]}
[0m01:19:43.290892 [info ] [Thread-1 (]: 15 of 20 OK created sql table model GOLD.patient_utilization_summary ........... [[32mSUCCESS 1[0m in 1.89s]
[0m01:19:43.294312 [debug] [Thread-1 (]: Finished running node model.healthcare.patient_utilization_summary
[0m01:19:43.297929 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m01:19:43.300325 [info ] [Thread-1 (]: 16 of 20 SKIP relation GOLD.ar_balance_summary ................................. [[33mSKIP[0m]
[0m01:19:43.302002 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m01:19:43.303359 [debug] [Thread-1 (]: Began running node model.healthcare.denials_by_dept_provider
[0m01:19:43.304319 [info ] [Thread-1 (]: 17 of 20 SKIP relation GOLD.denials_by_dept_provider ........................... [[33mSKIP[0m]
[0m01:19:43.306173 [debug] [Thread-1 (]: Finished running node model.healthcare.denials_by_dept_provider
[0m01:19:43.308731 [debug] [Thread-1 (]: Began running node model.healthcare.missing_providers_audit
[0m01:19:43.310502 [info ] [Thread-1 (]: 18 of 20 SKIP relation GOLD.missing_providers_audit ............................ [[33mSKIP[0m]
[0m01:19:43.313086 [debug] [Thread-1 (]: Finished running node model.healthcare.missing_providers_audit
[0m01:19:43.315885 [debug] [Thread-1 (]: Began running node model.healthcare.provider_department_revenue_summary
[0m01:19:43.317838 [info ] [Thread-1 (]: 19 of 20 SKIP relation GOLD.provider_department_revenue_summary ................ [[33mSKIP[0m]
[0m01:19:43.319398 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_department_revenue_summary
[0m01:19:43.321733 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m01:19:43.323610 [info ] [Thread-1 (]: 20 of 20 SKIP relation GOLD.provider_performance_summary ....................... [[33mSKIP[0m]
[0m01:19:43.325365 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m01:19:43.331864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:43.333941 [debug] [MainThread]: Connection 'model.healthcare.patient_utilization_summary' was properly closed.
[0m01:19:43.336713 [info ] [MainThread]: 
[0m01:19:43.338288 [info ] [MainThread]: Finished running 7 view models, 13 table models in 0 hours 0 minutes and 22.32 seconds (22.32s).
[0m01:19:43.342068 [debug] [MainThread]: Command end result
[0m01:19:43.488160 [info ] [MainThread]: 
[0m01:19:43.490067 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:19:43.491498 [info ] [MainThread]: 
[0m01:19:43.495058 [error] [MainThread]:   Database Error in model src_providers (models/healthcare/staging/src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target/run/healthcare/models/healthcare/staging/src_providers.sql
[0m01:19:43.497413 [info ] [MainThread]: 
[0m01:19:43.498800 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=6 TOTAL=20
[0m01:19:43.501035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.083755, "process_user_time": 3.521204, "process_kernel_time": 0.429602, "process_mem_max_rss": "142796", "process_in_blocks": "4424", "process_out_blocks": "16", "command_success": false}
[0m01:19:43.502663 [debug] [MainThread]: Command `dbt run` failed at 01:19:43.502559 after 27.09 seconds
[0m01:19:43.504509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1e6171d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1e6160c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc1bbe4320>]}
[0m01:19:43.506281 [debug] [MainThread]: Flushing usage events
[0m01:19:47.783618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a75836e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a85afe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a7c03200>]}


============================== 01:19:47.788336 | 62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef ==============================
[0m01:19:47.788336 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:19:47.791780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:19:48.129129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a58c3620>]}
[0m01:19:48.184425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a537b470>]}
[0m01:19:48.187460 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:19:48.212638 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:19:49.245056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:49.247940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:49.254434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:19:49.289258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a5316f00>]}
[0m01:19:49.440869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a50d3bf0>]}
[0m01:19:49.443045 [info ] [MainThread]: Found 20 models, 6 data tests, 2 sources, 455 macros
[0m01:19:49.444484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a53d2210>]}
[0m01:19:49.448380 [info ] [MainThread]: 
[0m01:19:49.450408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:19:49.457075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:19:49.472332 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:19:49.473777 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:19:49.475157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:50.239669 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.764 seconds
[0m01:19:50.244018 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:19:50.409495 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:19:50.413824 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:19:50.417301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:51.043950 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.627 seconds
[0m01:19:51.048121 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:19:51.205092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now list_DBT_DB_GOLD)
[0m01:19:51.215272 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:19:51.217559 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000
[0m01:19:51.220458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:51.854620 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.634 seconds
[0m01:19:51.860432 [debug] [ThreadPool]: On list_DBT_DB_GOLD: Close
[0m01:19:52.029117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now list_DBT_DB_SILVER)
[0m01:19:52.032766 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:19:52.034489 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000
[0m01:19:52.035661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:52.479284 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.444 seconds
[0m01:19:52.484585 [debug] [ThreadPool]: On list_DBT_DB_SILVER: Close
[0m01:19:52.636289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a4f99820>]}
[0m01:19:52.639637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:52.642865 [info ] [MainThread]: 
[0m01:19:52.648581 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m01:19:52.650499 [info ] [Thread-1 (]: 1 of 20 START sql view model SILVER.src_claims ................................. [RUN]
[0m01:19:52.653965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now model.healthcare.src_claims)
[0m01:19:52.657822 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m01:19:52.665537 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m01:19:52.688801 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m01:19:52.715018 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m01:19:52.752396 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m01:19:52.757162 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

    case 
        when Hospital_ID = 'HOSP1' then replace(Patient_ID, 'HOSP1-', 'H1-')
        when Hospital_ID = 'HOSP2' then replace(Patient_ID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else Patient_ID
    end as patient_id,
    
    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m01:19:52.759952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:53.385113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m01:19:53.407525 [debug] [Thread-1 (]: On model.healthcare.src_claims: Close
[0m01:19:53.551470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a53ff800>]}
[0m01:19:53.555688 [info ] [Thread-1 (]: 1 of 20 OK created sql view model SILVER.src_claims ............................ [[32mSUCCESS 1[0m in 0.90s]
[0m01:19:53.558274 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m01:19:53.561738 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m01:19:53.566445 [info ] [Thread-1 (]: 2 of 20 START sql view model SILVER.src_cptcodes ............................... [RUN]
[0m01:19:53.568734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m01:19:53.570314 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m01:19:53.573470 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m01:19:53.594509 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m01:19:53.600586 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m01:19:53.625536 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m01:19:53.627204 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m01:19:53.628267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:54.209012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m01:19:54.213887 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: Close
[0m01:19:54.371402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a4451ca0>]}
[0m01:19:54.374352 [info ] [Thread-1 (]: 2 of 20 OK created sql view model SILVER.src_cptcodes .......................... [[32mSUCCESS 1[0m in 0.80s]
[0m01:19:54.378231 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m01:19:54.381217 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m01:19:54.383273 [info ] [Thread-1 (]: 3 of 20 START sql view model SILVER.src_departments ............................ [RUN]
[0m01:19:54.386470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m01:19:54.388325 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m01:19:54.390644 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m01:19:54.410175 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m01:19:54.415319 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m01:19:54.433715 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m01:19:54.435187 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    
    -- Add encounter prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPARTMENT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPARTMENT_ID
        else Department_id
    end as department_id,
    
    DEPARTMENT_Name as department_name
from RAW_DEPARTMENTS
  );
[0m01:19:54.436744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:55.079267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m01:19:55.088842 [debug] [Thread-1 (]: On model.healthcare.src_departments: Close
[0m01:19:55.256425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a4ede510>]}
[0m01:19:55.260526 [info ] [Thread-1 (]: 3 of 20 OK created sql view model SILVER.src_departments ....................... [[32mSUCCESS 1[0m in 0.87s]
[0m01:19:55.264287 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m01:19:55.266542 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m01:19:55.268676 [info ] [Thread-1 (]: 4 of 20 START sql view model SILVER.src_encounters ............................. [RUN]
[0m01:19:55.271320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m01:19:55.273430 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m01:19:55.278846 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m01:19:55.303964 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m01:19:55.309190 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m01:19:55.330072 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m01:19:55.332239 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.raw.raw_encounters
)

select
    -- Add encounter prefix based on patient_id
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Encounter_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Encounter_ID
        else Encounter_ID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Provider_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || dept_id
        when Provider_key like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    Procedure_Code as procedure_code,
    Inserted_Date as inserted_date,
    Modified_Date as modified_date
from RAW_ENCOUNTERS
  );
[0m01:19:55.334549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:55.891137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m01:19:55.896353 [debug] [Thread-1 (]: On model.healthcare.src_encounters: Close
[0m01:19:56.073115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a44b9df0>]}
[0m01:19:56.076650 [info ] [Thread-1 (]: 4 of 20 OK created sql view model SILVER.src_encounters ........................ [[32mSUCCESS 1[0m in 0.80s]
[0m01:19:56.078600 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m01:19:56.081025 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m01:19:56.083138 [info ] [Thread-1 (]: 5 of 20 START sql view model SILVER.src_patients ............................... [RUN]
[0m01:19:56.085433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m01:19:56.089081 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m01:19:56.091778 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m01:19:56.112732 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m01:19:56.117334 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m01:19:56.138964 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m01:19:56.141091 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    Patientid as patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m01:19:56.142947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:56.726069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m01:19:56.729826 [debug] [Thread-1 (]: On model.healthcare.src_patients: Close
[0m01:19:56.878025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a44d3e90>]}
[0m01:19:56.881876 [info ] [Thread-1 (]: 5 of 20 OK created sql view model SILVER.src_patients .......................... [[32mSUCCESS 1[0m in 0.79s]
[0m01:19:56.885100 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m01:19:56.887112 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m01:19:56.888918 [info ] [Thread-1 (]: 6 of 20 START sql view model SILVER.src_providers .............................. [RUN]
[0m01:19:56.891619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m01:19:56.893571 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m01:19:56.896319 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m01:19:56.915752 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m01:19:56.922836 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m01:19:56.941209 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m01:19:56.943071 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    DepartmentID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m01:19:56.944327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:57.682467 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be129b-0000-289f-0027-cf8b0009517a
[0m01:19:57.686730 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'DEPARTMENTID'
[0m01:19:57.692165 [debug] [Thread-1 (]: On model.healthcare.src_providers: Close
[0m01:19:57.847562 [debug] [Thread-1 (]: Database Error in model src_providers (models/healthcare/staging/src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target/run/healthcare/models/healthcare/staging/src_providers.sql
[0m01:19:57.849800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a442fa40>]}
[0m01:19:57.851769 [error] [Thread-1 (]: 6 of 20 ERROR creating sql view model SILVER.src_providers ..................... [[31mERROR[0m in 0.96s]
[0m01:19:57.853392 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m01:19:57.855026 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m01:19:57.856876 [info ] [Thread-1 (]: 7 of 20 START sql view model SILVER.src_transactions ........................... [RUN]
[0m01:19:57.858442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m01:19:57.859699 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m01:19:57.863838 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m01:19:57.879659 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m01:19:57.885392 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m01:19:57.904091 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m01:19:57.906004 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    case 
        when HospitalID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when HospitalID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id,
    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m01:19:57.907731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:58.491562 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m01:19:58.496298 [debug] [Thread-1 (]: On model.healthcare.src_transactions: Close
[0m01:19:58.655069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a44dbbc0>]}
[0m01:19:58.658340 [info ] [Thread-1 (]: 7 of 20 OK created sql view model SILVER.src_transactions ...................... [[32mSUCCESS 1[0m in 0.80s]
[0m01:19:58.661172 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m01:19:58.664278 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:19:58.667461 [info ] [Thread-1 (]: 8 of 20 START sql table model GOLD.claims_status_metrics ....................... [RUN]
[0m01:19:58.670794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.claims_status_metrics)
[0m01:19:58.672464 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:19:58.676884 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:19:58.697580 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:19:58.717030 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:19:58.736631 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:19:58.738878 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
         as
        (

with base as (
    select
        claim_status,
        try_to_date(claim_date) as claim_date
    from DBT_DB.SILVER.src_claims
    where claim_status is not null
),

agg as (
    select
        to_char(claim_date, 'YYYY-MM') as claim_month,
        upper(claim_status) as claim_status,
        count(*) as claim_count
    from base
    group by claim_month, claim_status
)

select * from agg
order by claim_month, claim_status
        );
[0m01:19:58.741074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:00.318216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.577 seconds
[0m01:20:00.321746 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: Close
[0m01:20:00.470203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a445a1b0>]}
[0m01:20:00.474764 [info ] [Thread-1 (]: 8 of 20 OK created sql table model GOLD.claims_status_metrics .................. [[32mSUCCESS 1[0m in 1.80s]
[0m01:20:00.477658 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:20:00.482191 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m01:20:00.484032 [info ] [Thread-1 (]: 9 of 20 START sql table model GOLD.dim_cptcodes ................................ [RUN]
[0m01:20:00.485650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.claims_status_metrics, now model.healthcare.dim_cptcodes)
[0m01:20:00.487019 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m01:20:00.492009 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m01:20:00.511589 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m01:20:00.515159 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m01:20:00.534480 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m01:20:00.536117 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
         as
        (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_codes AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE procedure_code_category IS NOT NULL
)

SELECT * FROM cleaned_cpt
        );
[0m01:20:00.537806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:02.096518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.559 seconds
[0m01:20:02.099694 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: Close
[0m01:20:02.250614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a877ca10>]}
[0m01:20:02.253896 [info ] [Thread-1 (]: 9 of 20 OK created sql table model GOLD.dim_cptcodes ........................... [[32mSUCCESS 1[0m in 1.76s]
[0m01:20:02.256755 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m01:20:02.259311 [debug] [Thread-1 (]: Began running node model.healthcare.dim_departments
[0m01:20:02.262042 [info ] [Thread-1 (]: 10 of 20 START sql table model GOLD.dim_departments ............................ [RUN]
[0m01:20:02.264021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_cptcodes, now model.healthcare.dim_departments)
[0m01:20:02.265609 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_departments
[0m01:20:02.268837 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_departments"
[0m01:20:02.295628 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_departments
[0m01:20:02.300692 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_departments"
[0m01:20:02.322505 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_departments"
[0m01:20:02.325320 [debug] [Thread-1 (]: On model.healthcare.dim_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_departments"} */
create or replace transient table DBT_DB.GOLD.dim_departments
         as
        (

WITH deduplicated_departments AS (
    SELECT DISTINCT department_id, department_name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    department_id AS department_key,
    INITCAP(department_name) AS department_name
FROM deduplicated_departments
        );
[0m01:20:02.327419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:03.665892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.338 seconds
[0m01:20:03.672423 [debug] [Thread-1 (]: On model.healthcare.dim_departments: Close
[0m01:20:03.836251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a43f7fe0>]}
[0m01:20:03.840854 [info ] [Thread-1 (]: 10 of 20 OK created sql table model GOLD.dim_departments ....................... [[32mSUCCESS 1[0m in 1.57s]
[0m01:20:03.844444 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_departments
[0m01:20:03.848048 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m01:20:03.850787 [info ] [Thread-1 (]: 11 of 20 START sql table model GOLD.dim_patients ............................... [RUN]
[0m01:20:03.852750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_departments, now model.healthcare.dim_patients)
[0m01:20:03.854847 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m01:20:03.860926 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m01:20:03.888487 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m01:20:03.895681 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m01:20:03.918401 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m01:20:03.919930 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (

with base as (
    select * 
    from DBT_DB.SILVER.src_patients
),

deduplicated as (
    select * 
    from base
    qualify row_number() over (partition by patient_id order by modified_date desc) = 1
),

final as (
    select
        patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated
)

select * from final
        );
[0m01:20:03.921156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:05.368365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.447 seconds
[0m01:20:05.371917 [debug] [Thread-1 (]: On model.healthcare.dim_patients: Close
[0m01:20:05.541468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a43f8290>]}
[0m01:20:05.545951 [info ] [Thread-1 (]: 11 of 20 OK created sql table model GOLD.dim_patients .......................... [[32mSUCCESS 1[0m in 1.69s]
[0m01:20:05.549797 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m01:20:05.552202 [debug] [Thread-1 (]: Began running node model.healthcare.dim_providers
[0m01:20:05.553874 [info ] [Thread-1 (]: 12 of 20 SKIP relation GOLD.dim_providers ...................................... [[33mSKIP[0m]
[0m01:20:05.555486 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_providers
[0m01:20:05.557101 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m01:20:05.559220 [info ] [Thread-1 (]: 13 of 20 START sql table model GOLD.procedure_statistics ....................... [RUN]
[0m01:20:05.561412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_patients, now model.healthcare.procedure_statistics)
[0m01:20:05.563563 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m01:20:05.568423 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m01:20:05.594973 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m01:20:05.600244 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m01:20:05.622558 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m01:20:05.625837 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
         as
        (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
        );
[0m01:20:05.628915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:07.300785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.672 seconds
[0m01:20:07.304773 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: Close
[0m01:20:07.465369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a452f590>]}
[0m01:20:07.471011 [info ] [Thread-1 (]: 13 of 20 OK created sql table model GOLD.procedure_statistics .................. [[32mSUCCESS 1[0m in 1.90s]
[0m01:20:07.472703 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m01:20:07.475988 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:20:07.477945 [info ] [Thread-1 (]: 14 of 20 START sql table model GOLD.department_revenue_summary ................. [RUN]
[0m01:20:07.479607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.procedure_statistics, now model.healthcare.department_revenue_summary)
[0m01:20:07.482031 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:20:07.490597 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:20:07.512685 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:20:07.519623 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:20:07.543450 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:20:07.545626 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        department_id,
        COALESCE(CHARGE_amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.department_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.department_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY department_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
        );
[0m01:20:07.546894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:09.318810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.772 seconds
[0m01:20:09.325877 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: Close
[0m01:20:09.485016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a445ee10>]}
[0m01:20:09.488155 [info ] [Thread-1 (]: 14 of 20 OK created sql table model GOLD.department_revenue_summary ............ [[32mSUCCESS 1[0m in 2.00s]
[0m01:20:09.490896 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:20:09.495014 [debug] [Thread-1 (]: Began running node model.healthcare.patient_utilization_summary
[0m01:20:09.497740 [info ] [Thread-1 (]: 15 of 20 START sql table model GOLD.patient_utilization_summary ................ [RUN]
[0m01:20:09.500461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.department_revenue_summary, now model.healthcare.patient_utilization_summary)
[0m01:20:09.503410 [debug] [Thread-1 (]: Began compiling node model.healthcare.patient_utilization_summary
[0m01:20:09.508239 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.patient_utilization_summary"
[0m01:20:09.533687 [debug] [Thread-1 (]: Began executing node model.healthcare.patient_utilization_summary
[0m01:20:09.539396 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.patient_utilization_summary"
[0m01:20:09.558911 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.patient_utilization_summary"
[0m01:20:09.560326 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.patient_utilization_summary"} */
create or replace transient table DBT_DB.GOLD.patient_utilization_summary
         as
        (

-- Step 1: encounter counts per patient
WITH encounter_summary AS (
    SELECT
        patient_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY patient_id
),

-- Step 2: transaction summary per patient
transaction_summary AS (
    SELECT
        patient_id,
        COUNT(*) AS total_procedures,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY patient_id
),

-- Step 3: combine metrics at patient level
combined_metrics AS (
    SELECT
        COALESCE(e.patient_id, t.patient_id) AS patient_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_procedures, 0) AS total_procedures,
        COALESCE(total_charges, 0) AS total_charges
    FROM encounter_summary e
    FULL OUTER JOIN transaction_summary t
        ON e.patient_id = t.patient_id
),

-- Step 4: enrich with demographic data
final AS (
    SELECT
        cm.patient_id,
        p.first_name,
        p.last_name,
        p.gender_flag,
        p.age,
        p.age_group,
        cm.total_encounters,
        cm.total_procedures,
        cm.total_charges
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_patients p
        ON cm.patient_id = p.patient_key
)

SELECT * FROM final
        );
[0m01:20:09.562103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:11.337968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.776 seconds
[0m01:20:11.344112 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: Close
[0m01:20:11.508186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e21ed2-4d57-4f7b-ade5-b2c4f8c4a5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a4458d40>]}
[0m01:20:11.510894 [info ] [Thread-1 (]: 15 of 20 OK created sql table model GOLD.patient_utilization_summary ........... [[32mSUCCESS 1[0m in 2.01s]
[0m01:20:11.514423 [debug] [Thread-1 (]: Finished running node model.healthcare.patient_utilization_summary
[0m01:20:11.517761 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m01:20:11.520299 [info ] [Thread-1 (]: 16 of 20 SKIP relation GOLD.ar_balance_summary ................................. [[33mSKIP[0m]
[0m01:20:11.522485 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m01:20:11.524375 [debug] [Thread-1 (]: Began running node model.healthcare.denials_by_dept_provider
[0m01:20:11.526619 [info ] [Thread-1 (]: 17 of 20 SKIP relation GOLD.denials_by_dept_provider ........................... [[33mSKIP[0m]
[0m01:20:11.529399 [debug] [Thread-1 (]: Finished running node model.healthcare.denials_by_dept_provider
[0m01:20:11.532151 [debug] [Thread-1 (]: Began running node model.healthcare.missing_providers_audit
[0m01:20:11.534821 [info ] [Thread-1 (]: 18 of 20 SKIP relation GOLD.missing_providers_audit ............................ [[33mSKIP[0m]
[0m01:20:11.537799 [debug] [Thread-1 (]: Finished running node model.healthcare.missing_providers_audit
[0m01:20:11.540119 [debug] [Thread-1 (]: Began running node model.healthcare.provider_department_revenue_summary
[0m01:20:11.542450 [info ] [Thread-1 (]: 19 of 20 SKIP relation GOLD.provider_department_revenue_summary ................ [[33mSKIP[0m]
[0m01:20:11.544982 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_department_revenue_summary
[0m01:20:11.547375 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m01:20:11.549795 [info ] [Thread-1 (]: 20 of 20 SKIP relation GOLD.provider_performance_summary ....................... [[33mSKIP[0m]
[0m01:20:11.552228 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m01:20:11.557995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:11.561516 [debug] [MainThread]: Connection 'model.healthcare.patient_utilization_summary' was properly closed.
[0m01:20:11.565362 [info ] [MainThread]: 
[0m01:20:11.569569 [info ] [MainThread]: Finished running 7 view models, 13 table models in 0 hours 0 minutes and 22.11 seconds (22.11s).
[0m01:20:11.579103 [debug] [MainThread]: Command end result
[0m01:20:11.691099 [info ] [MainThread]: 
[0m01:20:11.694216 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:20:11.696476 [info ] [MainThread]: 
[0m01:20:11.698429 [error] [MainThread]:   Database Error in model src_providers (models/healthcare/staging/src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target/run/healthcare/models/healthcare/staging/src_providers.sql
[0m01:20:11.699868 [info ] [MainThread]: 
[0m01:20:11.701281 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=6 TOTAL=20
[0m01:20:11.703379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 24.062252, "process_user_time": 2.669943, "process_kernel_time": 0.335204, "process_mem_max_rss": "135972", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:20:11.704832 [debug] [MainThread]: Command `dbt run` failed at 01:20:11.704718 after 24.06 seconds
[0m01:20:11.706176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a75836e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a4fe3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02a4fe3560>]}
[0m01:20:11.707634 [debug] [MainThread]: Flushing usage events
[0m01:24:08.581838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C75204A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C75204BD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7520487A0>]}


============================== 01:24:08.581838 | 94caf232-cd38-4324-beb5-0f265045ddd2 ==============================
[0m01:24:08.581838 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:24:08.581838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjanaassignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_providers.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:24:09.461864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94caf232-cd38-4324-beb5-0f265045ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76BC31970>]}
[0m01:24:09.515465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94caf232-cd38-4324-beb5-0f265045ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76BCF7770>]}
[0m01:24:09.531301 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:24:09.766347 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:24:09.838149 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:24:09.838149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94caf232-cd38-4324-beb5-0f265045ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7526D7C80>]}
[0m01:24:10.971732 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:24:10.975120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94caf232-cd38-4324-beb5-0f265045ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76D7623F0>]}
[0m01:24:11.045405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:24:11.047386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:24:11.058407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94caf232-cd38-4324-beb5-0f265045ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76D81FC50>]}
[0m01:24:11.058407 [info ] [MainThread]: Found 20 models, 6 data tests, 2 sources, 477 macros
[0m01:24:11.058407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94caf232-cd38-4324-beb5-0f265045ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76D6AA990>]}
[0m01:24:11.071208 [info ] [MainThread]: 
[0m01:24:11.071208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:24:11.071208 [info ] [MainThread]: 
[0m01:24:11.071208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:24:11.074062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:24:11.128313 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:24:11.128313 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:24:11.128313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:11.825699 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.697 seconds
[0m01:24:11.833688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:24:11.843724 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:24:11.844229 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:24:11.844229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:12.368261 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.525 seconds
[0m01:24:12.372994 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:24:12.372994 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:24:12.492082 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.121 seconds
[0m01:24:12.496990 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:24:12.496990 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:24:12.594827 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m01:24:12.597344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:24:12.599353 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:24:12.601360 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:24:12.683271 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m01:24:12.699285 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:24:12.699285 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:24:12.826933 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.128 seconds
[0m01:24:12.829469 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:24:12.829469 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:24:12.933092 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m01:24:12.939623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94caf232-cd38-4324-beb5-0f265045ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76D79A660>]}
[0m01:24:12.946318 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m01:24:12.946318 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_providers ............................... [RUN]
[0m01:24:12.946318 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_providers'
[0m01:24:12.946318 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m01:24:12.953398 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m01:24:12.953398 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m01:24:12.979652 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m01:24:12.981653 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m01:24:12.982652 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    DepartmentID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m01:24:12.982652 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:24:13.659649 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be12a0-0000-289f-0027-cf8b000951be
[0m01:24:13.659649 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'DEPARTMENTID'
[0m01:24:13.669643 [debug] [Thread-1 (]: Database Error in model src_providers (models\healthcare\staging\src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_providers.sql
[0m01:24:13.675321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94caf232-cd38-4324-beb5-0f265045ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7520193D0>]}
[0m01:24:13.675321 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model SILVER.src_providers ...................... [[31mERROR[0m in 0.73s]
[0m01:24:13.675321 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m01:24:13.675321 [debug] [Thread-4 (]: Marking all children of 'model.healthcare.src_providers' to be skipped because of status 'error'.  Reason: Database Error in model src_providers (models\healthcare\staging\src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_providers.sql.
[0m01:24:13.675321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:13.675321 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:24:13.675321 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:24:13.820398 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:24:13.820398 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:24:13.962133 [debug] [MainThread]: Connection 'model.healthcare.src_providers' was left open.
[0m01:24:13.963648 [debug] [MainThread]: On model.healthcare.src_providers: Close
[0m01:24:14.121735 [info ] [MainThread]: 
[0m01:24:14.123738 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m01:24:14.123738 [debug] [MainThread]: Command end result
[0m01:24:14.150515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:24:14.150515 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:24:14.159851 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:24:14.160857 [info ] [MainThread]: 
[0m01:24:14.161529 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:24:14.161529 [info ] [MainThread]: 
[0m01:24:14.161529 [error] [MainThread]: [31mFailure in model src_providers (models\healthcare\staging\src_providers.sql)[0m
[0m01:24:14.161529 [error] [MainThread]:   Database Error in model src_providers (models\healthcare\staging\src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target\run\healthcare\models\healthcare\staging\src_providers.sql
[0m01:24:14.161529 [info ] [MainThread]: 
[0m01:24:14.161529 [info ] [MainThread]:   compiled code at target\compiled\healthcare\models\healthcare\staging\src_providers.sql
[0m01:24:14.161529 [info ] [MainThread]: 
[0m01:24:14.161529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:24:14.161529 [debug] [MainThread]: Command `dbt run` failed at 01:24:14.161529 after 5.79 seconds
[0m01:24:14.161529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76D523D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76D6F3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76D56AB10>]}
[0m01:24:14.161529 [debug] [MainThread]: Flushing usage events
[0m01:24:14.747590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:24:47.813576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382d8e1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382db6fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382dc4f0b0>]}


============================== 01:24:47.817671 | 0ded8b4c-b7cd-423d-81a3-153ad339e564 ==============================
[0m01:24:47.817671 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:24:47.819311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:24:48.128991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382d8b20c0>]}
[0m01:24:48.169903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382beb34d0>]}
[0m01:24:48.172214 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:24:48.189990 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:24:48.310938 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:24:48.312646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382be2d790>]}
[0m01:24:48.380389 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:24:48.383085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382e4ddca0>]}
[0m01:24:48.640442 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:24:48.656937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382a0e94c0>]}
[0m01:24:48.962406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773829f52d80>]}
[0m01:24:48.964913 [info ] [MainThread]: Found 20 models, 6 data tests, 2 sources, 455 macros
[0m01:24:48.966945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382f3648f0>]}
[0m01:24:48.971298 [info ] [MainThread]: 
[0m01:24:48.973902 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:24:48.981011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:24:49.004246 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:24:49.015799 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:24:49.018671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:49.788409 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.770 seconds
[0m01:24:49.792618 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:24:49.962357 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:24:49.965011 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:24:49.967907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:50.615637 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.648 seconds
[0m01:24:50.626963 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:24:50.779876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now list_DBT_DB_SILVER)
[0m01:24:50.792662 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:24:50.796190 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000
[0m01:24:50.799181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:51.415457 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.616 seconds
[0m01:24:51.422148 [debug] [ThreadPool]: On list_DBT_DB_SILVER: Close
[0m01:24:51.580115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:24:51.587496 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:24:51.588980 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000
[0m01:24:51.590466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:52.110882 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.520 seconds
[0m01:24:52.115287 [debug] [ThreadPool]: On list_DBT_DB_GOLD: Close
[0m01:24:52.269818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382bb5de80>]}
[0m01:24:52.272804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:24:52.277446 [info ] [MainThread]: 
[0m01:24:52.285408 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m01:24:52.288082 [info ] [Thread-1 (]: 1 of 20 START sql view model SILVER.src_claims ................................. [RUN]
[0m01:24:52.290379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now model.healthcare.src_claims)
[0m01:24:52.292618 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m01:24:52.308532 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m01:24:52.337658 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m01:24:52.360867 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m01:24:52.385307 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m01:24:52.386858 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

    case 
        when Hospital_ID = 'HOSP1' then replace(Patient_ID, 'HOSP1-', 'H1-')
        when Hospital_ID = 'HOSP2' then replace(Patient_ID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else Patient_ID
    end as patient_id,
    
    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m01:24:52.388072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:53.263797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.876 seconds
[0m01:24:53.283258 [debug] [Thread-1 (]: On model.healthcare.src_claims: Close
[0m01:24:53.453474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738294660c0>]}
[0m01:24:53.456629 [info ] [Thread-1 (]: 1 of 20 OK created sql view model SILVER.src_claims ............................ [[32mSUCCESS 1[0m in 1.16s]
[0m01:24:53.459160 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m01:24:53.461638 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m01:24:53.464143 [info ] [Thread-1 (]: 2 of 20 START sql view model SILVER.src_cptcodes ............................... [RUN]
[0m01:24:53.466396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m01:24:53.468175 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m01:24:53.471373 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m01:24:53.495159 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m01:24:53.499622 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m01:24:53.529259 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m01:24:53.531651 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m01:24:53.533945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:54.095255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m01:24:54.098999 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: Close
[0m01:24:54.263435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382943c6e0>]}
[0m01:24:54.266307 [info ] [Thread-1 (]: 2 of 20 OK created sql view model SILVER.src_cptcodes .......................... [[32mSUCCESS 1[0m in 0.80s]
[0m01:24:54.268653 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m01:24:54.270597 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m01:24:54.272441 [info ] [Thread-1 (]: 3 of 20 START sql view model SILVER.src_departments ............................ [RUN]
[0m01:24:54.274537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m01:24:54.276588 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m01:24:54.279280 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m01:24:54.296931 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m01:24:54.300075 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m01:24:54.322782 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m01:24:54.325029 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    
    -- Add encounter prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPARTMENT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPARTMENT_ID
        else Department_id
    end as department_id,
    
    DEPARTMENT_Name as department_name
from RAW_DEPARTMENTS
  );
[0m01:24:54.326859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:54.898775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m01:24:54.902552 [debug] [Thread-1 (]: On model.healthcare.src_departments: Close
[0m01:24:55.059927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738294b9100>]}
[0m01:24:55.063185 [info ] [Thread-1 (]: 3 of 20 OK created sql view model SILVER.src_departments ....................... [[32mSUCCESS 1[0m in 0.78s]
[0m01:24:55.066422 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m01:24:55.069206 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m01:24:55.071887 [info ] [Thread-1 (]: 4 of 20 START sql view model SILVER.src_encounters ............................. [RUN]
[0m01:24:55.074056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m01:24:55.075592 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m01:24:55.080271 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m01:24:55.103832 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m01:24:55.109090 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m01:24:55.132824 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m01:24:55.136318 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.raw.raw_encounters
)

select
    -- Add encounter prefix based on patient_id
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Encounter_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Encounter_ID
        else Encounter_ID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Provider_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || dept_id
        when Provider_key like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    Procedure_Code as procedure_code,
    Inserted_Date as inserted_date,
    Modified_Date as modified_date
from RAW_ENCOUNTERS
  );
[0m01:24:55.138357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:55.760651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m01:24:55.764629 [debug] [Thread-1 (]: On model.healthcare.src_encounters: Close
[0m01:24:55.929073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738294dc080>]}
[0m01:24:55.932184 [info ] [Thread-1 (]: 4 of 20 OK created sql view model SILVER.src_encounters ........................ [[32mSUCCESS 1[0m in 0.85s]
[0m01:24:55.935207 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m01:24:55.937560 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m01:24:55.939351 [info ] [Thread-1 (]: 5 of 20 START sql view model SILVER.src_patients ............................... [RUN]
[0m01:24:55.941259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m01:24:55.943335 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m01:24:55.947034 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m01:24:55.964214 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m01:24:55.968719 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m01:24:55.989321 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m01:24:55.992013 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    Patientid as patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m01:24:55.995166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:56.762515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m01:24:56.767916 [debug] [Thread-1 (]: On model.healthcare.src_patients: Close
[0m01:24:56.919079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738294ebb00>]}
[0m01:24:56.922207 [info ] [Thread-1 (]: 5 of 20 OK created sql view model SILVER.src_patients .......................... [[32mSUCCESS 1[0m in 0.98s]
[0m01:24:56.924635 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m01:24:56.927150 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m01:24:56.929554 [info ] [Thread-1 (]: 6 of 20 START sql view model SILVER.src_providers .............................. [RUN]
[0m01:24:56.931620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m01:24:56.933478 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m01:24:56.936577 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m01:24:56.977791 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m01:24:56.982042 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m01:24:57.019959 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m01:24:57.022675 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    DepartmentID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m01:24:57.024826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:57.612146 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be12a0-0000-2906-0027-cf8b0009718e
[0m01:24:57.616095 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'DEPARTMENTID'
[0m01:24:57.619738 [debug] [Thread-1 (]: On model.healthcare.src_providers: Close
[0m01:24:57.784801 [debug] [Thread-1 (]: Database Error in model src_providers (models/healthcare/staging/src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target/run/healthcare/models/healthcare/staging/src_providers.sql
[0m01:24:57.787548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382954dcd0>]}
[0m01:24:57.791053 [error] [Thread-1 (]: 6 of 20 ERROR creating sql view model SILVER.src_providers ..................... [[31mERROR[0m in 0.86s]
[0m01:24:57.794308 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m01:24:57.797590 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m01:24:57.801569 [info ] [Thread-1 (]: 7 of 20 START sql view model SILVER.src_transactions ........................... [RUN]
[0m01:24:57.804710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m01:24:57.807419 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m01:24:57.815250 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m01:24:57.848995 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m01:24:57.853688 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m01:24:57.879121 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m01:24:57.881021 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    case 
        when HospitalID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when HospitalID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id,
    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m01:24:57.883383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:58.523020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m01:24:58.527138 [debug] [Thread-1 (]: On model.healthcare.src_transactions: Close
[0m01:24:58.704415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738294e95b0>]}
[0m01:24:58.707596 [info ] [Thread-1 (]: 7 of 20 OK created sql view model SILVER.src_transactions ...................... [[32mSUCCESS 1[0m in 0.90s]
[0m01:24:58.710090 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m01:24:58.712481 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:24:58.714444 [info ] [Thread-1 (]: 8 of 20 START sql table model GOLD.claims_status_metrics ....................... [RUN]
[0m01:24:58.716507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.claims_status_metrics)
[0m01:24:58.718451 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:24:58.723186 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:24:58.741818 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:24:58.759276 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:24:58.782260 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:24:58.784256 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
         as
        (

with base as (
    select
        claim_status,
        try_to_date(claim_date) as claim_date
    from DBT_DB.SILVER.src_claims
    where claim_status is not null
),

agg as (
    select
        to_char(claim_date, 'YYYY-MM') as claim_month,
        upper(claim_status) as claim_status,
        count(*) as claim_count
    from base
    group by claim_month, claim_status
)

select * from agg
order by claim_month, claim_status
        );
[0m01:24:58.786122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:59.729592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.943 seconds
[0m01:24:59.736444 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: Close
[0m01:24:59.904710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738307738f0>]}
[0m01:24:59.907763 [info ] [Thread-1 (]: 8 of 20 OK created sql table model GOLD.claims_status_metrics .................. [[32mSUCCESS 1[0m in 1.19s]
[0m01:24:59.910541 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:24:59.913237 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m01:24:59.916485 [info ] [Thread-1 (]: 9 of 20 START sql table model GOLD.dim_cptcodes ................................ [RUN]
[0m01:24:59.919150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.claims_status_metrics, now model.healthcare.dim_cptcodes)
[0m01:24:59.921461 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m01:24:59.926137 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m01:24:59.945987 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m01:24:59.951993 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m01:24:59.978695 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m01:24:59.980523 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
         as
        (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_codes AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE procedure_code_category IS NOT NULL
)

SELECT * FROM cleaned_cpt
        );
[0m01:24:59.982814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:00.930740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m01:25:00.937950 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: Close
[0m01:25:01.083357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738283f8dd0>]}
[0m01:25:01.087839 [info ] [Thread-1 (]: 9 of 20 OK created sql table model GOLD.dim_cptcodes ........................... [[32mSUCCESS 1[0m in 1.16s]
[0m01:25:01.091727 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m01:25:01.094978 [debug] [Thread-1 (]: Began running node model.healthcare.dim_departments
[0m01:25:01.098258 [info ] [Thread-1 (]: 10 of 20 START sql table model GOLD.dim_departments ............................ [RUN]
[0m01:25:01.101301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_cptcodes, now model.healthcare.dim_departments)
[0m01:25:01.104109 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_departments
[0m01:25:01.111549 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_departments"
[0m01:25:01.137704 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_departments
[0m01:25:01.141073 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_departments"
[0m01:25:01.166469 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_departments"
[0m01:25:01.168601 [debug] [Thread-1 (]: On model.healthcare.dim_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_departments"} */
create or replace transient table DBT_DB.GOLD.dim_departments
         as
        (

WITH deduplicated_departments AS (
    SELECT DISTINCT department_id, department_name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    department_id AS department_key,
    INITCAP(department_name) AS department_name
FROM deduplicated_departments
        );
[0m01:25:01.170506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:02.361859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.191 seconds
[0m01:25:02.368525 [debug] [Thread-1 (]: On model.healthcare.dim_departments: Close
[0m01:25:02.518944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382840e3c0>]}
[0m01:25:02.522659 [info ] [Thread-1 (]: 10 of 20 OK created sql table model GOLD.dim_departments ....................... [[32mSUCCESS 1[0m in 1.42s]
[0m01:25:02.525162 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_departments
[0m01:25:02.527852 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m01:25:02.531528 [info ] [Thread-1 (]: 11 of 20 START sql table model GOLD.dim_patients ............................... [RUN]
[0m01:25:02.534736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_departments, now model.healthcare.dim_patients)
[0m01:25:02.537782 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m01:25:02.543793 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m01:25:02.566249 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m01:25:02.571121 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m01:25:02.593743 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m01:25:02.596661 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (

with base as (
    select * 
    from DBT_DB.SILVER.src_patients
),

deduplicated as (
    select * 
    from base
    qualify row_number() over (partition by patient_id order by modified_date desc) = 1
),

final as (
    select
        patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated
)

select * from final
        );
[0m01:25:02.598926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:04.372141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.773 seconds
[0m01:25:04.376365 [debug] [Thread-1 (]: On model.healthcare.dim_patients: Close
[0m01:25:04.536184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738283e25d0>]}
[0m01:25:04.542206 [info ] [Thread-1 (]: 11 of 20 OK created sql table model GOLD.dim_patients .......................... [[32mSUCCESS 1[0m in 2.00s]
[0m01:25:04.544998 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m01:25:04.547185 [debug] [Thread-1 (]: Began running node model.healthcare.dim_providers
[0m01:25:04.554965 [info ] [Thread-1 (]: 12 of 20 SKIP relation GOLD.dim_providers ...................................... [[33mSKIP[0m]
[0m01:25:04.568750 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_providers
[0m01:25:04.571627 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m01:25:04.574002 [info ] [Thread-1 (]: 13 of 20 START sql table model GOLD.procedure_statistics ....................... [RUN]
[0m01:25:04.576534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_patients, now model.healthcare.procedure_statistics)
[0m01:25:04.579158 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m01:25:04.584738 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m01:25:04.610424 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m01:25:04.615912 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m01:25:04.636841 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m01:25:04.639192 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
         as
        (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
        );
[0m01:25:04.641426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:06.041557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m01:25:06.051967 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: Close
[0m01:25:06.205017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738294cfec0>]}
[0m01:25:06.209215 [info ] [Thread-1 (]: 13 of 20 OK created sql table model GOLD.procedure_statistics .................. [[32mSUCCESS 1[0m in 1.63s]
[0m01:25:06.212948 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m01:25:06.216832 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:25:06.220509 [info ] [Thread-1 (]: 14 of 20 START sql table model GOLD.department_revenue_summary ................. [RUN]
[0m01:25:06.222781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.procedure_statistics, now model.healthcare.department_revenue_summary)
[0m01:25:06.225004 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:25:06.229353 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:25:06.259026 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:25:06.265829 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:25:06.294621 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:25:06.297352 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        department_id,
        COALESCE(CHARGE_amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.department_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.department_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY department_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
        );
[0m01:25:06.300252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:07.648063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.348 seconds
[0m01:25:07.653334 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: Close
[0m01:25:07.802592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738294baa20>]}
[0m01:25:07.806702 [info ] [Thread-1 (]: 14 of 20 OK created sql table model GOLD.department_revenue_summary ............ [[32mSUCCESS 1[0m in 1.58s]
[0m01:25:07.810149 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:25:07.814145 [debug] [Thread-1 (]: Began running node model.healthcare.patient_utilization_summary
[0m01:25:07.817038 [info ] [Thread-1 (]: 15 of 20 START sql table model GOLD.patient_utilization_summary ................ [RUN]
[0m01:25:07.821081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.department_revenue_summary, now model.healthcare.patient_utilization_summary)
[0m01:25:07.823906 [debug] [Thread-1 (]: Began compiling node model.healthcare.patient_utilization_summary
[0m01:25:07.830762 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.patient_utilization_summary"
[0m01:25:07.864629 [debug] [Thread-1 (]: Began executing node model.healthcare.patient_utilization_summary
[0m01:25:07.870450 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.patient_utilization_summary"
[0m01:25:07.894060 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.patient_utilization_summary"
[0m01:25:07.895995 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.patient_utilization_summary"} */
create or replace transient table DBT_DB.GOLD.patient_utilization_summary
         as
        (

-- Step 1: encounter counts per patient
WITH encounter_summary AS (
    SELECT
        patient_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY patient_id
),

-- Step 2: transaction summary per patient
transaction_summary AS (
    SELECT
        patient_id,
        COUNT(*) AS total_procedures,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY patient_id
),

-- Step 3: combine metrics at patient level
combined_metrics AS (
    SELECT
        COALESCE(e.patient_id, t.patient_id) AS patient_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_procedures, 0) AS total_procedures,
        COALESCE(total_charges, 0) AS total_charges
    FROM encounter_summary e
    FULL OUTER JOIN transaction_summary t
        ON e.patient_id = t.patient_id
),

-- Step 4: enrich with demographic data
final AS (
    SELECT
        cm.patient_id,
        p.first_name,
        p.last_name,
        p.gender_flag,
        p.age,
        p.age_group,
        cm.total_encounters,
        cm.total_procedures,
        cm.total_charges
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_patients p
        ON cm.patient_id = p.patient_key
)

SELECT * FROM final
        );
[0m01:25:07.897716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:09.546484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.649 seconds
[0m01:25:09.550145 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: Close
[0m01:25:09.703176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ded8b4c-b7cd-423d-81a3-153ad339e564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7738294b9550>]}
[0m01:25:09.706482 [info ] [Thread-1 (]: 15 of 20 OK created sql table model GOLD.patient_utilization_summary ........... [[32mSUCCESS 1[0m in 1.88s]
[0m01:25:09.709622 [debug] [Thread-1 (]: Finished running node model.healthcare.patient_utilization_summary
[0m01:25:09.711450 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m01:25:09.713749 [info ] [Thread-1 (]: 16 of 20 SKIP relation GOLD.ar_balance_summary ................................. [[33mSKIP[0m]
[0m01:25:09.716340 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m01:25:09.719067 [debug] [Thread-1 (]: Began running node model.healthcare.denials_by_dept_provider
[0m01:25:09.721242 [info ] [Thread-1 (]: 17 of 20 SKIP relation GOLD.denials_by_dept_provider ........................... [[33mSKIP[0m]
[0m01:25:09.723586 [debug] [Thread-1 (]: Finished running node model.healthcare.denials_by_dept_provider
[0m01:25:09.725486 [debug] [Thread-1 (]: Began running node model.healthcare.missing_providers_audit
[0m01:25:09.727284 [info ] [Thread-1 (]: 18 of 20 SKIP relation GOLD.missing_providers_audit ............................ [[33mSKIP[0m]
[0m01:25:09.729482 [debug] [Thread-1 (]: Finished running node model.healthcare.missing_providers_audit
[0m01:25:09.731346 [debug] [Thread-1 (]: Began running node model.healthcare.provider_department_revenue_summary
[0m01:25:09.733319 [info ] [Thread-1 (]: 19 of 20 SKIP relation GOLD.provider_department_revenue_summary ................ [[33mSKIP[0m]
[0m01:25:09.735430 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_department_revenue_summary
[0m01:25:09.737661 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m01:25:09.739149 [info ] [Thread-1 (]: 20 of 20 SKIP relation GOLD.provider_performance_summary ....................... [[33mSKIP[0m]
[0m01:25:09.740388 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m01:25:09.743200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:09.744733 [debug] [MainThread]: Connection 'model.healthcare.patient_utilization_summary' was properly closed.
[0m01:25:09.746559 [info ] [MainThread]: 
[0m01:25:09.748656 [info ] [MainThread]: Finished running 7 view models, 13 table models in 0 hours 0 minutes and 20.77 seconds (20.77s).
[0m01:25:09.752530 [debug] [MainThread]: Command end result
[0m01:25:09.886912 [info ] [MainThread]: 
[0m01:25:09.891292 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:25:09.893847 [info ] [MainThread]: 
[0m01:25:09.897444 [error] [MainThread]:   Database Error in model src_providers (models/healthcare/staging/src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target/run/healthcare/models/healthcare/staging/src_providers.sql
[0m01:25:09.899443 [info ] [MainThread]: 
[0m01:25:09.902003 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=6 TOTAL=20
[0m01:25:09.904729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 23.816938, "process_user_time": 3.349826, "process_kernel_time": 0.353827, "process_mem_max_rss": "142344", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:25:09.907077 [debug] [MainThread]: Command `dbt run` failed at 01:25:09.906938 after 23.82 seconds
[0m01:25:09.910566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773829502180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382e131040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77382e130da0>]}
[0m01:25:09.913740 [debug] [MainThread]: Flushing usage events
[0m01:25:16.083540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6108d0cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6108d0f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ae81eb0>]}


============================== 01:25:16.088521 | c5aa1014-c284-4ce6-886d-b4fa9306e1e5 ==============================
[0m01:25:16.088521 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:25:16.090567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:25:16.424364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6106a0c1d0>]}
[0m01:25:16.473284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6108d2fd70>]}
[0m01:25:16.476480 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:25:16.504173 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:25:17.583735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:17.586961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:17.594162 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:25:17.629705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6106b062d0>]}
[0m01:25:17.812444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61067fe4e0>]}
[0m01:25:17.816638 [info ] [MainThread]: Found 20 models, 6 data tests, 2 sources, 455 macros
[0m01:25:17.818488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61066f2090>]}
[0m01:25:17.824475 [info ] [MainThread]: 
[0m01:25:17.826431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:25:17.836570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:25:17.853028 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:25:17.854890 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:25:17.857984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:18.682972 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.825 seconds
[0m01:25:18.686086 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:25:18.868750 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:25:18.872154 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:25:18.875898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:19.497703 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.622 seconds
[0m01:25:19.502986 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:25:19.660724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now list_DBT_DB_SILVER)
[0m01:25:19.671981 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:25:19.676460 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000
[0m01:25:19.679231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:20.142046 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.463 seconds
[0m01:25:20.145974 [debug] [ThreadPool]: On list_DBT_DB_SILVER: Close
[0m01:25:20.320572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:25:20.328062 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:25:20.330170 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000
[0m01:25:20.331641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:19.426041 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.619 seconds
[0m01:25:19.430467 [debug] [ThreadPool]: On list_DBT_DB_GOLD: Close
[0m01:25:19.589370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6106a1cbc0>]}
[0m01:25:19.593999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:19.597193 [info ] [MainThread]: 
[0m01:25:19.609170 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m01:25:19.612005 [info ] [Thread-1 (]: 1 of 20 START sql view model SILVER.src_claims ................................. [RUN]
[0m01:25:19.614136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now model.healthcare.src_claims)
[0m01:25:19.615759 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m01:25:19.624293 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m01:25:19.642962 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m01:25:19.683652 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m01:25:19.708411 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m01:25:19.711184 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

    case 
        when Hospital_ID = 'HOSP1' then replace(Patient_ID, 'HOSP1-', 'H1-')
        when Hospital_ID = 'HOSP2' then replace(Patient_ID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else Patient_ID
    end as patient_id,
    
    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m01:25:19.713965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:20.387614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m01:25:20.413184 [debug] [Thread-1 (]: On model.healthcare.src_claims: Close
[0m01:25:20.560501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105b5fad0>]}
[0m01:25:20.562672 [info ] [Thread-1 (]: 1 of 20 OK created sql view model SILVER.src_claims ............................ [[32mSUCCESS 1[0m in 0.95s]
[0m01:25:20.566242 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m01:25:20.569181 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m01:25:20.573488 [info ] [Thread-1 (]: 2 of 20 START sql view model SILVER.src_cptcodes ............................... [RUN]
[0m01:25:20.575346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m01:25:20.576562 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m01:25:20.579682 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m01:25:20.599072 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m01:25:20.607516 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m01:25:20.636461 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m01:25:20.639920 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m01:25:20.642733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:21.346724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m01:25:21.353788 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: Close
[0m01:25:21.510501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105b9b920>]}
[0m01:25:21.514754 [info ] [Thread-1 (]: 2 of 20 OK created sql view model SILVER.src_cptcodes .......................... [[32mSUCCESS 1[0m in 0.93s]
[0m01:25:21.518642 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m01:25:21.522535 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m01:25:21.525105 [info ] [Thread-1 (]: 3 of 20 START sql view model SILVER.src_departments ............................ [RUN]
[0m01:25:21.528606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m01:25:21.532090 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m01:25:21.537640 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m01:25:21.572909 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m01:25:21.578477 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m01:25:21.606102 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m01:25:21.608433 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    
    -- Add encounter prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPARTMENT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPARTMENT_ID
        else Department_id
    end as department_id,
    
    DEPARTMENT_Name as department_name
from RAW_DEPARTMENTS
  );
[0m01:25:21.610971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:22.183224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m01:25:22.189759 [debug] [Thread-1 (]: On model.healthcare.src_departments: Close
[0m01:25:22.336034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105d16990>]}
[0m01:25:22.340768 [info ] [Thread-1 (]: 3 of 20 OK created sql view model SILVER.src_departments ....................... [[32mSUCCESS 1[0m in 0.81s]
[0m01:25:22.344726 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m01:25:22.349167 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m01:25:22.353007 [info ] [Thread-1 (]: 4 of 20 START sql view model SILVER.src_encounters ............................. [RUN]
[0m01:25:22.357013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m01:25:22.360666 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m01:25:22.367085 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m01:25:22.404135 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m01:25:22.410014 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m01:25:22.434015 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m01:25:22.435956 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.raw.raw_encounters
)

select
    -- Add encounter prefix based on patient_id
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Encounter_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Encounter_ID
        else Encounter_ID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Provider_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || dept_id
        when Provider_key like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    Procedure_Code as procedure_code,
    Inserted_Date as inserted_date,
    Modified_Date as modified_date
from RAW_ENCOUNTERS
  );
[0m01:25:22.438045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:22.966371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m01:25:22.971891 [debug] [Thread-1 (]: On model.healthcare.src_encounters: Close
[0m01:25:23.137795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105ca7d70>]}
[0m01:25:23.141332 [info ] [Thread-1 (]: 4 of 20 OK created sql view model SILVER.src_encounters ........................ [[32mSUCCESS 1[0m in 0.78s]
[0m01:25:23.144758 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m01:25:23.147917 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m01:25:23.150915 [info ] [Thread-1 (]: 5 of 20 START sql view model SILVER.src_patients ............................... [RUN]
[0m01:25:23.152698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m01:25:23.154360 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m01:25:23.158869 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m01:25:23.177783 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m01:25:23.182797 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m01:25:23.205507 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m01:25:23.207333 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    Patientid as patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m01:25:23.209117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:23.948986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m01:25:23.955624 [debug] [Thread-1 (]: On model.healthcare.src_patients: Close
[0m01:25:24.107644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105be7050>]}
[0m01:25:24.109168 [info ] [Thread-1 (]: 5 of 20 OK created sql view model SILVER.src_patients .......................... [[32mSUCCESS 1[0m in 0.95s]
[0m01:25:24.110816 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m01:25:24.114891 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m01:25:24.116889 [info ] [Thread-1 (]: 6 of 20 START sql view model SILVER.src_providers .............................. [RUN]
[0m01:25:24.118549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m01:25:24.120793 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m01:25:24.123437 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m01:25:24.150249 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m01:25:24.156646 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m01:25:24.185610 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m01:25:24.188496 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)
select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    DepartmentID as dept_id,
    NPI as npi
from RAW_PROVIDERS
  );
[0m01:25:24.191476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:24.782822 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be12a1-0000-2906-0027-cf8b0009719e
[0m01:25:24.785876 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'DEPARTMENTID'
[0m01:25:24.789252 [debug] [Thread-1 (]: On model.healthcare.src_providers: Close
[0m01:25:24.967532 [debug] [Thread-1 (]: Database Error in model src_providers (models/healthcare/staging/src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target/run/healthcare/models/healthcare/staging/src_providers.sql
[0m01:25:24.970405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105b83080>]}
[0m01:25:24.973254 [error] [Thread-1 (]: 6 of 20 ERROR creating sql view model SILVER.src_providers ..................... [[31mERROR[0m in 0.85s]
[0m01:25:24.975958 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m01:25:24.978789 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m01:25:24.981648 [info ] [Thread-1 (]: 7 of 20 START sql view model SILVER.src_transactions ........................... [RUN]
[0m01:25:24.983945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m01:25:24.985898 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m01:25:24.991043 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m01:25:25.019932 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m01:25:25.026451 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m01:25:25.056661 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m01:25:25.059396 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    case 
        when HospitalID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when HospitalID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id,
    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m01:25:25.061843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:25.757558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m01:25:25.761888 [debug] [Thread-1 (]: On model.healthcare.src_transactions: Close
[0m01:25:25.917719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105c03bc0>]}
[0m01:25:25.920015 [info ] [Thread-1 (]: 7 of 20 OK created sql view model SILVER.src_transactions ...................... [[32mSUCCESS 1[0m in 0.93s]
[0m01:25:25.922542 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m01:25:25.924091 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:25:25.926535 [info ] [Thread-1 (]: 8 of 20 START sql table model GOLD.claims_status_metrics ....................... [RUN]
[0m01:25:25.929242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.claims_status_metrics)
[0m01:25:25.930908 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:25:25.934230 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:25:25.955984 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:25:25.975288 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:25:26.001850 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:25:26.004522 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
         as
        (

with base as (
    select
        claim_status,
        try_to_date(claim_date) as claim_date
    from DBT_DB.SILVER.src_claims
    where claim_status is not null
),

agg as (
    select
        to_char(claim_date, 'YYYY-MM') as claim_month,
        upper(claim_status) as claim_status,
        count(*) as claim_count
    from base
    group by claim_month, claim_status
)

select * from agg
order by claim_month, claim_status
        );
[0m01:25:26.007424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:27.207086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.200 seconds
[0m01:25:27.210397 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: Close
[0m01:25:27.367960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61065c7b60>]}
[0m01:25:27.371148 [info ] [Thread-1 (]: 8 of 20 OK created sql table model GOLD.claims_status_metrics .................. [[32mSUCCESS 1[0m in 1.44s]
[0m01:25:27.373520 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:25:27.375240 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m01:25:27.377944 [info ] [Thread-1 (]: 9 of 20 START sql table model GOLD.dim_cptcodes ................................ [RUN]
[0m01:25:27.379914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.claims_status_metrics, now model.healthcare.dim_cptcodes)
[0m01:25:27.381686 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m01:25:27.385998 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m01:25:27.409552 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m01:25:27.416355 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m01:25:27.443164 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m01:25:27.445336 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
         as
        (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_codes AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE procedure_code_category IS NOT NULL
)

SELECT * FROM cleaned_cpt
        );
[0m01:25:27.449640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:28.676344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.227 seconds
[0m01:25:28.680500 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: Close
[0m01:25:28.832822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105d231a0>]}
[0m01:25:28.834764 [info ] [Thread-1 (]: 9 of 20 OK created sql table model GOLD.dim_cptcodes ........................... [[32mSUCCESS 1[0m in 1.45s]
[0m01:25:28.836815 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m01:25:28.838101 [debug] [Thread-1 (]: Began running node model.healthcare.dim_departments
[0m01:25:28.839678 [info ] [Thread-1 (]: 10 of 20 START sql table model GOLD.dim_departments ............................ [RUN]
[0m01:25:28.841286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_cptcodes, now model.healthcare.dim_departments)
[0m01:25:28.843598 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_departments
[0m01:25:28.846682 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_departments"
[0m01:25:28.866645 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_departments
[0m01:25:28.872637 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_departments"
[0m01:25:28.894794 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_departments"
[0m01:25:28.898058 [debug] [Thread-1 (]: On model.healthcare.dim_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_departments"} */
create or replace transient table DBT_DB.GOLD.dim_departments
         as
        (

WITH deduplicated_departments AS (
    SELECT DISTINCT department_id, department_name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    department_id AS department_key,
    INITCAP(department_name) AS department_name
FROM deduplicated_departments
        );
[0m01:25:28.900419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:29.870706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.970 seconds
[0m01:25:29.874946 [debug] [Thread-1 (]: On model.healthcare.dim_departments: Close
[0m01:25:30.032219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610412be60>]}
[0m01:25:30.034796 [info ] [Thread-1 (]: 10 of 20 OK created sql table model GOLD.dim_departments ....................... [[32mSUCCESS 1[0m in 1.19s]
[0m01:25:30.037955 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_departments
[0m01:25:30.040193 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m01:25:30.044335 [info ] [Thread-1 (]: 11 of 20 START sql table model GOLD.dim_patients ............................... [RUN]
[0m01:25:30.047216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_departments, now model.healthcare.dim_patients)
[0m01:25:30.049052 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m01:25:30.054275 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m01:25:30.079994 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m01:25:30.086399 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m01:25:30.111710 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m01:25:30.116866 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (

with base as (
    select * 
    from DBT_DB.SILVER.src_patients
),

deduplicated as (
    select * 
    from base
    qualify row_number() over (partition by patient_id order by modified_date desc) = 1
),

final as (
    select
        patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated
)

select * from final
        );
[0m01:25:30.120583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:31.287032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m01:25:31.293847 [debug] [Thread-1 (]: On model.healthcare.dim_patients: Close
[0m01:25:31.454154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610412ce30>]}
[0m01:25:31.457189 [info ] [Thread-1 (]: 11 of 20 OK created sql table model GOLD.dim_patients .......................... [[32mSUCCESS 1[0m in 1.41s]
[0m01:25:31.459442 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m01:25:31.460868 [debug] [Thread-1 (]: Began running node model.healthcare.dim_providers
[0m01:25:31.461860 [info ] [Thread-1 (]: 12 of 20 SKIP relation GOLD.dim_providers ...................................... [[33mSKIP[0m]
[0m01:25:31.463109 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_providers
[0m01:25:31.464288 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m01:25:31.465876 [info ] [Thread-1 (]: 13 of 20 START sql table model GOLD.procedure_statistics ....................... [RUN]
[0m01:25:31.467585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_patients, now model.healthcare.procedure_statistics)
[0m01:25:31.469595 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m01:25:31.474313 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m01:25:31.495471 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m01:25:31.499480 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m01:25:31.523054 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m01:25:31.526475 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
         as
        (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
        );
[0m01:25:31.528303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:32.738271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.210 seconds
[0m01:25:32.741649 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: Close
[0m01:25:32.893792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105b83ef0>]}
[0m01:25:32.897708 [info ] [Thread-1 (]: 13 of 20 OK created sql table model GOLD.procedure_statistics .................. [[32mSUCCESS 1[0m in 1.43s]
[0m01:25:32.901626 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m01:25:32.905482 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:25:32.909940 [info ] [Thread-1 (]: 14 of 20 START sql table model GOLD.department_revenue_summary ................. [RUN]
[0m01:25:32.915552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.procedure_statistics, now model.healthcare.department_revenue_summary)
[0m01:25:32.922653 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:25:32.930480 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:25:32.958605 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:25:32.964900 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:25:32.991508 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:25:32.993357 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        department_id,
        COALESCE(CHARGE_amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.department_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.department_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY department_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
        );
[0m01:25:32.996302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:34.335806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.339 seconds
[0m01:25:34.340223 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: Close
[0m01:25:34.497115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105b80590>]}
[0m01:25:34.501569 [info ] [Thread-1 (]: 14 of 20 OK created sql table model GOLD.department_revenue_summary ............ [[32mSUCCESS 1[0m in 1.58s]
[0m01:25:34.506529 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:25:34.510511 [debug] [Thread-1 (]: Began running node model.healthcare.patient_utilization_summary
[0m01:25:34.514692 [info ] [Thread-1 (]: 15 of 20 START sql table model GOLD.patient_utilization_summary ................ [RUN]
[0m01:25:34.518720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.department_revenue_summary, now model.healthcare.patient_utilization_summary)
[0m01:25:34.522541 [debug] [Thread-1 (]: Began compiling node model.healthcare.patient_utilization_summary
[0m01:25:34.530960 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.patient_utilization_summary"
[0m01:25:34.563281 [debug] [Thread-1 (]: Began executing node model.healthcare.patient_utilization_summary
[0m01:25:34.569411 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.patient_utilization_summary"
[0m01:25:34.597312 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.patient_utilization_summary"
[0m01:25:34.599943 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.patient_utilization_summary"} */
create or replace transient table DBT_DB.GOLD.patient_utilization_summary
         as
        (

-- Step 1: encounter counts per patient
WITH encounter_summary AS (
    SELECT
        patient_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY patient_id
),

-- Step 2: transaction summary per patient
transaction_summary AS (
    SELECT
        patient_id,
        COUNT(*) AS total_procedures,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY patient_id
),

-- Step 3: combine metrics at patient level
combined_metrics AS (
    SELECT
        COALESCE(e.patient_id, t.patient_id) AS patient_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_procedures, 0) AS total_procedures,
        COALESCE(total_charges, 0) AS total_charges
    FROM encounter_summary e
    FULL OUTER JOIN transaction_summary t
        ON e.patient_id = t.patient_id
),

-- Step 4: enrich with demographic data
final AS (
    SELECT
        cm.patient_id,
        p.first_name,
        p.last_name,
        p.gender_flag,
        p.age,
        p.age_group,
        cm.total_encounters,
        cm.total_procedures,
        cm.total_charges
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_patients p
        ON cm.patient_id = p.patient_key
)

SELECT * FROM final
        );
[0m01:25:34.606551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:36.166322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.560 seconds
[0m01:25:36.170961 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: Close
[0m01:25:36.334867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aa1014-c284-4ce6-886d-b4fa9306e1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105b982c0>]}
[0m01:25:36.338158 [info ] [Thread-1 (]: 15 of 20 OK created sql table model GOLD.patient_utilization_summary ........... [[32mSUCCESS 1[0m in 1.82s]
[0m01:25:36.340468 [debug] [Thread-1 (]: Finished running node model.healthcare.patient_utilization_summary
[0m01:25:36.342708 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m01:25:36.346218 [info ] [Thread-1 (]: 16 of 20 SKIP relation GOLD.ar_balance_summary ................................. [[33mSKIP[0m]
[0m01:25:36.350430 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m01:25:36.352672 [debug] [Thread-1 (]: Began running node model.healthcare.denials_by_dept_provider
[0m01:25:36.354789 [info ] [Thread-1 (]: 17 of 20 SKIP relation GOLD.denials_by_dept_provider ........................... [[33mSKIP[0m]
[0m01:25:36.356180 [debug] [Thread-1 (]: Finished running node model.healthcare.denials_by_dept_provider
[0m01:25:36.358243 [debug] [Thread-1 (]: Began running node model.healthcare.missing_providers_audit
[0m01:25:36.360285 [info ] [Thread-1 (]: 18 of 20 SKIP relation GOLD.missing_providers_audit ............................ [[33mSKIP[0m]
[0m01:25:36.364415 [debug] [Thread-1 (]: Finished running node model.healthcare.missing_providers_audit
[0m01:25:36.367035 [debug] [Thread-1 (]: Began running node model.healthcare.provider_department_revenue_summary
[0m01:25:36.368876 [info ] [Thread-1 (]: 19 of 20 SKIP relation GOLD.provider_department_revenue_summary ................ [[33mSKIP[0m]
[0m01:25:36.371257 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_department_revenue_summary
[0m01:25:36.372729 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m01:25:36.374337 [info ] [Thread-1 (]: 20 of 20 SKIP relation GOLD.provider_performance_summary ....................... [[33mSKIP[0m]
[0m01:25:36.376046 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m01:25:36.380696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:36.382756 [debug] [MainThread]: Connection 'model.healthcare.patient_utilization_summary' was properly closed.
[0m01:25:36.385252 [info ] [MainThread]: 
[0m01:25:36.386752 [info ] [MainThread]: Finished running 7 view models, 13 table models in 0 hours 0 minutes and 18.56 seconds (18.56s).
[0m01:25:36.390258 [debug] [MainThread]: Command end result
[0m01:25:36.514698 [info ] [MainThread]: 
[0m01:25:36.517740 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:25:36.520632 [info ] [MainThread]: 
[0m01:25:36.523310 [error] [MainThread]:   Database Error in model src_providers (models/healthcare/staging/src_providers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'DEPARTMENTID'
  compiled code at target/run/healthcare/models/healthcare/staging/src_providers.sql
[0m01:25:36.527150 [info ] [MainThread]: 
[0m01:25:36.529288 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=6 TOTAL=20
[0m01:25:36.532135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.147867, "process_user_time": 3.000813, "process_kernel_time": 0.380331, "process_mem_max_rss": "136188", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:25:36.533978 [debug] [MainThread]: Command `dbt run` failed at 01:25:36.533816 after 22.15 seconds
[0m01:25:36.535463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6109417260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61068a4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6108de04a0>]}
[0m01:25:36.537014 [debug] [MainThread]: Flushing usage events
[0m01:31:07.506798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DBC3F1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DBC3F1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DBC3F13D0>]}


============================== 01:31:07.510803 | 53f5d625-09c7-495a-a3fb-15f0384e3a6f ==============================
[0m01:31:07.510803 [info ] [MainThread]: Running with dbt=1.10.2
[0m01:31:07.510803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\sanja\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\sanja\\OneDrive\\Documents\\sanjanaassignments\\snowflake\\sf-org-pipeline\\dbt\\healthcare\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select src_providers.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:31:08.368627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53f5d625-09c7-495a-a3fb-15f0384e3a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD64BBAD0>]}
[0m01:31:08.420389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53f5d625-09c7-495a-a3fb-15f0384e3a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DB90CE330>]}
[0m01:31:08.420389 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:31:08.667684 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m01:31:08.731625 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:31:08.731625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '53f5d625-09c7-495a-a3fb-15f0384e3a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD68EC650>]}
[0m01:31:09.799983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.fact
- models.healthcare.dim
[0m01:31:09.816839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53f5d625-09c7-495a-a3fb-15f0384e3a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD6A48500>]}
[0m01:31:09.882569 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:31:09.884568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:31:09.903604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53f5d625-09c7-495a-a3fb-15f0384e3a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD6CF7830>]}
[0m01:31:09.903604 [info ] [MainThread]: Found 20 models, 6 data tests, 2 sources, 477 macros
[0m01:31:09.903604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53f5d625-09c7-495a-a3fb-15f0384e3a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD64D8E60>]}
[0m01:31:09.910639 [info ] [MainThread]: 
[0m01:31:09.910639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:09.910639 [info ] [MainThread]: 
[0m01:31:09.912653 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:31:09.912653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:31:09.954790 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:31:09.954790 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:31:09.954790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:10.696397 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.734 seconds
[0m01:31:10.696397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:31:10.714903 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:31:10.714903 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:31:10.714903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:11.310725 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.601 seconds
[0m01:31:11.319180 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:31:11.319995 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER
    limit 10000
    
;
[0m01:31:11.430229 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.113 seconds
[0m01:31:11.430229 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:31:11.430229 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:11.517646 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m01:31:11.526298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:31:11.529288 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:31:11.529288 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:31:11.617626 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m01:31:11.621722 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:31:11.621722 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD
    limit 10000
    
;
[0m01:31:11.746073 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.120 seconds
[0m01:31:11.746073 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:31:11.746073 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:11.852402 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m01:31:11.852402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53f5d625-09c7-495a-a3fb-15f0384e3a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD6AE2C90>]}
[0m01:31:11.852402 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m01:31:11.852402 [info ] [Thread-1 (]: 1 of 1 START sql view model SILVER.src_providers ............................... [RUN]
[0m01:31:11.852402 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.healthcare.src_providers'
[0m01:31:11.852402 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m01:31:11.868235 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m01:31:11.868235 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m01:31:11.892151 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m01:31:11.892151 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m01:31:11.892151 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)

select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    DEPT_ID as dept_id,
    NPI as npi,
    
    case 
        when split_part(DEPARTMENT_KEY, '-', 1) = 'HOSP1' then 'H1'
        when split_part(DEPARTMENT_KEY, '-', 1) = 'HOSP2' then 'H2'
        else 'UNKNOWN'
    end as hospital_code

from RAW_PROVIDERS
  );
[0m01:31:11.896164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:12.420604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m01:31:12.437578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53f5d625-09c7-495a-a3fb-15f0384e3a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DB90CD520>]}
[0m01:31:12.437578 [info ] [Thread-1 (]: 1 of 1 OK created sql view model SILVER.src_providers .......................... [[32mSUCCESS 1[0m in 0.59s]
[0m01:31:12.437578 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m01:31:12.437578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:12.437578 [debug] [MainThread]: Connection 'list_DBT_DB' was left open.
[0m01:31:12.437578 [debug] [MainThread]: On list_DBT_DB: Close
[0m01:31:12.587477 [debug] [MainThread]: Connection 'list_DBT_DB_GOLD' was left open.
[0m01:31:12.595215 [debug] [MainThread]: On list_DBT_DB_GOLD: Close
[0m01:31:12.746789 [debug] [MainThread]: Connection 'model.healthcare.src_providers' was left open.
[0m01:31:12.746789 [debug] [MainThread]: On model.healthcare.src_providers: Close
[0m01:31:12.887454 [info ] [MainThread]: 
[0m01:31:12.887454 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m01:31:12.903654 [debug] [MainThread]: Command end result
[0m01:31:12.929681 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\manifest.json
[0m01:31:12.929681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\semantic_manifest.json
[0m01:31:12.929681 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\sanja\OneDrive\Documents\sanjanaassignments\snowflake\sf-org-pipeline\dbt\healthcare\target\run_results.json
[0m01:31:12.929681 [info ] [MainThread]: 
[0m01:31:12.929681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:12.929681 [info ] [MainThread]: 
[0m01:31:12.939822 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:31:12.939822 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:12.939822 after 5.62 seconds
[0m01:31:12.939822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD6515040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD68EE420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD6CF5400>]}
[0m01:31:12.939822 [debug] [MainThread]: Flushing usage events
[0m01:31:13.548292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:32:29.432762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1ca22faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1c99c2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1ca7fc830>]}


============================== 01:32:29.437444 | 51837eb7-c21d-4c43-91ac-3d03c1933faa ==============================
[0m01:32:29.437444 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:32:29.439637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:32:29.452127 [info ] [MainThread]: dbt version: 1.8.8
[0m01:32:29.454487 [info ] [MainThread]: python version: 3.12.3
[0m01:32:29.457026 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m01:32:29.459140 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m01:32:29.715710 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m01:32:29.718163 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m01:32:29.719574 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m01:32:29.721122 [info ] [MainThread]: adapter type: snowflake
[0m01:32:29.722500 [info ] [MainThread]: adapter version: 1.8.4
[0m01:32:29.806895 [info ] [MainThread]: Configuration:
[0m01:32:29.808293 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:32:29.809694 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:32:29.811344 [info ] [MainThread]: Required dependencies:
[0m01:32:29.812301 [debug] [MainThread]: Executing "git --help"
[0m01:32:29.816335 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:32:29.818170 [debug] [MainThread]: STDERR: "b''"
[0m01:32:29.819761 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:32:29.821463 [info ] [MainThread]: Connection:
[0m01:32:29.824731 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:32:29.826483 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:32:29.828040 [info ] [MainThread]:   database: DBT_DB
[0m01:32:29.830441 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:32:29.831681 [info ] [MainThread]:   role: DBT_ROLE
[0m01:32:29.833383 [info ] [MainThread]:   schema: SILVER
[0m01:32:29.835042 [info ] [MainThread]:   authenticator: None
[0m01:32:29.837473 [info ] [MainThread]:   oauth_client_id: None
[0m01:32:29.839604 [info ] [MainThread]:   query_tag: None
[0m01:32:29.841810 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:32:29.844303 [info ] [MainThread]:   host: None
[0m01:32:29.845742 [info ] [MainThread]:   port: None
[0m01:32:29.846753 [info ] [MainThread]:   proxy_host: None
[0m01:32:29.847636 [info ] [MainThread]:   proxy_port: None
[0m01:32:29.849145 [info ] [MainThread]:   protocol: None
[0m01:32:29.851025 [info ] [MainThread]:   connect_retries: 1
[0m01:32:29.852648 [info ] [MainThread]:   connect_timeout: None
[0m01:32:29.854276 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:32:29.855983 [info ] [MainThread]:   retry_all: False
[0m01:32:29.859604 [info ] [MainThread]:   insecure_mode: False
[0m01:32:29.861442 [info ] [MainThread]:   reuse_connections: None
[0m01:32:29.863397 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:32:29.866788 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:32:29.869273 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:32:29.870857 [debug] [MainThread]: On debug: select 1 as id
[0m01:32:29.872921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:29.007246 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.732 seconds
[0m01:32:29.011493 [debug] [MainThread]: On debug: Close
[0m01:32:29.161370 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:32:29.164826 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:32:29.169662 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.5339102, "process_user_time": 1.253541, "process_kernel_time": 0.215332, "process_mem_max_rss": "127896", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m01:32:29.172722 [debug] [MainThread]: Command `dbt debug` succeeded at 01:32:29.172532 after 1.54 seconds
[0m01:32:29.175551 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:32:29.178868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1ca22faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1c81b1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1c99c2ea0>]}
[0m01:32:29.181632 [debug] [MainThread]: Flushing usage events
[0m01:32:33.044068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424c17fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424caf0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424c8f0a10>]}


============================== 01:32:33.047804 | 57be0fee-8e34-4f0a-9cee-d81338eff964 ==============================
[0m01:32:33.047804 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:32:33.049227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:32:33.060252 [info ] [MainThread]: dbt version: 1.8.8
[0m01:32:33.062331 [info ] [MainThread]: python version: 3.12.3
[0m01:32:33.064386 [info ] [MainThread]: python path: /home/sanja/air_venv/bin/python3
[0m01:32:33.066217 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m01:32:33.309876 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/sanja/.dbt
[0m01:32:33.312132 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/sanja/.dbt/profiles.yml
[0m01:32:33.313982 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/dbt_project.yml
[0m01:32:33.315647 [info ] [MainThread]: adapter type: snowflake
[0m01:32:33.317375 [info ] [MainThread]: adapter version: 1.8.4
[0m01:32:33.392111 [info ] [MainThread]: Configuration:
[0m01:32:33.394235 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:32:33.396279 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:32:33.398033 [info ] [MainThread]: Required dependencies:
[0m01:32:33.399798 [debug] [MainThread]: Executing "git --help"
[0m01:32:33.403201 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:32:33.405170 [debug] [MainThread]: STDERR: "b''"
[0m01:32:33.406846 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:32:33.408729 [info ] [MainThread]: Connection:
[0m01:32:33.410391 [info ] [MainThread]:   account: ATAHHHY-YLC89681
[0m01:32:33.412294 [info ] [MainThread]:   user: SANJANAREDDY23US
[0m01:32:33.414316 [info ] [MainThread]:   database: DBT_DB
[0m01:32:33.416458 [info ] [MainThread]:   warehouse: DBT_WH
[0m01:32:33.418479 [info ] [MainThread]:   role: DBT_ROLE
[0m01:32:33.420836 [info ] [MainThread]:   schema: SILVER
[0m01:32:33.423203 [info ] [MainThread]:   authenticator: None
[0m01:32:33.425532 [info ] [MainThread]:   oauth_client_id: None
[0m01:32:33.428076 [info ] [MainThread]:   query_tag: None
[0m01:32:33.429480 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:32:33.431011 [info ] [MainThread]:   host: None
[0m01:32:33.432597 [info ] [MainThread]:   port: None
[0m01:32:33.434382 [info ] [MainThread]:   proxy_host: None
[0m01:32:33.436636 [info ] [MainThread]:   proxy_port: None
[0m01:32:33.438982 [info ] [MainThread]:   protocol: None
[0m01:32:33.441503 [info ] [MainThread]:   connect_retries: 1
[0m01:32:33.443977 [info ] [MainThread]:   connect_timeout: None
[0m01:32:33.446437 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:32:33.448913 [info ] [MainThread]:   retry_all: False
[0m01:32:33.451354 [info ] [MainThread]:   insecure_mode: False
[0m01:32:33.453959 [info ] [MainThread]:   reuse_connections: None
[0m01:32:33.456518 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:32:33.460757 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:32:33.463557 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:32:33.465601 [debug] [MainThread]: On debug: select 1 as id
[0m01:32:33.467588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:34.151508 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.684 seconds
[0m01:32:34.154695 [debug] [MainThread]: On debug: Close
[0m01:32:34.305473 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:32:34.309162 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:32:34.313851 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3942353, "process_user_time": 1.281664, "process_kernel_time": 0.1655, "process_mem_max_rss": "128188", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m01:32:34.317479 [debug] [MainThread]: Command `dbt debug` succeeded at 01:32:34.317083 after 1.40 seconds
[0m01:32:34.321119 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:32:34.323009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424a6552e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424bff1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424bd042c0>]}
[0m01:32:34.325688 [debug] [MainThread]: Flushing usage events
[0m01:32:39.040245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b450270aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44edfe120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44ece71a0>]}


============================== 01:32:39.045234 | 9abab9c8-2496-4d12-bbaf-bc9b7a4fce73 ==============================
[0m01:32:39.045234 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:32:39.047208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:32:39.360576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44ff8ac30>]}
[0m01:32:39.403750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44ca3c590>]}
[0m01:32:39.406601 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:32:39.429364 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:32:39.622886 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:32:39.625116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44edfe960>]}
[0m01:32:41.351747 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:32:41.353962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44cb182c0>]}
[0m01:32:41.581474 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:32:41.599468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44c9af170>]}
[0m01:32:41.849755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b446b71310>]}
[0m01:32:41.853719 [info ] [MainThread]: Found 20 models, 6 data tests, 2 sources, 455 macros
[0m01:32:41.857598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44c687560>]}
[0m01:32:41.864618 [info ] [MainThread]: 
[0m01:32:41.868224 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:32:41.876430 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:32:41.889336 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:32:41.891994 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:32:41.894372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:42.593740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.699 seconds
[0m01:32:42.598518 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:32:42.769040 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:32:42.773817 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:32:42.777517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:43.273732 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.496 seconds
[0m01:32:43.279689 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:32:43.446566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_SILVER'
[0m01:32:43.459909 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:32:43.463151 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000
[0m01:32:43.466088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:44.114431 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.648 seconds
[0m01:32:44.119655 [debug] [ThreadPool]: On list_DBT_DB_SILVER: Close
[0m01:32:44.269498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:32:44.276554 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:32:44.279839 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000
[0m01:32:44.282324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:44.843000 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.561 seconds
[0m01:32:44.849476 [debug] [ThreadPool]: On list_DBT_DB_GOLD: Close
[0m01:32:45.019872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44c70d820>]}
[0m01:32:45.024361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:32:45.028364 [info ] [MainThread]: 
[0m01:32:45.034824 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m01:32:45.036397 [info ] [Thread-1 (]: 1 of 20 START sql view model SILVER.src_claims ................................. [RUN]
[0m01:32:45.038333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now model.healthcare.src_claims)
[0m01:32:45.040676 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m01:32:45.048839 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m01:32:45.068207 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m01:32:45.099412 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m01:32:45.123088 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m01:32:45.125277 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

    case 
        when Hospital_ID = 'HOSP1' then replace(Patient_ID, 'HOSP1-', 'H1-')
        when Hospital_ID = 'HOSP2' then replace(Patient_ID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else Patient_ID
    end as patient_id,
    
    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m01:32:45.127318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:45.788971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m01:32:45.812098 [debug] [Thread-1 (]: On model.healthcare.src_claims: Close
[0m01:32:45.972194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4458224b0>]}
[0m01:32:45.976304 [info ] [Thread-1 (]: 1 of 20 OK created sql view model SILVER.src_claims ............................ [[32mSUCCESS 1[0m in 0.93s]
[0m01:32:45.979769 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m01:32:45.982783 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m01:32:45.985915 [info ] [Thread-1 (]: 2 of 20 START sql view model SILVER.src_cptcodes ............................... [RUN]
[0m01:32:45.989194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m01:32:45.993375 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m01:32:46.002754 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m01:32:46.037064 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m01:32:46.041260 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m01:32:46.069315 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m01:32:46.071996 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m01:32:46.074833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:46.801475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m01:32:46.808663 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: Close
[0m01:32:46.960257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4461e7590>]}
[0m01:32:46.964584 [info ] [Thread-1 (]: 2 of 20 OK created sql view model SILVER.src_cptcodes .......................... [[32mSUCCESS 1[0m in 0.97s]
[0m01:32:46.970073 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m01:32:46.973487 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m01:32:46.975861 [info ] [Thread-1 (]: 3 of 20 START sql view model SILVER.src_departments ............................ [RUN]
[0m01:32:46.979431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m01:32:46.981450 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m01:32:46.984341 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m01:32:47.001177 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m01:32:47.004264 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m01:32:47.018595 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m01:32:47.020421 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    
    -- Add encounter prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPARTMENT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPARTMENT_ID
        else Department_id
    end as department_id,
    
    DEPARTMENT_Name as department_name
from RAW_DEPARTMENTS
  );
[0m01:32:47.021964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:47.607616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m01:32:47.614355 [debug] [Thread-1 (]: On model.healthcare.src_departments: Close
[0m01:32:47.766705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4458716a0>]}
[0m01:32:47.771020 [info ] [Thread-1 (]: 3 of 20 OK created sql view model SILVER.src_departments ....................... [[32mSUCCESS 1[0m in 0.79s]
[0m01:32:47.775017 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m01:32:47.780524 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m01:32:47.784013 [info ] [Thread-1 (]: 4 of 20 START sql view model SILVER.src_encounters ............................. [RUN]
[0m01:32:47.786753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m01:32:47.789094 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m01:32:47.798106 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m01:32:47.829208 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m01:32:47.832989 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m01:32:47.858624 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m01:32:47.860806 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.raw.raw_encounters
)

select
    -- Add encounter prefix based on patient_id
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Encounter_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Encounter_ID
        else Encounter_ID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Provider_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || dept_id
        when Provider_key like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    Procedure_Code as procedure_code,
    Inserted_Date as inserted_date,
    Modified_Date as modified_date
from RAW_ENCOUNTERS
  );
[0m01:32:47.863066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:48.554340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m01:32:48.560577 [debug] [Thread-1 (]: On model.healthcare.src_encounters: Close
[0m01:32:48.717850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4458857c0>]}
[0m01:32:48.721450 [info ] [Thread-1 (]: 4 of 20 OK created sql view model SILVER.src_encounters ........................ [[32mSUCCESS 1[0m in 0.93s]
[0m01:32:48.725642 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m01:32:48.730350 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m01:32:48.734956 [info ] [Thread-1 (]: 5 of 20 START sql view model SILVER.src_patients ............................... [RUN]
[0m01:32:48.738759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m01:32:48.741793 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m01:32:48.747495 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m01:32:48.790180 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m01:32:48.802416 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m01:32:48.845482 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m01:32:48.849342 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    Patientid as patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m01:32:48.851599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:49.591815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m01:32:49.598896 [debug] [Thread-1 (]: On model.healthcare.src_patients: Close
[0m01:32:49.748100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b451317800>]}
[0m01:32:49.752689 [info ] [Thread-1 (]: 5 of 20 OK created sql view model SILVER.src_patients .......................... [[32mSUCCESS 1[0m in 1.01s]
[0m01:32:49.756756 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m01:32:49.760580 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m01:32:49.764117 [info ] [Thread-1 (]: 6 of 20 START sql view model SILVER.src_providers .............................. [RUN]
[0m01:32:49.768223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m01:32:49.772486 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m01:32:49.778104 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m01:32:49.834568 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m01:32:49.839781 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m01:32:49.885111 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m01:32:49.889184 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)

select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    DEPT_ID as dept_id,
    NPI as npi,
    
    case 
        when split_part(DEPARTMENT_KEY, '-', 1) = 'HOSP1' then 'H1'
        when split_part(DEPARTMENT_KEY, '-', 1) = 'HOSP2' then 'H2'
        else 'UNKNOWN'
    end as hospital_code

from RAW_PROVIDERS
  );
[0m01:32:49.893219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:50.680637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m01:32:50.684639 [debug] [Thread-1 (]: On model.healthcare.src_providers: Close
[0m01:32:50.854057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b446a728d0>]}
[0m01:32:50.857204 [info ] [Thread-1 (]: 6 of 20 OK created sql view model SILVER.src_providers ......................... [[32mSUCCESS 1[0m in 1.09s]
[0m01:32:50.860065 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m01:32:50.862289 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m01:32:50.865233 [info ] [Thread-1 (]: 7 of 20 START sql view model SILVER.src_transactions ........................... [RUN]
[0m01:32:50.867399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m01:32:50.869874 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m01:32:50.875376 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m01:32:50.905030 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m01:32:50.911304 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m01:32:50.942900 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m01:32:50.947181 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    case 
        when HospitalID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when HospitalID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id,
    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m01:32:50.949603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:51.814708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.865 seconds
[0m01:32:51.820846 [debug] [Thread-1 (]: On model.healthcare.src_transactions: Close
[0m01:32:51.986603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b446b90350>]}
[0m01:32:51.990259 [info ] [Thread-1 (]: 7 of 20 OK created sql view model SILVER.src_transactions ...................... [[32mSUCCESS 1[0m in 1.12s]
[0m01:32:51.993855 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m01:32:51.997810 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:32:52.003996 [info ] [Thread-1 (]: 8 of 20 START sql table model GOLD.claims_status_metrics ....................... [RUN]
[0m01:32:52.008619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.claims_status_metrics)
[0m01:32:52.013924 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:32:52.020451 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:32:52.043909 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:32:52.063351 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:32:52.087211 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:32:52.089578 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
         as
        (

with base as (
    select
        claim_status,
        try_to_date(claim_date) as claim_date
    from DBT_DB.SILVER.src_claims
    where claim_status is not null
),

agg as (
    select
        to_char(claim_date, 'YYYY-MM') as claim_month,
        upper(claim_status) as claim_status,
        count(*) as claim_count
    from base
    group by claim_month, claim_status
)

select * from agg
order by claim_month, claim_status
        );
[0m01:32:52.092099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:53.142261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.050 seconds
[0m01:32:53.145786 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: Close
[0m01:32:53.296244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4458b4c80>]}
[0m01:32:53.300949 [info ] [Thread-1 (]: 8 of 20 OK created sql table model GOLD.claims_status_metrics .................. [[32mSUCCESS 1[0m in 1.29s]
[0m01:32:53.303447 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:32:53.305590 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m01:32:53.308634 [info ] [Thread-1 (]: 9 of 20 START sql table model GOLD.dim_cptcodes ................................ [RUN]
[0m01:32:53.310575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.claims_status_metrics, now model.healthcare.dim_cptcodes)
[0m01:32:53.312363 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m01:32:53.317173 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m01:32:53.335922 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m01:32:53.339530 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m01:32:53.361976 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m01:32:53.365796 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
         as
        (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_codes AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE procedure_code_category IS NOT NULL
)

SELECT * FROM cleaned_cpt
        );
[0m01:32:53.368146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:54.435892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.068 seconds
[0m01:32:54.440693 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: Close
[0m01:32:54.605148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4458d8830>]}
[0m01:32:54.608238 [info ] [Thread-1 (]: 9 of 20 OK created sql table model GOLD.dim_cptcodes ........................... [[32mSUCCESS 1[0m in 1.29s]
[0m01:32:54.611182 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m01:32:54.612956 [debug] [Thread-1 (]: Began running node model.healthcare.dim_departments
[0m01:32:54.614400 [info ] [Thread-1 (]: 10 of 20 START sql table model GOLD.dim_departments ............................ [RUN]
[0m01:32:54.616617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_cptcodes, now model.healthcare.dim_departments)
[0m01:32:54.619210 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_departments
[0m01:32:54.625593 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_departments"
[0m01:32:54.648684 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_departments
[0m01:32:54.653286 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_departments"
[0m01:32:54.684083 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_departments"
[0m01:32:54.688397 [debug] [Thread-1 (]: On model.healthcare.dim_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_departments"} */
create or replace transient table DBT_DB.GOLD.dim_departments
         as
        (

WITH deduplicated_departments AS (
    SELECT DISTINCT department_id, department_name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    department_id AS department_key,
    INITCAP(department_name) AS department_name
FROM deduplicated_departments
        );
[0m01:32:54.691338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:55.689904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m01:32:55.694999 [debug] [Thread-1 (]: On model.healthcare.dim_departments: Close
[0m01:32:55.845073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4458b0bf0>]}
[0m01:32:55.850223 [info ] [Thread-1 (]: 10 of 20 OK created sql table model GOLD.dim_departments ....................... [[32mSUCCESS 1[0m in 1.23s]
[0m01:32:55.854024 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_departments
[0m01:32:55.858396 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m01:32:55.861910 [info ] [Thread-1 (]: 11 of 20 START sql table model GOLD.dim_patients ............................... [RUN]
[0m01:32:55.865294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_departments, now model.healthcare.dim_patients)
[0m01:32:55.868551 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m01:32:55.876330 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m01:32:55.908997 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m01:32:55.915468 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m01:32:55.959986 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m01:32:55.963474 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (

with base as (
    select * 
    from DBT_DB.SILVER.src_patients
),

deduplicated as (
    select * 
    from base
    qualify row_number() over (partition by patient_id order by modified_date desc) = 1
),

final as (
    select
        patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated
)

select * from final
        );
[0m01:32:55.966738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:57.303122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.336 seconds
[0m01:32:57.307586 [debug] [Thread-1 (]: On model.healthcare.dim_patients: Close
[0m01:32:57.455299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4461d03e0>]}
[0m01:32:57.459417 [info ] [Thread-1 (]: 11 of 20 OK created sql table model GOLD.dim_patients .......................... [[32mSUCCESS 1[0m in 1.59s]
[0m01:32:57.461829 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m01:32:57.464802 [debug] [Thread-1 (]: Began running node model.healthcare.dim_providers
[0m01:32:57.466378 [info ] [Thread-1 (]: 12 of 20 START sql table model GOLD.dim_providers .............................. [RUN]
[0m01:32:57.468248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_patients, now model.healthcare.dim_providers)
[0m01:32:57.470039 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_providers
[0m01:32:57.475637 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_providers"
[0m01:32:57.511255 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_providers
[0m01:32:57.517966 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_providers"
[0m01:32:57.561046 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_providers"
[0m01:32:57.567241 [debug] [Thread-1 (]: On model.healthcare.dim_providers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_providers"} */
create or replace transient table DBT_DB.GOLD.dim_providers
         as
        (

WITH base AS (
    SELECT * 
    FROM DBT_DB.SILVER.src_providers
),

deduplicated AS (
    SELECT *
    FROM base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY provider_id ORDER BY npi DESC) = 1
),

final AS (
    SELECT
        provider_id,
        INITCAP(first_name) AS first_name,
        INITCAP(last_name) AS last_name,
        INITCAP(specialization) AS specialization,
        dept_id,
        npi,

        -- Derived: full name
        CONCAT(INITCAP(first_name), ' ', INITCAP(last_name)) AS full_name
    FROM deduplicated
)

SELECT * FROM final
        );
[0m01:32:57.569633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:58.664435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.095 seconds
[0m01:32:58.666941 [debug] [Thread-1 (]: On model.healthcare.dim_providers: Close
[0m01:32:58.817910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b445887590>]}
[0m01:32:58.820180 [info ] [Thread-1 (]: 12 of 20 OK created sql table model GOLD.dim_providers ......................... [[32mSUCCESS 1[0m in 1.35s]
[0m01:32:58.823271 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_providers
[0m01:32:58.825002 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m01:32:58.826617 [info ] [Thread-1 (]: 13 of 20 START sql table model GOLD.procedure_statistics ....................... [RUN]
[0m01:32:58.828574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_providers, now model.healthcare.procedure_statistics)
[0m01:32:58.830313 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m01:32:58.833938 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m01:32:58.853390 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m01:32:58.856390 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m01:32:58.881712 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m01:32:58.887368 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
         as
        (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
        );
[0m01:32:58.888987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:00.186054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.297 seconds
[0m01:33:00.189867 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: Close
[0m01:33:00.353170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b445897950>]}
[0m01:33:00.356083 [info ] [Thread-1 (]: 13 of 20 OK created sql table model GOLD.procedure_statistics .................. [[32mSUCCESS 1[0m in 1.52s]
[0m01:33:00.359197 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m01:33:00.362665 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:33:00.365977 [info ] [Thread-1 (]: 14 of 20 START sql table model GOLD.department_revenue_summary ................. [RUN]
[0m01:33:00.368756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.procedure_statistics, now model.healthcare.department_revenue_summary)
[0m01:33:00.371098 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:33:00.376424 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:33:00.407129 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:33:00.414014 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:33:00.443181 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:33:00.445631 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        department_id,
        COALESCE(CHARGE_amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.department_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.department_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY department_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
        );
[0m01:33:00.448142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:00.287031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.446 seconds
[0m01:33:00.290381 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: Close
[0m01:33:00.445041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b444703f20>]}
[0m01:33:00.449216 [info ] [Thread-1 (]: 14 of 20 OK created sql table model GOLD.department_revenue_summary ............ [[32mSUCCESS 1[0m in 0.08s]
[0m01:33:00.451992 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:33:00.454020 [debug] [Thread-1 (]: Began running node model.healthcare.patient_utilization_summary
[0m01:33:00.457277 [info ] [Thread-1 (]: 15 of 20 START sql table model GOLD.patient_utilization_summary ................ [RUN]
[0m01:33:00.458810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.department_revenue_summary, now model.healthcare.patient_utilization_summary)
[0m01:33:00.460430 [debug] [Thread-1 (]: Began compiling node model.healthcare.patient_utilization_summary
[0m01:33:00.465902 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.patient_utilization_summary"
[0m01:33:00.489424 [debug] [Thread-1 (]: Began executing node model.healthcare.patient_utilization_summary
[0m01:33:00.497672 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.patient_utilization_summary"
[0m01:33:00.521724 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.patient_utilization_summary"
[0m01:33:00.523653 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.patient_utilization_summary"} */
create or replace transient table DBT_DB.GOLD.patient_utilization_summary
         as
        (

-- Step 1: encounter counts per patient
WITH encounter_summary AS (
    SELECT
        patient_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY patient_id
),

-- Step 2: transaction summary per patient
transaction_summary AS (
    SELECT
        patient_id,
        COUNT(*) AS total_procedures,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY patient_id
),

-- Step 3: combine metrics at patient level
combined_metrics AS (
    SELECT
        COALESCE(e.patient_id, t.patient_id) AS patient_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_procedures, 0) AS total_procedures,
        COALESCE(total_charges, 0) AS total_charges
    FROM encounter_summary e
    FULL OUTER JOIN transaction_summary t
        ON e.patient_id = t.patient_id
),

-- Step 4: enrich with demographic data
final AS (
    SELECT
        cm.patient_id,
        p.first_name,
        p.last_name,
        p.gender_flag,
        p.age,
        p.age_group,
        cm.total_encounters,
        cm.total_procedures,
        cm.total_charges
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_patients p
        ON cm.patient_id = p.patient_key
)

SELECT * FROM final
        );
[0m01:33:00.526534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:02.224968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.699 seconds
[0m01:33:02.229291 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: Close
[0m01:33:02.380381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b4458bd6d0>]}
[0m01:33:02.383714 [info ] [Thread-1 (]: 15 of 20 OK created sql table model GOLD.patient_utilization_summary ........... [[32mSUCCESS 1[0m in 1.92s]
[0m01:33:02.387501 [debug] [Thread-1 (]: Finished running node model.healthcare.patient_utilization_summary
[0m01:33:02.391855 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m01:33:02.394788 [info ] [Thread-1 (]: 16 of 20 START sql table model GOLD.ar_balance_summary ......................... [RUN]
[0m01:33:02.397615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.patient_utilization_summary, now model.healthcare.ar_balance_summary)
[0m01:33:02.400195 [debug] [Thread-1 (]: Began compiling node model.healthcare.ar_balance_summary
[0m01:33:02.404123 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.ar_balance_summary"
[0m01:33:02.441558 [debug] [Thread-1 (]: Began executing node model.healthcare.ar_balance_summary
[0m01:33:02.449168 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.ar_balance_summary"
[0m01:33:02.506704 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.ar_balance_summary"
[0m01:33:02.511658 [debug] [Thread-1 (]: On model.healthcare.ar_balance_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.ar_balance_summary"} */
create or replace transient table DBT_DB.GOLD.ar_balance_summary
         as
        (

with txn as (
    select
        provider_id,
        transaction_id,
        coalesce(charge_amount, 0) as billed_amount
    from DBT_DB.SILVER.src_transactions
),

claims as (
    select
        transaction_id,
        coalesce(paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims
),

joined as (
    select
        t.provider_id,
        t.transaction_id,
        t.billed_amount,
        c.paid_amount
    from txn t
    left join claims c
        on t.transaction_id = c.transaction_id
),

aggregated as (
    select
        provider_id,
        count(*) as total_transactions,
        sum(billed_amount) as total_billed,
        sum(paid_amount) as total_paid,
        sum(greatest(billed_amount - paid_amount, 0)) as ar_balance
    from joined
    group by provider_id
),

with_provider_details as (
    select
        a.provider_id,
        p.full_name,
        p.specialization,
        a.total_transactions,
        a.total_billed,
        a.total_paid,
        a.ar_balance
    from aggregated a
    left join DBT_DB.GOLD.dim_providers p
        on a.provider_id = p.provider_id
)

select * from with_provider_details
        );
[0m01:33:02.517018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:04.480930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.964 seconds
[0m01:33:04.486040 [debug] [Thread-1 (]: On model.healthcare.ar_balance_summary: Close
[0m01:33:04.651948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b444703e90>]}
[0m01:33:04.655603 [info ] [Thread-1 (]: 16 of 20 OK created sql table model GOLD.ar_balance_summary .................... [[32mSUCCESS 1[0m in 2.25s]
[0m01:33:04.657874 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m01:33:04.660647 [debug] [Thread-1 (]: Began running node model.healthcare.denials_by_dept_provider
[0m01:33:04.662872 [info ] [Thread-1 (]: 17 of 20 START sql table model GOLD.denials_by_dept_provider ................... [RUN]
[0m01:33:04.665074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.ar_balance_summary, now model.healthcare.denials_by_dept_provider)
[0m01:33:04.667237 [debug] [Thread-1 (]: Began compiling node model.healthcare.denials_by_dept_provider
[0m01:33:04.672717 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.denials_by_dept_provider"
[0m01:33:04.731110 [debug] [Thread-1 (]: Began executing node model.healthcare.denials_by_dept_provider
[0m01:33:04.736209 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.denials_by_dept_provider"
[0m01:33:04.791496 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.denials_by_dept_provider"
[0m01:33:04.795526 [debug] [Thread-1 (]: On model.healthcare.denials_by_dept_provider: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.denials_by_dept_provider"} */
create or replace transient table DBT_DB.GOLD.denials_by_dept_provider
         as
        (

with base as (
    select
        provider_id,
        dept_id,
        claim_status
    from DBT_DB.SILVER.src_claims
    where upper(claim_status) = 'DENIED'
),

agg as (
    select
        provider_id,
        dept_id,
        count(*) as denial_count
    from base
    group by provider_id, dept_id
)

select 
    a.provider_id,
    p.full_name,
    p.specialization,
    a.dept_id,
    d.department_name,
    a.denial_count
from agg a
left join DBT_DB.GOLD.dim_providers p on a.provider_id = p.provider_id
left join DBT_DB.GOLD.dim_departments d on a.dept_id = d.department_key
order by denial_count desc
        );
[0m01:33:04.797733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:06.101540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.304 seconds
[0m01:33:06.104764 [debug] [Thread-1 (]: On model.healthcare.denials_by_dept_provider: Close
[0m01:33:06.256764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b445888710>]}
[0m01:33:06.260549 [info ] [Thread-1 (]: 17 of 20 OK created sql table model GOLD.denials_by_dept_provider .............. [[32mSUCCESS 1[0m in 1.59s]
[0m01:33:06.264313 [debug] [Thread-1 (]: Finished running node model.healthcare.denials_by_dept_provider
[0m01:33:06.268221 [debug] [Thread-1 (]: Began running node model.healthcare.missing_providers_audit
[0m01:33:06.272227 [info ] [Thread-1 (]: 18 of 20 START sql table model GOLD.missing_providers_audit .................... [RUN]
[0m01:33:06.275109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.denials_by_dept_provider, now model.healthcare.missing_providers_audit)
[0m01:33:06.277982 [debug] [Thread-1 (]: Began compiling node model.healthcare.missing_providers_audit
[0m01:33:06.284679 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.missing_providers_audit"
[0m01:33:06.359039 [debug] [Thread-1 (]: Began executing node model.healthcare.missing_providers_audit
[0m01:33:06.365980 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.missing_providers_audit"
[0m01:33:06.440301 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.missing_providers_audit"
[0m01:33:06.444148 [debug] [Thread-1 (]: On model.healthcare.missing_providers_audit: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.missing_providers_audit"} */
create or replace transient table DBT_DB.GOLD.missing_providers_audit
         as
        (

SELECT
    provider_id,
    COUNT(*) AS occurrence_count,
    'encounters' AS source_table
FROM DBT_DB.SILVER.src_encounters
WHERE provider_id NOT IN (SELECT provider_id FROM DBT_DB.GOLD.dim_providers)
GROUP BY provider_id

UNION ALL

SELECT
    provider_id,
    COUNT(*) AS occurrence_count,
    'transactions' AS source_table
FROM DBT_DB.SILVER.src_transactions
WHERE provider_id NOT IN (SELECT provider_id FROM DBT_DB.GOLD.dim_providers)
GROUP BY provider_id
        );
[0m01:33:06.447427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:07.897638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.450 seconds
[0m01:33:07.902660 [debug] [Thread-1 (]: On model.healthcare.missing_providers_audit: Close
[0m01:33:08.051253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b444710560>]}
[0m01:33:08.055371 [info ] [Thread-1 (]: 18 of 20 OK created sql table model GOLD.missing_providers_audit ............... [[32mSUCCESS 1[0m in 1.78s]
[0m01:33:08.057846 [debug] [Thread-1 (]: Finished running node model.healthcare.missing_providers_audit
[0m01:33:08.060794 [debug] [Thread-1 (]: Began running node model.healthcare.provider_department_revenue_summary
[0m01:33:08.063025 [info ] [Thread-1 (]: 19 of 20 START sql table model GOLD.provider_department_revenue_summary ........ [RUN]
[0m01:33:08.065158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.missing_providers_audit, now model.healthcare.provider_department_revenue_summary)
[0m01:33:08.067566 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_department_revenue_summary
[0m01:33:08.071974 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_department_revenue_summary"
[0m01:33:08.119858 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_department_revenue_summary
[0m01:33:08.125827 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_department_revenue_summary"
[0m01:33:08.172940 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_department_revenue_summary"
[0m01:33:08.175005 [debug] [Thread-1 (]: On model.healthcare.provider_department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.provider_department_revenue_summary
         as
        (

WITH txn AS (
    SELECT
        provider_id,
        department_id,
        COALESCE(charge_amount, 0) AS charge_amount
    FROM DBT_DB.SILVER.src_transactions
),

providers AS (
    SELECT
        provider_id,
        full_name,
        specialization
    FROM DBT_DB.GOLD.dim_providers
),

departments AS (
    SELECT
        department_key,
        department_name
    FROM DBT_DB.GOLD.dim_departments
),

joined AS (
    SELECT
        t.provider_id,
        p.full_name,
        p.specialization,
        t.department_id,
        d.department_name,
        t.charge_amount
    FROM txn t
    LEFT JOIN providers p ON t.provider_id = p.provider_id
    LEFT JOIN departments d ON t.department_id = d.department_key
),

aggregated AS (
    SELECT
        provider_id,
        full_name,
        specialization,
        department_id,
        department_name,
        SUM(charge_amount) AS total_charges,
        COUNT(*) AS total_visits
    FROM joined
    GROUP BY provider_id, full_name, specialization, department_id, department_name
)

SELECT * FROM aggregated
        );
[0m01:33:08.176883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:09.291147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.114 seconds
[0m01:33:09.295925 [debug] [Thread-1 (]: On model.healthcare.provider_department_revenue_summary: Close
[0m01:33:09.465486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44473ed50>]}
[0m01:33:09.468366 [info ] [Thread-1 (]: 19 of 20 OK created sql table model GOLD.provider_department_revenue_summary ... [[32mSUCCESS 1[0m in 1.40s]
[0m01:33:09.470478 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_department_revenue_summary
[0m01:33:09.472103 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m01:33:09.473787 [info ] [Thread-1 (]: 20 of 20 START sql table model GOLD.provider_performance_summary ............... [RUN]
[0m01:33:09.476057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.provider_department_revenue_summary, now model.healthcare.provider_performance_summary)
[0m01:33:09.477584 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_performance_summary
[0m01:33:09.483334 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_performance_summary"
[0m01:33:09.538709 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_performance_summary
[0m01:33:09.547401 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_performance_summary"
[0m01:33:09.603806 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_performance_summary"
[0m01:33:09.606621 [debug] [Thread-1 (]: On model.healthcare.provider_performance_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_performance_summary"} */
create or replace transient table DBT_DB.GOLD.provider_performance_summary
         as
        (

WITH encounter_counts AS (
    SELECT
        provider_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY provider_id
),

transaction_sums AS (
    SELECT
        provider_id,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY provider_id
),

claims_with_providers AS (
    SELECT
        t.provider_id,
        SUM(COALESCE(c.paid_amount, 0)) AS total_payments
    FROM DBT_DB.SILVER.src_transactions t
    LEFT JOIN DBT_DB.SILVER.src_claims c
        ON t.transaction_id = c.transaction_id
    GROUP BY t.provider_id
),

combined_metrics AS (
    SELECT
        COALESCE(e.provider_id, t.provider_id, c.provider_id) AS provider_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_charges, 0) AS total_charges,
        COALESCE(total_payments, 0) AS total_payments
    FROM encounter_counts e
    FULL OUTER JOIN transaction_sums t ON e.provider_id = t.provider_id
    FULL OUTER JOIN claims_with_providers c ON COALESCE(e.provider_id, t.provider_id) = c.provider_id
),

final AS (
    SELECT
        cm.provider_id,
        p.full_name,
        p.specialization,
        p.dept_id,
        cm.total_encounters,
        cm.total_charges,
        cm.total_payments,
        ROUND(CASE 
            WHEN cm.total_encounters > 0 THEN cm.total_charges / cm.total_encounters
            ELSE NULL
        END, 2) AS avg_charge_per_encounter
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_providers p
        ON cm.provider_id = p.provider_id
)

SELECT * FROM final
        );
[0m01:33:09.609608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:11.339277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.730 seconds
[0m01:33:11.344028 [debug] [Thread-1 (]: On model.healthcare.provider_performance_summary: Close
[0m01:33:11.501920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abab9c8-2496-4d12-bbaf-bc9b7a4fce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44d225ac0>]}
[0m01:33:11.504911 [info ] [Thread-1 (]: 20 of 20 OK created sql table model GOLD.provider_performance_summary .......... [[32mSUCCESS 1[0m in 2.03s]
[0m01:33:11.507720 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m01:33:11.512244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:33:11.513651 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m01:33:11.515212 [debug] [MainThread]: Connection 'model.healthcare.provider_performance_summary' was properly closed.
[0m01:33:11.516611 [info ] [MainThread]: 
[0m01:33:11.518047 [info ] [MainThread]: Finished running 7 view models, 13 table models in 0 hours 0 minutes and 29.65 seconds (29.65s).
[0m01:33:11.521115 [debug] [MainThread]: Command end result
[0m01:33:11.643126 [info ] [MainThread]: 
[0m01:33:11.645964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:33:11.648931 [info ] [MainThread]: 
[0m01:33:11.652561 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 TOTAL=20
[0m01:33:11.657544 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 34.374016, "process_user_time": 3.877398, "process_kernel_time": 0.382333, "process_mem_max_rss": "141416", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m01:33:11.659683 [debug] [MainThread]: Command `dbt run` succeeded at 01:33:11.659558 after 34.38 seconds
[0m01:33:11.661611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44e69b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44f0085c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b44ed5bbc0>]}
[0m01:33:12.082954 [debug] [MainThread]: Flushing usage events
[0m01:33:15.672226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4ab2554a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4ab0f58440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4ab17b7890>]}


============================== 01:33:15.677263 | 4a5d8c25-9699-4fd3-bc69-758cdbb7f33b ==============================
[0m01:33:15.677263 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:33:15.679301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/sanja/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /mnt/c/Users/sanja/.dbt --project-dir /mnt/c/Users/sanja/OneDrive/Documents/sanjanaassignments/snowflake/sf-org-pipeline/dbt/healthcare', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:33:15.965989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaf5d6240>]}
[0m01:33:16.009061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaec60950>]}
[0m01:33:16.011987 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:33:16.032617 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:33:16.912039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:33:16.913878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:33:16.919355 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.healthcare.dim
- models.healthcare.fact
[0m01:33:16.944941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaeb9ad80>]}
[0m01:33:17.085250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaea1ffb0>]}
[0m01:33:17.088193 [info ] [MainThread]: Found 20 models, 6 data tests, 2 sources, 455 macros
[0m01:33:17.091922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaf1c1af0>]}
[0m01:33:17.099554 [info ] [MainThread]: 
[0m01:33:17.102229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:33:17.113240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:33:17.126595 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:33:17.129409 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:33:17.131686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:17.824963 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.693 seconds
[0m01:33:17.827771 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:33:17.993522 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:33:17.996504 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:33:17.999247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:18.449162 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.450 seconds
[0m01:33:18.452792 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:33:18.620705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now list_DBT_DB_SILVER)
[0m01:33:18.633000 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_SILVER"
[0m01:33:18.635018 [debug] [ThreadPool]: On list_DBT_DB_SILVER: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_SILVER"} */
show objects in DBT_DB.SILVER limit 10000
[0m01:33:18.637544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:19.074125 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.437 seconds
[0m01:33:19.079396 [debug] [ThreadPool]: On list_DBT_DB_SILVER: Close
[0m01:33:19.263171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB_SILVER, now list_DBT_DB_GOLD)
[0m01:33:19.267062 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_GOLD"
[0m01:33:19.269141 [debug] [ThreadPool]: On list_DBT_DB_GOLD: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "connection_name": "list_DBT_DB_GOLD"} */
show objects in DBT_DB.GOLD limit 10000
[0m01:33:19.271600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:19.898615 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.627 seconds
[0m01:33:19.902928 [debug] [ThreadPool]: On list_DBT_DB_GOLD: Close
[0m01:33:20.070982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4ab21d8dd0>]}
[0m01:33:20.075016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:33:20.077796 [info ] [MainThread]: 
[0m01:33:20.083929 [debug] [Thread-1 (]: Began running node model.healthcare.src_claims
[0m01:33:20.085811 [info ] [Thread-1 (]: 1 of 20 START sql view model SILVER.src_claims ................................. [RUN]
[0m01:33:20.087548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_DB_GOLD, now model.healthcare.src_claims)
[0m01:33:20.088641 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_claims
[0m01:33:20.094338 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_claims"
[0m01:33:20.111687 [debug] [Thread-1 (]: Began executing node model.healthcare.src_claims
[0m01:33:20.134247 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_claims"
[0m01:33:20.153031 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_claims"
[0m01:33:20.155254 [debug] [Thread-1 (]: On model.healthcare.src_claims: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_claims"} */
create or replace   view DBT_DB.SILVER.src_claims
  
   as (
    with RAW_CLAIMS as (
    select * from DBT_DB.RAW.RAW_CLAIMS
)

select
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || CLAIM_ID
        when Hospital_id like 'HOSP2' then 'H2-' || CLAIM_ID
        else CLAIM_ID
    end as CLAIM_ID,
    
-- Add CLAIMID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || TRANSACTION_ID
        when Hospital_id like 'HOSP2' then 'H2-' || TRANSACTION_ID
        else TRANSACTION_ID
    end as transaction_id,

    case 
        when Hospital_ID = 'HOSP1' then replace(Patient_ID, 'HOSP1-', 'H1-')
        when Hospital_ID = 'HOSP2' then replace(Patient_ID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else Patient_ID
    end as patient_id,
    
    -- Add ENCOUNTERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || ENCOUNTER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || ENCOUNTER_ID
        else ENCOUNTER_ID
    end as encounter_id,

    -- Add PROVIDERID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || PROVIDER_ID
        when Hospital_id like 'HOSP2' then 'H2-' || PROVIDER_ID
        else PROVIDER_ID
    end as provider_id,

    -- Add deptID prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPT_ID
        else DEPT_ID
    end as dept_id,

    SERVICE_DATE           AS service_date, 
    CLAIM_DATE            AS claim_date,
    PAYOR_ID              AS payor_id,
    CLAIM_AMOUNT          AS claim_amount,
    PAID_AMOUNT           AS paid_amount,
    CLAIM_STATUS          AS claim_status,
    PAYOR_TYPE            AS payor_type,
    DEDUCTIBLE         AS deductible,
    COINSURANCE           AS coinsurance,
    COPAY                 AS copay,
    INSERT_DATE            AS insert_date,
    MODIFIED_DATE          AS modified_date
from RAW_CLAIMS
  );
[0m01:33:20.156937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:21.006965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.850 seconds
[0m01:33:21.030195 [debug] [Thread-1 (]: On model.healthcare.src_claims: Close
[0m01:33:21.192226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaedff8c0>]}
[0m01:33:21.199170 [info ] [Thread-1 (]: 1 of 20 OK created sql view model SILVER.src_claims ............................ [[32mSUCCESS 1[0m in 1.10s]
[0m01:33:21.201533 [debug] [Thread-1 (]: Finished running node model.healthcare.src_claims
[0m01:33:21.207796 [debug] [Thread-1 (]: Began running node model.healthcare.src_cptcodes
[0m01:33:21.209808 [info ] [Thread-1 (]: 2 of 20 START sql view model SILVER.src_cptcodes ............................... [RUN]
[0m01:33:21.212022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_claims, now model.healthcare.src_cptcodes)
[0m01:33:21.214668 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_cptcodes
[0m01:33:21.217890 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_cptcodes"
[0m01:33:21.237902 [debug] [Thread-1 (]: Began executing node model.healthcare.src_cptcodes
[0m01:33:21.244286 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_cptcodes"
[0m01:33:21.262950 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_cptcodes"
[0m01:33:21.264461 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_cptcodes"} */
create or replace   view DBT_DB.SILVER.src_cptcodes
  
   as (
    WITH RAW_CPTCODES AS (

    SELECT *
    FROM DBT_DB.RAW.RAW_CPTCODES

)

SELECT
    INDEX                       AS index,
    PROCEDURE_CODE_CATEGORY     AS procedure_code_category,
    CPT_CODES                   AS cpt_codes,
    PROCEDURE_CODE_DESCRIPTIONS AS procedure_code_descriptions,
    CODE_STATUS                 AS code_status

FROM RAW_CPTCODES
  );
[0m01:33:21.265554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:21.837251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m01:33:21.843021 [debug] [Thread-1 (]: On model.healthcare.src_cptcodes: Close
[0m01:33:22.007440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aade5f7a0>]}
[0m01:33:22.010978 [info ] [Thread-1 (]: 2 of 20 OK created sql view model SILVER.src_cptcodes .......................... [[32mSUCCESS 1[0m in 0.80s]
[0m01:33:22.013022 [debug] [Thread-1 (]: Finished running node model.healthcare.src_cptcodes
[0m01:33:22.015600 [debug] [Thread-1 (]: Began running node model.healthcare.src_departments
[0m01:33:22.016841 [info ] [Thread-1 (]: 3 of 20 START sql view model SILVER.src_departments ............................ [RUN]
[0m01:33:22.018161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_cptcodes, now model.healthcare.src_departments)
[0m01:33:22.019336 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_departments
[0m01:33:22.021765 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_departments"
[0m01:33:22.040099 [debug] [Thread-1 (]: Began executing node model.healthcare.src_departments
[0m01:33:22.043630 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_departments"
[0m01:33:22.068247 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_departments"
[0m01:33:22.069844 [debug] [Thread-1 (]: On model.healthcare.src_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_departments"} */
create or replace   view DBT_DB.SILVER.src_departments
  
   as (
    with RAW_DEPARTMENTS as (
    select * from DBT_DB.RAW.RAW_DEPARTMENTS
)
select
    
    -- Add encounter prefix based on patient_id
    case 
        when Hospital_id like 'HOSP1' then 'H1-' || DEPARTMENT_ID
        when Hospital_id like 'HOSP2' then 'H2-' || DEPARTMENT_ID
        else Department_id
    end as department_id,
    
    DEPARTMENT_Name as department_name
from RAW_DEPARTMENTS
  );
[0m01:33:22.072030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:22.561169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m01:33:22.567550 [debug] [Thread-1 (]: On model.healthcare.src_departments: Close
[0m01:33:22.715554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadf63590>]}
[0m01:33:22.718505 [info ] [Thread-1 (]: 3 of 20 OK created sql view model SILVER.src_departments ....................... [[32mSUCCESS 1[0m in 0.70s]
[0m01:33:22.720674 [debug] [Thread-1 (]: Finished running node model.healthcare.src_departments
[0m01:33:22.723397 [debug] [Thread-1 (]: Began running node model.healthcare.src_encounters
[0m01:33:22.725027 [info ] [Thread-1 (]: 4 of 20 START sql view model SILVER.src_encounters ............................. [RUN]
[0m01:33:22.727064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_departments, now model.healthcare.src_encounters)
[0m01:33:22.729215 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_encounters
[0m01:33:22.733749 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_encounters"
[0m01:33:22.753932 [debug] [Thread-1 (]: Began executing node model.healthcare.src_encounters
[0m01:33:22.759216 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_encounters"
[0m01:33:22.782370 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_encounters"
[0m01:33:22.783959 [debug] [Thread-1 (]: On model.healthcare.src_encounters: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_encounters"} */
create or replace   view DBT_DB.SILVER.src_encounters
  
   as (
    with RAW_ENCOUNTERS as (
    select * from DBT_DB.raw.raw_encounters
)

select
    -- Add encounter prefix based on patient_id
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Encounter_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Encounter_ID
        else Encounter_ID
    end as encounter_id,

    -- Replace patient_id prefix
    replace(replace(Patient_ID, 'HOSP1-', 'H1-'), 'HOSP2-', 'H2-') as patient_id,

    Encounter_Date as encounter_date,
    Encounter_Type as encounter_type,

    -- Prefix provider_id based on patient hospital
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || Provider_ID
        when Provider_key like 'HOSP2-%' then 'H2-' || Provider_ID
        else Provider_ID
    end as provider_id,

    -- Same logic can be applied if you need to change department_id too
    case 
        when Provider_key like 'HOSP1-%' then 'H1-' || dept_id
        when Provider_key like 'HOSP2-%' then 'H2-' || dept_id
        else dept_id
    end as dept_id,
    

    Procedure_Code as procedure_code,
    Inserted_Date as inserted_date,
    Modified_Date as modified_date
from RAW_ENCOUNTERS
  );
[0m01:33:22.785575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:23.539858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m01:33:23.546601 [debug] [Thread-1 (]: On model.healthcare.src_encounters: Close
[0m01:33:23.693163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadf6d010>]}
[0m01:33:23.695918 [info ] [Thread-1 (]: 4 of 20 OK created sql view model SILVER.src_encounters ........................ [[32mSUCCESS 1[0m in 0.97s]
[0m01:33:23.699382 [debug] [Thread-1 (]: Finished running node model.healthcare.src_encounters
[0m01:33:23.701938 [debug] [Thread-1 (]: Began running node model.healthcare.src_patients
[0m01:33:23.704035 [info ] [Thread-1 (]: 5 of 20 START sql view model SILVER.src_patients ............................... [RUN]
[0m01:33:23.706279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_encounters, now model.healthcare.src_patients)
[0m01:33:23.707931 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_patients
[0m01:33:23.709697 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_patients"
[0m01:33:23.729564 [debug] [Thread-1 (]: Began executing node model.healthcare.src_patients
[0m01:33:23.732825 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_patients"
[0m01:33:23.750950 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_patients"
[0m01:33:23.753191 [debug] [Thread-1 (]: On model.healthcare.src_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_patients"} */
create or replace   view DBT_DB.SILVER.src_patients
  
   as (
    with raw_patients as (
    select *
    from DBT_DB.RAW.RAW_PATIENTS
)

select
    Patientid as patient_id,
    firstname as first_name,
    lastname as last_name,
    middlename as middle_name,
    ssn,
    phonenumber as phone_number,
    upper(gender) as gender,
    try_to_date(dob) as date_of_birth,
    address,
    try_to_date(modifieddate) as modified_date
from raw_patients
  );
[0m01:33:23.754357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:24.371849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m01:33:24.375738 [debug] [Thread-1 (]: On model.healthcare.src_patients: Close
[0m01:33:24.540454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadeb7fb0>]}
[0m01:33:24.543479 [info ] [Thread-1 (]: 5 of 20 OK created sql view model SILVER.src_patients .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m01:33:24.545212 [debug] [Thread-1 (]: Finished running node model.healthcare.src_patients
[0m01:33:24.546951 [debug] [Thread-1 (]: Began running node model.healthcare.src_providers
[0m01:33:24.548724 [info ] [Thread-1 (]: 6 of 20 START sql view model SILVER.src_providers .............................. [RUN]
[0m01:33:24.550386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_patients, now model.healthcare.src_providers)
[0m01:33:24.551993 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_providers
[0m01:33:24.555813 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_providers"
[0m01:33:24.575193 [debug] [Thread-1 (]: Began executing node model.healthcare.src_providers
[0m01:33:24.579279 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_providers"
[0m01:33:24.594833 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_providers"
[0m01:33:24.597204 [debug] [Thread-1 (]: On model.healthcare.src_providers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_providers"} */
create or replace   view DBT_DB.SILVER.src_providers
  
   as (
    with RAW_PROVIDERS as (
    select * from DBT_DB.RAW.RAW_PROVIDERS
)

select
    Provider_ID as provider_id,
    First_Name as first_name,
    Last_Name as last_name,
    Specialization as specialization,
    DEPT_ID as dept_id,
    NPI as npi,
    
    case 
        when split_part(DEPARTMENT_KEY, '-', 1) = 'HOSP1' then 'H1'
        when split_part(DEPARTMENT_KEY, '-', 1) = 'HOSP2' then 'H2'
        else 'UNKNOWN'
    end as hospital_code

from RAW_PROVIDERS
  );
[0m01:33:24.599150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:25.316191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m01:33:25.322605 [debug] [Thread-1 (]: On model.healthcare.src_providers: Close
[0m01:33:25.478567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadee8da0>]}
[0m01:33:25.481617 [info ] [Thread-1 (]: 6 of 20 OK created sql view model SILVER.src_providers ......................... [[32mSUCCESS 1[0m in 0.93s]
[0m01:33:25.485394 [debug] [Thread-1 (]: Finished running node model.healthcare.src_providers
[0m01:33:25.489269 [debug] [Thread-1 (]: Began running node model.healthcare.src_transactions
[0m01:33:25.492479 [info ] [Thread-1 (]: 7 of 20 START sql view model SILVER.src_transactions ........................... [RUN]
[0m01:33:25.495172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_providers, now model.healthcare.src_transactions)
[0m01:33:25.497202 [debug] [Thread-1 (]: Began compiling node model.healthcare.src_transactions
[0m01:33:25.504331 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.src_transactions"
[0m01:33:25.524152 [debug] [Thread-1 (]: Began executing node model.healthcare.src_transactions
[0m01:33:25.530216 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.src_transactions"
[0m01:33:25.554744 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.src_transactions"
[0m01:33:25.557533 [debug] [Thread-1 (]: On model.healthcare.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.src_transactions"} */
create or replace   view DBT_DB.SILVER.src_transactions
  
   as (
    with RAW_TRANSACTIONS as (
    select * from DBT_DB.raw.raw_transactions
)

select
    -- Add transaction prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || TransactionID
        when hospitalid like 'HOSP2' then 'H2-' || TransactionID
        else TransactionID
    end as transaction_id,

    -- Add encounter prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || EncounterID
        when hospitalid like 'HOSP2' then 'H2-' || EncounterID
        else EncounterID
    end as encounter_id,

    case 
        when HospitalID = 'HOSP1' then replace(PatientID, 'HOSP1-', 'H1-')
        when HospitalID = 'HOSP2' then replace(PatientID, 'HOSP1-', 'H2-')  -- assumes HOSP2 patients are still labeled with HOSP1-
        else PatientID
    end as patient_id,
    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || ProviderID
        when hospitalid like 'HOSP2' then 'H2-' || ProviderID
        else ProviderID
    end as provider_id,

    -- Add provider_id prefix based on patient_id
    case 
        when hospitalid like 'HOSP1' then 'H1-' || DepartmentID
        when hospitalid like 'HOSP2' then 'H2-' || DepartmentID
        else DepartmentID
    end as Department_id,


    visitdate as visit_date,
    serviceDate as service_date,
    paidDate as paid_date,
    visittype as visit_type,
    amount as charge_amount,
    amounttype as amount_type,
    paidamount as paid_amount,

    -- Same logic can be applied if you need to change department_id too
    case 
        when hospitalid like 'HOSP1' then 'H1-' || claimid
        when hospitalid like 'HOSP2' then 'H2-' || claimid
        else claimid
    end as claim_id,

    payorid as payor_id,
    procedurecode as procedure_code,
    icdcode as icd_code,
    lineofbusiness as line_of_business,
    medicaidid as medica_id,
    medicareid as medicare_id,
    insertdate as inserted_date,
    modifieddate as modified_date


from RAW_TRANSACTIONS
  );
[0m01:33:25.560789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:26.144488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m01:33:26.150047 [debug] [Thread-1 (]: On model.healthcare.src_transactions: Close
[0m01:33:26.305221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaded4a10>]}
[0m01:33:26.310523 [info ] [Thread-1 (]: 7 of 20 OK created sql view model SILVER.src_transactions ...................... [[32mSUCCESS 1[0m in 0.81s]
[0m01:33:26.313561 [debug] [Thread-1 (]: Finished running node model.healthcare.src_transactions
[0m01:33:26.316789 [debug] [Thread-1 (]: Began running node model.healthcare.claims_status_metrics
[0m01:33:26.319237 [info ] [Thread-1 (]: 8 of 20 START sql table model GOLD.claims_status_metrics ....................... [RUN]
[0m01:33:26.321300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.src_transactions, now model.healthcare.claims_status_metrics)
[0m01:33:26.323615 [debug] [Thread-1 (]: Began compiling node model.healthcare.claims_status_metrics
[0m01:33:26.330022 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.claims_status_metrics"
[0m01:33:26.352759 [debug] [Thread-1 (]: Began executing node model.healthcare.claims_status_metrics
[0m01:33:26.369476 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.claims_status_metrics"
[0m01:33:26.396848 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.claims_status_metrics"
[0m01:33:26.398965 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.claims_status_metrics"} */
create or replace transient table DBT_DB.GOLD.claims_status_metrics
         as
        (

with base as (
    select
        claim_status,
        try_to_date(claim_date) as claim_date
    from DBT_DB.SILVER.src_claims
    where claim_status is not null
),

agg as (
    select
        to_char(claim_date, 'YYYY-MM') as claim_month,
        upper(claim_status) as claim_status,
        count(*) as claim_count
    from base
    group by claim_month, claim_status
)

select * from agg
order by claim_month, claim_status
        );
[0m01:33:26.400818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:27.631293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.230 seconds
[0m01:33:27.636699 [debug] [Thread-1 (]: On model.healthcare.claims_status_metrics: Close
[0m01:33:27.802927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadf2ec60>]}
[0m01:33:27.806236 [info ] [Thread-1 (]: 8 of 20 OK created sql table model GOLD.claims_status_metrics .................. [[32mSUCCESS 1[0m in 1.48s]
[0m01:33:27.810536 [debug] [Thread-1 (]: Finished running node model.healthcare.claims_status_metrics
[0m01:33:27.813751 [debug] [Thread-1 (]: Began running node model.healthcare.dim_cptcodes
[0m01:33:27.815728 [info ] [Thread-1 (]: 9 of 20 START sql table model GOLD.dim_cptcodes ................................ [RUN]
[0m01:33:27.818062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.claims_status_metrics, now model.healthcare.dim_cptcodes)
[0m01:33:27.820017 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_cptcodes
[0m01:33:27.825902 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_cptcodes"
[0m01:33:27.847069 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_cptcodes
[0m01:33:27.850246 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_cptcodes"
[0m01:33:27.869406 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_cptcodes"
[0m01:33:27.871897 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_cptcodes"} */
create or replace transient table DBT_DB.GOLD.dim_cptcodes
         as
        (

WITH cleaned_cpt AS (
    SELECT DISTINCT
        procedure_code_category AS cpt_code,               -- numeric code
        cpt_codes AS description             -- full text
    FROM DBT_DB.SILVER.src_cptcodes
    WHERE procedure_code_category IS NOT NULL
)

SELECT * FROM cleaned_cpt
        );
[0m01:33:27.873641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:28.797731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m01:33:28.802452 [debug] [Thread-1 (]: On model.healthcare.dim_cptcodes: Close
[0m01:33:28.984668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadfee120>]}
[0m01:33:28.987768 [info ] [Thread-1 (]: 9 of 20 OK created sql table model GOLD.dim_cptcodes ........................... [[32mSUCCESS 1[0m in 1.17s]
[0m01:33:28.990633 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_cptcodes
[0m01:33:28.997171 [debug] [Thread-1 (]: Began running node model.healthcare.dim_departments
[0m01:33:28.999587 [info ] [Thread-1 (]: 10 of 20 START sql table model GOLD.dim_departments ............................ [RUN]
[0m01:33:29.002222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_cptcodes, now model.healthcare.dim_departments)
[0m01:33:29.003769 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_departments
[0m01:33:29.007688 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_departments"
[0m01:33:29.030371 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_departments
[0m01:33:29.033318 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_departments"
[0m01:33:29.054636 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_departments"
[0m01:33:29.056650 [debug] [Thread-1 (]: On model.healthcare.dim_departments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_departments"} */
create or replace transient table DBT_DB.GOLD.dim_departments
         as
        (

WITH deduplicated_departments AS (
    SELECT DISTINCT department_id, department_name
    FROM DBT_DB.SILVER.src_departments
)

SELECT
    department_id AS department_key,
    INITCAP(department_name) AS department_name
FROM deduplicated_departments
        );
[0m01:33:29.057607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:30.036146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.978 seconds
[0m01:33:30.044552 [debug] [Thread-1 (]: On model.healthcare.dim_departments: Close
[0m01:33:30.195731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadf6d070>]}
[0m01:33:30.198862 [info ] [Thread-1 (]: 10 of 20 OK created sql table model GOLD.dim_departments ....................... [[32mSUCCESS 1[0m in 1.19s]
[0m01:33:30.201527 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_departments
[0m01:33:30.204842 [debug] [Thread-1 (]: Began running node model.healthcare.dim_patients
[0m01:33:30.207358 [info ] [Thread-1 (]: 11 of 20 START sql table model GOLD.dim_patients ............................... [RUN]
[0m01:33:30.209121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_departments, now model.healthcare.dim_patients)
[0m01:33:30.210403 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_patients
[0m01:33:30.215794 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_patients"
[0m01:33:30.236924 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_patients
[0m01:33:30.243556 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_patients"
[0m01:33:30.269249 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_patients"
[0m01:33:30.271963 [debug] [Thread-1 (]: On model.healthcare.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_patients"} */
create or replace transient table DBT_DB.GOLD.dim_patients
         as
        (

with base as (
    select * 
    from DBT_DB.SILVER.src_patients
),

deduplicated as (
    select * 
    from base
    qualify row_number() over (partition by patient_id order by modified_date desc) = 1
),

final as (
    select
        patient_id as patient_key,
        first_name,
        last_name,
        middle_name,
        ssn,
        phone_number,
        upper(gender) as gender,
        date_of_birth,
        address,
        modified_date,

        -- Derived: age
        datediff('year', date_of_birth, current_date) as age,

        -- Derived: age_group
        case 
            when datediff('year', date_of_birth, current_date) < 18 then '0-17'
            when datediff('year', date_of_birth, current_date) between 18 and 35 then '18-35'
            when datediff('year', date_of_birth, current_date) between 36 and 60 then '36-60'
            else '60+'
        end as age_group,

        -- Derived: gender flag
        case 
            when upper(gender) like 'M%' then 'M'
            when upper(gender) like 'F%' then 'F'
            else 'U'
        end as gender_flag

    from deduplicated
)

select * from final
        );
[0m01:33:30.273730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:31.443372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.170 seconds
[0m01:33:31.446921 [debug] [Thread-1 (]: On model.healthcare.dim_patients: Close
[0m01:33:31.599912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadf17aa0>]}
[0m01:33:31.604013 [info ] [Thread-1 (]: 11 of 20 OK created sql table model GOLD.dim_patients .......................... [[32mSUCCESS 1[0m in 1.39s]
[0m01:33:31.607851 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_patients
[0m01:33:31.610370 [debug] [Thread-1 (]: Began running node model.healthcare.dim_providers
[0m01:33:31.612432 [info ] [Thread-1 (]: 12 of 20 START sql table model GOLD.dim_providers .............................. [RUN]
[0m01:33:31.614673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_patients, now model.healthcare.dim_providers)
[0m01:33:31.616994 [debug] [Thread-1 (]: Began compiling node model.healthcare.dim_providers
[0m01:33:31.621636 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.dim_providers"
[0m01:33:31.640342 [debug] [Thread-1 (]: Began executing node model.healthcare.dim_providers
[0m01:33:31.646227 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.dim_providers"
[0m01:33:31.666500 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.dim_providers"
[0m01:33:31.668127 [debug] [Thread-1 (]: On model.healthcare.dim_providers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.dim_providers"} */
create or replace transient table DBT_DB.GOLD.dim_providers
         as
        (

WITH base AS (
    SELECT * 
    FROM DBT_DB.SILVER.src_providers
),

deduplicated AS (
    SELECT *
    FROM base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY provider_id ORDER BY npi DESC) = 1
),

final AS (
    SELECT
        provider_id,
        INITCAP(first_name) AS first_name,
        INITCAP(last_name) AS last_name,
        INITCAP(specialization) AS specialization,
        dept_id,
        npi,

        -- Derived: full name
        CONCAT(INITCAP(first_name), ' ', INITCAP(last_name)) AS full_name
    FROM deduplicated
)

SELECT * FROM final
        );
[0m01:33:31.669643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:31.080904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m01:33:31.084842 [debug] [Thread-1 (]: On model.healthcare.dim_providers: Close
[0m01:33:31.241510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aae01ea50>]}
[0m01:33:31.245060 [info ] [Thread-1 (]: 12 of 20 OK created sql table model GOLD.dim_providers ......................... [[32mSUCCESS 1[0m in -0.37s]
[0m01:33:31.247329 [debug] [Thread-1 (]: Finished running node model.healthcare.dim_providers
[0m01:33:31.249521 [debug] [Thread-1 (]: Began running node model.healthcare.procedure_statistics
[0m01:33:31.251413 [info ] [Thread-1 (]: 13 of 20 START sql table model GOLD.procedure_statistics ....................... [RUN]
[0m01:33:31.252944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.dim_providers, now model.healthcare.procedure_statistics)
[0m01:33:31.254582 [debug] [Thread-1 (]: Began compiling node model.healthcare.procedure_statistics
[0m01:33:31.258840 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.procedure_statistics"
[0m01:33:31.274419 [debug] [Thread-1 (]: Began executing node model.healthcare.procedure_statistics
[0m01:33:31.277538 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.procedure_statistics"
[0m01:33:31.294213 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.procedure_statistics"
[0m01:33:31.295599 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.procedure_statistics"} */
create or replace transient table DBT_DB.GOLD.procedure_statistics
         as
        (

-- Step 1: Aggregate from transactions
WITH procedure_summary AS (
    SELECT
        LPAD(CAST(procedure_code AS STRING), 5, '0') AS cpt_code,
        COUNT(*) AS total_performed,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    WHERE procedure_code IS NOT NULL
    GROUP BY procedure_code
),

-- Step 2: Join with CPT dimension
final AS (
    SELECT
        ps.cpt_code,
        c.description,
        ps.total_performed,
        ps.total_charges,
        ROUND(ps.total_charges / NULLIF(ps.total_performed, 0), 2) AS average_charge_per_use
    FROM procedure_summary ps
    LEFT JOIN DBT_DB.GOLD.dim_cptcodes c
        ON ps.cpt_code = c.cpt_code
)

SELECT * FROM final
        );
[0m01:33:31.297312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:32.748530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.451 seconds
[0m01:33:32.751867 [debug] [Thread-1 (]: On model.healthcare.procedure_statistics: Close
[0m01:33:32.903105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaf180500>]}
[0m01:33:32.907435 [info ] [Thread-1 (]: 13 of 20 OK created sql table model GOLD.procedure_statistics .................. [[32mSUCCESS 1[0m in 1.65s]
[0m01:33:32.911231 [debug] [Thread-1 (]: Finished running node model.healthcare.procedure_statistics
[0m01:33:32.914526 [debug] [Thread-1 (]: Began running node model.healthcare.department_revenue_summary
[0m01:33:32.917575 [info ] [Thread-1 (]: 14 of 20 START sql table model GOLD.department_revenue_summary ................. [RUN]
[0m01:33:32.920318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.procedure_statistics, now model.healthcare.department_revenue_summary)
[0m01:33:32.923188 [debug] [Thread-1 (]: Began compiling node model.healthcare.department_revenue_summary
[0m01:33:32.928881 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.department_revenue_summary"
[0m01:33:32.947297 [debug] [Thread-1 (]: Began executing node model.healthcare.department_revenue_summary
[0m01:33:32.953237 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.department_revenue_summary"
[0m01:33:32.974114 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.department_revenue_summary"
[0m01:33:32.976526 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.department_revenue_summary
         as
        (

-- Step 1: Clean transaction data
WITH txn AS (
    SELECT
        department_id,
        COALESCE(CHARGE_amount, 0) AS charge_amount,
        transaction_id
    FROM DBT_DB.SILVER.src_transactions
),

-- Step 2: Clean claims data
claims AS (
    SELECT
        transaction_id,
        COALESCE(paid_amount, 0) AS paid_amount
    FROM DBT_DB.SILVER.src_claims
),

-- Step 3: Join transactions with claims and department dimension
joined AS (
    SELECT
        t.department_id,
        d.department_name,
        t.charge_amount,
        c.paid_amount
    FROM txn t
    LEFT JOIN claims c
        ON t.transaction_id = c.transaction_id
    LEFT JOIN DBT_DB.GOLD.dim_departments d
        ON t.department_id = d.department_key
),

-- Step 4: Aggregate results
aggregated AS (
    SELECT
        department_id AS department_key,
        department_name,
        COUNT(*) AS total_encounters,
        SUM(charge_amount) AS total_charges,
        SUM(paid_amount) AS total_payments,
        RANK() OVER (ORDER BY SUM(charge_amount) DESC) AS revenue_rank
    FROM joined
    GROUP BY department_id, department_name
)

-- Step 5: Output
SELECT * FROM aggregated
        );
[0m01:33:32.978680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:34.268181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.289 seconds
[0m01:33:34.271686 [debug] [Thread-1 (]: On model.healthcare.department_revenue_summary: Close
[0m01:33:34.427590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadeb4140>]}
[0m01:33:34.432155 [info ] [Thread-1 (]: 14 of 20 OK created sql table model GOLD.department_revenue_summary ............ [[32mSUCCESS 1[0m in 1.51s]
[0m01:33:34.436367 [debug] [Thread-1 (]: Finished running node model.healthcare.department_revenue_summary
[0m01:33:34.439798 [debug] [Thread-1 (]: Began running node model.healthcare.patient_utilization_summary
[0m01:33:34.442861 [info ] [Thread-1 (]: 15 of 20 START sql table model GOLD.patient_utilization_summary ................ [RUN]
[0m01:33:34.445753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.department_revenue_summary, now model.healthcare.patient_utilization_summary)
[0m01:33:34.447400 [debug] [Thread-1 (]: Began compiling node model.healthcare.patient_utilization_summary
[0m01:33:34.452471 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.patient_utilization_summary"
[0m01:33:34.478311 [debug] [Thread-1 (]: Began executing node model.healthcare.patient_utilization_summary
[0m01:33:34.482308 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.patient_utilization_summary"
[0m01:33:34.501036 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.patient_utilization_summary"
[0m01:33:34.503008 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.patient_utilization_summary"} */
create or replace transient table DBT_DB.GOLD.patient_utilization_summary
         as
        (

-- Step 1: encounter counts per patient
WITH encounter_summary AS (
    SELECT
        patient_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY patient_id
),

-- Step 2: transaction summary per patient
transaction_summary AS (
    SELECT
        patient_id,
        COUNT(*) AS total_procedures,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY patient_id
),

-- Step 3: combine metrics at patient level
combined_metrics AS (
    SELECT
        COALESCE(e.patient_id, t.patient_id) AS patient_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_procedures, 0) AS total_procedures,
        COALESCE(total_charges, 0) AS total_charges
    FROM encounter_summary e
    FULL OUTER JOIN transaction_summary t
        ON e.patient_id = t.patient_id
),

-- Step 4: enrich with demographic data
final AS (
    SELECT
        cm.patient_id,
        p.first_name,
        p.last_name,
        p.gender_flag,
        p.age,
        p.age_group,
        cm.total_encounters,
        cm.total_procedures,
        cm.total_charges
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_patients p
        ON cm.patient_id = p.patient_key
)

SELECT * FROM final
        );
[0m01:33:34.504833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:35.924828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.420 seconds
[0m01:33:35.931905 [debug] [Thread-1 (]: On model.healthcare.patient_utilization_summary: Close
[0m01:33:36.090340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadf22cf0>]}
[0m01:33:36.093455 [info ] [Thread-1 (]: 15 of 20 OK created sql table model GOLD.patient_utilization_summary ........... [[32mSUCCESS 1[0m in 1.64s]
[0m01:33:36.095846 [debug] [Thread-1 (]: Finished running node model.healthcare.patient_utilization_summary
[0m01:33:36.099203 [debug] [Thread-1 (]: Began running node model.healthcare.ar_balance_summary
[0m01:33:36.101599 [info ] [Thread-1 (]: 16 of 20 START sql table model GOLD.ar_balance_summary ......................... [RUN]
[0m01:33:36.103933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.patient_utilization_summary, now model.healthcare.ar_balance_summary)
[0m01:33:36.105983 [debug] [Thread-1 (]: Began compiling node model.healthcare.ar_balance_summary
[0m01:33:36.110671 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.ar_balance_summary"
[0m01:33:36.128703 [debug] [Thread-1 (]: Began executing node model.healthcare.ar_balance_summary
[0m01:33:36.133577 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.ar_balance_summary"
[0m01:33:36.152181 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.ar_balance_summary"
[0m01:33:36.154387 [debug] [Thread-1 (]: On model.healthcare.ar_balance_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.ar_balance_summary"} */
create or replace transient table DBT_DB.GOLD.ar_balance_summary
         as
        (

with txn as (
    select
        provider_id,
        transaction_id,
        coalesce(charge_amount, 0) as billed_amount
    from DBT_DB.SILVER.src_transactions
),

claims as (
    select
        transaction_id,
        coalesce(paid_amount, 0) as paid_amount
    from DBT_DB.SILVER.src_claims
),

joined as (
    select
        t.provider_id,
        t.transaction_id,
        t.billed_amount,
        c.paid_amount
    from txn t
    left join claims c
        on t.transaction_id = c.transaction_id
),

aggregated as (
    select
        provider_id,
        count(*) as total_transactions,
        sum(billed_amount) as total_billed,
        sum(paid_amount) as total_paid,
        sum(greatest(billed_amount - paid_amount, 0)) as ar_balance
    from joined
    group by provider_id
),

with_provider_details as (
    select
        a.provider_id,
        p.full_name,
        p.specialization,
        a.total_transactions,
        a.total_billed,
        a.total_paid,
        a.ar_balance
    from aggregated a
    left join DBT_DB.GOLD.dim_providers p
        on a.provider_id = p.provider_id
)

select * from with_provider_details
        );
[0m01:33:36.156517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:37.635197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.478 seconds
[0m01:33:37.641595 [debug] [Thread-1 (]: On model.healthcare.ar_balance_summary: Close
[0m01:33:37.794429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aac531040>]}
[0m01:33:37.796457 [info ] [Thread-1 (]: 16 of 20 OK created sql table model GOLD.ar_balance_summary .................... [[32mSUCCESS 1[0m in 1.69s]
[0m01:33:37.798620 [debug] [Thread-1 (]: Finished running node model.healthcare.ar_balance_summary
[0m01:33:37.800602 [debug] [Thread-1 (]: Began running node model.healthcare.denials_by_dept_provider
[0m01:33:37.802611 [info ] [Thread-1 (]: 17 of 20 START sql table model GOLD.denials_by_dept_provider ................... [RUN]
[0m01:33:37.804024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.ar_balance_summary, now model.healthcare.denials_by_dept_provider)
[0m01:33:37.805100 [debug] [Thread-1 (]: Began compiling node model.healthcare.denials_by_dept_provider
[0m01:33:37.809195 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.denials_by_dept_provider"
[0m01:33:37.827411 [debug] [Thread-1 (]: Began executing node model.healthcare.denials_by_dept_provider
[0m01:33:37.831061 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.denials_by_dept_provider"
[0m01:33:37.852864 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.denials_by_dept_provider"
[0m01:33:37.855078 [debug] [Thread-1 (]: On model.healthcare.denials_by_dept_provider: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.denials_by_dept_provider"} */
create or replace transient table DBT_DB.GOLD.denials_by_dept_provider
         as
        (

with base as (
    select
        provider_id,
        dept_id,
        claim_status
    from DBT_DB.SILVER.src_claims
    where upper(claim_status) = 'DENIED'
),

agg as (
    select
        provider_id,
        dept_id,
        count(*) as denial_count
    from base
    group by provider_id, dept_id
)

select 
    a.provider_id,
    p.full_name,
    p.specialization,
    a.dept_id,
    d.department_name,
    a.denial_count
from agg a
left join DBT_DB.GOLD.dim_providers p on a.provider_id = p.provider_id
left join DBT_DB.GOLD.dim_departments d on a.dept_id = d.department_key
order by denial_count desc
        );
[0m01:33:37.856840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:38.953347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.096 seconds
[0m01:33:38.961799 [debug] [Thread-1 (]: On model.healthcare.denials_by_dept_provider: Close
[0m01:33:39.124663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4ab35feea0>]}
[0m01:33:39.130749 [info ] [Thread-1 (]: 17 of 20 OK created sql table model GOLD.denials_by_dept_provider .............. [[32mSUCCESS 1[0m in 1.32s]
[0m01:33:39.133283 [debug] [Thread-1 (]: Finished running node model.healthcare.denials_by_dept_provider
[0m01:33:39.137981 [debug] [Thread-1 (]: Began running node model.healthcare.missing_providers_audit
[0m01:33:39.140272 [info ] [Thread-1 (]: 18 of 20 START sql table model GOLD.missing_providers_audit .................... [RUN]
[0m01:33:39.142773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.denials_by_dept_provider, now model.healthcare.missing_providers_audit)
[0m01:33:39.147086 [debug] [Thread-1 (]: Began compiling node model.healthcare.missing_providers_audit
[0m01:33:39.152748 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.missing_providers_audit"
[0m01:33:39.178320 [debug] [Thread-1 (]: Began executing node model.healthcare.missing_providers_audit
[0m01:33:39.182078 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.missing_providers_audit"
[0m01:33:39.200268 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.missing_providers_audit"
[0m01:33:39.201953 [debug] [Thread-1 (]: On model.healthcare.missing_providers_audit: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.missing_providers_audit"} */
create or replace transient table DBT_DB.GOLD.missing_providers_audit
         as
        (

SELECT
    provider_id,
    COUNT(*) AS occurrence_count,
    'encounters' AS source_table
FROM DBT_DB.SILVER.src_encounters
WHERE provider_id NOT IN (SELECT provider_id FROM DBT_DB.GOLD.dim_providers)
GROUP BY provider_id

UNION ALL

SELECT
    provider_id,
    COUNT(*) AS occurrence_count,
    'transactions' AS source_table
FROM DBT_DB.SILVER.src_transactions
WHERE provider_id NOT IN (SELECT provider_id FROM DBT_DB.GOLD.dim_providers)
GROUP BY provider_id
        );
[0m01:33:39.203645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:40.574453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.371 seconds
[0m01:33:40.577720 [debug] [Thread-1 (]: On model.healthcare.missing_providers_audit: Close
[0m01:33:41.103115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadec8650>]}
[0m01:33:41.110633 [info ] [Thread-1 (]: 18 of 20 OK created sql table model GOLD.missing_providers_audit ............... [[32mSUCCESS 1[0m in 1.96s]
[0m01:33:41.113054 [debug] [Thread-1 (]: Finished running node model.healthcare.missing_providers_audit
[0m01:33:41.116090 [debug] [Thread-1 (]: Began running node model.healthcare.provider_department_revenue_summary
[0m01:33:41.118370 [info ] [Thread-1 (]: 19 of 20 START sql table model GOLD.provider_department_revenue_summary ........ [RUN]
[0m01:33:41.120536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.missing_providers_audit, now model.healthcare.provider_department_revenue_summary)
[0m01:33:41.122242 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_department_revenue_summary
[0m01:33:41.127218 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_department_revenue_summary"
[0m01:33:41.153924 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_department_revenue_summary
[0m01:33:41.157217 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_department_revenue_summary"
[0m01:33:41.174573 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_department_revenue_summary"
[0m01:33:41.176269 [debug] [Thread-1 (]: On model.healthcare.provider_department_revenue_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_department_revenue_summary"} */
create or replace transient table DBT_DB.GOLD.provider_department_revenue_summary
         as
        (

WITH txn AS (
    SELECT
        provider_id,
        department_id,
        COALESCE(charge_amount, 0) AS charge_amount
    FROM DBT_DB.SILVER.src_transactions
),

providers AS (
    SELECT
        provider_id,
        full_name,
        specialization
    FROM DBT_DB.GOLD.dim_providers
),

departments AS (
    SELECT
        department_key,
        department_name
    FROM DBT_DB.GOLD.dim_departments
),

joined AS (
    SELECT
        t.provider_id,
        p.full_name,
        p.specialization,
        t.department_id,
        d.department_name,
        t.charge_amount
    FROM txn t
    LEFT JOIN providers p ON t.provider_id = p.provider_id
    LEFT JOIN departments d ON t.department_id = d.department_key
),

aggregated AS (
    SELECT
        provider_id,
        full_name,
        specialization,
        department_id,
        department_name,
        SUM(charge_amount) AS total_charges,
        COUNT(*) AS total_visits
    FROM joined
    GROUP BY provider_id, full_name, specialization, department_id, department_name
)

SELECT * FROM aggregated
        );
[0m01:33:41.178186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:42.540825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.362 seconds
[0m01:33:42.545867 [debug] [Thread-1 (]: On model.healthcare.provider_department_revenue_summary: Close
[0m01:33:42.715449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadffa840>]}
[0m01:33:42.717580 [info ] [Thread-1 (]: 19 of 20 OK created sql table model GOLD.provider_department_revenue_summary ... [[32mSUCCESS 1[0m in 1.59s]
[0m01:33:42.721161 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_department_revenue_summary
[0m01:33:42.726661 [debug] [Thread-1 (]: Began running node model.healthcare.provider_performance_summary
[0m01:33:42.729040 [info ] [Thread-1 (]: 20 of 20 START sql table model GOLD.provider_performance_summary ............... [RUN]
[0m01:33:42.730962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare.provider_department_revenue_summary, now model.healthcare.provider_performance_summary)
[0m01:33:42.732709 [debug] [Thread-1 (]: Began compiling node model.healthcare.provider_performance_summary
[0m01:33:42.736717 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare.provider_performance_summary"
[0m01:33:42.753967 [debug] [Thread-1 (]: Began executing node model.healthcare.provider_performance_summary
[0m01:33:42.757393 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare.provider_performance_summary"
[0m01:33:42.783459 [debug] [Thread-1 (]: Using snowflake connection "model.healthcare.provider_performance_summary"
[0m01:33:42.785719 [debug] [Thread-1 (]: On model.healthcare.provider_performance_summary: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "healthcare", "target_name": "dev", "node_id": "model.healthcare.provider_performance_summary"} */
create or replace transient table DBT_DB.GOLD.provider_performance_summary
         as
        (

WITH encounter_counts AS (
    SELECT
        provider_id,
        COUNT(DISTINCT encounter_id) AS total_encounters
    FROM DBT_DB.SILVER.src_encounters
    GROUP BY provider_id
),

transaction_sums AS (
    SELECT
        provider_id,
        SUM(COALESCE(charge_amount, 0)) AS total_charges
    FROM DBT_DB.SILVER.src_transactions
    GROUP BY provider_id
),

claims_with_providers AS (
    SELECT
        t.provider_id,
        SUM(COALESCE(c.paid_amount, 0)) AS total_payments
    FROM DBT_DB.SILVER.src_transactions t
    LEFT JOIN DBT_DB.SILVER.src_claims c
        ON t.transaction_id = c.transaction_id
    GROUP BY t.provider_id
),

combined_metrics AS (
    SELECT
        COALESCE(e.provider_id, t.provider_id, c.provider_id) AS provider_id,
        COALESCE(total_encounters, 0) AS total_encounters,
        COALESCE(total_charges, 0) AS total_charges,
        COALESCE(total_payments, 0) AS total_payments
    FROM encounter_counts e
    FULL OUTER JOIN transaction_sums t ON e.provider_id = t.provider_id
    FULL OUTER JOIN claims_with_providers c ON COALESCE(e.provider_id, t.provider_id) = c.provider_id
),

final AS (
    SELECT
        cm.provider_id,
        p.full_name,
        p.specialization,
        p.dept_id,
        cm.total_encounters,
        cm.total_charges,
        cm.total_payments,
        ROUND(CASE 
            WHEN cm.total_encounters > 0 THEN cm.total_charges / cm.total_encounters
            ELSE NULL
        END, 2) AS avg_charge_per_encounter
    FROM combined_metrics cm
    INNER JOIN DBT_DB.GOLD.dim_providers p
        ON cm.provider_id = p.provider_id
)

SELECT * FROM final
        );
[0m01:33:42.788421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:44.237872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.449 seconds
[0m01:33:44.241664 [debug] [Thread-1 (]: On model.healthcare.provider_performance_summary: Close
[0m01:33:44.401415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d8c25-9699-4fd3-bc69-758cdbb7f33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aadf6ea20>]}
[0m01:33:44.404497 [info ] [Thread-1 (]: 20 of 20 OK created sql table model GOLD.provider_performance_summary .......... [[32mSUCCESS 1[0m in 1.67s]
[0m01:33:44.409628 [debug] [Thread-1 (]: Finished running node model.healthcare.provider_performance_summary
[0m01:33:44.417027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:33:44.419428 [debug] [MainThread]: Connection 'model.healthcare.provider_performance_summary' was properly closed.
[0m01:33:44.420873 [info ] [MainThread]: 
[0m01:33:44.422209 [info ] [MainThread]: Finished running 7 view models, 13 table models in 0 hours 0 minutes and 27.32 seconds (27.32s).
[0m01:33:44.425875 [debug] [MainThread]: Command end result
[0m01:33:44.538760 [info ] [MainThread]: 
[0m01:33:44.540709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:33:44.542002 [info ] [MainThread]: 
[0m01:33:44.543625 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 TOTAL=20
[0m01:33:44.546284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.551083, "process_user_time": 2.551669, "process_kernel_time": 0.335847, "process_mem_max_rss": "135504", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m01:33:44.548993 [debug] [MainThread]: Command `dbt run` succeeded at 01:33:44.548699 after 30.55 seconds
[0m01:33:44.551427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4aaeb71880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4ab2e87260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4ab06e3b90>]}
[0m01:33:44.553389 [debug] [MainThread]: Flushing usage events
